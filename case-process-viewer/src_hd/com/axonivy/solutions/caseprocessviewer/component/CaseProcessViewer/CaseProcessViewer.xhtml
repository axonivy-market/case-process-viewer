<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite"
  xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://java.sun.com/jsp/jstl/core">
<cc:interface componentType="IvyComponent">
  <cc:attribute name="header" />
</cc:interface>

<cc:implementation>
  <h:outputScript name="resources/html2canvas.min.js" target="head" />
  <h:outputScript name="resources/custom-case-process-viewer.js"
    target="head" />
  <h:outputStylesheet library="css"
    name="custom-case-process-viewer.css" />
  <p:graphicImage id="process-url-hidden-image" library="ivy-cms"
    name="#{caseProcessViewerBean.processUrl}" />

  <h:panelGroup id="viewer-group" layout="block">
    <p:panel id="viewer-panel" widgetVar="viewer-panel"
      toggleable="true" toggleSpeed="500"
      toggleTitle="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/component/ProcessViewer/ToggleTooltip')}"
      styleClass="viewer-group">
      <f:facet name="header">
        <h:outputText rendered="#{not empty cc.attrs.header}"
          value="#{cc.attrs.header}" />
        <h:outputText rendered="#{empty cc.attrs.header}"
          value="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/caseprocessviewer/component/ProcessViewer/CaseProcessViewer')}" />
        <p:outputLabel id="header-tooltip">
          <i class="ui-icon pi pi-info-circle ml-1" />
        </p:outputLabel>
        <p:tooltip for="header-tooltip" trackMouse="true"
          value="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/caseprocessviewer/component/ProcessViewer/ResizeTooltip')}" />
      </f:facet>
      <f:facet name="actions">
        <h:panelGroup styleClass="flex flex-row-reverse">
          <p:commandLink id="open-viewer-on-new-tab-link"
            styleClass="ui-panel-titlebar-icon ui-corner-all ui-state-default"
            onclick="openViewerInNewTab()" update="@none"
            disabled="#{!caseProcessViewerBean.shouldRenderBpmnFrame()}"
            process="@this" partialSubmit="true" immediate="true">
            <h:outputText styleClass="ui-icon pi pi-external-link" />
          </p:commandLink>
          <p:tooltip for="@previous" trackMouse="true"
            value="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/component/ProcessViewer/OpenOnNewTabTooltip')}" />
        </h:panelGroup>
      </f:facet>
      <h:panelGroup
        rendered="#{caseProcessViewerBean.shouldRenderBpmnFrame()}">
        <iframe id="case-process-viewer"
          src="#{caseProcessViewerBean.bpmnIframeSourceUrl}" width="100%"
          height="100%" class="case-process-viewer"
          onload="loadIframe(false)" />
      </h:panelGroup>
    </p:panel>
    <p:resizable id="viewer-group-resize" for="viewer-panel"
      animate="true" ghost="true" grid="20" handles="s" proxy="true" />
  </h:panelGroup>
</cc:implementation>
</html>
