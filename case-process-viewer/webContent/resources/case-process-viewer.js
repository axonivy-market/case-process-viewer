var _G=Object.defineProperty;var yw=e=>{throw TypeError(e)};var bG=(e,n,t)=>n in e?_G(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var x=(e,n,t)=>bG(e,typeof n!="symbol"?n+"":n,t),_w=(e,n,t)=>n.has(e)||yw("Cannot "+t);var Fe=(e,n,t)=>(_w(e,n,"read from private field"),t?t.call(e):n.get(e)),Zn=(e,n,t)=>n.has(e)?yw("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,t),Dn=(e,n,t,i)=>(_w(e,n,"write to private field"),i?i.call(e,t):n.set(e,t),t);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();var ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function V8(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function G8(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var t=function i(){return this instanceof i?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}),t}var bw={};/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Sw;function bC(){if(Sw)return bw;Sw=1;var e;return function(n){(function(t){var i=typeof globalThis=="object"?globalThis:typeof ka=="object"?ka:typeof self=="object"?self:typeof this=="object"?this:d(),a=o(n);typeof i.Reflect<"u"&&(a=o(i.Reflect,a)),t(a,i),typeof i.Reflect>"u"&&(i.Reflect=n);function o(l,c){return function(u,f){Object.defineProperty(l,u,{configurable:!0,writable:!0,value:f}),c&&c(u,f)}}function s(){try{return Function("return this;")()}catch{}}function r(){try{return(0,eval)("(function() { return this; })()")}catch{}}function d(){return s()||r()}})(function(t,i){var a=Object.prototype.hasOwnProperty,o=typeof Symbol=="function",s=o&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",r=o&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",d=typeof Object.create=="function",l={__proto__:[]}instanceof Array,c=!d&&!l,u={create:d?function(){return Ja(Object.create(null))}:l?function(){return Ja({__proto__:null})}:function(){return Ja({})},has:c?function(X,te){return a.call(X,te)}:function(X,te){return te in X},get:c?function(X,te){return a.call(X,te)?X[te]:void 0}:function(X,te){return X[te]}},f=Object.getPrototypeOf(Function),h=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Zo(),p=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Qr(),g=typeof WeakMap=="function"?WeakMap:eu(),m=o?Symbol.for("@reflect-metadata:registry"):void 0,v=vh(),_=Qa(v);function S(X,te,re,me){if(pe(re)){if(!Ge(X))throw new TypeError;if(!he(te))throw new TypeError;return D(X,te)}else{if(!Ge(X))throw new TypeError;if(!Be(te))throw new TypeError;if(!Be(me)&&!pe(me)&&!et(me))throw new TypeError;return et(me)&&(me=void 0),re=Le(re),B(X,te,re,me)}}t("decorate",S);function E(X,te){function re(me,Ne){if(!Be(me))throw new TypeError;if(!pe(Ne)&&!Ke(Ne))throw new TypeError;Z(X,te,me,Ne)}return re}t("metadata",E);function C(X,te,re,me){if(!Be(re))throw new TypeError;return pe(me)||(me=Le(me)),Z(X,te,re,me)}t("defineMetadata",C);function M(X,te,re){if(!Be(te))throw new TypeError;return pe(re)||(re=Le(re)),H(X,te,re)}t("hasMetadata",M);function L(X,te,re){if(!Be(te))throw new TypeError;return pe(re)||(re=Le(re)),F(X,te,re)}t("hasOwnMetadata",L);function I(X,te,re){if(!Be(te))throw new TypeError;return pe(re)||(re=Le(re)),K(X,te,re)}t("getMetadata",I);function R(X,te,re){if(!Be(te))throw new TypeError;return pe(re)||(re=Le(re)),U(X,te,re)}t("getOwnMetadata",R);function w(X,te){if(!Be(X))throw new TypeError;return pe(te)||(te=Le(te)),ce(X,te)}t("getMetadataKeys",w);function T(X,te){if(!Be(X))throw new TypeError;return pe(te)||(te=Le(te)),de(X,te)}t("getOwnMetadataKeys",T);function j(X,te,re){if(!Be(te))throw new TypeError;if(pe(re)||(re=Le(re)),!Be(te))throw new TypeError;pe(re)||(re=Le(re));var me=zi(te,re,!1);return pe(me)?!1:me.OrdinaryDeleteMetadata(X,te,re)}t("deleteMetadata",j);function D(X,te){for(var re=X.length-1;re>=0;--re){var me=X[re],Ne=me(te);if(!pe(Ne)&&!et(Ne)){if(!he(Ne))throw new TypeError;te=Ne}}return te}function B(X,te,re,me){for(var Ne=X.length-1;Ne>=0;--Ne){var jt=X[Ne],Jt=jt(te,re,me);if(!pe(Jt)&&!et(Jt)){if(!Be(Jt))throw new TypeError;me=Jt}}return me}function H(X,te,re){var me=F(X,te,re);if(me)return!0;var Ne=Lt(te);return et(Ne)?!1:H(X,Ne,re)}function F(X,te,re){var me=zi(te,re,!1);return pe(me)?!1:fe(me.OrdinaryHasOwnMetadata(X,te,re))}function K(X,te,re){var me=F(X,te,re);if(me)return U(X,te,re);var Ne=Lt(te);if(!et(Ne))return K(X,Ne,re)}function U(X,te,re){var me=zi(te,re,!1);if(!pe(me))return me.OrdinaryGetOwnMetadata(X,te,re)}function Z(X,te,re,me){var Ne=zi(re,me,!0);Ne.OrdinaryDefineOwnMetadata(X,te,re,me)}function ce(X,te){var re=de(X,te),me=Lt(X);if(me===null)return re;var Ne=ce(me,te);if(Ne.length<=0)return re;if(re.length<=0)return Ne;for(var jt=new p,Jt=[],Ze=0,Ee=re;Ze<Ee.length;Ze++){var be=Ee[Ze],Re=jt.has(be);Re||(jt.add(be),Jt.push(be))}for(var we=0,Ye=Ne;we<Ye.length;we++){var be=Ye[we],Re=jt.has(be);Re||(jt.add(be),Jt.push(be))}return Jt}function de(X,te){var re=zi(X,te,!1);return re?re.OrdinaryOwnMetadataKeys(X,te):[]}function ke(X){if(X===null)return 1;switch(typeof X){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return X===null?1:6;default:return 6}}function pe(X){return X===void 0}function et(X){return X===null}function ot(X){return typeof X=="symbol"}function Be(X){return typeof X=="object"?X!==null:typeof X=="function"}function ee(X,te){switch(ke(X)){case 0:return X;case 1:return X;case 2:return X;case 3:return X;case 4:return X;case 5:return X}var re="string",me=At(X,s);if(me!==void 0){var Ne=me.call(X,re);if(Be(Ne))throw new TypeError;return Ne}return ge(X)}function ge(X,te){var re,me,Ne;{var jt=X.toString;if(pn(jt)){var me=jt.call(X);if(!Be(me))return me}var re=X.valueOf;if(pn(re)){var me=re.call(X);if(!Be(me))return me}}throw new TypeError}function fe(X){return!!X}function Ae(X){return""+X}function Le(X){var te=ee(X);return ot(te)?te:Ae(te)}function Ge(X){return Array.isArray?Array.isArray(X):X instanceof Object?X instanceof Array:Object.prototype.toString.call(X)==="[object Array]"}function pn(X){return typeof X=="function"}function he(X){return typeof X=="function"}function Ke(X){switch(ke(X)){case 3:return!0;case 4:return!0;default:return!1}}function Kt(X,te){return X===te||X!==X&&te!==te}function At(X,te){var re=X[te];if(re!=null){if(!pn(re))throw new TypeError;return re}}function cn(X){var te=At(X,r);if(!pn(te))throw new TypeError;var re=te.call(X);if(!Be(re))throw new TypeError;return re}function gn(X){return X.value}function Kn(X){var te=X.next();return te.done?!1:te}function dt(X){var te=X.return;te&&te.call(X)}function Lt(X){var te=Object.getPrototypeOf(X);if(typeof X!="function"||X===f||te!==f)return te;var re=X.prototype,me=re&&Object.getPrototypeOf(re);if(me==null||me===Object.prototype)return te;var Ne=me.constructor;return typeof Ne!="function"||Ne===X?te:Ne}function Gi(){var X;!pe(m)&&typeof i.Reflect<"u"&&!(m in i.Reflect)&&typeof i.Reflect.defineMetadata=="function"&&(X=yh(i.Reflect));var te,re,me,Ne=new g,jt={registerProvider:Jt,getProvider:Ee,setProvider:Re};return jt;function Jt(we){if(!Object.isExtensible(jt))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case X===we:break;case pe(te):te=we;break;case te===we:break;case pe(re):re=we;break;case re===we:break;default:me===void 0&&(me=new p),me.add(we);break}}function Ze(we,Ye){if(!pe(te)){if(te.isProviderFor(we,Ye))return te;if(!pe(re)){if(re.isProviderFor(we,Ye))return te;if(!pe(me))for(var St=cn(me);;){var Nt=Kn(St);if(!Nt)return;var mi=gn(Nt);if(mi.isProviderFor(we,Ye))return dt(St),mi}}}if(!pe(X)&&X.isProviderFor(we,Ye))return X}function Ee(we,Ye){var St=Ne.get(we),Nt;return pe(St)||(Nt=St.get(Ye)),pe(Nt)&&(Nt=Ze(we,Ye),pe(Nt)||(pe(St)&&(St=new h,Ne.set(we,St)),St.set(Ye,Nt))),Nt}function be(we){if(pe(we))throw new TypeError;return te===we||re===we||!pe(me)&&me.has(we)}function Re(we,Ye,St){if(!be(St))throw new Error("Metadata provider not registered.");var Nt=Ee(we,Ye);if(Nt!==St){if(!pe(Nt))return!1;var mi=Ne.get(we);pe(mi)&&(mi=new h,Ne.set(we,mi)),mi.set(Ye,St)}return!0}}function vh(){var X;return!pe(m)&&Be(i.Reflect)&&Object.isExtensible(i.Reflect)&&(X=i.Reflect[m]),pe(X)&&(X=Gi()),!pe(m)&&Be(i.Reflect)&&Object.isExtensible(i.Reflect)&&Object.defineProperty(i.Reflect,m,{enumerable:!1,configurable:!1,writable:!1,value:X}),X}function Qa(X){var te=new g,re={isProviderFor:function(be,Re){var we=te.get(be);return pe(we)?!1:we.has(Re)},OrdinaryDefineOwnMetadata:Jt,OrdinaryHasOwnMetadata:Ne,OrdinaryGetOwnMetadata:jt,OrdinaryOwnMetadataKeys:Ze,OrdinaryDeleteMetadata:Ee};return v.registerProvider(re),re;function me(be,Re,we){var Ye=te.get(be),St=!1;if(pe(Ye)){if(!we)return;Ye=new h,te.set(be,Ye),St=!0}var Nt=Ye.get(Re);if(pe(Nt)){if(!we)return;if(Nt=new h,Ye.set(Re,Nt),!X.setProvider(be,Re,re))throw Ye.delete(Re),St&&te.delete(be),new Error("Wrong provider for target.")}return Nt}function Ne(be,Re,we){var Ye=me(Re,we,!1);return pe(Ye)?!1:fe(Ye.has(be))}function jt(be,Re,we){var Ye=me(Re,we,!1);if(!pe(Ye))return Ye.get(be)}function Jt(be,Re,we,Ye){var St=me(we,Ye,!0);St.set(be,Re)}function Ze(be,Re){var we=[],Ye=me(be,Re,!1);if(pe(Ye))return we;for(var St=Ye.keys(),Nt=cn(St),mi=0;;){var Qo=Kn(Nt);if(!Qo)return we.length=mi,we;var Xa=gn(Qo);try{we[mi]=Xa}catch(_h){try{dt(Nt)}finally{throw _h}}mi++}}function Ee(be,Re,we){var Ye=me(Re,we,!1);if(pe(Ye)||!Ye.delete(be))return!1;if(Ye.size===0){var St=te.get(Re);pe(St)||(St.delete(we),St.size===0&&te.delete(St))}return!0}}function yh(X){var te=X.defineMetadata,re=X.hasOwnMetadata,me=X.getOwnMetadata,Ne=X.getOwnMetadataKeys,jt=X.deleteMetadata,Jt=new g,Ze={isProviderFor:function(Ee,be){var Re=Jt.get(Ee);return!pe(Re)&&Re.has(be)?!0:Ne(Ee,be).length?(pe(Re)&&(Re=new p,Jt.set(Ee,Re)),Re.add(be),!0):!1},OrdinaryDefineOwnMetadata:te,OrdinaryHasOwnMetadata:re,OrdinaryGetOwnMetadata:me,OrdinaryOwnMetadataKeys:Ne,OrdinaryDeleteMetadata:jt};return Ze}function zi(X,te,re){var me=v.getProvider(X,te);if(!pe(me))return me;if(re){if(v.setProvider(X,te,_))return _;throw new Error("Illegal state.")}}function Zo(){var X={},te=[],re=function(){function Ze(Ee,be,Re){this._index=0,this._keys=Ee,this._values=be,this._selector=Re}return Ze.prototype["@@iterator"]=function(){return this},Ze.prototype[r]=function(){return this},Ze.prototype.next=function(){var Ee=this._index;if(Ee>=0&&Ee<this._keys.length){var be=this._selector(this._keys[Ee],this._values[Ee]);return Ee+1>=this._keys.length?(this._index=-1,this._keys=te,this._values=te):this._index++,{value:be,done:!1}}return{value:void 0,done:!0}},Ze.prototype.throw=function(Ee){throw this._index>=0&&(this._index=-1,this._keys=te,this._values=te),Ee},Ze.prototype.return=function(Ee){return this._index>=0&&(this._index=-1,this._keys=te,this._values=te),{value:Ee,done:!0}},Ze}(),me=function(){function Ze(){this._keys=[],this._values=[],this._cacheKey=X,this._cacheIndex=-2}return Object.defineProperty(Ze.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Ze.prototype.has=function(Ee){return this._find(Ee,!1)>=0},Ze.prototype.get=function(Ee){var be=this._find(Ee,!1);return be>=0?this._values[be]:void 0},Ze.prototype.set=function(Ee,be){var Re=this._find(Ee,!0);return this._values[Re]=be,this},Ze.prototype.delete=function(Ee){var be=this._find(Ee,!1);if(be>=0){for(var Re=this._keys.length,we=be+1;we<Re;we++)this._keys[we-1]=this._keys[we],this._values[we-1]=this._values[we];return this._keys.length--,this._values.length--,Kt(Ee,this._cacheKey)&&(this._cacheKey=X,this._cacheIndex=-2),!0}return!1},Ze.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=X,this._cacheIndex=-2},Ze.prototype.keys=function(){return new re(this._keys,this._values,Ne)},Ze.prototype.values=function(){return new re(this._keys,this._values,jt)},Ze.prototype.entries=function(){return new re(this._keys,this._values,Jt)},Ze.prototype["@@iterator"]=function(){return this.entries()},Ze.prototype[r]=function(){return this.entries()},Ze.prototype._find=function(Ee,be){if(!Kt(this._cacheKey,Ee)){this._cacheIndex=-1;for(var Re=0;Re<this._keys.length;Re++)if(Kt(this._keys[Re],Ee)){this._cacheIndex=Re;break}}return this._cacheIndex<0&&be&&(this._cacheIndex=this._keys.length,this._keys.push(Ee),this._values.push(void 0)),this._cacheIndex},Ze}();return me;function Ne(Ze,Ee){return Ze}function jt(Ze,Ee){return Ee}function Jt(Ze,Ee){return[Ze,Ee]}}function Qr(){var X=function(){function te(){this._map=new h}return Object.defineProperty(te.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),te.prototype.has=function(re){return this._map.has(re)},te.prototype.add=function(re){return this._map.set(re,re),this},te.prototype.delete=function(re){return this._map.delete(re)},te.prototype.clear=function(){this._map.clear()},te.prototype.keys=function(){return this._map.keys()},te.prototype.values=function(){return this._map.keys()},te.prototype.entries=function(){return this._map.entries()},te.prototype["@@iterator"]=function(){return this.keys()},te.prototype[r]=function(){return this.keys()},te}();return X}function eu(){var X=16,te=u.create(),re=me();return function(){function Ee(){this._key=me()}return Ee.prototype.has=function(be){var Re=Ne(be,!1);return Re!==void 0?u.has(Re,this._key):!1},Ee.prototype.get=function(be){var Re=Ne(be,!1);return Re!==void 0?u.get(Re,this._key):void 0},Ee.prototype.set=function(be,Re){var we=Ne(be,!0);return we[this._key]=Re,this},Ee.prototype.delete=function(be){var Re=Ne(be,!1);return Re!==void 0?delete Re[this._key]:!1},Ee.prototype.clear=function(){this._key=me()},Ee}();function me(){var Ee;do Ee="@@WeakMap@@"+Ze();while(u.has(te,Ee));return te[Ee]=!0,Ee}function Ne(Ee,be){if(!a.call(Ee,re)){if(!be)return;Object.defineProperty(Ee,re,{value:u.create()})}return Ee[re]}function jt(Ee,be){for(var Re=0;Re<be;++Re)Ee[Re]=Math.random()*255|0;return Ee}function Jt(Ee){if(typeof Uint8Array=="function"){var be=new Uint8Array(Ee);return typeof crypto<"u"?crypto.getRandomValues(be):typeof msCrypto<"u"?msCrypto.getRandomValues(be):jt(be,Ee),be}return jt(new Array(Ee),Ee)}function Ze(){var Ee=Jt(X);Ee[6]=Ee[6]&79|64,Ee[8]=Ee[8]&191|128;for(var be="",Re=0;Re<X;++Re){var we=Ee[Re];(Re===4||Re===6||Re===8)&&(be+="-"),we<16&&(be+="0"),be+=we.toString(16).toLowerCase()}return be}}function Ja(X){return X.__=void 0,delete X.__,X}})}(e||(e={})),bw}bC();var Cl={},Bs={},Pl={},ns={},uc={},db={},Xv={},Ew;function SG(){if(Ew)return Xv;Ew=1,Object.defineProperty(Xv,"__esModule",{value:!0}),Xv.stringifyServiceIdentifier=e;function e(n){switch(typeof n){case"string":case"symbol":return n.toString();case"function":return n.name;default:throw new Error(`Unexpected ${typeof n} service id type`)}}return Xv}var fb={},Cw;function EG(){return Cw||(Cw=1,function(e){var t,i;Object.defineProperty(e,"__esModule",{value:!0}),e.LazyServiceIdentifier=e.islazyServiceIdentifierSymbol=void 0,e.islazyServiceIdentifierSymbol=Symbol.for("@inversifyjs/common/islazyServiceIdentifier"),t=e.islazyServiceIdentifierSymbol;class n{constructor(o){x(this,t);Zn(this,i);Dn(this,i,o),this[e.islazyServiceIdentifierSymbol]=!0}static is(o){return typeof o=="object"&&o!==null&&o[e.islazyServiceIdentifierSymbol]===!0}unwrap(){return Fe(this,i).call(this)}}i=new WeakMap,e.LazyServiceIdentifier=n}(fb)),fb}var Pw;function LS(){return Pw||(Pw=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.stringifyServiceIdentifier=e.LazyServiceIdentifier=void 0;const n=SG();Object.defineProperty(e,"stringifyServiceIdentifier",{enumerable:!0,get:function(){return n.stringifyServiceIdentifier}});const t=EG();Object.defineProperty(e,"LazyServiceIdentifier",{enumerable:!0,get:function(){return t.LazyServiceIdentifier}})}(db)),db}var hb={},Rw;function Gn(){return Rw||(Rw=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.PRE_DESTROY=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.PRE_DESTROY="pre_destroy";function n(){return[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]}e.NON_CUSTOM_TAG_KEYS=n()}(hb)),hb}var is={},xh={},lc={},Mw;function Va(){if(Mw)return lc;Mw=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.TargetTypeEnum=lc.BindingTypeEnum=lc.BindingScopeEnum=void 0;const e={Request:"Request",Singleton:"Singleton",Transient:"Transient"};lc.BindingScopeEnum=e;const n={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};lc.BindingTypeEnum=n;const t={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};return lc.TargetTypeEnum=t,lc}var e1={},Aw;function Jf(){if(Aw)return e1;Aw=1,Object.defineProperty(e1,"__esModule",{value:!0}),e1.id=n;let e=0;function n(){return e++}return e1}var ww;function CG(){if(ww)return xh;ww=1,Object.defineProperty(xh,"__esModule",{value:!0}),xh.Binding=void 0;const e=Va(),n=Jf();class t{constructor(a,o){x(this,"id");x(this,"moduleId");x(this,"activated");x(this,"serviceIdentifier");x(this,"implementationType");x(this,"cache");x(this,"dynamicValue");x(this,"scope");x(this,"type");x(this,"factory");x(this,"provider");x(this,"constraint");x(this,"onActivation");x(this,"onDeactivation");this.id=(0,n.id)(),this.activated=!1,this.serviceIdentifier=a,this.scope=o,this.type=e.BindingTypeEnum.Invalid,this.constraint=s=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){const a=new t(this.serviceIdentifier,this.scope);return a.activated=a.scope===e.BindingScopeEnum.Singleton?this.activated:!1,a.implementationType=this.implementationType,a.dynamicValue=this.dynamicValue,a.scope=this.scope,a.type=this.type,a.factory=this.factory,a.provider=this.provider,a.constraint=this.constraint,a.onActivation=this.onActivation,a.onDeactivation=this.onDeactivation,a.cache=this.cache,a}}return xh.Binding=t,xh}var Te={},Iw;function _r(){if(Iw)return Te;Iw=1,Object.defineProperty(Te,"__esModule",{value:!0}),Te.STACK_OVERFLOW=Te.CIRCULAR_DEPENDENCY_IN_FACTORY=Te.ON_DEACTIVATION_ERROR=Te.PRE_DESTROY_ERROR=Te.POST_CONSTRUCT_ERROR=Te.ASYNC_UNBIND_REQUIRED=Te.MULTIPLE_POST_CONSTRUCT_METHODS=Te.MULTIPLE_PRE_DESTROY_METHODS=Te.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Te.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Te.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Te.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Te.ARGUMENTS_LENGTH_MISMATCH=Te.INVALID_DECORATOR_OPERATION=Te.INVALID_TO_SELF_VALUE=Te.LAZY_IN_SYNC=Te.INVALID_FUNCTION_BINDING=Te.INVALID_MIDDLEWARE_RETURN=Te.NO_MORE_SNAPSHOTS_AVAILABLE=Te.INVALID_BINDING_TYPE=Te.CIRCULAR_DEPENDENCY=Te.UNDEFINED_INJECT_ANNOTATION=Te.TRYING_TO_RESOLVE_BINDINGS=Te.NOT_REGISTERED=Te.CANNOT_UNBIND=Te.AMBIGUOUS_MATCH=Te.KEY_NOT_FOUND=Te.NULL_ARGUMENT=Te.DUPLICATED_METADATA=Te.DUPLICATED_INJECTABLE_DECORATOR=void 0,Te.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",Te.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",Te.NULL_ARGUMENT="NULL argument",Te.KEY_NOT_FOUND="Key Not Found",Te.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",Te.CANNOT_UNBIND="Could not unbind serviceIdentifier:",Te.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";const e=l=>`Trying to resolve bindings for "${l}"`;Te.TRYING_TO_RESOLVE_BINDINGS=e;const n=l=>`@inject called with undefined this could mean that the class ${l} has a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation.`;Te.UNDEFINED_INJECT_ANNOTATION=n,Te.CIRCULAR_DEPENDENCY="Circular dependency found:",Te.INVALID_BINDING_TYPE="Invalid binding type:",Te.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",Te.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",Te.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";const t=l=>`You are attempting to construct ${d(l)} in a synchronous way but it has asynchronous dependencies.`;Te.LAZY_IN_SYNC=t,Te.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",Te.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";const i=l=>`The number of constructor arguments in the derived class ${l} must be >= than the number of constructor arguments of its base class.`;Te.ARGUMENTS_LENGTH_MISMATCH=i,Te.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",Te.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE='Invalid Container option. Default scope must be a string ("singleton" or "transient").',Te.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",Te.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",Te.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class",Te.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",Te.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";const a=(l,c)=>`@postConstruct error in class ${l}: ${c}`;Te.POST_CONSTRUCT_ERROR=a;const o=(l,c)=>`@preDestroy error in class ${l}: ${c}`;Te.PRE_DESTROY_ERROR=o;const s=(l,c)=>`onDeactivation() error in class ${l}: ${c}`;Te.ON_DEACTIVATION_ERROR=s;const r=(l,c)=>`It looks like there is a circular dependency in one of the '${l}' bindings. Please investigate bindings with service identifier '${c}'.`;Te.CIRCULAR_DEPENDENCY_IN_FACTORY=r,Te.STACK_OVERFLOW="Maximum call stack size exceeded";function d(l){return typeof l=="function"?`[function/class ${l.name||"<anonymous>"}]`:typeof l=="symbol"?l.toString():`'${l}'`}return Te}var rs={},Tw;function z8(){if(Tw)return rs;Tw=1;var e=rs&&rs.__createBinding||(Object.create?function(o,s,r,d){d===void 0&&(d=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,d,l)}:function(o,s,r,d){d===void 0&&(d=r),o[d]=s[r]}),n=rs&&rs.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=rs&&rs.__importStar||function(){var o=function(s){return o=Object.getOwnPropertyNames||function(r){var d=[];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(d[d.length]=l);return d},o(s)};return function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var d=o(s),l=0;l<d.length;l++)d[l]!=="default"&&e(r,s,d[l]);return n(r,s),r}}();Object.defineProperty(rs,"__esModule",{value:!0}),rs.MetadataReader=void 0;const i=t(Gn());class a{getConstructorMetadata(s){const r=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,s)??[],d=Reflect.getMetadata(i.TAGGED,s);return{compilerGeneratedMetadata:r,userGeneratedMetadata:d??{}}}getPropertiesMetadata(s){return Reflect.getMetadata(i.TAGGED_PROP,s)??{}}}return rs.MetadataReader=a,rs}var so={},pb={},Fh={},t1={},gb={},n1={},Dw;function U8(){if(Dw)return n1;Dw=1,Object.defineProperty(n1,"__esModule",{value:!0}),n1.getReflectMetadata=e;function e(n,t){return Reflect.getMetadata(t,n)}return n1}var i1={},Ow;function PG(){if(Ow)return i1;Ow=1,Object.defineProperty(i1,"__esModule",{value:!0}),i1.updateReflectMetadata=n;const e=U8();function n(t,i,a,o){const s=(0,e.getReflectMetadata)(t,i)??a,r=o(s);Reflect.defineMetadata(i,r,t)}return i1}var Lw;function Mm(){return Lw||(Lw=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.updateReflectMetadata=e.getReflectMetadata=void 0;const n=U8();Object.defineProperty(e,"getReflectMetadata",{enumerable:!0,get:function(){return n.getReflectMetadata}});const t=PG();Object.defineProperty(e,"updateReflectMetadata",{enumerable:!0,get:function(){return t.updateReflectMetadata}})}(gb)),gb}var mb={},jw;function Yd(){return jw||(jw=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.PRE_DESTROY=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.PRE_DESTROY="pre_destroy";function n(){return[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]}e.NON_CUSTOM_TAG_KEYS=n()}(mb)),mb}var r1={},o1={},vb={},Nw;function $y(){return Nw||(Nw=1,function(e){var t,i;Object.defineProperty(e,"__esModule",{value:!0}),e.InversifyCoreError=e.isAppErrorSymbol=void 0,e.isAppErrorSymbol=Symbol.for("@inversifyjs/core/InversifyCoreError");class n extends(i=Error,t=e.isAppErrorSymbol,i){constructor(s,r,d){super(r,d);x(this,t);x(this,"kind");this[e.isAppErrorSymbol]=!0,this.kind=s}static is(s){return typeof s=="object"&&s!==null&&s[e.isAppErrorSymbol]===!0}static isErrorOfKind(s,r){return n.is(s)&&s.kind===r}}e.InversifyCoreError=n}(vb)),vb}var kh={},Bw;function Yy(){if(Bw)return kh;Bw=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.InversifyCoreErrorKind=void 0;var e;return function(n){n[n.injectionDecoratorConflict=0]="injectionDecoratorConflict",n[n.missingInjectionDecorator=1]="missingInjectionDecorator",n[n.planning=2]="planning",n[n.unknown=3]="unknown"}(e||(kh.InversifyCoreErrorKind=e={})),kh}var xw;function $8(){if(xw)return o1;xw=1,Object.defineProperty(o1,"__esModule",{value:!0}),o1.assertConstructorMetadataArrayFilled=t;const e=$y(),n=Yy();function t(i,a){const o=[];for(let s=0;s<a.length;++s)a[s]===void 0&&o.push(s);if(o.length>0)throw new e.InversifyCoreError(n.InversifyCoreErrorKind.missingInjectionDecorator,`Found unexpected missing metadata on type "${i.name}" at constructor indexes "${o.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}return o1}var s1={},Kh={},Fw;function Xf(){if(Fw)return Kh;Fw=1,Object.defineProperty(Kh,"__esModule",{value:!0}),Kh.ClassElementMetadataKind=void 0;var e;return function(n){n[n.multipleInjection=0]="multipleInjection",n[n.singleInjection=1]="singleInjection",n[n.unmanaged=2]="unmanaged"}(e||(Kh.ClassElementMetadataKind=e={})),Kh}var kw;function Y8(){if(kw)return s1;kw=1,Object.defineProperty(s1,"__esModule",{value:!0}),s1.getClassElementMetadataFromNewable=n;const e=Xf();function n(t){return{kind:e.ClassElementMetadataKind.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:t}}return s1}var a1={},c1={},Kw;function SC(){if(Kw)return c1;Kw=1,Object.defineProperty(c1,"__esModule",{value:!0}),c1.getClassElementMetadataFromLegacyMetadata=a;const e=$y(),n=Yy(),t=Yd(),i=Xf();function a(s){const r=s.find(p=>p.key===t.INJECT_TAG),d=s.find(p=>p.key===t.MULTI_INJECT_TAG);if(s.find(p=>p.key===t.UNMANAGED_TAG)!==void 0)return o(r,d);if(d===void 0&&r===void 0)throw new e.InversifyCoreError(n.InversifyCoreErrorKind.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");const c=s.find(p=>p.key===t.NAMED_TAG),u=s.find(p=>p.key===t.OPTIONAL_TAG),f=s.find(p=>p.key===t.NAME_TAG);return{kind:r===void 0?i.ClassElementMetadataKind.multipleInjection:i.ClassElementMetadataKind.singleInjection,name:c==null?void 0:c.value,optional:u!==void 0,tags:new Map(s.filter(p=>t.NON_CUSTOM_TAG_KEYS.every(g=>p.key!==g)).map(p=>[p.key,p.value])),targetName:f==null?void 0:f.value,value:r===void 0?d==null?void 0:d.value:r.value}}function o(s,r){if(r!==void 0||s!==void 0)throw new e.InversifyCoreError(n.InversifyCoreErrorKind.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:i.ClassElementMetadataKind.unmanaged}}return c1}var qw;function W8(){if(qw)return a1;qw=1,Object.defineProperty(a1,"__esModule",{value:!0}),a1.getConstructorArgumentMetadataFromLegacyMetadata=i;const e=$y(),n=Yy(),t=SC();function i(a,o,s){try{return(0,t.getClassElementMetadataFromLegacyMetadata)(s)}catch(r){throw e.InversifyCoreError.isErrorOfKind(r,n.InversifyCoreErrorKind.missingInjectionDecorator)?new e.InversifyCoreError(n.InversifyCoreErrorKind.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${a.name}" at constructor arguments at index "${o.toString()}"`,{cause:r}):r}}return a1}var Hw;function RG(){if(Hw)return r1;Hw=1,Object.defineProperty(r1,"__esModule",{value:!0}),r1.getClassMetadataConstructorArguments=o;const e=Mm(),n=Yd(),t=$8(),i=Y8(),a=W8();function o(s){const r=(0,e.getReflectMetadata)(s,n.DESIGN_PARAM_TYPES),d=(0,e.getReflectMetadata)(s,n.TAGGED),l=[];if(d!==void 0)for(const[c,u]of Object.entries(d)){const f=parseInt(c);l[f]=(0,a.getConstructorArgumentMetadataFromLegacyMetadata)(s,f,u)}if(r!==void 0){for(let c=0;c<r.length;++c)if(l[c]===void 0){const u=r[c];l[c]=(0,i.getClassElementMetadataFromNewable)(u)}}return(0,t.assertConstructorMetadataArrayFilled)(s,l),l}return r1}var u1={},l1={},Vw;function Z8(){if(Vw)return l1;Vw=1,Object.defineProperty(l1,"__esModule",{value:!0}),l1.getPropertyMetadataFromLegacyMetadata=i;const e=$y(),n=Yy(),t=SC();function i(a,o,s){try{return(0,t.getClassElementMetadataFromLegacyMetadata)(s)}catch(r){throw e.InversifyCoreError.isErrorOfKind(r,n.InversifyCoreErrorKind.missingInjectionDecorator)?new e.InversifyCoreError(n.InversifyCoreErrorKind.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${a.name}" at property "${o.toString()}"`,{cause:r}):r}}return l1}var Gw;function Q8(){if(Gw)return u1;Gw=1,Object.defineProperty(u1,"__esModule",{value:!0}),u1.getClassMetadataProperties=i;const e=Mm(),n=Yd(),t=Z8();function i(a){const o=(0,e.getReflectMetadata)(a,n.TAGGED_PROP),s=new Map;if(o!==void 0)for(const r of Reflect.ownKeys(o)){const d=o[r];s.set(r,(0,t.getPropertyMetadataFromLegacyMetadata)(a,r,d))}return s}return u1}var zw;function J8(){if(zw)return t1;zw=1,Object.defineProperty(t1,"__esModule",{value:!0}),t1.getClassMetadata=a;const e=Mm(),n=Yd(),t=RG(),i=Q8();function a(o){const s=(0,e.getReflectMetadata)(o,n.POST_CONSTRUCT),r=(0,e.getReflectMetadata)(o,n.PRE_DESTROY);return{constructorArguments:(0,t.getClassMetadataConstructorArguments)(o),lifecycle:{postConstructMethodName:s==null?void 0:s.value,preDestroyMethodName:r==null?void 0:r.value},properties:(0,i.getClassMetadataProperties)(o)}}return t1}var d1={},f1={},Uw;function MG(){if(Uw)return f1;Uw=1,Object.defineProperty(f1,"__esModule",{value:!0}),f1.getClassMetadataConstructorArgumentsFromMetadataReader=i;const e=$8(),n=Y8(),t=W8();function i(a,o){const s=o.getConstructorMetadata(a),r=[];for(const[d,l]of Object.entries(s.userGeneratedMetadata)){const c=parseInt(d);r[c]=(0,t.getConstructorArgumentMetadataFromLegacyMetadata)(a,c,l)}if(s.compilerGeneratedMetadata!==void 0){for(let d=0;d<s.compilerGeneratedMetadata.length;++d)if(r[d]===void 0){const l=s.compilerGeneratedMetadata[d];r[d]=(0,n.getClassElementMetadataFromNewable)(l)}}return(0,e.assertConstructorMetadataArrayFilled)(a,r),r}return f1}var h1={},$w;function X8(){if($w)return h1;$w=1,Object.defineProperty(h1,"__esModule",{value:!0}),h1.getClassMetadataPropertiesFromMetadataReader=n;const e=Z8();function n(t,i){const a=i.getPropertiesMetadata(t),o=new Map;for(const s of Reflect.ownKeys(a)){const r=a[s];o.set(s,(0,e.getPropertyMetadataFromLegacyMetadata)(t,s,r))}return o}return h1}var Yw;function e7(){if(Yw)return d1;Yw=1,Object.defineProperty(d1,"__esModule",{value:!0}),d1.getClassMetadataFromMetadataReader=a;const e=Mm(),n=Yd(),t=MG(),i=X8();function a(o,s){const r=(0,e.getReflectMetadata)(o,n.POST_CONSTRUCT),d=(0,e.getReflectMetadata)(o,n.PRE_DESTROY);return{constructorArguments:(0,t.getClassMetadataConstructorArgumentsFromMetadataReader)(o,s),lifecycle:{postConstructMethodName:r==null?void 0:r.value,preDestroyMethodName:d==null?void 0:d.value},properties:(0,i.getClassMetadataPropertiesFromMetadataReader)(o,s)}}return d1}var p1={},g1={},Ww;function AG(){if(Ww)return g1;Ww=1,Object.defineProperty(g1,"__esModule",{value:!0}),g1.getBaseType=e;function e(n){const t=Object.getPrototypeOf(n.prototype);return t==null?void 0:t.constructor}return g1}var qh={},m1={},Zw;function wG(){if(Zw)return m1;Zw=1,Object.defineProperty(m1,"__esModule",{value:!0}),m1.getLegacyMetadata=t;const e=Yd(),n=Xf();function t(s){switch(s.kind){case n.ClassElementMetadataKind.unmanaged:return o();default:return i(s)}}function i(s){const r=[a(s)];s.name!==void 0&&r.push({key:e.NAMED_TAG,value:s.name}),s.optional&&r.push({key:e.OPTIONAL_TAG,value:!0});for(const[d,l]of s.tags)r.push({key:d,value:l});return s.targetName!==void 0&&r.push({key:e.NAME_TAG,value:s.targetName}),r}function a(s){let r;switch(s.kind){case n.ClassElementMetadataKind.multipleInjection:r={key:e.MULTI_INJECT_TAG,value:s.value};break;case n.ClassElementMetadataKind.singleInjection:r={key:e.INJECT_TAG,value:s.value};break}return r}function o(){return[{key:e.UNMANAGED_TAG,value:!0}]}return m1}var Hh={},Qw;function IG(){var n,t;if(Qw)return Hh;Qw=1,Object.defineProperty(Hh,"__esModule",{value:!0}),Hh.LegacyQueryableStringImpl=void 0;let e=(t=class{constructor(a){Zn(this,n);Dn(this,n,a)}startsWith(a){return Fe(this,n).startsWith(a)}endsWith(a){return Fe(this,n).endsWith(a)}contains(a){return Fe(this,n).includes(a)}equals(a){return Fe(this,n)===a}value(){return Fe(this,n)}},n=new WeakMap,t);return Hh.LegacyQueryableStringImpl=e,Hh}var v1={},Jw;function TG(){if(Jw)return v1;Jw=1,Object.defineProperty(v1,"__esModule",{value:!0}),v1.getDescription=t;const e=7,n=-1;function t(i){return i.toString().slice(e,n)}return v1}var y1={},Xw;function DG(){if(Xw)return y1;Xw=1,Object.defineProperty(y1,"__esModule",{value:!0}),y1.getTargetId=t;const e=Mm(),n="@inversifyjs/core/targetId";function t(){const i=(0,e.getReflectMetadata)(Object,n)??0;return i===Number.MAX_SAFE_INTEGER?(0,e.updateReflectMetadata)(Object,n,i,()=>Number.MIN_SAFE_INTEGER):(0,e.updateReflectMetadata)(Object,n,i,a=>a+1),i}return y1}var eI;function t7(){var d,l,c,u,f,h,p;if(eI)return qh;eI=1,Object.defineProperty(qh,"__esModule",{value:!0}),qh.LegacyTargetImpl=void 0;const e=LS(),n=wG(),t=Xf(),i=Yd(),a=IG(),o=TG(),s=DG();let r=(p=class{constructor(m,v,_){Zn(this,d);Zn(this,l);Zn(this,c);Zn(this,u);Zn(this,f);Zn(this,h);Dn(this,l,(0,s.getTargetId)()),Dn(this,c,m),Dn(this,u,void 0),Dn(this,d,v),Dn(this,f,new a.LegacyQueryableStringImpl(typeof m=="string"?m:(0,o.getDescription)(m))),Dn(this,h,_)}get id(){return Fe(this,l)}get identifier(){return Fe(this,c)}get metadata(){return Fe(this,u)===void 0&&Dn(this,u,(0,n.getLegacyMetadata)(Fe(this,d))),Fe(this,u)}get name(){return Fe(this,f)}get type(){return Fe(this,h)}get serviceIdentifier(){return e.LazyServiceIdentifier.is(Fe(this,d).value)?Fe(this,d).value.unwrap():Fe(this,d).value}getCustomTags(){return[...Fe(this,d).tags.entries()].map(([m,v])=>({key:m,value:v}))}getNamedTag(){return Fe(this,d).name===void 0?null:{key:i.NAMED_TAG,value:Fe(this,d).name}}hasTag(m){return this.metadata.some(v=>v.key===m)}isArray(){return Fe(this,d).kind===t.ClassElementMetadataKind.multipleInjection}isNamed(){return Fe(this,d).name!==void 0}isOptional(){return Fe(this,d).optional}isTagged(){return Fe(this,d).tags.size>0}matchesArray(m){return this.isArray()&&Fe(this,d).value===m}matchesNamedTag(m){return Fe(this,d).name===m}matchesTag(m){return v=>this.metadata.some(_=>_.key===m&&_.value===v)}},d=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,f=new WeakMap,h=new WeakMap,p);return qh.LegacyTargetImpl=r,qh}var tI;function OG(){if(tI)return p1;tI=1,Object.defineProperty(p1,"__esModule",{value:!0}),p1.getTargetsFromMetadataProviders=i;const e=Xf(),n=AG(),t=t7();function i(a,o){return function(r){const d=a(r);let l=(0,n.getBaseType)(r);for(;l!==void 0&&l!==Object;){const u=o(l);for(const[f,h]of u)d.properties.has(f)||d.properties.set(f,h);l=(0,n.getBaseType)(l)}const c=[];for(const u of d.constructorArguments)if(u.kind!==e.ClassElementMetadataKind.unmanaged){const f=u.targetName??"";c.push(new t.LegacyTargetImpl(f,u,"ConstructorArgument"))}for(const[u,f]of d.properties)if(f.kind!==e.ClassElementMetadataKind.unmanaged){const h=f.targetName??u;c.push(new t.LegacyTargetImpl(h,f,"ClassProperty"))}return c}}return p1}var nI;function LG(){if(nI)return Fh;nI=1,Object.defineProperty(Fh,"__esModule",{value:!0}),Fh.getTargets=void 0;const e=J8(),n=e7(),t=Q8(),i=X8(),a=OG(),o=s=>{const r=s===void 0?e.getClassMetadata:l=>(0,n.getClassMetadataFromMetadataReader)(l,s),d=s===void 0?t.getClassMetadataProperties:l=>(0,i.getClassMetadataPropertiesFromMetadataReader)(l,s);return(0,a.getTargetsFromMetadataProviders)(r,d)};return Fh.getTargets=o,Fh}var iI;function n7(){return iI||(iI=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.LegacyTargetImpl=e.getTargets=e.getClassMetadataFromMetadataReader=e.getClassMetadata=e.getClassElementMetadataFromLegacyMetadata=e.ClassElementMetadataKind=void 0;const n=LG();Object.defineProperty(e,"getTargets",{enumerable:!0,get:function(){return n.getTargets}});const t=t7();Object.defineProperty(e,"LegacyTargetImpl",{enumerable:!0,get:function(){return t.LegacyTargetImpl}});const i=SC();Object.defineProperty(e,"getClassElementMetadataFromLegacyMetadata",{enumerable:!0,get:function(){return i.getClassElementMetadataFromLegacyMetadata}});const a=J8();Object.defineProperty(e,"getClassMetadata",{enumerable:!0,get:function(){return a.getClassMetadata}});const o=e7();Object.defineProperty(e,"getClassMetadataFromMetadataReader",{enumerable:!0,get:function(){return o.getClassMetadataFromMetadataReader}});const s=Xf();Object.defineProperty(e,"ClassElementMetadataKind",{enumerable:!0,get:function(){return s.ClassElementMetadataKind}})}(pb)),pb}var Vh={},rI;function jG(){if(rI)return Vh;rI=1,Object.defineProperty(Vh,"__esModule",{value:!0}),Vh.BindingCount=void 0;var e;return function(n){n[n.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",n[n.NoBindingsAvailable=0]="NoBindingsAvailable",n[n.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"}(e||(Vh.BindingCount=e={})),Vh}var ao={},oI;function i7(){if(oI)return ao;oI=1;var e=ao&&ao.__createBinding||(Object.create?function(s,r,d,l){l===void 0&&(l=d);var c=Object.getOwnPropertyDescriptor(r,d);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[d]}}),Object.defineProperty(s,l,c)}:function(s,r,d,l){l===void 0&&(l=d),s[l]=r[d]}),n=ao&&ao.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),t=ao&&ao.__importStar||function(){var s=function(r){return s=Object.getOwnPropertyNames||function(d){var l=[];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(l[l.length]=c);return l},s(r)};return function(r){if(r&&r.__esModule)return r;var d={};if(r!=null)for(var l=s(r),c=0;c<l.length;c++)l[c]!=="default"&&e(d,r,l[c]);return n(d,r),d}}();Object.defineProperty(ao,"__esModule",{value:!0}),ao.tryAndThrowErrorIfStackOverflow=void 0,ao.isStackOverflowException=a;const i=t(_r());function a(s){return s instanceof RangeError||s.message===i.STACK_OVERFLOW}const o=(s,r)=>{try{return s()}catch(d){throw a(d)?r():d}};return ao.tryAndThrowErrorIfStackOverflow=o,ao}var wi={},sI;function Am(){if(sI)return wi;sI=1;var e=wi&&wi.__createBinding||(Object.create?function(h,p,g,m){m===void 0&&(m=g);var v=Object.getOwnPropertyDescriptor(p,g);(!v||("get"in v?!p.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return p[g]}}),Object.defineProperty(h,m,v)}:function(h,p,g,m){m===void 0&&(m=g),h[m]=p[g]}),n=wi&&wi.__setModuleDefault||(Object.create?function(h,p){Object.defineProperty(h,"default",{enumerable:!0,value:p})}:function(h,p){h.default=p}),t=wi&&wi.__importStar||function(){var h=function(p){return h=Object.getOwnPropertyNames||function(g){var m=[];for(var v in g)Object.prototype.hasOwnProperty.call(g,v)&&(m[m.length]=v);return m},h(p)};return function(p){if(p&&p.__esModule)return p;var g={};if(p!=null)for(var m=h(p),v=0;v<m.length;v++)m[v]!=="default"&&e(g,p,m[v]);return n(g,p),g}}();Object.defineProperty(wi,"__esModule",{value:!0}),wi.getFunctionName=c,wi.getServiceIdentifierAsString=a,wi.listRegisteredBindingsForServiceIdentifier=o,wi.listMetadataForTarget=l,wi.circularDependencyToException=d,wi.getSymbolDescription=u;const i=t(_r());function a(h){return typeof h=="function"?h.name:typeof h=="symbol"?h.toString():h}function o(h,p,g){let m="";const v=g(h,p);return v.length!==0&&(m=`
Registered bindings:`,v.forEach(_=>{let S="Object";_.implementationType!==null&&(S=c(_.implementationType)),m=`${m}
 ${S}`,_.constraint.metaData&&(m=`${m} - ${_.constraint.metaData}`)})),m}function s(h,p){return h.parentRequest===null?!1:h.parentRequest.serviceIdentifier===p?!0:s(h.parentRequest,p)}function r(h){function p(m,v=[]){const _=a(m.serviceIdentifier);return v.push(_),m.parentRequest!==null?p(m.parentRequest,v):v}return p(h).reverse().join(" --> ")}function d(h){h.childRequests.forEach(p=>{if(s(h,p.serviceIdentifier)){const g=r(p);throw new Error(`${i.CIRCULAR_DEPENDENCY} ${g}`)}else d(p)})}function l(h,p){if(p.isTagged()||p.isNamed()){let g="";const m=p.getNamedTag(),v=p.getCustomTags();return m!==null&&(g+=f(m)+`
`),v!==null&&v.forEach(_=>{g+=f(_)+`
`}),` ${h}
 ${h} - ${g}`}else return` ${h}`}function c(h){if(h.name!=null&&h.name!=="")return h.name;{const p=h.toString(),g=p.match(/^function\s*([^\s(]+)/);return g===null?`Anonymous function: ${p}`:g[1]}}function u(h){return h.toString().slice(7,-1)}function f(h){return`{"key":"${h.key.toString()}","value":"${h.value.toString()}"}`}return wi}var Gh={},aI;function NG(){if(aI)return Gh;aI=1,Object.defineProperty(Gh,"__esModule",{value:!0}),Gh.Context=void 0;const e=Jf();class n{constructor(i){x(this,"id");x(this,"container");x(this,"plan");x(this,"currentRequest");this.id=(0,e.id)(),this.container=i}addPlan(i){this.plan=i}setCurrentRequest(i){this.currentRequest=i}}return Gh.Context=n,Gh}var os={},cI;function Uc(){if(cI)return os;cI=1;var e=os&&os.__createBinding||(Object.create?function(o,s,r,d){d===void 0&&(d=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,d,l)}:function(o,s,r,d){d===void 0&&(d=r),o[d]=s[r]}),n=os&&os.__setModuleDefault||(Object.create?function(o,s){Object.defineProperty(o,"default",{enumerable:!0,value:s})}:function(o,s){o.default=s}),t=os&&os.__importStar||function(){var o=function(s){return o=Object.getOwnPropertyNames||function(r){var d=[];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(d[d.length]=l);return d},o(s)};return function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var d=o(s),l=0;l<d.length;l++)d[l]!=="default"&&e(r,s,d[l]);return n(r,s),r}}();Object.defineProperty(os,"__esModule",{value:!0}),os.Metadata=void 0;const i=t(Gn());class a{constructor(s,r){x(this,"key");x(this,"value");this.key=s,this.value=r}toString(){return this.key===i.NAMED_TAG?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}return os.Metadata=a,os}var zh={},uI;function BG(){if(uI)return zh;uI=1,Object.defineProperty(zh,"__esModule",{value:!0}),zh.Plan=void 0;class e{constructor(t,i){x(this,"parentContext");x(this,"rootRequest");this.parentContext=t,this.rootRequest=i}}return zh.Plan=e,zh}var dc={},_1={},lI;function xG(){if(lI)return _1;lI=1,Object.defineProperty(_1,"__esModule",{value:!0}),_1.getBaseType=e;function e(n){const t=Object.getPrototypeOf(n.prototype);return t==null?void 0:t.constructor}return _1}var dI;function FG(){return dI||(dI=1,function(e){var n=dc&&dc.__createBinding||(Object.create?function(c,u,f,h){h===void 0&&(h=f);var p=Object.getOwnPropertyDescriptor(u,f);(!p||("get"in p?!u.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return u[f]}}),Object.defineProperty(c,h,p)}:function(c,u,f,h){h===void 0&&(h=f),c[h]=u[f]}),t=dc&&dc.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),i=dc&&dc.__importStar||function(){var c=function(u){return c=Object.getOwnPropertyNames||function(f){var h=[];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(h[h.length]=p);return h},c(u)};return function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var h=c(u),p=0;p<h.length;p++)h[p]!=="default"&&n(f,u,h[p]);return t(f,u),f}}();Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=void 0,e.getDependencies=d,e.getBaseClassDependencyCount=l;const a=n7(),o=i(Gn()),s=xG(),r=Am();Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return r.getFunctionName}});function d(c,u){return(0,a.getTargets)(c)(u)}function l(c,u){const f=(0,s.getBaseType)(u);if(f===void 0||f===Object)return 0;const h=(0,a.getTargets)(c)(f),p=h.map(v=>v.metadata.filter(_=>_.key===o.UNMANAGED_TAG)),g=[].concat.apply([],p).length,m=h.length-g;return m>0?m:l(c,f)}}(dc)),dc}var Uh={},fI;function kG(){if(fI)return Uh;fI=1,Object.defineProperty(Uh,"__esModule",{value:!0}),Uh.Request=void 0;const e=Jf();class n{constructor(i,a,o,s,r){x(this,"id");x(this,"serviceIdentifier");x(this,"parentContext");x(this,"parentRequest");x(this,"bindings");x(this,"childRequests");x(this,"target");x(this,"requestScope");this.id=(0,e.id)(),this.serviceIdentifier=i,this.parentContext=a,this.parentRequest=o,this.target=r,this.childRequests=[],this.bindings=Array.isArray(s)?s:[s],this.requestScope=o===null?new Map:null}addChildRequest(i,a,o){const s=new n(i,this.parentContext,this,a,o);return this.childRequests.push(s),s}}return Uh.Request=n,Uh}var hI;function r7(){if(hI)return so;hI=1;var e=so&&so.__createBinding||(Object.create?function(I,R,w,T){T===void 0&&(T=w);var j=Object.getOwnPropertyDescriptor(R,w);(!j||("get"in j?!R.__esModule:j.writable||j.configurable))&&(j={enumerable:!0,get:function(){return R[w]}}),Object.defineProperty(I,T,j)}:function(I,R,w,T){T===void 0&&(T=w),I[T]=R[w]}),n=so&&so.__setModuleDefault||(Object.create?function(I,R){Object.defineProperty(I,"default",{enumerable:!0,value:R})}:function(I,R){I.default=R}),t=so&&so.__importStar||function(){var I=function(R){return I=Object.getOwnPropertyNames||function(w){var T=[];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(T[T.length]=j);return T},I(R)};return function(R){if(R&&R.__esModule)return R;var w={};if(R!=null)for(var T=I(R),j=0;j<T.length;j++)T[j]!=="default"&&e(w,R,T[j]);return n(w,R),w}}();Object.defineProperty(so,"__esModule",{value:!0}),so.getBindingDictionary=g,so.plan=M,so.createMockRequest=L;const i=n7(),a=jG(),o=t(_r()),s=Va(),r=t(Gn()),d=i7(),l=Am(),c=NG(),u=Uc(),f=BG(),h=FG(),p=kG();function g(I){return I._bindingDictionary}function m(I,R,w){const T=_(R,w),j=(0,i.getClassElementMetadataFromLegacyMetadata)(T);if(j.kind===i.ClassElementMetadataKind.unmanaged)throw new Error("Unexpected metadata when creating target");return new i.LegacyTargetImpl("",j,I)}function v(I,R,w,T,j){let D=C(w.container,j.serviceIdentifier),B=[];return D.length===a.BindingCount.NoBindingsAvailable&&w.container.options.autoBindInjectable===!0&&typeof j.serviceIdentifier=="function"&&I.getConstructorMetadata(j.serviceIdentifier).compilerGeneratedMetadata&&(w.container.bind(j.serviceIdentifier).toSelf(),D=C(w.container,j.serviceIdentifier)),R?B=D:B=D.filter(H=>{const F=new p.Request(H.serviceIdentifier,w,T,H,j);return H.constraint(F)}),S(j.serviceIdentifier,B,T,j,w.container),B}function _(I,R){const w=R.isMultiInject?r.MULTI_INJECT_TAG:r.INJECT_TAG,T=[new u.Metadata(w,I)];return R.customTag!==void 0&&T.push(new u.Metadata(R.customTag.key,R.customTag.value)),R.isOptional===!0&&T.push(new u.Metadata(r.OPTIONAL_TAG,!0)),T}function S(I,R,w,T,j){switch(R.length){case a.BindingCount.NoBindingsAvailable:if(T.isOptional())return R;{const D=(0,l.getServiceIdentifierAsString)(I);let B=o.NOT_REGISTERED;throw B+=(0,l.listMetadataForTarget)(D,T),B+=(0,l.listRegisteredBindingsForServiceIdentifier)(j,D,C),w!==null&&(B+=`
${o.TRYING_TO_RESOLVE_BINDINGS((0,l.getServiceIdentifierAsString)(w.serviceIdentifier))}`),new Error(B)}case a.BindingCount.OnlyOneBindingAvailable:return R;case a.BindingCount.MultipleBindingsAvailable:default:if(T.isArray())return R;{const D=(0,l.getServiceIdentifierAsString)(I);let B=`${o.AMBIGUOUS_MATCH} ${D}`;throw B+=(0,l.listRegisteredBindingsForServiceIdentifier)(j,D,C),new Error(B)}}}function E(I,R,w,T,j,D){let B,H;if(j===null){B=v(I,R,T,null,D),H=new p.Request(w,T,null,B,D);const F=new f.Plan(T,H);T.addPlan(F)}else B=v(I,R,T,j,D),H=j.addChildRequest(D.serviceIdentifier,B,D);B.forEach(F=>{let K=null;if(D.isArray())K=H.addChildRequest(F.serviceIdentifier,F,D);else{if(F.cache!==null)return;K=H}if(F.type===s.BindingTypeEnum.Instance&&F.implementationType!==null){const U=(0,h.getDependencies)(I,F.implementationType);if(T.container.options.skipBaseClassChecks!==!0){const Z=(0,h.getBaseClassDependencyCount)(I,F.implementationType);if(U.length<Z){const ce=o.ARGUMENTS_LENGTH_MISMATCH((0,h.getFunctionName)(F.implementationType));throw new Error(ce)}}U.forEach(Z=>{E(I,!1,Z.serviceIdentifier,T,K,Z)})}})}function C(I,R){let w=[];const T=g(I);return T.hasKey(R)?w=T.get(R):I.parent!==null&&(w=C(I.parent,R)),w}function M(I,R,w,T,j,D=!1){const B=new c.Context(R),H=m(w,T,j);try{return E(I,D,T,B,null,H),B}catch(F){throw(0,d.isStackOverflowException)(F)&&(0,l.circularDependencyToException)(B.plan.rootRequest),F}}function L(I,R,w){const T=_(R,w),j=(0,i.getClassElementMetadataFromLegacyMetadata)(T);if(j.kind===i.ClassElementMetadataKind.unmanaged)throw new Error("Unexpected metadata when creating target");const D=new i.LegacyTargetImpl("",j,"Variable"),B=new c.Context(I);return new p.Request(R,B,null,[],D)}return so}var xs={},Rl={},$h={},pI;function Wy(){if(pI)return $h;pI=1,Object.defineProperty($h,"__esModule",{value:!0}),$h.isPromise=e,$h.isPromiseOrContainsPromise=n;function e(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&typeof t.then=="function"}function n(t){return e(t)?!0:Array.isArray(t)&&t.some(e)}return $h}var gI;function KG(){if(gI)return Rl;gI=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.saveToScope=Rl.tryGetFromScope=void 0;const e=Va(),n=Wy(),t=(r,d)=>d.scope===e.BindingScopeEnum.Singleton&&d.activated?d.cache:d.scope===e.BindingScopeEnum.Request&&r.has(d.id)?r.get(d.id):null;Rl.tryGetFromScope=t;const i=(r,d,l)=>{d.scope===e.BindingScopeEnum.Singleton&&o(d,l),d.scope===e.BindingScopeEnum.Request&&a(r,d,l)};Rl.saveToScope=i;const a=(r,d,l)=>{r.has(d.id)||r.set(d.id,l)},o=(r,d)=>{r.cache=d,r.activated=!0,(0,n.isPromise)(d)&&s(r,d)},s=async(r,d)=>{try{const l=await d;r.cache=l}catch(l){throw r.cache=null,r.activated=!1,l}};return Rl}var Ii={},Yh={},mI;function qG(){if(mI)return Yh;mI=1,Object.defineProperty(Yh,"__esModule",{value:!0}),Yh.FactoryType=void 0;var e;return function(n){n.DynamicValue="toDynamicValue",n.Factory="toFactory",n.Provider="toProvider"}(e||(Yh.FactoryType=e={})),Yh}var vI;function o7(){if(vI)return Ii;vI=1;var e=Ii&&Ii.__createBinding||(Object.create?function(c,u,f,h){h===void 0&&(h=f);var p=Object.getOwnPropertyDescriptor(u,f);(!p||("get"in p?!u.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return u[f]}}),Object.defineProperty(c,h,p)}:function(c,u,f,h){h===void 0&&(h=f),c[h]=u[f]}),n=Ii&&Ii.__setModuleDefault||(Object.create?function(c,u){Object.defineProperty(c,"default",{enumerable:!0,value:u})}:function(c,u){c.default=u}),t=Ii&&Ii.__importStar||function(){var c=function(u){return c=Object.getOwnPropertyNames||function(f){var h=[];for(var p in f)Object.prototype.hasOwnProperty.call(f,p)&&(h[h.length]=p);return h},c(u)};return function(u){if(u&&u.__esModule)return u;var f={};if(u!=null)for(var h=c(u),p=0;p<h.length;p++)h[p]!=="default"&&e(f,u,h[p]);return n(f,u),f}}();Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.getFactoryDetails=Ii.ensureFullyBound=Ii.multiBindToService=void 0;const i=t(_r()),a=Va(),o=Am(),s=qG(),r=c=>u=>(...f)=>{f.forEach(h=>{c.bind(h).toService(u)})};Ii.multiBindToService=r;const d=c=>{let u=null;switch(c.type){case a.BindingTypeEnum.ConstantValue:case a.BindingTypeEnum.Function:u=c.cache;break;case a.BindingTypeEnum.Constructor:case a.BindingTypeEnum.Instance:u=c.implementationType;break;case a.BindingTypeEnum.DynamicValue:u=c.dynamicValue;break;case a.BindingTypeEnum.Provider:u=c.provider;break;case a.BindingTypeEnum.Factory:u=c.factory;break}if(u===null){const f=(0,o.getServiceIdentifierAsString)(c.serviceIdentifier);throw new Error(`${i.INVALID_BINDING_TYPE} ${f}`)}};Ii.ensureFullyBound=d;const l=c=>{switch(c.type){case a.BindingTypeEnum.Factory:return{factory:c.factory,factoryType:s.FactoryType.Factory};case a.BindingTypeEnum.Provider:return{factory:c.provider,factoryType:s.FactoryType.Provider};case a.BindingTypeEnum.DynamicValue:return{factory:c.dynamicValue,factoryType:s.FactoryType.DynamicValue};default:throw new Error(`Unexpected factory type ${c.type}`)}};return Ii.getFactoryDetails=l,Ii}var Fs={},yI;function HG(){if(yI)return Fs;yI=1;var e=Fs&&Fs.__createBinding||(Object.create?function(v,_,S,E){E===void 0&&(E=S);var C=Object.getOwnPropertyDescriptor(_,S);(!C||("get"in C?!_.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return _[S]}}),Object.defineProperty(v,E,C)}:function(v,_,S,E){E===void 0&&(E=S),v[E]=_[S]}),n=Fs&&Fs.__setModuleDefault||(Object.create?function(v,_){Object.defineProperty(v,"default",{enumerable:!0,value:_})}:function(v,_){v.default=_}),t=Fs&&Fs.__importStar||function(){var v=function(_){return v=Object.getOwnPropertyNames||function(S){var E=[];for(var C in S)Object.prototype.hasOwnProperty.call(S,C)&&(E[E.length]=C);return E},v(_)};return function(_){if(_&&_.__esModule)return _;var S={};if(_!=null)for(var E=v(_),C=0;C<E.length;C++)E[C]!=="default"&&e(S,_,E[C]);return n(S,_),S}}();Object.defineProperty(Fs,"__esModule",{value:!0}),Fs.resolveInstance=m;const i=_r(),a=Va(),o=t(Gn()),s=Wy();function r(v,_){return v.reduce((S,E)=>{const C=_(E);return E.target.type===a.TargetTypeEnum.ConstructorArgument?S.constructorInjections.push(C):(S.propertyRequests.push(E),S.propertyInjections.push(C)),S.isAsync||(S.isAsync=(0,s.isPromiseOrContainsPromise)(C)),S},{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}function d(v,_,S){let E;if(_.length>0){const C=r(_,S),M={...C,constr:v};C.isAsync?E=c(M):E=l(M)}else E=new v;return E}function l(v){const _=new v.constr(...v.constructorInjections);return v.propertyRequests.forEach((S,E)=>{const C=S.target.identifier,M=v.propertyInjections[E];(!S.target.isOptional()||M!==void 0)&&(_[C]=M)}),_}async function c(v){const _=await u(v.constructorInjections),S=await u(v.propertyInjections);return l({...v,constructorInjections:_,propertyInjections:S})}async function u(v){const _=[];for(const S of v)Array.isArray(S)?_.push(Promise.all(S)):_.push(S);return Promise.all(_)}function f(v,_){const S=h(v,_);return(0,s.isPromise)(S)?S.then(()=>_):_}function h(v,_){var S;if(Reflect.hasMetadata(o.POST_CONSTRUCT,v)){const E=Reflect.getMetadata(o.POST_CONSTRUCT,v);try{return(S=_[E.value])==null?void 0:S.call(_)}catch(C){if(C instanceof Error)throw new Error((0,i.POST_CONSTRUCT_ERROR)(v.name,C.message))}}}function p(v,_){v.scope!==a.BindingScopeEnum.Singleton&&g(v,_)}function g(v,_){const S=`Class cannot be instantiated in ${v.scope===a.BindingScopeEnum.Request?"request":"transient"} scope.`;if(typeof v.onDeactivation=="function")throw new Error((0,i.ON_DEACTIVATION_ERROR)(_.name,S));if(Reflect.hasMetadata(o.PRE_DESTROY,_))throw new Error((0,i.PRE_DESTROY_ERROR)(_.name,S))}function m(v,_,S,E){p(v,_);const C=d(_,S,E);return(0,s.isPromise)(C)?C.then(M=>f(_,M)):f(_,C)}return Fs}var _I;function VG(){if(_I)return xs;_I=1;var e=xs&&xs.__createBinding||(Object.create?function(L,I,R,w){w===void 0&&(w=R);var T=Object.getOwnPropertyDescriptor(I,R);(!T||("get"in T?!I.__esModule:T.writable||T.configurable))&&(T={enumerable:!0,get:function(){return I[R]}}),Object.defineProperty(L,w,T)}:function(L,I,R,w){w===void 0&&(w=R),L[w]=I[R]}),n=xs&&xs.__setModuleDefault||(Object.create?function(L,I){Object.defineProperty(L,"default",{enumerable:!0,value:I})}:function(L,I){L.default=I}),t=xs&&xs.__importStar||function(){var L=function(I){return L=Object.getOwnPropertyNames||function(R){var w=[];for(var T in R)Object.prototype.hasOwnProperty.call(R,T)&&(w[w.length]=T);return w},L(I)};return function(I){if(I&&I.__esModule)return I;var R={};if(I!=null)for(var w=L(I),T=0;T<w.length;T++)w[T]!=="default"&&e(R,I,w[T]);return n(R,I),R}}();Object.defineProperty(xs,"__esModule",{value:!0}),xs.resolve=M;const i=t(_r()),a=Va(),o=r7(),s=KG(),r=Wy(),d=o7(),l=i7(),c=HG(),u=L=>I=>{I.parentContext.setCurrentRequest(I);const R=I.bindings,w=I.childRequests,T=I.target&&I.target.isArray(),j=!I.parentRequest||!I.parentRequest.target||!I.target||!I.parentRequest.target.matchesArray(I.target.serviceIdentifier);if(T&&j)return w.map(D=>u(L)(D));{if(I.target.isOptional()&&R.length===0)return;const D=R[0];return g(L,I,D)}},f=(L,I)=>{const R=(0,d.getFactoryDetails)(L);return(0,l.tryAndThrowErrorIfStackOverflow)(()=>R.factory.bind(L)(I),()=>new Error(i.CIRCULAR_DEPENDENCY_IN_FACTORY(R.factoryType,I.currentRequest.serviceIdentifier.toString())))},h=(L,I,R)=>{let w;const T=I.childRequests;switch((0,d.ensureFullyBound)(R),R.type){case a.BindingTypeEnum.ConstantValue:case a.BindingTypeEnum.Function:w=R.cache;break;case a.BindingTypeEnum.Constructor:w=R.implementationType;break;case a.BindingTypeEnum.Instance:w=(0,c.resolveInstance)(R,R.implementationType,T,u(L));break;default:w=f(R,I.parentContext)}return w},p=(L,I,R)=>{let w=(0,s.tryGetFromScope)(L,I);return w!==null||(w=R(),(0,s.saveToScope)(L,I,w)),w},g=(L,I,R)=>p(L,R,()=>{let w=h(L,I,R);return(0,r.isPromise)(w)?w=w.then(T=>m(I,R,T)):w=m(I,R,w),w});function m(L,I,R){let w=v(L.parentContext,I,R);const T=C(L.parentContext.container);let j,D=T.next();do{j=D.value;const B=L.parentContext,H=L.serviceIdentifier,F=E(j,H);(0,r.isPromise)(w)?w=S(F,B,w):w=_(F,B,w),D=T.next()}while(D.done!==!0&&!(0,o.getBindingDictionary)(j).hasKey(L.serviceIdentifier));return w}const v=(L,I,R)=>{let w;return typeof I.onActivation=="function"?w=I.onActivation(L,R):w=R,w},_=(L,I,R)=>{let w=L.next();for(;w.done!==!0;){if(R=w.value(I,R),(0,r.isPromise)(R))return S(L,I,R);w=L.next()}return R},S=async(L,I,R)=>{let w=await R,T=L.next();for(;T.done!==!0;)w=await T.value(I,w),T=L.next();return w},E=(L,I)=>{const R=L._activations;return R.hasKey(I)?R.get(I).values():[].values()},C=L=>{const I=[L];let R=L.parent;for(;R!==null;)I.push(R),R=R.parent;return{next:()=>{const j=I.pop();return j!==void 0?{done:!1,value:j}:{done:!0,value:void 0}}}};function M(L){return u(L.plan.rootRequest.requestScope)(L.plan.rootRequest)}return xs}var ss={},Wh={},Zh={},Qh={},Jh={},Xh={},Qn={},bI;function s7(){if(bI)return Qn;bI=1;var e=Qn&&Qn.__createBinding||(Object.create?function(l,c,u,f){f===void 0&&(f=u);var h=Object.getOwnPropertyDescriptor(c,u);(!h||("get"in h?!c.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return c[u]}}),Object.defineProperty(l,f,h)}:function(l,c,u,f){f===void 0&&(f=u),l[f]=c[u]}),n=Qn&&Qn.__setModuleDefault||(Object.create?function(l,c){Object.defineProperty(l,"default",{enumerable:!0,value:c})}:function(l,c){l.default=c}),t=Qn&&Qn.__importStar||function(){var l=function(c){return l=Object.getOwnPropertyNames||function(u){var f=[];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(f[f.length]=h);return f},l(c)};return function(c){if(c&&c.__esModule)return c;var u={};if(c!=null)for(var f=l(c),h=0;h<f.length;h++)f[h]!=="default"&&e(u,c,f[h]);return n(u,c),u}}();Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.typeConstraint=Qn.namedConstraint=Qn.taggedConstraint=Qn.traverseAncerstors=void 0;const i=t(Gn()),a=Uc(),o=(l,c)=>{const u=l.parentRequest;return u!==null?c(u)?!0:o(u,c):!1};Qn.traverseAncerstors=o;const s=l=>c=>{const u=f=>f!==null&&f.target!==null&&f.target.matchesTag(l)(c);return u.metaData=new a.Metadata(l,c),u};Qn.taggedConstraint=s;const r=s(i.NAMED_TAG);Qn.namedConstraint=r;const d=l=>c=>{let u=null;if(c!==null){if(u=c.bindings[0],typeof l=="string")return u.serviceIdentifier===l;{const f=c.bindings[0].implementationType;return l===f}}return!1};return Qn.typeConstraint=d,Qn}var SI;function EC(){if(SI)return Xh;SI=1,Object.defineProperty(Xh,"__esModule",{value:!0}),Xh.BindingWhenSyntax=void 0;const e=CC(),n=s7();class t{constructor(a){x(this,"_binding");this._binding=a}when(a){return this._binding.constraint=a,new e.BindingOnSyntax(this._binding)}whenTargetNamed(a){return this._binding.constraint=(0,n.namedConstraint)(a),new e.BindingOnSyntax(this._binding)}whenTargetIsDefault(){return this._binding.constraint=a=>a===null?!1:a.target!==null&&!a.target.isNamed()&&!a.target.isTagged(),new e.BindingOnSyntax(this._binding)}whenTargetTagged(a,o){return this._binding.constraint=(0,n.taggedConstraint)(a)(o),new e.BindingOnSyntax(this._binding)}whenInjectedInto(a){return this._binding.constraint=o=>o!==null&&(0,n.typeConstraint)(a)(o.parentRequest),new e.BindingOnSyntax(this._binding)}whenParentNamed(a){return this._binding.constraint=o=>o!==null&&(0,n.namedConstraint)(a)(o.parentRequest),new e.BindingOnSyntax(this._binding)}whenParentTagged(a,o){return this._binding.constraint=s=>s!==null&&(0,n.taggedConstraint)(a)(o)(s.parentRequest),new e.BindingOnSyntax(this._binding)}whenAnyAncestorIs(a){return this._binding.constraint=o=>o!==null&&(0,n.traverseAncerstors)(o,(0,n.typeConstraint)(a)),new e.BindingOnSyntax(this._binding)}whenNoAncestorIs(a){return this._binding.constraint=o=>o!==null&&!(0,n.traverseAncerstors)(o,(0,n.typeConstraint)(a)),new e.BindingOnSyntax(this._binding)}whenAnyAncestorNamed(a){return this._binding.constraint=o=>o!==null&&(0,n.traverseAncerstors)(o,(0,n.namedConstraint)(a)),new e.BindingOnSyntax(this._binding)}whenNoAncestorNamed(a){return this._binding.constraint=o=>o!==null&&!(0,n.traverseAncerstors)(o,(0,n.namedConstraint)(a)),new e.BindingOnSyntax(this._binding)}whenAnyAncestorTagged(a,o){return this._binding.constraint=s=>s!==null&&(0,n.traverseAncerstors)(s,(0,n.taggedConstraint)(a)(o)),new e.BindingOnSyntax(this._binding)}whenNoAncestorTagged(a,o){return this._binding.constraint=s=>s!==null&&!(0,n.traverseAncerstors)(s,(0,n.taggedConstraint)(a)(o)),new e.BindingOnSyntax(this._binding)}whenAnyAncestorMatches(a){return this._binding.constraint=o=>o!==null&&(0,n.traverseAncerstors)(o,a),new e.BindingOnSyntax(this._binding)}whenNoAncestorMatches(a){return this._binding.constraint=o=>o!==null&&!(0,n.traverseAncerstors)(o,a),new e.BindingOnSyntax(this._binding)}}return Xh.BindingWhenSyntax=t,Xh}var EI;function CC(){if(EI)return Jh;EI=1,Object.defineProperty(Jh,"__esModule",{value:!0}),Jh.BindingOnSyntax=void 0;const e=EC();class n{constructor(i){x(this,"_binding");this._binding=i}onActivation(i){return this._binding.onActivation=i,new e.BindingWhenSyntax(this._binding)}onDeactivation(i){return this._binding.onDeactivation=i,new e.BindingWhenSyntax(this._binding)}}return Jh.BindingOnSyntax=n,Jh}var CI;function a7(){if(CI)return Qh;CI=1,Object.defineProperty(Qh,"__esModule",{value:!0}),Qh.BindingWhenOnSyntax=void 0;const e=CC(),n=EC();class t{constructor(a){x(this,"_bindingWhenSyntax");x(this,"_bindingOnSyntax");x(this,"_binding");this._binding=a,this._bindingWhenSyntax=new n.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new e.BindingOnSyntax(this._binding)}when(a){return this._bindingWhenSyntax.when(a)}whenTargetNamed(a){return this._bindingWhenSyntax.whenTargetNamed(a)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(a,o){return this._bindingWhenSyntax.whenTargetTagged(a,o)}whenInjectedInto(a){return this._bindingWhenSyntax.whenInjectedInto(a)}whenParentNamed(a){return this._bindingWhenSyntax.whenParentNamed(a)}whenParentTagged(a,o){return this._bindingWhenSyntax.whenParentTagged(a,o)}whenAnyAncestorIs(a){return this._bindingWhenSyntax.whenAnyAncestorIs(a)}whenNoAncestorIs(a){return this._bindingWhenSyntax.whenNoAncestorIs(a)}whenAnyAncestorNamed(a){return this._bindingWhenSyntax.whenAnyAncestorNamed(a)}whenAnyAncestorTagged(a,o){return this._bindingWhenSyntax.whenAnyAncestorTagged(a,o)}whenNoAncestorNamed(a){return this._bindingWhenSyntax.whenNoAncestorNamed(a)}whenNoAncestorTagged(a,o){return this._bindingWhenSyntax.whenNoAncestorTagged(a,o)}whenAnyAncestorMatches(a){return this._bindingWhenSyntax.whenAnyAncestorMatches(a)}whenNoAncestorMatches(a){return this._bindingWhenSyntax.whenNoAncestorMatches(a)}onActivation(a){return this._bindingOnSyntax.onActivation(a)}onDeactivation(a){return this._bindingOnSyntax.onDeactivation(a)}}return Qh.BindingWhenOnSyntax=t,Qh}var PI;function GG(){if(PI)return Zh;PI=1,Object.defineProperty(Zh,"__esModule",{value:!0}),Zh.BindingInSyntax=void 0;const e=Va(),n=a7();class t{constructor(a){x(this,"_binding");this._binding=a}inRequestScope(){return this._binding.scope=e.BindingScopeEnum.Request,new n.BindingWhenOnSyntax(this._binding)}inSingletonScope(){return this._binding.scope=e.BindingScopeEnum.Singleton,new n.BindingWhenOnSyntax(this._binding)}inTransientScope(){return this._binding.scope=e.BindingScopeEnum.Transient,new n.BindingWhenOnSyntax(this._binding)}}return Zh.BindingInSyntax=t,Zh}var RI;function zG(){if(RI)return Wh;RI=1,Object.defineProperty(Wh,"__esModule",{value:!0}),Wh.BindingInWhenOnSyntax=void 0;const e=GG(),n=CC(),t=EC();class i{constructor(o){x(this,"_bindingInSyntax");x(this,"_bindingWhenSyntax");x(this,"_bindingOnSyntax");x(this,"_binding");this._binding=o,this._bindingWhenSyntax=new t.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new n.BindingOnSyntax(this._binding),this._bindingInSyntax=new e.BindingInSyntax(o)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(o){return this._bindingWhenSyntax.when(o)}whenTargetNamed(o){return this._bindingWhenSyntax.whenTargetNamed(o)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(o,s){return this._bindingWhenSyntax.whenTargetTagged(o,s)}whenInjectedInto(o){return this._bindingWhenSyntax.whenInjectedInto(o)}whenParentNamed(o){return this._bindingWhenSyntax.whenParentNamed(o)}whenParentTagged(o,s){return this._bindingWhenSyntax.whenParentTagged(o,s)}whenAnyAncestorIs(o){return this._bindingWhenSyntax.whenAnyAncestorIs(o)}whenNoAncestorIs(o){return this._bindingWhenSyntax.whenNoAncestorIs(o)}whenAnyAncestorNamed(o){return this._bindingWhenSyntax.whenAnyAncestorNamed(o)}whenAnyAncestorTagged(o,s){return this._bindingWhenSyntax.whenAnyAncestorTagged(o,s)}whenNoAncestorNamed(o){return this._bindingWhenSyntax.whenNoAncestorNamed(o)}whenNoAncestorTagged(o,s){return this._bindingWhenSyntax.whenNoAncestorTagged(o,s)}whenAnyAncestorMatches(o){return this._bindingWhenSyntax.whenAnyAncestorMatches(o)}whenNoAncestorMatches(o){return this._bindingWhenSyntax.whenNoAncestorMatches(o)}onActivation(o){return this._bindingOnSyntax.onActivation(o)}onDeactivation(o){return this._bindingOnSyntax.onDeactivation(o)}}return Wh.BindingInWhenOnSyntax=i,Wh}var MI;function UG(){if(MI)return ss;MI=1;var e=ss&&ss.__createBinding||(Object.create?function(d,l,c,u){u===void 0&&(u=c);var f=Object.getOwnPropertyDescriptor(l,c);(!f||("get"in f?!l.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(d,u,f)}:function(d,l,c,u){u===void 0&&(u=c),d[u]=l[c]}),n=ss&&ss.__setModuleDefault||(Object.create?function(d,l){Object.defineProperty(d,"default",{enumerable:!0,value:l})}:function(d,l){d.default=l}),t=ss&&ss.__importStar||function(){var d=function(l){return d=Object.getOwnPropertyNames||function(c){var u=[];for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(u[u.length]=f);return u},d(l)};return function(l){if(l&&l.__esModule)return l;var c={};if(l!=null)for(var u=d(l),f=0;f<u.length;f++)u[f]!=="default"&&e(c,l,u[f]);return n(c,l),c}}();Object.defineProperty(ss,"__esModule",{value:!0}),ss.BindingToSyntax=void 0;const i=t(_r()),a=Va(),o=zG(),s=a7();class r{constructor(l){x(this,"_binding");this._binding=l}to(l){return this._binding.type=a.BindingTypeEnum.Instance,this._binding.implementationType=l,new o.BindingInWhenOnSyntax(this._binding)}toSelf(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(i.INVALID_TO_SELF_VALUE);const l=this._binding.serviceIdentifier;return this.to(l)}toConstantValue(l){return this._binding.type=a.BindingTypeEnum.ConstantValue,this._binding.cache=l,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=a.BindingScopeEnum.Singleton,new s.BindingWhenOnSyntax(this._binding)}toDynamicValue(l){return this._binding.type=a.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=l,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)}toConstructor(l){return this._binding.type=a.BindingTypeEnum.Constructor,this._binding.implementationType=l,this._binding.scope=a.BindingScopeEnum.Singleton,new s.BindingWhenOnSyntax(this._binding)}toFactory(l){return this._binding.type=a.BindingTypeEnum.Factory,this._binding.factory=l,this._binding.scope=a.BindingScopeEnum.Singleton,new s.BindingWhenOnSyntax(this._binding)}toFunction(l){if(typeof l!="function")throw new Error(i.INVALID_FUNCTION_BINDING);const c=this.toConstantValue(l);return this._binding.type=a.BindingTypeEnum.Function,this._binding.scope=a.BindingScopeEnum.Singleton,c}toAutoFactory(l){return this._binding.type=a.BindingTypeEnum.Factory,this._binding.factory=c=>()=>c.container.get(l),this._binding.scope=a.BindingScopeEnum.Singleton,new s.BindingWhenOnSyntax(this._binding)}toAutoNamedFactory(l){return this._binding.type=a.BindingTypeEnum.Factory,this._binding.factory=c=>u=>c.container.getNamed(l,u),new s.BindingWhenOnSyntax(this._binding)}toProvider(l){return this._binding.type=a.BindingTypeEnum.Provider,this._binding.provider=l,this._binding.scope=a.BindingScopeEnum.Singleton,new s.BindingWhenOnSyntax(this._binding)}toService(l){this._binding.type=a.BindingTypeEnum.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get(){return null},set(c){}}),this._binding.dynamicValue=c=>{try{return c.container.get(l)}catch{return c.container.getAsync(l)}},this._binding.implementationType=null}}return ss.BindingToSyntax=r,ss}var ep={},AI;function $G(){if(AI)return ep;AI=1,Object.defineProperty(ep,"__esModule",{value:!0}),ep.ContainerSnapshot=void 0;class e{constructor(){x(this,"bindings");x(this,"activations");x(this,"deactivations");x(this,"middleware");x(this,"moduleActivationStore")}static of(t,i,a,o,s){const r=new e;return r.bindings=t,r.middleware=i,r.deactivations=o,r.activations=a,r.moduleActivationStore=s,r}}return ep.ContainerSnapshot=e,ep}var as={},b1={},wI;function YG(){if(wI)return b1;wI=1,Object.defineProperty(b1,"__esModule",{value:!0}),b1.isClonable=e;function e(n){return typeof n=="object"&&n!==null&&"clone"in n&&typeof n.clone=="function"}return b1}var II;function c7(){if(II)return as;II=1;var e=as&&as.__createBinding||(Object.create?function(s,r,d,l){l===void 0&&(l=d);var c=Object.getOwnPropertyDescriptor(r,d);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[d]}}),Object.defineProperty(s,l,c)}:function(s,r,d,l){l===void 0&&(l=d),s[l]=r[d]}),n=as&&as.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),t=as&&as.__importStar||function(){var s=function(r){return s=Object.getOwnPropertyNames||function(d){var l=[];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(l[l.length]=c);return l},s(r)};return function(r){if(r&&r.__esModule)return r;var d={};if(r!=null)for(var l=s(r),c=0;c<l.length;c++)l[c]!=="default"&&e(d,r,l[c]);return n(d,r),d}}();Object.defineProperty(as,"__esModule",{value:!0}),as.Lookup=void 0;const i=t(_r()),a=YG();class o{constructor(){x(this,"_map");this._map=new Map}getMap(){return this._map}add(r,d){if(this._checkNonNulish(r),d==null)throw new Error(i.NULL_ARGUMENT);const l=this._map.get(r);l!==void 0?l.push(d):this._map.set(r,[d])}get(r){this._checkNonNulish(r);const d=this._map.get(r);if(d!==void 0)return d;throw new Error(i.KEY_NOT_FOUND)}remove(r){if(this._checkNonNulish(r),!this._map.delete(r))throw new Error(i.KEY_NOT_FOUND)}removeIntersection(r){this.traverse((d,l)=>{const c=r.hasKey(d)?r.get(d):void 0;if(c!==void 0){const u=l.filter(f=>!c.some(h=>f===h));this._setValue(d,u)}})}removeByCondition(r){const d=[];return this._map.forEach((l,c)=>{const u=[];for(const f of l)r(f)?d.push(f):u.push(f);this._setValue(c,u)}),d}hasKey(r){return this._checkNonNulish(r),this._map.has(r)}clone(){const r=new o;return this._map.forEach((d,l)=>{d.forEach(c=>{r.add(l,(0,a.isClonable)(c)?c.clone():c)})}),r}traverse(r){this._map.forEach((d,l)=>{r(l,d)})}_checkNonNulish(r){if(r==null)throw new Error(i.NULL_ARGUMENT)}_setValue(r,d){d.length>0?this._map.set(r,d):this._map.delete(r)}}return as.Lookup=o,as}var tp={},TI;function WG(){if(TI)return tp;TI=1,Object.defineProperty(tp,"__esModule",{value:!0}),tp.ModuleActivationStore=void 0;const e=c7();class n{constructor(){x(this,"_map",new Map)}remove(i){const a=this._map.get(i);return a===void 0?this._getEmptyHandlersStore():(this._map.delete(i),a)}addDeactivation(i,a,o){this._getModuleActivationHandlers(i).onDeactivations.add(a,o)}addActivation(i,a,o){this._getModuleActivationHandlers(i).onActivations.add(a,o)}clone(){const i=new n;return this._map.forEach((a,o)=>{i._map.set(o,{onActivations:a.onActivations.clone(),onDeactivations:a.onDeactivations.clone()})}),i}_getModuleActivationHandlers(i){let a=this._map.get(i);return a===void 0&&(a=this._getEmptyHandlersStore(),this._map.set(i,a)),a}_getEmptyHandlersStore(){return{onActivations:new e.Lookup,onDeactivations:new e.Lookup}}}return tp.ModuleActivationStore=n,tp}var DI;function ZG(){if(DI)return is;DI=1;var e=is&&is.__createBinding||(Object.create?function(_,S,E,C){C===void 0&&(C=E);var M=Object.getOwnPropertyDescriptor(S,E);(!M||("get"in M?!S.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return S[E]}}),Object.defineProperty(_,C,M)}:function(_,S,E,C){C===void 0&&(C=E),_[C]=S[E]}),n=is&&is.__setModuleDefault||(Object.create?function(_,S){Object.defineProperty(_,"default",{enumerable:!0,value:S})}:function(_,S){_.default=S}),t=is&&is.__importStar||function(){var _=function(S){return _=Object.getOwnPropertyNames||function(E){var C=[];for(var M in E)Object.prototype.hasOwnProperty.call(E,M)&&(C[C.length]=M);return C},_(S)};return function(S){if(S&&S.__esModule)return S;var E={};if(S!=null)for(var C=_(S),M=0;M<C.length;M++)C[M]!=="default"&&e(E,S,C[M]);return n(E,S),E}}();Object.defineProperty(is,"__esModule",{value:!0}),is.Container=void 0;const i=CG(),a=t(_r()),o=Va(),s=t(Gn()),r=z8(),d=r7(),l=VG(),c=UG(),u=Wy(),f=Jf(),h=Am(),p=$G(),g=c7(),m=WG();class v{constructor(S){x(this,"id");x(this,"parent");x(this,"options");x(this,"_middleware");x(this,"_bindingDictionary");x(this,"_activations");x(this,"_deactivations");x(this,"_snapshots");x(this,"_metadataReader");x(this,"_moduleActivationStore");const E=S||{};if(typeof E!="object")throw new Error(a.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(E.defaultScope===void 0)E.defaultScope=o.BindingScopeEnum.Transient;else if(E.defaultScope!==o.BindingScopeEnum.Singleton&&E.defaultScope!==o.BindingScopeEnum.Transient&&E.defaultScope!==o.BindingScopeEnum.Request)throw new Error(a.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(E.autoBindInjectable===void 0)E.autoBindInjectable=!1;else if(typeof E.autoBindInjectable!="boolean")throw new Error(a.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(E.skipBaseClassChecks===void 0)E.skipBaseClassChecks=!1;else if(typeof E.skipBaseClassChecks!="boolean")throw new Error(a.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:E.autoBindInjectable,defaultScope:E.defaultScope,skipBaseClassChecks:E.skipBaseClassChecks},this.id=(0,f.id)(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this._activations=new g.Lookup,this._deactivations=new g.Lookup,this.parent=null,this._metadataReader=new r.MetadataReader,this._moduleActivationStore=new m.ModuleActivationStore}static merge(S,E,...C){const M=new v,L=[S,E,...C].map(w=>(0,d.getBindingDictionary)(w)),I=(0,d.getBindingDictionary)(M);function R(w,T){w.traverse((j,D)=>{D.forEach(B=>{T.add(B.serviceIdentifier,B.clone())})})}return L.forEach(w=>{R(w,I)}),M}load(...S){const E=this._getContainerModuleHelpersFactory();for(const C of S){const M=E(C.id);C.registry(M.bindFunction,M.unbindFunction,M.isboundFunction,M.rebindFunction,M.unbindAsyncFunction,M.onActivationFunction,M.onDeactivationFunction)}}async loadAsync(...S){const E=this._getContainerModuleHelpersFactory();for(const C of S){const M=E(C.id);await C.registry(M.bindFunction,M.unbindFunction,M.isboundFunction,M.rebindFunction,M.unbindAsyncFunction,M.onActivationFunction,M.onDeactivationFunction)}}unload(...S){S.forEach(E=>{const C=this._removeModuleBindings(E.id);this._deactivateSingletons(C),this._removeModuleHandlers(E.id)})}async unloadAsync(...S){for(const E of S){const C=this._removeModuleBindings(E.id);await this._deactivateSingletonsAsync(C),this._removeModuleHandlers(E.id)}}bind(S){return this._bind(this._buildBinding(S))}rebind(S){return this.unbind(S),this.bind(S)}async rebindAsync(S){return await this.unbindAsync(S),this.bind(S)}unbind(S){if(this._bindingDictionary.hasKey(S)){const E=this._bindingDictionary.get(S);this._deactivateSingletons(E)}this._removeServiceFromDictionary(S)}async unbindAsync(S){if(this._bindingDictionary.hasKey(S)){const E=this._bindingDictionary.get(S);await this._deactivateSingletonsAsync(E)}this._removeServiceFromDictionary(S)}unbindAll(){this._bindingDictionary.traverse((S,E)=>{this._deactivateSingletons(E)}),this._bindingDictionary=new g.Lookup}async unbindAllAsync(){const S=[];this._bindingDictionary.traverse((E,C)=>{S.push(this._deactivateSingletonsAsync(C))}),await Promise.all(S),this._bindingDictionary=new g.Lookup}onActivation(S,E){this._activations.add(S,E)}onDeactivation(S,E){this._deactivations.add(S,E)}isBound(S){let E=this._bindingDictionary.hasKey(S);return!E&&this.parent&&(E=this.parent.isBound(S)),E}isCurrentBound(S){return this._bindingDictionary.hasKey(S)}isBoundNamed(S,E){return this.isBoundTagged(S,s.NAMED_TAG,E)}isBoundTagged(S,E,C){let M=!1;if(this._bindingDictionary.hasKey(S)){const L=this._bindingDictionary.get(S),I=(0,d.createMockRequest)(this,S,{customTag:{key:E,value:C},isMultiInject:!1});M=L.some(R=>R.constraint(I))}return!M&&this.parent&&(M=this.parent.isBoundTagged(S,E,C)),M}snapshot(){this._snapshots.push(p.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){const S=this._snapshots.pop();if(S===void 0)throw new Error(a.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=S.bindings,this._activations=S.activations,this._deactivations=S.deactivations,this._middleware=S.middleware,this._moduleActivationStore=S.moduleActivationStore}createChild(S){const E=new v(S||this.options);return E.parent=this,E}applyMiddleware(...S){const E=this._middleware?this._middleware:this._planAndResolve();this._middleware=S.reduce((C,M)=>M(C),E)}applyCustomMetadataReader(S){this._metadataReader=S}get(S){const E=this._getNotAllArgs(S,!1,!1);return this._getButThrowIfAsync(E)}async getAsync(S){const E=this._getNotAllArgs(S,!1,!1);return this._get(E)}getTagged(S,E,C){const M=this._getNotAllArgs(S,!1,!1,E,C);return this._getButThrowIfAsync(M)}async getTaggedAsync(S,E,C){const M=this._getNotAllArgs(S,!1,!1,E,C);return this._get(M)}getNamed(S,E){return this.getTagged(S,s.NAMED_TAG,E)}async getNamedAsync(S,E){return this.getTaggedAsync(S,s.NAMED_TAG,E)}getAll(S,E){const C=this._getAllArgs(S,E,!1);return this._getButThrowIfAsync(C)}async getAllAsync(S,E){const C=this._getAllArgs(S,E,!1);return this._getAll(C)}getAllTagged(S,E,C){const M=this._getNotAllArgs(S,!0,!1,E,C);return this._getButThrowIfAsync(M)}async getAllTaggedAsync(S,E,C){const M=this._getNotAllArgs(S,!0,!1,E,C);return this._getAll(M)}getAllNamed(S,E){return this.getAllTagged(S,s.NAMED_TAG,E)}async getAllNamedAsync(S,E){return this.getAllTaggedAsync(S,s.NAMED_TAG,E)}resolve(S){const E=this.isBound(S);E||this.bind(S).toSelf();const C=this.get(S);return E||this.unbind(S),C}tryGet(S){const E=this._getNotAllArgs(S,!1,!0);return this._getButThrowIfAsync(E)}async tryGetAsync(S){const E=this._getNotAllArgs(S,!1,!0);return this._get(E)}tryGetTagged(S,E,C){const M=this._getNotAllArgs(S,!1,!0,E,C);return this._getButThrowIfAsync(M)}async tryGetTaggedAsync(S,E,C){const M=this._getNotAllArgs(S,!1,!0,E,C);return this._get(M)}tryGetNamed(S,E){return this.tryGetTagged(S,s.NAMED_TAG,E)}async tryGetNamedAsync(S,E){return this.tryGetTaggedAsync(S,s.NAMED_TAG,E)}tryGetAll(S,E){const C=this._getAllArgs(S,E,!0);return this._getButThrowIfAsync(C)}async tryGetAllAsync(S,E){const C=this._getAllArgs(S,E,!0);return this._getAll(C)}tryGetAllTagged(S,E,C){const M=this._getNotAllArgs(S,!0,!0,E,C);return this._getButThrowIfAsync(M)}async tryGetAllTaggedAsync(S,E,C){const M=this._getNotAllArgs(S,!0,!0,E,C);return this._getAll(M)}tryGetAllNamed(S,E){return this.tryGetAllTagged(S,s.NAMED_TAG,E)}async tryGetAllNamedAsync(S,E){return this.tryGetAllTaggedAsync(S,s.NAMED_TAG,E)}_preDestroy(S,E){var C;if(S!==void 0&&Reflect.hasMetadata(s.PRE_DESTROY,S)){const M=Reflect.getMetadata(s.PRE_DESTROY,S);return(C=E[M.value])==null?void 0:C.call(E)}}_removeModuleHandlers(S){const E=this._moduleActivationStore.remove(S);this._activations.removeIntersection(E.onActivations),this._deactivations.removeIntersection(E.onDeactivations)}_removeModuleBindings(S){return this._bindingDictionary.removeByCondition(E=>E.moduleId===S)}_deactivate(S,E){const C=E==null?void 0:Object.getPrototypeOf(E).constructor;try{if(this._deactivations.hasKey(S.serviceIdentifier)){const L=this._deactivateContainer(E,this._deactivations.get(S.serviceIdentifier).values());if((0,u.isPromise)(L))return this._handleDeactivationError(L.then(async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(S,E,C)),S.serviceIdentifier)}const M=this._propagateContainerDeactivationThenBindingAndPreDestroy(S,E,C);if((0,u.isPromise)(M))return this._handleDeactivationError(M,S.serviceIdentifier)}catch(M){if(M instanceof Error)throw new Error(a.ON_DEACTIVATION_ERROR((0,h.getServiceIdentifierAsString)(S.serviceIdentifier),M.message))}}async _handleDeactivationError(S,E){try{await S}catch(C){if(C instanceof Error)throw new Error(a.ON_DEACTIVATION_ERROR((0,h.getServiceIdentifierAsString)(E),C.message))}}_deactivateContainer(S,E){let C=E.next();for(;typeof C.value=="function";){const M=C.value(S);if((0,u.isPromise)(M))return M.then(async()=>this._deactivateContainerAsync(S,E));C=E.next()}}async _deactivateContainerAsync(S,E){let C=E.next();for(;typeof C.value=="function";)await C.value(S),C=E.next()}_getContainerModuleHelpersFactory(){const S=w=>T=>{const j=this._buildBinding(T);return j.moduleId=w,this._bind(j)},E=()=>w=>{this.unbind(w)},C=()=>async w=>this.unbindAsync(w),M=()=>w=>this.isBound(w),L=w=>{const T=S(w);return j=>(this.unbind(j),T(j))},I=w=>(T,j)=>{this._moduleActivationStore.addActivation(w,T,j),this.onActivation(T,j)},R=w=>(T,j)=>{this._moduleActivationStore.addDeactivation(w,T,j),this.onDeactivation(T,j)};return w=>({bindFunction:S(w),isboundFunction:M(),onActivationFunction:I(w),onDeactivationFunction:R(w),rebindFunction:L(w),unbindAsyncFunction:C(),unbindFunction:E()})}_bind(S){return this._bindingDictionary.add(S.serviceIdentifier,S),new c.BindingToSyntax(S)}_buildBinding(S){const E=this.options.defaultScope||o.BindingScopeEnum.Transient;return new i.Binding(S,E)}async _getAll(S){return Promise.all(this._get(S))}_get(S){const E={...S,contextInterceptor:C=>C,targetType:o.TargetTypeEnum.Variable};if(this._middleware){const C=this._middleware(E);if(C==null)throw new Error(a.INVALID_MIDDLEWARE_RETURN);return C}return this._planAndResolve()(E)}_getButThrowIfAsync(S){const E=this._get(S);if((0,u.isPromiseOrContainsPromise)(E))throw new Error(a.LAZY_IN_SYNC(S.serviceIdentifier));return E}_getAllArgs(S,E,C){return{avoidConstraints:!((E==null?void 0:E.enforceBindingConstraints)??!1),isMultiInject:!0,isOptional:C,serviceIdentifier:S}}_getNotAllArgs(S,E,C,M,L){return{avoidConstraints:!1,isMultiInject:E,isOptional:C,key:M,serviceIdentifier:S,value:L}}_getPlanMetadataFromNextArgs(S){const E={isMultiInject:S.isMultiInject};return S.key!==void 0&&(E.customTag={key:S.key,value:S.value}),S.isOptional===!0&&(E.isOptional=!0),E}_planAndResolve(){return S=>{let E=(0,d.plan)(this._metadataReader,this,S.targetType,S.serviceIdentifier,this._getPlanMetadataFromNextArgs(S),S.avoidConstraints);return E=S.contextInterceptor(E),(0,l.resolve)(E)}}_deactivateIfSingleton(S){if(S.activated)return(0,u.isPromise)(S.cache)?S.cache.then(E=>this._deactivate(S,E)):this._deactivate(S,S.cache)}_deactivateSingletons(S){for(const E of S){const C=this._deactivateIfSingleton(E);if((0,u.isPromise)(C))throw new Error(a.ASYNC_UNBIND_REQUIRED)}}async _deactivateSingletonsAsync(S){await Promise.all(S.map(async E=>this._deactivateIfSingleton(E)))}_propagateContainerDeactivationThenBindingAndPreDestroy(S,E,C){return this.parent?this._deactivate.bind(this.parent)(S,E):this._bindingDeactivationAndPreDestroy(S,E,C)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(S,E,C){this.parent?await this._deactivate.bind(this.parent)(S,E):await this._bindingDeactivationAndPreDestroyAsync(S,E,C)}_removeServiceFromDictionary(S){try{this._bindingDictionary.remove(S)}catch{throw new Error(`${a.CANNOT_UNBIND} ${(0,h.getServiceIdentifierAsString)(S)}`)}}_bindingDeactivationAndPreDestroy(S,E,C){if(typeof S.onDeactivation=="function"){const M=S.onDeactivation(E);if((0,u.isPromise)(M))return M.then(()=>this._preDestroy(C,E))}return this._preDestroy(C,E)}async _bindingDeactivationAndPreDestroyAsync(S,E,C){typeof S.onDeactivation=="function"&&await S.onDeactivation(E),await this._preDestroy(C,E)}}return is.Container=v,is}var Ml={},OI;function QG(){if(OI)return Ml;OI=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.AsyncContainerModule=Ml.ContainerModule=void 0;const e=Jf();class n{constructor(a){x(this,"id");x(this,"registry");this.id=(0,e.id)(),this.registry=a}}Ml.ContainerModule=n;class t{constructor(a){x(this,"id");x(this,"registry");this.id=(0,e.id)(),this.registry=a}}return Ml.AsyncContainerModule=t,Ml}var Dr={},S1={},LI;function JG(){if(LI)return S1;LI=1,Object.defineProperty(S1,"__esModule",{value:!0}),S1.getFirstArrayDuplicate=e;function e(n){const t=new Set;for(const i of n){if(t.has(i))return i;t.add(i)}}return S1}var jI;function sl(){if(jI)return Dr;jI=1;var e=Dr&&Dr.__createBinding||(Object.create?function(m,v,_,S){S===void 0&&(S=_);var E=Object.getOwnPropertyDescriptor(v,_);(!E||("get"in E?!v.__esModule:E.writable||E.configurable))&&(E={enumerable:!0,get:function(){return v[_]}}),Object.defineProperty(m,S,E)}:function(m,v,_,S){S===void 0&&(S=_),m[S]=v[_]}),n=Dr&&Dr.__setModuleDefault||(Object.create?function(m,v){Object.defineProperty(m,"default",{enumerable:!0,value:v})}:function(m,v){m.default=v}),t=Dr&&Dr.__importStar||function(){var m=function(v){return m=Object.getOwnPropertyNames||function(_){var S=[];for(var E in _)Object.prototype.hasOwnProperty.call(_,E)&&(S[S.length]=E);return S},m(v)};return function(v){if(v&&v.__esModule)return v;var _={};if(v!=null)for(var S=m(v),E=0;E<S.length;E++)S[E]!=="default"&&e(_,v,S[E]);return n(_,v),_}}();Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.decorate=g,Dr.tagParameter=d,Dr.tagProperty=l,Dr.createTaggedDecorator=f;const i=t(_r()),a=t(Gn()),o=JG();function s(m){return m.prototype!==void 0}function r(m){if(m!==void 0)throw new Error(i.INVALID_DECORATOR_OPERATION)}function d(m,v,_,S){r(v),u(a.TAGGED,m,_.toString(),S)}function l(m,v,_){if(s(m))throw new Error(i.INVALID_DECORATOR_OPERATION);u(a.TAGGED_PROP,m.constructor,v,_)}function c(m){let v=[];if(Array.isArray(m)){v=m;const _=(0,o.getFirstArrayDuplicate)(v.map(S=>S.key));if(_!==void 0)throw new Error(`${i.DUPLICATED_METADATA} ${_.toString()}`)}else v=[m];return v}function u(m,v,_,S){const E=c(S);let C={};Reflect.hasOwnMetadata(m,v)&&(C=Reflect.getMetadata(m,v));let M=C[_];if(M===void 0)M=[];else for(const L of M)if(E.some(I=>I.key===L.key))throw new Error(`${i.DUPLICATED_METADATA} ${L.key.toString()}`);M.push(...E),C[_]=M,Reflect.defineMetadata(m,C,v)}function f(m){return(v,_,S)=>{typeof S=="number"?d(v,_,S,m):l(v,_,m)}}function h(m,v){Reflect.decorate(m,v)}function p(m,v){return function(_,S){v(_,S,m)}}function g(m,v,_){typeof _=="number"?h([p(_,m)],v):typeof _=="string"?Reflect.decorate([m],v,_):h([m],v)}return Dr}var ks={},NI;function XG(){if(NI)return ks;NI=1;var e=ks&&ks.__createBinding||(Object.create?function(s,r,d,l){l===void 0&&(l=d);var c=Object.getOwnPropertyDescriptor(r,d);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[d]}}),Object.defineProperty(s,l,c)}:function(s,r,d,l){l===void 0&&(l=d),s[l]=r[d]}),n=ks&&ks.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),t=ks&&ks.__importStar||function(){var s=function(r){return s=Object.getOwnPropertyNames||function(d){var l=[];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(l[l.length]=c);return l},s(r)};return function(r){if(r&&r.__esModule)return r;var d={};if(r!=null)for(var l=s(r),c=0;c<l.length;c++)l[c]!=="default"&&e(d,r,l[c]);return n(d,r),d}}();Object.defineProperty(ks,"__esModule",{value:!0}),ks.injectable=o;const i=t(_r()),a=t(Gn());function o(){return function(s){if(Reflect.hasOwnMetadata(a.PARAM_TYPES,s))throw new Error(i.DUPLICATED_INJECTABLE_DECORATOR);const r=Reflect.getMetadata(a.DESIGN_PARAM_TYPES,s)||[];return Reflect.defineMetadata(a.PARAM_TYPES,r,s),s}}return ks}var E1={},BI;function ez(){if(BI)return E1;BI=1,Object.defineProperty(E1,"__esModule",{value:!0}),E1.tagged=t;const e=Uc(),n=sl();function t(i,a){return(0,n.createTaggedDecorator)(new e.Metadata(i,a))}return E1}var Ks={},xI;function tz(){if(xI)return Ks;xI=1;var e=Ks&&Ks.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=Ks&&Ks.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=Ks&&Ks.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.named=s;const i=t(Gn()),a=Uc(),o=sl();function s(r){return(0,o.createTaggedDecorator)(new a.Metadata(i.NAMED_TAG,r))}return Ks}var cs={},C1={},FI;function u7(){if(FI)return C1;FI=1,Object.defineProperty(C1,"__esModule",{value:!0}),C1.injectBase=i;const e=_r(),n=Uc(),t=sl();function i(a){return o=>(s,r,d)=>{if(o===void 0){const l=typeof s=="function"?s.name:s.constructor.name;throw new Error((0,e.UNDEFINED_INJECT_ANNOTATION)(l))}(0,t.createTaggedDecorator)(new n.Metadata(a,o))(s,r,d)}}return C1}var kI;function nz(){if(kI)return cs;kI=1;var e=cs&&cs.__createBinding||(Object.create?function(s,r,d,l){l===void 0&&(l=d);var c=Object.getOwnPropertyDescriptor(r,d);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[d]}}),Object.defineProperty(s,l,c)}:function(s,r,d,l){l===void 0&&(l=d),s[l]=r[d]}),n=cs&&cs.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),t=cs&&cs.__importStar||function(){var s=function(r){return s=Object.getOwnPropertyNames||function(d){var l=[];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(l[l.length]=c);return l},s(r)};return function(r){if(r&&r.__esModule)return r;var d={};if(r!=null)for(var l=s(r),c=0;c<l.length;c++)l[c]!=="default"&&e(d,r,l[c]);return n(d,r),d}}();Object.defineProperty(cs,"__esModule",{value:!0}),cs.inject=void 0;const i=t(Gn()),o=(0,u7().injectBase)(i.INJECT_TAG);return cs.inject=o,cs}var qs={},KI;function iz(){if(KI)return qs;KI=1;var e=qs&&qs.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=qs&&qs.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=qs&&qs.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(qs,"__esModule",{value:!0}),qs.optional=s;const i=t(Gn()),a=Uc(),o=sl();function s(){return(0,o.createTaggedDecorator)(new a.Metadata(i.OPTIONAL_TAG,!0))}return qs}var Hs={},qI;function rz(){if(qI)return Hs;qI=1;var e=Hs&&Hs.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=Hs&&Hs.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=Hs&&Hs.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.unmanaged=s;const i=t(Gn()),a=Uc(),o=sl();function s(){return function(r,d,l){const c=new a.Metadata(i.UNMANAGED_TAG,!0);(0,o.tagParameter)(r,d,l,c)}}return Hs}var us={},HI;function oz(){if(HI)return us;HI=1;var e=us&&us.__createBinding||(Object.create?function(s,r,d,l){l===void 0&&(l=d);var c=Object.getOwnPropertyDescriptor(r,d);(!c||("get"in c?!r.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return r[d]}}),Object.defineProperty(s,l,c)}:function(s,r,d,l){l===void 0&&(l=d),s[l]=r[d]}),n=us&&us.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),t=us&&us.__importStar||function(){var s=function(r){return s=Object.getOwnPropertyNames||function(d){var l=[];for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&(l[l.length]=c);return l},s(r)};return function(r){if(r&&r.__esModule)return r;var d={};if(r!=null)for(var l=s(r),c=0;c<l.length;c++)l[c]!=="default"&&e(d,r,l[c]);return n(d,r),d}}();Object.defineProperty(us,"__esModule",{value:!0}),us.multiInject=void 0;const i=t(Gn()),o=(0,u7().injectBase)(i.MULTI_INJECT_TAG);return us.multiInject=o,us}var Vs={},VI;function sz(){if(VI)return Vs;VI=1;var e=Vs&&Vs.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=Vs&&Vs.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=Vs&&Vs.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.targetName=s;const i=t(Gn()),a=Uc(),o=sl();function s(r){return function(d,l,c){const u=new a.Metadata(i.NAME_TAG,r);(0,o.tagParameter)(d,l,c,u)}}return Vs}var ls={},P1={},GI;function l7(){if(GI)return P1;GI=1,Object.defineProperty(P1,"__esModule",{value:!0}),P1.propertyEventDecorator=n;const e=Uc();function n(t,i){return()=>(a,o)=>{const s=new e.Metadata(t,o);if(Reflect.hasOwnMetadata(t,a.constructor))throw new Error(i);Reflect.defineMetadata(t,s,a.constructor)}}return P1}var zI;function az(){if(zI)return ls;zI=1;var e=ls&&ls.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=ls&&ls.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=ls&&ls.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(ls,"__esModule",{value:!0}),ls.postConstruct=void 0;const i=t(_r()),a=t(Gn()),s=(0,l7().propertyEventDecorator)(a.POST_CONSTRUCT,i.MULTIPLE_POST_CONSTRUCT_METHODS);return ls.postConstruct=s,ls}var ds={},UI;function cz(){if(UI)return ds;UI=1;var e=ds&&ds.__createBinding||(Object.create?function(r,d,l,c){c===void 0&&(c=l);var u=Object.getOwnPropertyDescriptor(d,l);(!u||("get"in u?!d.__esModule:u.writable||u.configurable))&&(u={enumerable:!0,get:function(){return d[l]}}),Object.defineProperty(r,c,u)}:function(r,d,l,c){c===void 0&&(c=l),r[c]=d[l]}),n=ds&&ds.__setModuleDefault||(Object.create?function(r,d){Object.defineProperty(r,"default",{enumerable:!0,value:d})}:function(r,d){r.default=d}),t=ds&&ds.__importStar||function(){var r=function(d){return r=Object.getOwnPropertyNames||function(l){var c=[];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(c[c.length]=u);return c},r(d)};return function(d){if(d&&d.__esModule)return d;var l={};if(d!=null)for(var c=r(d),u=0;u<c.length;u++)c[u]!=="default"&&e(l,d,c[u]);return n(l,d),l}}();Object.defineProperty(ds,"__esModule",{value:!0}),ds.preDestroy=void 0;const i=t(_r()),a=t(Gn()),s=(0,l7().propertyEventDecorator)(a.PRE_DESTROY,i.MULTIPLE_PRE_DESTROY_METHODS);return ds.preDestroy=s,ds}var $I;function G(){return $I||($I=1,function(e){var n=uc&&uc.__createBinding||(Object.create?function(T,j,D,B){B===void 0&&(B=D);var H=Object.getOwnPropertyDescriptor(j,D);(!H||("get"in H?!j.__esModule:H.writable||H.configurable))&&(H={enumerable:!0,get:function(){return j[D]}}),Object.defineProperty(T,B,H)}:function(T,j,D,B){B===void 0&&(B=D),T[B]=j[D]}),t=uc&&uc.__setModuleDefault||(Object.create?function(T,j){Object.defineProperty(T,"default",{enumerable:!0,value:j})}:function(T,j){T.default=j}),i=uc&&uc.__importStar||function(){var T=function(j){return T=Object.getOwnPropertyNames||function(D){var B=[];for(var H in D)Object.prototype.hasOwnProperty.call(D,H)&&(B[B.length]=H);return B},T(j)};return function(j){if(j&&j.__esModule)return j;var D={};if(j!=null)for(var B=T(j),H=0;H<B.length;H++)B[H]!=="default"&&n(D,j,B[H]);return t(D,j),D}}();Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=e.getServiceIdentifierAsString=e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=e.decorate=e.id=e.MetadataReader=e.preDestroy=e.postConstruct=e.targetName=e.multiInject=e.unmanaged=e.optional=e.inject=e.named=e.tagged=e.injectable=e.createTaggedDecorator=e.ContainerModule=e.AsyncContainerModule=e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=e.Container=e.METADATA_KEY=e.LazyServiceIdentifer=e.LazyServiceIdentifier=void 0,bC();const a=LS(),o=i(Gn());var s=LS();Object.defineProperty(e,"LazyServiceIdentifier",{enumerable:!0,get:function(){return s.LazyServiceIdentifier}}),e.LazyServiceIdentifer=a.LazyServiceIdentifier,e.METADATA_KEY=o;var r=ZG();Object.defineProperty(e,"Container",{enumerable:!0,get:function(){return r.Container}});var d=Va();Object.defineProperty(e,"BindingScopeEnum",{enumerable:!0,get:function(){return d.BindingScopeEnum}}),Object.defineProperty(e,"BindingTypeEnum",{enumerable:!0,get:function(){return d.BindingTypeEnum}}),Object.defineProperty(e,"TargetTypeEnum",{enumerable:!0,get:function(){return d.TargetTypeEnum}});var l=QG();Object.defineProperty(e,"AsyncContainerModule",{enumerable:!0,get:function(){return l.AsyncContainerModule}}),Object.defineProperty(e,"ContainerModule",{enumerable:!0,get:function(){return l.ContainerModule}});var c=sl();Object.defineProperty(e,"createTaggedDecorator",{enumerable:!0,get:function(){return c.createTaggedDecorator}});var u=XG();Object.defineProperty(e,"injectable",{enumerable:!0,get:function(){return u.injectable}});var f=ez();Object.defineProperty(e,"tagged",{enumerable:!0,get:function(){return f.tagged}});var h=tz();Object.defineProperty(e,"named",{enumerable:!0,get:function(){return h.named}});var p=nz();Object.defineProperty(e,"inject",{enumerable:!0,get:function(){return p.inject}});var g=iz();Object.defineProperty(e,"optional",{enumerable:!0,get:function(){return g.optional}});var m=rz();Object.defineProperty(e,"unmanaged",{enumerable:!0,get:function(){return m.unmanaged}});var v=oz();Object.defineProperty(e,"multiInject",{enumerable:!0,get:function(){return v.multiInject}});var _=sz();Object.defineProperty(e,"targetName",{enumerable:!0,get:function(){return _.targetName}});var S=az();Object.defineProperty(e,"postConstruct",{enumerable:!0,get:function(){return S.postConstruct}});var E=cz();Object.defineProperty(e,"preDestroy",{enumerable:!0,get:function(){return E.preDestroy}});var C=z8();Object.defineProperty(e,"MetadataReader",{enumerable:!0,get:function(){return C.MetadataReader}});var M=Jf();Object.defineProperty(e,"id",{enumerable:!0,get:function(){return M.id}});var L=sl();Object.defineProperty(e,"decorate",{enumerable:!0,get:function(){return L.decorate}});var I=s7();Object.defineProperty(e,"traverseAncerstors",{enumerable:!0,get:function(){return I.traverseAncerstors}}),Object.defineProperty(e,"taggedConstraint",{enumerable:!0,get:function(){return I.taggedConstraint}}),Object.defineProperty(e,"namedConstraint",{enumerable:!0,get:function(){return I.namedConstraint}}),Object.defineProperty(e,"typeConstraint",{enumerable:!0,get:function(){return I.typeConstraint}});var R=Am();Object.defineProperty(e,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return R.getServiceIdentifierAsString}});var w=o7();Object.defineProperty(e,"multiBindToService",{enumerable:!0,get:function(){return w.multiBindToService}})}(uc)),uc}var fc={},Al={},YI;function PC(){if(YI)return Al;YI=1,Object.defineProperty(Al,"__esModule",{value:!0}),Al.isLabeledAction=Al.LabeledAction=void 0;class e{constructor(i,a,o){this.label=i,this.actions=a,this.icon=o}}Al.LabeledAction=e;function n(t){return t!==void 0&&t.label!==void 0&&t.actions!==void 0}return Al.isLabeledAction=n,Al}var Gs={},ve={},hc={},WI;function $c(){if(WI)return hc;WI=1,Object.defineProperty(hc,"__esModule",{value:!0}),hc.safeAssign=hc.hasOwnProperty=hc.isObject=void 0;function e(i){return typeof i=="object"&&i!==null}hc.isObject=e;function n(i,a,o){if(!e(i))return!1;if(Array.isArray(a))for(const s of a){if(!Object.prototype.hasOwnProperty.call(i,s)||typeof o=="string"&&typeof i[s]!==o)return!1;if(typeof o=="function"&&!o(i[s]))return!1}else{if(!Object.prototype.hasOwnProperty.call(i,a))return!1;if(typeof o=="string")return typeof i[a]===o;if(typeof o=="function")return o(i[a])}return!0}hc.hasOwnProperty=n;function t(i,a){return Object.assign(i,a)}return hc.safeAssign=t,hc}var ZI;function lt(){if(ZI)return ve;ZI=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.ReconnectAction=ve.ApplyLabelEditAction=ve.DeleteElementAction=ve.CreateElementAction=ve.ExportSvgAction=ve.RequestExportSvgAction=ve.HoverFeedbackAction=ve.MoveAction=ve.RedoAction=ve.UndoAction=ve.BringToFrontAction=ve.ViewportResult=ve.GetViewportAction=ve.SetViewportAction=ve.FitToScreenAction=ve.CenterAction=ve.LayoutAction=ve.OpenAction=ve.CollapseExpandAllAction=ve.CollapseExpandAction=ve.SelectionResult=ve.GetSelectionAction=ve.SelectAllAction=ve.SelectAction=ve.LoggingAction=ve.ComputedBoundsAction=ve.RequestBoundsAction=ve.SetBoundsAction=ve.SetPopupModelAction=ve.RequestPopupModelAction=ve.UpdateModelAction=ve.SetModelAction=ve.RequestModelAction=ve.RejectAction=ve.isResponseAction=ve.setRequestContext=ve.generateRequestId=ve.isRequestAction=ve.isAction=ve.isActionMessage=void 0;const e=$c();function n(ee){return(0,e.hasOwnProperty)(ee,"action")}ve.isActionMessage=n;function t(ee){return(0,e.hasOwnProperty)(ee,"kind","string")}ve.isAction=t;function i(ee){return(0,e.hasOwnProperty)(ee,"requestId","string")}ve.isRequestAction=i;let a="",o=1;function s(){return`${a}_${o++}`}ve.generateRequestId=s;function r(ee){a=ee}ve.setRequestContext=r;function d(ee){return(0,e.hasOwnProperty)(ee,"responseId","string")&&ee.responseId!==""}ve.isResponseAction=d;var l;(function(ee){ee.KIND="rejectRequest";function ge(fe){return{kind:ee.KIND,message:fe.message,detail:fe.detail,responseId:fe.requestId}}ee.create=ge})(l||(ve.RejectAction=l={}));var c;(function(ee){ee.KIND="requestModel";function ge(fe){return{kind:ee.KIND,options:fe,requestId:s()}}ee.create=ge})(c||(ve.RequestModelAction=c={}));var u;(function(ee){ee.KIND="setModel";function ge(fe,Ae=""){return{kind:ee.KIND,newRoot:fe,responseId:Ae}}ee.create=ge})(u||(ve.SetModelAction=u={}));var f;(function(ee){ee.KIND="updateModel";function ge(fe,Ae={}){return Array.isArray(fe)?{kind:ee.KIND,matches:fe,animate:Ae.animate,cause:Ae.cause}:{kind:ee.KIND,newRoot:fe,animate:Ae.animate,cause:Ae.cause}}ee.create=ge})(f||(ve.UpdateModelAction=f={}));var h;(function(ee){ee.KIND="requestPopupModel";function ge(fe){return{kind:ee.KIND,elementId:fe.elementId,bounds:fe.bounds,requestId:s()}}ee.create=ge})(h||(ve.RequestPopupModelAction=h={}));var p;(function(ee){ee.KIND="setPopupModel";function ge(fe,Ae=""){return{kind:ee.KIND,newRoot:fe,responseId:Ae}}ee.create=ge})(p||(ve.SetPopupModelAction=p={}));var g;(function(ee){ee.KIND="setBounds";function ge(fe){return{kind:ee.KIND,bounds:fe}}ee.create=ge})(g||(ve.SetBoundsAction=g={}));var m;(function(ee){ee.KIND="requestBounds";function ge(fe){return{kind:ee.KIND,newRoot:fe,requestId:s()}}ee.create=ge})(m||(ve.RequestBoundsAction=m={}));var v;(function(ee){ee.KIND="computedBounds";function ge(fe,Ae={}){var Le;return{kind:ee.KIND,bounds:fe,revision:Ae.revision,alignments:Ae.alignments,responseId:(Le=Ae.requestId)!==null&&Le!==void 0?Le:""}}ee.create=ge})(v||(ve.ComputedBoundsAction=v={}));var _;(function(ee){ee.KIND="logging";function ge(fe){return Object.assign({kind:ee.KIND},fe)}ee.create=ge})(_||(ve.LoggingAction=_={}));var S;(function(ee){ee.KIND="elementSelected";function ge(fe){var Ae,Le;return{kind:ee.KIND,selectedElementsIDs:(Ae=fe.selectedElementsIDs)!==null&&Ae!==void 0?Ae:[],deselectedElementsIDs:(Le=fe.deselectedElementsIDs)!==null&&Le!==void 0?Le:[]}}ee.create=ge})(S||(ve.SelectAction=S={}));var E;(function(ee){ee.KIND="allSelected";function ge(fe={}){var Ae;return{kind:ee.KIND,select:(Ae=fe.select)!==null&&Ae!==void 0?Ae:!0}}ee.create=ge})(E||(ve.SelectAllAction=E={}));var C;(function(ee){ee.KIND="getSelection";function ge(){return{kind:ee.KIND,requestId:s()}}ee.create=ge})(C||(ve.GetSelectionAction=C={}));var M;(function(ee){ee.KIND="selectionResult";function ge(fe,Ae){return{kind:ee.KIND,selectedElementsIDs:fe,responseId:Ae}}ee.create=ge})(M||(ve.SelectionResult=M={}));var L;(function(ee){ee.KIND="collapseExpand";function ge(fe){var Ae,Le;return{kind:ee.KIND,expandIds:(Ae=fe.expandIds)!==null&&Ae!==void 0?Ae:[],collapseIds:(Le=fe.collapseIds)!==null&&Le!==void 0?Le:[]}}ee.create=ge})(L||(ve.CollapseExpandAction=L={}));var I;(function(ee){ee.KIND="collapseExpandAll";function ge(fe={}){var Ae;return{kind:ee.KIND,expand:(Ae=fe.expand)!==null&&Ae!==void 0?Ae:!0}}ee.create=ge})(I||(ve.CollapseExpandAllAction=I={}));var R;(function(ee){ee.KIND="open";function ge(fe){return{kind:ee.KIND,elementId:fe}}ee.create=ge})(R||(ve.OpenAction=R={}));var w;(function(ee){ee.KIND="layout";function ge(fe={}){return{kind:ee.KIND,layoutType:fe.layoutType,elementIds:fe.elementIds}}ee.create=ge})(w||(ve.LayoutAction=w={}));var T;(function(ee){ee.KIND="center";function ge(fe,Ae={}){var Le,Ge;return{kind:ee.KIND,elementIds:fe,animate:(Le=Ae.animate)!==null&&Le!==void 0?Le:!0,retainZoom:(Ge=Ae.retainZoom)!==null&&Ge!==void 0?Ge:!1,zoomScale:Ae.zoomScale}}ee.create=ge})(T||(ve.CenterAction=T={}));var j;(function(ee){ee.KIND="fit";function ge(fe,Ae={}){var Le;return{kind:ee.KIND,elementIds:fe,padding:Ae.padding,maxZoom:Ae.maxZoom,animate:(Le=Ae.animate)!==null&&Le!==void 0?Le:!0}}ee.create=ge})(j||(ve.FitToScreenAction=j={}));var D;(function(ee){ee.KIND="viewport";function ge(fe,Ae,Le={}){var Ge;return{kind:ee.KIND,elementId:fe,newViewport:Ae,animate:(Ge=Le.animate)!==null&&Ge!==void 0?Ge:!0}}ee.create=ge})(D||(ve.SetViewportAction=D={}));var B;(function(ee){ee.KIND="getViewport";function ge(){return{kind:ee.KIND,requestId:s()}}ee.create=ge})(B||(ve.GetViewportAction=B={}));var H;(function(ee){ee.KIND="viewportResult";function ge(fe,Ae,Le){return{kind:ee.KIND,viewport:fe,canvasBounds:Ae,responseId:Le}}ee.create=ge})(H||(ve.ViewportResult=H={}));var F;(function(ee){ee.KIND="bringToFront";function ge(fe){return{kind:ee.KIND,elementIDs:fe}}ee.create=ge})(F||(ve.BringToFrontAction=F={}));var K;(function(ee){ee.KIND="undo";function ge(){return{kind:ee.KIND}}ee.create=ge})(K||(ve.UndoAction=K={}));var U;(function(ee){ee.KIND="redo";function ge(){return{kind:ee.KIND}}ee.create=ge})(U||(ve.RedoAction=U={}));var Z;(function(ee){ee.KIND="move";function ge(fe,Ae={}){var Le,Ge,pn;return{kind:ee.KIND,moves:fe,animate:(Le=Ae.animate)!==null&&Le!==void 0?Le:!0,finished:(Ge=Ae.finished)!==null&&Ge!==void 0?Ge:!1,stoppable:(pn=Ae.stoppable)!==null&&pn!==void 0?pn:!1}}ee.create=ge})(Z||(ve.MoveAction=Z={}));var ce;(function(ee){ee.KIND="hoverFeedback";function ge(fe){return{kind:ee.KIND,mouseoverElement:fe.mouseoverElement,mouseIsOver:fe.mouseIsOver}}ee.create=ge})(ce||(ve.HoverFeedbackAction=ce={}));var de;(function(ee){ee.KIND="requestExportSvg";function ge(fe){return{kind:ee.KIND,requestId:s(),options:fe}}ee.create=ge})(de||(ve.RequestExportSvgAction=de={}));var ke;(function(ee){ee.KIND="exportSvg";function ge(fe,Ae,Le){return{kind:ee.KIND,svg:fe,responseId:Ae,options:Le}}ee.create=ge})(ke||(ve.ExportSvgAction=ke={}));var pe;(function(ee){ee.KIND="createElement";function ge(fe,Ae){return{kind:ee.KIND,elementSchema:fe,containerId:Ae.containerId}}ee.create=ge})(pe||(ve.CreateElementAction=pe={}));var et;(function(ee){ee.KIND="delete";function ge(fe){return{kind:ee.KIND,elementIds:fe}}ee.create=ge})(et||(ve.DeleteElementAction=et={}));var ot;(function(ee){ee.KIND="applyLabelEdit";function ge(fe,Ae){return{kind:ee.KIND,labelId:fe,text:Ae}}ee.create=ge})(ot||(ve.ApplyLabelEditAction=ot={}));var Be;return function(ee){ee.KIND="reconnect";function ge(fe){return{kind:ee.KIND,routableId:fe.routableId,newSourceId:fe.newSourceId,newTargetId:fe.newTargetId}}ee.create=ge}(Be||(ve.ReconnectAction=Be={})),ve}var np={},QI;function Zy(){if(QI)return np;QI=1,Object.defineProperty(np,"__esModule",{value:!0}),np.Deferred=void 0;class e{constructor(){this._state="unresolved",this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),this.promise.then(t=>this._state="resolved",t=>this._state="rejected")}set state(t){this._state==="unresolved"&&(this._state=t)}get state(){return this._state}}return np.Deferred=e,np}var ip={},JI;function Se(){return JI||(JI=1,Object.defineProperty(ip,"__esModule",{value:!0}),ip.TYPES=void 0,ip.TYPES={Action:Symbol("Action"),IActionDispatcher:Symbol("IActionDispatcher"),IActionDispatcherProvider:Symbol("IActionDispatcherProvider"),IActionHandlerInitializer:Symbol("IActionHandlerInitializer"),ActionHandlerRegistration:Symbol("ActionHandlerRegistration"),ActionHandlerRegistryProvider:Symbol("ActionHandlerRegistryProvider"),IAnchorComputer:Symbol("IAnchor"),AnimationFrameSyncer:Symbol("AnimationFrameSyncer"),IButtonHandlerRegistration:Symbol("IButtonHandlerRegistration"),ICommandPaletteActionProvider:Symbol("ICommandPaletteActionProvider"),ICommandPaletteActionProviderRegistry:Symbol("ICommandPaletteActionProviderRegistry"),CommandRegistration:Symbol("CommandRegistration"),ICommandStack:Symbol("ICommandStack"),CommandStackOptions:Symbol("CommandStackOptions"),ICommandStackProvider:Symbol("ICommandStackProvider"),IContextMenuItemProvider:Symbol.for("IContextMenuProvider"),IContextMenuProviderRegistry:Symbol.for("IContextMenuProviderRegistry"),IContextMenuService:Symbol.for("IContextMenuService"),IContextMenuServiceProvider:Symbol.for("IContextMenuServiceProvider"),DOMHelper:Symbol("DOMHelper"),IDiagramLocker:Symbol("IDiagramLocker"),IEdgeRouter:Symbol("IEdgeRouter"),IEdgeRoutePostprocessor:Symbol("IEdgeRoutePostprocessor"),IEditLabelValidationDecorator:Symbol("IEditLabelValidationDecorator"),IEditLabelValidator:Symbol("IEditLabelValidator"),HiddenModelViewer:Symbol("HiddenModelViewer"),HiddenVNodePostprocessor:Symbol("HiddenVNodeDecorator"),HoverState:Symbol("HoverState"),KeyListener:Symbol("KeyListener"),LayoutRegistration:Symbol("LayoutRegistration"),LayoutRegistry:Symbol("LayoutRegistry"),Layouter:Symbol("Layouter"),LogLevel:Symbol("LogLevel"),ILogger:Symbol("ILogger"),IModelFactory:Symbol("IModelFactory"),IModelLayoutEngine:Symbol("IModelLayoutEngine"),ModelRendererFactory:Symbol("ModelRendererFactory"),ModelSource:Symbol("ModelSource"),ModelSourceProvider:Symbol("ModelSourceProvider"),ModelViewer:Symbol("ModelViewer"),MouseListener:Symbol("MouseListener"),PatcherProvider:Symbol("PatcherProvider"),IPopupModelProvider:Symbol("IPopupModelProvider"),PopupModelViewer:Symbol("PopupModelViewer"),PopupMouseListener:Symbol("PopupMouseListener"),PopupVNodePostprocessor:Symbol("PopupVNodeDecorator"),SModelElementRegistration:Symbol("SModelElementRegistration"),SModelRegistry:Symbol("SModelRegistry"),ISnapper:Symbol("ISnapper"),SvgExporter:Symbol("SvgExporter"),ISvgExportPostprocessor:Symbol("ISvgExportPostprocessor"),IUIExtension:Symbol("IUIExtension"),UIExtensionRegistry:Symbol("UIExtensionRegistry"),IVNodePostprocessor:Symbol("IVNodePostprocessor"),ViewRegistration:Symbol("ViewRegistration"),ViewRegistry:Symbol("ViewRegistry"),IViewer:Symbol("IViewer"),ViewerOptions:Symbol("ViewerOptions"),IViewerProvider:Symbol("IViewerProvider")}),ip}var On={},Jn={},XI;function Ga(){if(XI)return Jn;XI=1;var e=Jn&&Jn.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.MultiInstanceRegistry=Jn.InstanceRegistry=Jn.FactoryRegistry=Jn.ProviderRegistry=void 0;const n=G();let t=class{constructor(){this.elements=new Map}register(r,d){if(r===void 0)throw new Error("Key is undefined");if(this.hasKey(r))throw new Error("Key is already registered: "+r);this.elements.set(r,d)}deregister(r){if(r===void 0)throw new Error("Key is undefined");this.elements.delete(r)}hasKey(r){return this.elements.has(r)}get(r,d){const l=this.elements.get(r);return l?new l(d):this.missing(r,d)}missing(r,d){throw new Error("Unknown registry key: "+r)}};Jn.ProviderRegistry=t,Jn.ProviderRegistry=t=e([(0,n.injectable)()],t);let i=class{constructor(){this.elements=new Map}register(r,d){if(r===void 0)throw new Error("Key is undefined");if(this.hasKey(r))throw new Error(`Key is already registered: ${r}. Use \`overrideModelElement\` instead.`);this.elements.set(r,d)}override(r,d){if(r===void 0)throw new Error("Key is undefined");if(!this.hasKey(r))throw new Error(`Key is not registered: ${r}. Use \`configureModelElement\` instead.`);this.elements.set(r,d)}deregister(r){if(r===void 0)throw new Error("Key is undefined");this.elements.delete(r)}hasKey(r){return this.elements.has(r)}get(r,d){const l=this.elements.get(r);return l?l(d):this.missing(r,d)}missing(r,d){throw new Error("Unknown registry key: "+r)}};Jn.FactoryRegistry=i,Jn.FactoryRegistry=i=e([(0,n.injectable)()],i);let a=class{constructor(){this.elements=new Map}register(r,d){if(r===void 0)throw new Error("Key is undefined");if(this.hasKey(r))throw new Error(`Key is already registered: ${r}. Use \`overrideModelElement\` instead.`);this.elements.set(r,d)}override(r,d){if(r===void 0)throw new Error("Key is undefined");if(!this.hasKey(r))throw new Error(`Key is not registered: ${r}. Use \`configureModelElement\` instead.`);this.elements.set(r,d)}deregister(r){if(r===void 0)throw new Error("Key is undefined");this.elements.delete(r)}hasKey(r){return this.elements.has(r)}get(r){const d=this.elements.get(r);return d||this.missing(r)}missing(r){throw new Error("Unknown registry key: "+r)}};Jn.InstanceRegistry=a,Jn.InstanceRegistry=a=e([(0,n.injectable)()],a);let o=class{constructor(){this.elements=new Map}register(r,d){if(r===void 0)throw new Error("Key is undefined");const l=this.elements.get(r);l!==void 0?l.push(d):this.elements.set(r,[d])}deregisterAll(r){if(r===void 0)throw new Error("Key is undefined");this.elements.delete(r)}get(r){const d=this.elements.get(r);return d!==void 0?d:[]}};return Jn.MultiInstanceRegistry=o,Jn.MultiInstanceRegistry=o=e([(0,n.injectable)()],o),Jn}var Xn={},tn={},eT;function at(){if(eT)return tn;eT=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.almostEquals=tn.toRadians=tn.toDegrees=tn.Bounds=tn.isBounds=tn.Dimension=tn.centerOfLine=tn.angleBetweenPoints=tn.angleOfPoint=tn.Point=void 0;const e=$c();var n;(function(u){u.ORIGIN=Object.freeze({x:0,y:0});function f(L,I){return{x:L.x+I.x,y:L.y+I.y}}u.add=f;function h(L,I){return{x:L.x-I.x,y:L.y-I.y}}u.subtract=h;function p(L,I){return L.x===I.x&&L.y===I.y}u.equals=p;function g(L,I,R){const w=h(I,L),T=m(w),j={x:T.x*R,y:T.y*R};return f(L,j)}u.shiftTowards=g;function m(L){const I=v(L);return I===0||I===1?u.ORIGIN:{x:L.x/I,y:L.y/I}}u.normalize=m;function v(L){return Math.sqrt(Math.pow(L.x,2)+Math.pow(L.y,2))}u.magnitude=v;function _(L,I,R){return{x:(1-R)*L.x+R*I.x,y:(1-R)*L.y+R*I.y}}u.linear=_;function S(L,I){const R=I.x-L.x,w=I.y-L.y;return Math.sqrt(R*R+w*w)}u.euclideanDistance=S;function E(L,I){return Math.abs(I.x-L.x)+Math.abs(I.y-L.y)}u.manhattanDistance=E;function C(L,I){return Math.max(Math.abs(I.x-L.x),Math.abs(I.y-L.y))}u.maxDistance=C;function M(L,I){return L.x*I.x+L.y*I.y}u.dotProduct=M})(n||(tn.Point=n={}));function t(u){return Math.atan2(u.y,u.x)}tn.angleOfPoint=t;function i(u,f){const h=Math.sqrt((u.x*u.x+u.y*u.y)*(f.x*f.x+f.y*f.y));if(isNaN(h)||h===0)return NaN;const p=u.x*f.x+u.y*f.y;return Math.acos(p/h)}tn.angleBetweenPoints=i;function a(u,f){const h={x:u.x>f.x?f.x:u.x,y:u.y>f.y?f.y:u.y,width:Math.abs(f.x-u.x),height:Math.abs(f.y-u.y)};return r.center(h)}tn.centerOfLine=a;var o;(function(u){u.EMPTY=Object.freeze({width:-1,height:-1});function f(h){return h.width>=0&&h.height>=0}u.isValid=f})(o||(tn.Dimension=o={}));function s(u){return(0,e.hasOwnProperty)(u,["x","y","width","height"])}tn.isBounds=s;var r;(function(u){u.EMPTY=Object.freeze({x:0,y:0,width:-1,height:-1});function f(m,v){if(!o.isValid(m))return o.isValid(v)?v:u.EMPTY;if(!o.isValid(v))return m;const _=Math.min(m.x,v.x),S=Math.min(m.y,v.y),E=Math.max(m.x+(m.width>=0?m.width:0),v.x+(v.width>=0?v.width:0)),C=Math.max(m.y+(m.height>=0?m.height:0),v.y+(v.height>=0?v.height:0));return{x:_,y:S,width:E-_,height:C-S}}u.combine=f;function h(m,v){return{x:m.x+v.x,y:m.y+v.y,width:m.width,height:m.height}}u.translate=h;function p(m){return{x:m.x+(m.width>=0?.5*m.width:0),y:m.y+(m.height>=0?.5*m.height:0)}}u.center=p;function g(m,v){return v.x>=m.x&&v.x<=m.x+m.width&&v.y>=m.y&&v.y<=m.y+m.height}u.includes=g})(r||(tn.Bounds=r={}));function d(u){return u*180/Math.PI}tn.toDegrees=d;function l(u){return u*Math.PI/180}tn.toRadians=l;function c(u,f){return Math.abs(u-f)<.001}return tn.almostEquals=c,tn}var yb={},tT;function Wd(){return tT||(tT=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.mapIterable=e.filterIterable=e.DONE_RESULT=e.toArray=e.FluentIterableImpl=void 0;class n{constructor(d,l){this.startFn=d,this.nextFn=l}[Symbol.iterator](){const d={state:this.startFn(),next:()=>this.nextFn(d.state),[Symbol.iterator]:()=>d};return d}filter(d){return i(this,d)}map(d){return a(this,d)}forEach(d){const l=this[Symbol.iterator]();let c=0,u;do u=l.next(),u.value!==void 0&&d(u.value,c),c++;while(!u.done)}indexOf(d){const l=this[Symbol.iterator]();let c=0,u;do{if(u=l.next(),u.value===d)return c;c++}while(!u.done);return-1}}e.FluentIterableImpl=n;function t(r){if(r.constructor===Array)return r;const d=[];return r.forEach(l=>d.push(l)),d}e.toArray=t,e.DONE_RESULT=Object.freeze({done:!0,value:void 0});function i(r,d){return new n(()=>o(r),l=>{let c;do c=l.next();while(!c.done&&!d(c.value));return c})}e.filterIterable=i;function a(r,d){return new n(()=>o(r),l=>{const{done:c,value:u}=l.next();return c?e.DONE_RESULT:{done:!1,value:d(u)}})}e.mapIterable=a;function o(r){const d=r[Symbol.iterator];if(typeof d=="function")return d.call(r);const l=r.length;return typeof l=="number"&&l>=0?new s(r):{next:()=>e.DONE_RESULT}}class s{constructor(d){this.array=d,this.index=0}next(){return this.index<this.array.length?{done:!1,value:this.array[this.index++]}:e.DONE_RESULT}[Symbol.iterator](){return this}}}(yb)),yb}var nT;function ft(){if(nT)return Xn;nT=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.ModelIndexImpl=Xn.createRandomId=Xn.SModelRootImpl=Xn.SChildElementImpl=Xn.SParentElementImpl=Xn.isParent=Xn.SModelElementImpl=void 0;const e=at(),n=Wd();class t{get root(){let u=this;for(;u;){if(u instanceof s)return u;u instanceof o?u=u.parent:u=void 0}throw new Error("Element has no root")}get index(){return this.root.index}hasFeature(u){return this.features!==void 0&&this.features.has(u)}}Xn.SModelElementImpl=t;function i(c){const u=c.children;return u!==void 0&&u.constructor===Array}Xn.isParent=i;class a extends t{constructor(){super(...arguments),this.children=[]}add(u,f){const h=this.children;if(f===void 0)h.push(u);else{if(f<0||f>this.children.length)throw new Error(`Child index ${f} out of bounds (0..${h.length})`);h.splice(f,0,u)}u.parent=this,this.index.add(u)}remove(u){const f=this.children,h=f.indexOf(u);if(h<0)throw new Error(`No such child ${u.id}`);f.splice(h,1),this.index.remove(u)}removeAll(u){const f=this.children;if(u!==void 0){for(let h=f.length-1;h>=0;h--)if(u(f[h])){const p=f.splice(h,1)[0];this.index.remove(p)}}else f.forEach(h=>{this.index.remove(h)}),f.splice(0,f.length)}move(u,f){const h=this.children,p=h.indexOf(u);if(p===-1)throw new Error(`No such child ${u.id}`);if(f<0||f>h.length-1)throw new Error(`Child index ${f} out of bounds (0..${h.length})`);h.splice(p,1),h.splice(f,0,u)}localToParent(u){return(0,e.isBounds)(u)?u:{x:u.x,y:u.y,width:-1,height:-1}}parentToLocal(u){return(0,e.isBounds)(u)?u:{x:u.x,y:u.y,width:-1,height:-1}}}Xn.SParentElementImpl=a;class o extends a{}Xn.SChildElementImpl=o;class s extends a{constructor(u=new l){super(),this.canvasBounds=e.Bounds.EMPTY,Object.defineProperty(this,"index",{value:u,writable:!1})}}Xn.SModelRootImpl=s;const r="0123456789abcdefghijklmnopqrstuvwxyz";function d(c=8){let u="";for(let f=0;f<c;f++)u+=r.charAt(Math.floor(Math.random()*r.length));return u}Xn.createRandomId=d;class l{constructor(){this.id2element=new Map}add(u){if(u.id){if(this.contains(u))throw new Error("Duplicate ID in model: "+u.id)}else do u.id=d();while(this.contains(u));if(this.id2element.set(u.id,u),u instanceof a)for(const f of u.children)this.add(f)}remove(u){if(this.id2element.delete(u.id),u instanceof a)for(const f of u.children)this.remove(f)}contains(u){return this.id2element.has(u.id)}getById(u){return this.id2element.get(u)}getAttachedElements(u){return[]}all(){return(0,n.mapIterable)(this.id2element,([u,f])=>f)}}return Xn.ModelIndexImpl=l,Xn}var iT;function Yc(){if(iT)return On;iT=1;var e=On&&On.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=On&&On.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=On&&On.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(On,"__esModule",{value:!0}),On.createFeatureSet=On.EMPTY_ROOT=On.SModelFactory=On.SModelRegistry=void 0;const i=G(),a=Se(),o=Ga(),s=ft();let r=class extends o.FactoryRegistry{constructor(u){super(),u.forEach(f=>{let h=this.getDefaultFeatures(f.constr);if(!h&&f.features&&f.features.enable&&(h=[]),h){const p=l(h,f.features);f.isOverride?this.override(f.type,()=>{const g=new f.constr;return g.features=p,g}):this.register(f.type,()=>{const g=new f.constr;return g.features=p,g})}else f.isOverride?this.override(f.type,()=>new f.constr):this.register(f.type,()=>new f.constr)})}getDefaultFeatures(u){let f=u;do{const h=f.DEFAULT_FEATURES;if(h)return h;f=Object.getPrototypeOf(f)}while(f)}};On.SModelRegistry=r,On.SModelRegistry=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(a.TYPES.SModelElementRegistration)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],r);let d=class{createElement(u,f){let h;if(this.registry.hasKey(u.type)){const p=this.registry.get(u.type,void 0);if(!(p instanceof s.SChildElementImpl))throw new Error(`Element with type ${u.type} was expected to be an SChildElement.`);h=p}else h=new s.SChildElementImpl;return this.initializeChild(h,u,f)}createRoot(u){let f;if(this.registry.hasKey(u.type)){const h=this.registry.get(u.type,void 0);if(!(h instanceof s.SModelRootImpl))throw new Error(`Element with type ${u.type} was expected to be an SModelRoot.`);f=h}else f=new s.SModelRootImpl;return this.initializeRoot(f,u)}createSchema(u){const f={};for(const h in u)if(!this.isReserved(u,h)){const p=u[h];typeof p!="function"&&(f[h]=p)}return u instanceof s.SParentElementImpl&&(f.children=u.children.map(h=>this.createSchema(h))),f}initializeElement(u,f){for(const h in f)if(!this.isReserved(u,h)){const p=f[h];typeof p!="function"&&(u[h]=p)}return u}isReserved(u,f){if(["children","parent","index"].indexOf(f)>=0)return!0;let h=u;do{const p=Object.getOwnPropertyDescriptor(h,f);if(p!==void 0)return p.get!==void 0;h=Object.getPrototypeOf(h)}while(h);return!1}initializeParent(u,f){return this.initializeElement(u,f),(0,s.isParent)(f)&&(u.children=f.children.map(h=>this.createElement(h,u))),u}initializeChild(u,f,h){return this.initializeParent(u,f),h!==void 0&&(u.parent=h),u}initializeRoot(u,f){return this.initializeParent(u,f),u.index.add(u),u}};On.SModelFactory=d,e([(0,i.inject)(a.TYPES.SModelRegistry),n("design:type",r)],d.prototype,"registry",void 0),On.SModelFactory=d=e([(0,i.injectable)()],d),On.EMPTY_ROOT=Object.freeze({type:"NONE",id:"EMPTY"});function l(c,u){const f=new Set(c);if(u&&u.enable)for(const h of u.enable)f.add(h);if(u&&u.disable)for(const h of u.disable)f.delete(h);return f}return On.createFeatureSet=l,On}var du={},rT;function eh(){if(rT)return du;rT=1;var e=du&&du.__decorate||function(i,a,o,s){var r=arguments.length,d=r<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,o):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(i,a,o,s);else for(var c=i.length-1;c>=0;c--)(l=i[c])&&(d=(r<3?l(d):r>3?l(a,o,d):l(a,o))||d);return r>3&&d&&Object.defineProperty(a,o,d),d};Object.defineProperty(du,"__esModule",{value:!0}),du.AnimationFrameSyncer=void 0;const n=G();let t=class{constructor(){this.tasks=[],this.endTasks=[],this.triggered=!1}isAvailable(){return typeof requestAnimationFrame=="function"}onNextFrame(a){this.tasks.push(a),this.trigger()}onEndOfNextFrame(a){this.endTasks.push(a),this.trigger()}trigger(){this.triggered||(this.triggered=!0,this.isAvailable()?requestAnimationFrame(a=>this.run(a)):setTimeout(a=>this.run(a)))}run(a){const o=this.tasks,s=this.endTasks;this.triggered=!1,this.tasks=[],this.endTasks=[],o.forEach(r=>r.call(void 0,a)),s.forEach(r=>r.call(void 0,a))}};return du.AnimationFrameSyncer=t,du.AnimationFrameSyncer=t=e([(0,n.injectable)()],t),du}var oT;function Qy(){if(oT)return Gs;oT=1;var e=Gs&&Gs.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Gs&&Gs.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.ActionDispatcher=void 0;const t=G(),i=lt(),a=Zy(),o=Se(),s=Yc(),r=eh();(0,i.setRequestContext)("client");let d=class{constructor(){this.postponedActions=[],this.requests=new Map}initialize(){return this.initialized||(this.initialized=this.actionHandlerRegistryProvider().then(c=>{this.actionHandlerRegistry=c,this.handleAction(i.SetModelAction.create(s.EMPTY_ROOT)).catch(()=>{})})),this.initialized}dispatch(c){return this.initialize().then(()=>{if(this.blockUntil!==void 0)return this.handleBlocked(c,this.blockUntil);if(this.diagramLocker.isAllowed(c))return this.handleAction(c)})}dispatchAll(c){return Promise.all(c.map(u=>this.dispatch(u)))}request(c){if(!c.requestId)return Promise.reject(new Error("Request without requestId"));const u=new a.Deferred;return this.requests.set(c.requestId,u),this.dispatch(c).catch(()=>{}),u.promise}handleAction(c){if(c.kind===i.UndoAction.KIND)return this.commandStack.undo().then(()=>{});if(c.kind===i.RedoAction.KIND)return this.commandStack.redo().then(()=>{});if((0,i.isResponseAction)(c)){const h=this.requests.get(c.responseId);if(h!==void 0){if(this.requests.delete(c.responseId),c.kind===i.RejectAction.KIND){const p=c;h.reject(new Error(p.message)),this.logger.warn(this,`Request with id ${c.responseId} failed.`,p.message,p.detail)}else h.resolve(c);return Promise.resolve()}this.logger.log(this,"No matching request for response",c)}const u=this.actionHandlerRegistry.get(c.kind);if(u.length===0){this.logger.warn(this,"Missing handler for action",c);const h=new Error(`Missing handler for action '${c.kind}'`);if((0,i.isRequestAction)(c)){const p=this.requests.get(c.requestId);p!==void 0&&(this.requests.delete(c.requestId),p.reject(h))}return Promise.reject(h)}this.logger.log(this,"Handle",c);const f=[];for(const h of u){const p=h.handle(c);(0,i.isAction)(p)?f.push(this.dispatch(p)):p!==void 0&&(f.push(this.commandStack.execute(p)),this.blockUntil=p.blockUntil)}return Promise.all(f)}handleBlocked(c,u){if(u(c)){this.blockUntil=void 0;const f=this.handleAction(c),h=this.postponedActions;this.postponedActions=[];for(const p of h)this.dispatch(p.action).then(p.resolve,p.reject);return f}else return this.logger.log(this,"Action is postponed due to block condition",c),new Promise((f,h)=>{this.postponedActions.push({action:c,resolve:f,reject:h})})}};return Gs.ActionDispatcher=d,e([(0,t.inject)(o.TYPES.ActionHandlerRegistryProvider),n("design:type",Function)],d.prototype,"actionHandlerRegistryProvider",void 0),e([(0,t.inject)(o.TYPES.ICommandStack),n("design:type",Object)],d.prototype,"commandStack",void 0),e([(0,t.inject)(o.TYPES.ILogger),n("design:type",Object)],d.prototype,"logger",void 0),e([(0,t.inject)(o.TYPES.AnimationFrameSyncer),n("design:type",r.AnimationFrameSyncer)],d.prototype,"syncer",void 0),e([(0,t.inject)(o.TYPES.IDiagramLocker),n("design:type",Object)],d.prototype,"diagramLocker",void 0),Gs.ActionDispatcher=d=e([(0,t.injectable)()],d),Gs}var _i={},rp={},sT;function Zd(){if(sT)return rp;sT=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.isInjectable=void 0;function e(n){return Reflect.getMetadata("inversify:paramtypes",n)!==void 0}return rp.isInjectable=e,rp}var aT;function wm(){if(aT)return _i;aT=1;var e=_i&&_i.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=_i&&_i.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=_i&&_i.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(_i,"__esModule",{value:!0}),_i.onAction=_i.configureActionHandler=_i.ActionHandlerRegistry=void 0;const i=G(),a=Se(),o=Ga(),s=Zd();let r=class extends o.MultiInstanceRegistry{constructor(u,f){super(),u.forEach(h=>this.register(h.actionKind,h.factory())),f.forEach(h=>this.initializeActionHandler(h))}initializeActionHandler(u){u.initialize(this)}};_i.ActionHandlerRegistry=r,_i.ActionHandlerRegistry=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(a.TYPES.ActionHandlerRegistration)),t(0,(0,i.optional)()),t(1,(0,i.multiInject)(a.TYPES.IActionHandlerInitializer)),t(1,(0,i.optional)()),n("design:paramtypes",[Array,Array])],r);function d(c,u,f){if(typeof f=="function"){if(!(0,s.isInjectable)(f))throw new Error(`Action handlers should be @injectable: ${f.name}`);c.isBound(f)||c.bind(f).toSelf()}c.bind(a.TYPES.ActionHandlerRegistration).toDynamicValue(h=>({actionKind:u,factory:()=>h.container.get(f)}))}_i.configureActionHandler=d;function l(c,u,f){c.bind(a.TYPES.ActionHandlerRegistration).toConstantValue({actionKind:u,factory:()=>({handle:f})})}return _i.onAction=l,_i}var fu={},cT;function RC(){if(cT)return fu;cT=1;var e=fu&&fu.__decorate||function(i,a,o,s){var r=arguments.length,d=r<3?a:s===null?s=Object.getOwnPropertyDescriptor(a,o):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(i,a,o,s);else for(var c=i.length-1;c>=0;c--)(l=i[c])&&(d=(r<3?l(d):r>3?l(a,o,d):l(a,o))||d);return r>3&&d&&Object.defineProperty(a,o,d),d};Object.defineProperty(fu,"__esModule",{value:!0}),fu.DefaultDiagramLocker=void 0;const n=G();let t=class{isAllowed(a){return!0}};return fu.DefaultDiagramLocker=t,fu.DefaultDiagramLocker=t=e([(0,n.injectable)()],t),fu}var wl={},op={},uT;function MC(){if(uT)return op;uT=1,Object.defineProperty(op,"__esModule",{value:!0}),op.easeInOut=void 0;function e(n){return n<.5?n*n*2:1-(1-n)*(1-n)*2}return op.easeInOut=e,op}var lT;function Qd(){if(lT)return wl;lT=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.CompoundAnimation=wl.Animation=void 0;const e=MC();class n{constructor(a,o=e.easeInOut){this.context=a,this.ease=o,this.stopped=!1}start(){return this.stopped=!1,new Promise((a,o)=>{let s,r=0;const d=l=>{r++;let c;s===void 0?(s=l,c=0):c=l-s;const u=Math.min(1,c/this.context.duration),f=this.tween(this.ease(u),this.context);this.context.modelChanged.update(f),u===1?(this.context.logger.log(this,r*1e3/this.context.duration+" fps"),a(f)):this.stopped?(this.context.logger.log(this,"Animation stopped at "+u*100+"%"),a(f)):this.context.syncer.onNextFrame(d)};if(this.context.syncer.isAvailable())this.context.syncer.onNextFrame(d);else{const l=this.tween(1,this.context);a(l)}})}stop(){this.stopped=!0}}wl.Animation=n;class t extends n{constructor(a,o,s=[],r=e.easeInOut){super(o,r),this.model=a,this.context=o,this.components=s,this.ease=r}include(a){return this.components.push(a),this}tween(a,o){for(const s of this.components)s.tween(a,o);return this.model}}return wl.CompoundAnimation=t,wl}var Wt={},Il={},sp={},dT;function uz(){if(dT)return sp;dT=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.ServerActionHandlerRegistry=void 0;class e{constructor(){this.handlers=new Map}getHandler(t){return this.handlers.get(t)}onAction(t,i){this.handlers.has(t)?this.handlers.get(t).push(i):this.handlers.set(t,[i])}removeActionHandler(t,i){const a=this.handlers.get(t);if(a){const o=a.indexOf(i);o>=0&&a.splice(o,1)}}}return sp.ServerActionHandlerRegistry=e,sp}var ap={},Ti={},fT;function Jd(){if(fT)return Ti;fT=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.SModelIndex=Ti.findElement=Ti.getSubType=Ti.getBasicType=Ti.applyBounds=Ti.cloneModel=void 0;function e(s){return JSON.parse(JSON.stringify(s))}Ti.cloneModel=e;function n(s,r){const d=new o;d.add(s);for(const l of r.bounds){const c=d.getById(l.elementId);if(c){const u=c;l.newPosition&&(u.position={x:l.newPosition.x,y:l.newPosition.y}),l.newSize&&(u.size={width:l.newSize.width,height:l.newSize.height})}}if(r.alignments)for(const l of r.alignments){const c=d.getById(l.elementId);if(c){const u=c;u.alignment={x:l.newAlignment.x,y:l.newAlignment.y}}}}Ti.applyBounds=n;function t(s){if(!s.type)return"";const r=s.type.indexOf(":");return r>=0?s.type.substring(0,r):s.type}Ti.getBasicType=t;function i(s){if(!s.type)return"";const r=s.type.indexOf(":");return r>=0?s.type.substring(r+1):s.type}Ti.getSubType=i;function a(s,r){if(s.id===r)return s;if(s.children)for(const d of s.children){const l=a(d,r);if(l!==void 0)return l}}Ti.findElement=a;class o{constructor(){this.id2element=new Map,this.id2parent=new Map}add(r){if(r.id){if(this.contains(r))throw new Error("Duplicate ID in model: "+r.id)}else throw new Error("Model element has no ID.");if(this.id2element.set(r.id,r),Array.isArray(r.children))for(const d of r.children)this.add(d),this.id2parent.set(d.id,r);return this}remove(r){if(this.id2element.delete(r.id),Array.isArray(r.children))for(const d of r.children)this.id2parent.delete(d.id),this.remove(d);return this}contains(r){return this.id2element.has(r.id)}getById(r){return this.id2element.get(r)}getParent(r){return this.id2parent.get(r)}getRoot(r){let d=r;for(;d;){const l=this.id2parent.get(d.id);if(l===void 0)return d;d=l}throw new Error("Element has no root")}}return Ti.SModelIndex=o,Ti}var hT;function lz(){if(hT)return ap;hT=1,Object.defineProperty(ap,"__esModule",{value:!0}),ap.DiagramServer=void 0;const e=lt(),n=Zy(),t=Jd();class i{constructor(o,s){this.state={currentRoot:{type:"NONE",id:"ROOT"},revision:0},this.requests=new Map,this.dispatch=o,this.diagramGenerator=s.DiagramGenerator,this.layoutEngine=s.ModelLayoutEngine,this.actionHandlerRegistry=s.ServerActionHandlerRegistry}setModel(o){return o.revision=++this.state.revision,this.state.currentRoot=o,this.submitModel(o,!1)}updateModel(o){return o.revision=++this.state.revision,this.state.currentRoot=o,this.submitModel(o,!0)}get needsClientLayout(){return this.state.options&&this.state.options.needsClientLayout!==void 0?!!this.state.options.needsClientLayout:!0}get needsServerLayout(){return this.state.options&&this.state.options.needsServerLayout!==void 0?!!this.state.options.needsServerLayout:!1}accept(o){if((0,e.isResponseAction)(o)){const s=o.responseId,r=this.requests.get(s);if(r){if(this.requests.delete(s),o.kind===e.RejectAction.KIND){const d=o;r.reject(new Error(d.message)),console.warn(`Request with id ${o.responseId} failed: ${d.message}`,d.detail)}else r.resolve(o);return Promise.resolve()}console.info("No matching request for response:",o)}return this.handleAction(o)}request(o){o.requestId||(o.requestId="server_"+(0,e.generateRequestId)());const s=new n.Deferred;return this.requests.set(o.requestId,s),this.dispatch(o).catch(r=>{this.requests.delete(o.requestId),s.reject(r)}),s.promise}rejectRemoteRequest(o,s){o&&(0,e.isRequestAction)(o)&&this.dispatch({kind:e.RejectAction.KIND,responseId:o.requestId,message:s.message,detail:s.stack})}handleAction(o){var s,r;const d=(s=this.actionHandlerRegistry)===null||s===void 0?void 0:s.getHandler(o.kind);if(d&&d.length===1)return(r=d[0](o,this.state,this))!==null&&r!==void 0?r:Promise.resolve();if(d&&d.length>1)return Promise.all(d.map(l=>{var c;return(c=l(o,this.state,this))!==null&&c!==void 0?c:Promise.resolve()}));switch(o.kind){case e.RequestModelAction.KIND:return this.handleRequestModel(o);case e.ComputedBoundsAction.KIND:return this.handleComputedBounds(o);case e.LayoutAction.KIND:return this.handleLayout(o)}return console.warn(`Unhandled action from client: ${o.kind}`),Promise.resolve()}async handleRequestModel(o){var s;this.state.options=o.options;try{const r=await this.diagramGenerator.generate({options:(s=this.state.options)!==null&&s!==void 0?s:{},state:this.state});r.revision=++this.state.revision,this.state.currentRoot=r,await this.submitModel(this.state.currentRoot,!1,o)}catch(r){this.rejectRemoteRequest(o,r),console.error("Failed to generate diagram:",r)}}async submitModel(o,s,r){if(this.needsClientLayout)if(!this.needsServerLayout)this.dispatch({kind:e.RequestBoundsAction.KIND,newRoot:o});else{const d=e.RequestBoundsAction.create(o),l=await this.request(d),c=this.state.currentRoot;l.revision===c.revision?((0,t.applyBounds)(c,l),await this.doSubmitModel(c,s,r)):this.rejectRemoteRequest(r,new Error(`Model revision does not match: ${l.revision}`))}else await this.doSubmitModel(o,s,r)}async doSubmitModel(o,s,r){if(o.revision!==this.state.revision)return;this.needsServerLayout&&this.layoutEngine&&(o=await this.layoutEngine.layout(o));const d=o.type;if(r&&r.kind===e.RequestModelAction.KIND){const l=r.requestId,c=e.SetModelAction.create(o,l);await this.dispatch(c)}else s&&d===this.state.lastSubmittedModelType?await this.dispatch({kind:e.UpdateModelAction.KIND,newRoot:o,cause:r}):await this.dispatch({kind:e.SetModelAction.KIND,newRoot:o});this.state.lastSubmittedModelType=d}handleComputedBounds(o){return o.revision!==this.state.currentRoot.revision?Promise.reject():((0,t.applyBounds)(this.state.currentRoot,o),Promise.resolve())}async handleLayout(o){if(this.layoutEngine){if(!this.needsServerLayout){let s=(0,t.cloneModel)(this.state.currentRoot);s=await this.layoutEngine.layout(s),s.revision=++this.state.revision,this.state.currentRoot=s}await this.doSubmitModel(this.state.currentRoot,!0,o)}}}return ap.DiagramServer=i,ap}var _b={},pT;function dz(){return pT||(pT=1,Object.defineProperty(_b,"__esModule",{value:!0})),_b}var Tl={},gT;function d7(){if(gT)return Tl;gT=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.isZoomable=Tl.isScrollable=void 0;const e=$c();function n(i){return(0,e.hasOwnProperty)(i,"scroll")}Tl.isScrollable=n;function t(i){return(0,e.hasOwnProperty)(i,"zoom")}return Tl.isZoomable=t,Tl}var bb={},mT;function f7(){return mT||(mT=1,Object.defineProperty(bb,"__esModule",{value:!0})),bb}var vT;function Yr(){return vT||(vT=1,function(e){var n=Il&&Il.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=Il&&Il.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(uz(),e),t(lt(),e),t(lz(),e),t(dz(),e),t(d7(),e),t(Zy(),e),t(at(),e),t(f7(),e),t(Jd(),e),t($c(),e)}(Il)),Il}var yT;function sn(){if(yT)return Wt;yT=1;var e=Wt&&Wt.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g};Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ResetCommand=Wt.SystemCommand=Wt.PopupCommand=Wt.HiddenCommand=Wt.MergeableCommand=Wt.Command=Wt.isStoppableCommand=void 0,bC();const n=G(),t=Yr();function i(c){return c&&(0,t.hasOwnProperty)(c,"stoppableCommandKey")&&"stopExecution"in c&&typeof c.stopExecution=="function"}Wt.isStoppableCommand=i;let a=class{};Wt.Command=a,Wt.Command=a=e([(0,n.injectable)()],a);let o=class extends a{merge(u,f){return!1}};Wt.MergeableCommand=o,Wt.MergeableCommand=o=e([(0,n.injectable)()],o);let s=class extends a{undo(u){return u.logger.error(this,"Cannot undo a hidden command"),u.root}redo(u){return u.logger.error(this,"Cannot redo a hidden command"),u.root}};Wt.HiddenCommand=s,Wt.HiddenCommand=s=e([(0,n.injectable)()],s);let r=class extends a{};Wt.PopupCommand=r,Wt.PopupCommand=r=e([(0,n.injectable)()],r);let d=class extends a{};Wt.SystemCommand=d,Wt.SystemCommand=d=e([(0,n.injectable)()],d);let l=class extends a{};return Wt.ResetCommand=l,Wt.ResetCommand=l=e([(0,n.injectable)()],l),Wt}var bi={},_T;function br(){if(_T)return bi;_T=1;var e=bi&&bi.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=bi&&bi.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=bi&&bi.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(bi,"__esModule",{value:!0}),bi.configureCommand=bi.CommandActionHandlerInitializer=bi.CommandActionHandler=void 0;const i=G(),a=Zd(),o=Se();class s{constructor(c){this.commandRegistration=c}handle(c){return this.commandRegistration.factory(c)}}bi.CommandActionHandler=s;let r=class{constructor(c){this.registrations=c}initialize(c){this.registrations.forEach(u=>c.register(u.kind,new s(u)))}};bi.CommandActionHandlerInitializer=r,bi.CommandActionHandlerInitializer=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(o.TYPES.CommandRegistration)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],r);function d(l,c){if(!(0,a.isInjectable)(c))throw new Error(`Commands should be @injectable: ${c.name}`);l.isBound(c)||l.bind(c).toSelf(),l.bind(o.TYPES.CommandRegistration).toDynamicValue(u=>({kind:c.KIND,factory:f=>{const h=new i.Container;return h.parent=u.container,h.bind(o.TYPES.Action).toConstantValue(f),h.get(c)}}))}return bi.configureCommand=d,bi}var Sb={},bT;function AC(){return bT||(bT=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.overrideCommandStackOptions=e.configureCommandStackOptions=e.defaultCommandStackOptions=void 0;const n=$c(),t=Se(),i=()=>({defaultDuration:250,undoHistoryLimit:50});e.defaultCommandStackOptions=i;function a(s,r){const d=Object.assign(Object.assign({},(0,e.defaultCommandStackOptions)()),r);s.isBound(t.TYPES.CommandStackOptions)?s.rebind(t.TYPES.CommandStackOptions).toConstantValue(d):s.bind(t.TYPES.CommandStackOptions).toConstantValue(d)}e.configureCommandStackOptions=a;function o(s,r){const d=s.get(t.TYPES.CommandStackOptions);return(0,n.safeAssign)(d,r),d}e.overrideCommandStackOptions=o}(Sb)),Sb}var zs={},ST;function wC(){if(ST)return zs;ST=1;var e=zs&&zs.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=zs&&zs.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)};Object.defineProperty(zs,"__esModule",{value:!0}),zs.CommandStack=void 0;const t=G(),i=Se(),a=Yc(),o=ft(),s=eh(),r=sn();let d=class{constructor(){this.undoStack=[],this.redoStack=[],this.stoppableCommands=new Map,this.offStack=[]}initialize(){this.currentPromise=Promise.resolve({main:{model:this.modelFactory.createRoot(a.EMPTY_ROOT),modelChanged:!1},hidden:{model:this.modelFactory.createRoot(a.EMPTY_ROOT),modelChanged:!1},popup:{model:this.modelFactory.createRoot(a.EMPTY_ROOT),modelChanged:!1}})}get currentModel(){return this.currentPromise.then(u=>u.main.model)}executeAll(u){return u.forEach(f=>{this.logger.log(this,"Executing",f),this.handleCommand(f,f.execute,this.mergeOrPush)}),this.thenUpdate()}execute(u){return this.logger.log(this,"Executing",u),this.handleCommand(u,u.execute,this.mergeOrPush),this.thenUpdate()}undo(){this.undoOffStackSystemCommands(),this.undoPreceedingSystemCommands();const u=this.undoStack[this.undoStack.length-1];return u!==void 0&&!this.isBlockUndo(u)&&(this.undoStack.pop(),this.logger.log(this,"Undoing",u),this.handleCommand(u,u.undo,(f,h)=>{this.redoStack.push(f)})),this.thenUpdate()}redo(){this.undoOffStackSystemCommands();const u=this.redoStack.pop();return u!==void 0&&(this.logger.log(this,"Redoing",u),this.handleCommand(u,u.redo,(f,h)=>{this.pushToUndoStack(f)})),this.redoFollowingSystemCommands(),this.thenUpdate()}handleCommand(u,f,h){if((0,r.isStoppableCommand)(u)){const p=this.stoppableCommands.get(u.stoppableCommandKey);p&&p.stopExecution(),this.stoppableCommands.set(u.stoppableCommandKey,u)}this.currentPromise=this.currentPromise.then(p=>new Promise(g=>{let m;u instanceof r.HiddenCommand?m="hidden":u instanceof r.PopupCommand?m="popup":m="main";const v=this.createContext(p.main.model);let _;try{_=f.call(u,v)}catch(E){this.logger.error(this,"Failed to execute command:",E),_=p[m].model}const S=l(p);_ instanceof Promise?_.then(E=>{m==="main"&&h.call(this,u,v),S[m]={model:E,modelChanged:!0},g(S)}):_ instanceof o.SModelRootImpl?(m==="main"&&h.call(this,u,v),S[m]={model:_,modelChanged:!0},g(S)):(m==="main"&&h.call(this,u,v),S[m]={model:_.model,modelChanged:p[m].modelChanged||_.modelChanged,cause:_.cause},g(S))}))}pushToUndoStack(u){this.undoStack.push(u),this.options.undoHistoryLimit>=0&&this.undoStack.length>this.options.undoHistoryLimit&&this.undoStack.splice(0,this.undoStack.length-this.options.undoHistoryLimit)}thenUpdate(){return this.currentPromise=this.currentPromise.then(u=>{const f=l(u);return u.hidden.modelChanged&&(this.updateHidden(u.hidden.model,u.hidden.cause),f.hidden.modelChanged=!1,f.hidden.cause=void 0),u.main.modelChanged&&(this.update(u.main.model,u.main.cause),f.main.modelChanged=!1,f.main.cause=void 0),u.popup.modelChanged&&(this.updatePopup(u.popup.model,u.popup.cause),f.popup.modelChanged=!1,f.popup.cause=void 0),f}),this.currentModel}update(u,f){this.modelViewer===void 0&&(this.modelViewer=this.viewerProvider.modelViewer),this.modelViewer.update(u,f)}updateHidden(u,f){this.hiddenModelViewer===void 0&&(this.hiddenModelViewer=this.viewerProvider.hiddenModelViewer),this.hiddenModelViewer.update(u,f)}updatePopup(u,f){this.popupModelViewer===void 0&&(this.popupModelViewer=this.viewerProvider.popupModelViewer),this.popupModelViewer.update(u,f)}mergeOrPush(u,f){if(this.isBlockUndo(u)){this.undoStack=[],this.redoStack=[],this.offStack=[],this.pushToUndoStack(u);return}if(this.isPushToOffStack(u)&&this.redoStack.length>0){if(this.offStack.length>0){const h=this.offStack[this.offStack.length-1];if(h instanceof r.MergeableCommand&&h.merge(u,f))return}this.offStack.push(u);return}if(this.isPushToUndoStack(u)){if(this.offStack.forEach(h=>this.undoStack.push(h)),this.offStack=[],this.redoStack=[],this.undoStack.length>0){const h=this.undoStack[this.undoStack.length-1];if(h instanceof r.MergeableCommand&&h.merge(u,f))return}this.pushToUndoStack(u)}}undoOffStackSystemCommands(){let u=this.offStack.pop();for(;u!==void 0;)this.logger.log(this,"Undoing off-stack",u),this.handleCommand(u,u.undo,()=>{}),u=this.offStack.pop()}undoPreceedingSystemCommands(){let u=this.undoStack[this.undoStack.length-1];for(;u!==void 0&&this.isPushToOffStack(u);)this.undoStack.pop(),this.logger.log(this,"Undoing",u),this.handleCommand(u,u.undo,(f,h)=>{this.redoStack.push(f)}),u=this.undoStack[this.undoStack.length-1]}redoFollowingSystemCommands(){let u=this.redoStack[this.redoStack.length-1];for(;u!==void 0&&this.isPushToOffStack(u);)this.redoStack.pop(),this.logger.log(this,"Redoing ",u),this.handleCommand(u,u.redo,(f,h)=>{this.pushToUndoStack(f)}),u=this.redoStack[this.redoStack.length-1]}createContext(u){return{root:u,modelChanged:this,modelFactory:this.modelFactory,duration:this.options.defaultDuration,logger:this.logger,syncer:this.syncer}}isPushToOffStack(u){return u instanceof r.SystemCommand}isPushToUndoStack(u){return!(u instanceof r.HiddenCommand)}isBlockUndo(u){return u instanceof r.ResetCommand}};zs.CommandStack=d,e([(0,t.inject)(i.TYPES.IModelFactory),n("design:type",Object)],d.prototype,"modelFactory",void 0),e([(0,t.inject)(i.TYPES.IViewerProvider),n("design:type",Object)],d.prototype,"viewerProvider",void 0),e([(0,t.inject)(i.TYPES.ILogger),n("design:type",Object)],d.prototype,"logger",void 0),e([(0,t.inject)(i.TYPES.AnimationFrameSyncer),n("design:type",s.AnimationFrameSyncer)],d.prototype,"syncer",void 0),e([(0,t.inject)(i.TYPES.CommandStackOptions),n("design:type",Object)],d.prototype,"options",void 0),e([(0,t.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],d.prototype,"initialize",null),zs.CommandStack=d=e([(0,t.injectable)()],d);function l(c){return{main:Object.assign({},c.main),hidden:Object.assign({},c.hidden),popup:Object.assign({},c.popup)}}return zs}var ei={},Di={},ET;function Ts(){if(ET)return Di;ET=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.isSVGGraphicsElement=Di.hitsMouseEvent=Di.getWindowScroll=Di.isCrossSite=Di.isMac=Di.isCtrlOrCmd=void 0;const e=Yr();function n(r){return t()?r.metaKey:r.ctrlKey}Di.isCtrlOrCmd=n;function t(){return window.navigator.userAgent.indexOf("Mac")!==-1}Di.isMac=t;function i(r){if(r&&typeof window<"u"&&window.location){let d="";return window.location.protocol&&(d+=window.location.protocol+"//"),window.location.host&&(d+=window.location.host),d.length>0&&!r.startsWith(d)}return!1}Di.isCrossSite=i;function a(){return typeof window>"u"?e.Point.ORIGIN:{x:window.pageXOffset,y:window.pageYOffset}}Di.getWindowScroll=a;function o(r,d){const l=r.getBoundingClientRect();return d.clientX>=l.left&&d.clientX<=l.right&&d.clientY>=l.top&&d.clientY<=l.bottom}Di.hitsMouseEvent=o;function s(r){return typeof r.getBBox=="function"}return Di.isSVGGraphicsElement=s,Di}var CT;function Im(){if(CT)return ei;CT=1;var e=ei&&ei.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=ei&&ei.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)},t=ei&&ei.__param||function(f,h){return function(p,g){h(p,g,f)}};Object.defineProperty(ei,"__esModule",{value:!0}),ei.InitializeCanvasBoundsCommand=ei.InitializeCanvasBoundsAction=ei.CanvasBoundsInitializer=void 0;const i=G(),a=at(),o=Se(),s=ft(),r=sn(),d=Ts();let l=class{decorate(h,p){return p instanceof s.SModelRootImpl&&!a.Dimension.isValid(p.canvasBounds)&&(this.rootAndVnode=[p,h]),h}postUpdate(){if(this.rootAndVnode!==void 0){const h=this.rootAndVnode[1].elm,p=this.rootAndVnode[0].canvasBounds;if(h!==void 0){const g=this.getBoundsInPage(h);(0,a.almostEquals)(g.x,p.x)&&(0,a.almostEquals)(g.y,p.y)&&(0,a.almostEquals)(g.width,p.width)&&(0,a.almostEquals)(g.height,p.width)||this.actionDispatcher.dispatch(c.create(g))}this.rootAndVnode=void 0}}getBoundsInPage(h){const p=h.getBoundingClientRect(),g=(0,d.getWindowScroll)();return{x:p.left+g.x,y:p.top+g.y,width:p.width,height:p.height}}};ei.CanvasBoundsInitializer=l,e([(0,i.inject)(o.TYPES.IActionDispatcher),n("design:type",Object)],l.prototype,"actionDispatcher",void 0),ei.CanvasBoundsInitializer=l=e([(0,i.injectable)()],l);var c;(function(f){f.KIND="initializeCanvasBounds";function h(p){return{kind:f.KIND,newCanvasBounds:p}}f.create=h})(c||(ei.InitializeCanvasBoundsAction=c={}));let u=class extends r.SystemCommand{constructor(h){super(),this.action=h}execute(h){return this.newCanvasBounds=this.action.newCanvasBounds,h.root.canvasBounds=this.newCanvasBounds,h.root}undo(h){return h.root}redo(h){return h.root}};return ei.InitializeCanvasBoundsCommand=u,u.KIND=c.KIND,ei.InitializeCanvasBoundsCommand=u=e([(0,i.injectable)(),t(0,(0,i.inject)(o.TYPES.Action)),n("design:paramtypes",[Object])],u),ei}var co={},PT;function Jy(){if(PT)return co;PT=1;var e=co&&co.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=co&&co.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=co&&co.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(co,"__esModule",{value:!0}),co.SetModelCommand=void 0;const i=G(),a=lt(),o=sn(),s=Se(),r=Im();let d=class extends o.ResetCommand{constructor(c){super(),this.action=c}execute(c){return this.oldRoot=c.modelFactory.createRoot(c.root),this.newRoot=c.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(c){return this.oldRoot}redo(c){return this.newRoot}get blockUntil(){return c=>c.kind===r.InitializeCanvasBoundsCommand.KIND}};return co.SetModelCommand=d,d.KIND=a.SetModelAction.KIND,co.SetModelCommand=d=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],d),co}var ti={},RT;function gi(){if(RT)return ti;RT=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.transformToRootBounds=ti.containsSome=ti.translateBounds=ti.translatePoint=ti.findParentByFeature=ti.findParent=ti.registerModelElement=void 0;const e=Se(),n=ft();function t(l,c,u,f,h){l.bind(e.TYPES.SModelElementRegistration).toConstantValue({type:c,constr:u,features:f,isOverride:h})}ti.registerModelElement=t;function i(l,c){let u=l;for(;u!==void 0;){if(c(u))return u;u instanceof n.SChildElementImpl?u=u.parent:u=void 0}return u}ti.findParent=i;function a(l,c){let u=l;for(;u!==void 0;){if(c(u))return u;u instanceof n.SChildElementImpl?u=u.parent:u=void 0}return u}ti.findParentByFeature=a;function o(l,c,u){if(c!==u){for(;c instanceof n.SChildElementImpl;)if(l=c.localToParent(l),c=c.parent,c===u)return l;const f=[];for(;u instanceof n.SChildElementImpl;)f.push(u),u=u.parent;if(c!==u)throw new Error("Incompatible source and target: "+c.id+", "+u.id);for(let h=f.length-1;h>=0;h--)l=f[h].parentToLocal(l)}return l}ti.translatePoint=o;function s(l,c,u){const f=o(l,c,u),h=o({x:l.x+l.width,y:l.y+l.height},c,u);return{x:f.x,y:f.y,width:h.x-f.x,height:h.y-f.y}}ti.translateBounds=s;function r(l,c){const u=h=>l.index.getById(h.id)!==void 0,f=h=>h.some(p=>u(p)||f(p.children));return f([c])}ti.containsSome=r;function d(l,c){for(;l instanceof n.SChildElementImpl;)c=l.localToParent(c),l=l.parent;return c}return ti.transformToRootBounds=d,ti}var ni={},MT;function Tm(){if(MT)return ni;MT=1;var e=ni&&ni.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=ni&&ni.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=ni&&ni.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(ni,"__esModule",{value:!0}),ni.SetUIExtensionVisibilityCommand=ni.SetUIExtensionVisibilityAction=ni.UIExtensionRegistry=void 0;const i=G(),a=Ga(),o=sn(),s=Se();let r=class extends a.InstanceRegistry{constructor(u=[]){super(),u.forEach(f=>this.register(f.id(),f))}};ni.UIExtensionRegistry=r,ni.UIExtensionRegistry=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(s.TYPES.IUIExtension)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],r);var d;(function(c){c.KIND="setUIExtensionVisibility";function u(f){var h;return{kind:c.KIND,extensionId:f.extensionId,visible:f.visible,contextElementsId:(h=f.contextElementsId)!==null&&h!==void 0?h:[]}}c.create=u})(d||(ni.SetUIExtensionVisibilityAction=d={}));let l=class extends o.SystemCommand{constructor(u){super(),this.action=u}execute(u){const f=this.registry.get(this.action.extensionId);return f&&(this.action.visible?f.show(u.root,...this.action.contextElementsId):f.hide()),{model:u.root,modelChanged:!1}}undo(u){return{model:u.root,modelChanged:!1}}redo(u){return{model:u.root,modelChanged:!1}}};return ni.SetUIExtensionVisibilityCommand=l,l.KIND=d.KIND,e([(0,i.inject)(s.TYPES.UIExtensionRegistry),n("design:type",r)],l.prototype,"registry",void 0),ni.SetUIExtensionVisibilityCommand=l=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],l),ni}var uo={},AT;function Xy(){if(AT)return uo;AT=1;var e=uo&&uo.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=uo&&uo.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(uo,"__esModule",{value:!0}),uo.AbstractUIExtension=uo.isUIExtension=void 0;const t=G(),i=Yr(),a=Se();function o(r){return(0,i.hasOwnProperty)(r,"id","function")&&(0,i.hasOwnProperty)(r,"show","function")&&(0,i.hasOwnProperty)(r,"hide","function")}uo.isUIExtension=o;let s=class{show(d,...l){this.activeElement=document.activeElement,!(!this.containerElement&&!this.initialize())&&(this.onBeforeShow(this.containerElement,d,...l),this.setContainerVisible(!0))}hide(){this.setContainerVisible(!1),this.restoreFocus(),this.activeElement=null}restoreFocus(){const d=this.activeElement;d&&d.focus()}initialize(){const d=document.getElementById(this.options.baseDiv);return d?(this.containerElement=this.getOrCreateContainer(d.id),this.initializeContents(this.containerElement),d&&d.insertBefore(this.containerElement,d.firstChild),!0):(this.logger.warn(this,`Could not obtain sprotty base container for initializing UI extension ${this.id}`,this),!1)}getOrCreateContainer(d){let l=document.getElementById(this.id());return l===null&&(l=document.createElement("div"),l.id=d+"_"+this.id(),l.classList.add(this.containerClass())),l}setContainerVisible(d){this.containerElement&&(d?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="1"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}onBeforeShow(d,l,...c){}};return uo.AbstractUIExtension=s,e([(0,t.inject)(a.TYPES.ViewerOptions),n("design:type",Object)],s.prototype,"options",void 0),e([(0,t.inject)(a.TYPES.ILogger),n("design:type",Object)],s.prototype,"logger",void 0),uo.AbstractUIExtension=s=e([(0,t.injectable)()],s),uo}var Oi={},Ln={},wT;function zn(){if(wT)return Ln;wT=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.getAttrs=Ln.on=Ln.mergeStyle=Ln.copyClassesFromElement=Ln.copyClassesFromVNode=Ln.setNamespace=Ln.setClass=Ln.setAttr=void 0;function e(u,f,h){r(u)[f]=h}Ln.setAttr=e;function n(u,f,h){l(u)[f]=h}Ln.setClass=n;function t(u,f){u.data===void 0&&(u.data={}),u.data.ns=f;const h=u.children;if(h!==void 0)for(let p=0;p<h.length;p++){const g=h[p];typeof g!="string"&&t(g,f)}}Ln.setNamespace=t;function i(u,f){const h=l(u);Object.keys(h).forEach(p=>n(f,p,!0))}Ln.copyClassesFromVNode=i;function a(u,f){const h=u.classList;for(let p=0;p<h.length;p++){const g=h.item(p);g&&n(f,g,!0)}}Ln.copyClassesFromElement=a;function o(u,f){d(u).style=Object.assign(Object.assign({},d(u).style||{}),f)}Ln.mergeStyle=o;function s(u,f,h){const p=c(u);if(p[f])throw new Error("EventListener for "+f+" already registered on VNode");p[f]=h}Ln.on=s;function r(u){const f=d(u);return f.attrs||(f.attrs={}),f.attrs}Ln.getAttrs=r;function d(u){return u.data||(u.data={}),u.data}function l(u){const f=d(u);return f.class||(f.class={}),f.class}function c(u){const f=d(u);return f.on||(f.on={}),f.on}return Ln}var IT;function za(){if(IT)return Oi;IT=1;var e=Oi&&Oi.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Oi&&Oi.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=Oi&&Oi.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.KeyListener=Oi.KeyTool=void 0;const i=G(),a=Se(),o=ft(),s=zn();let r=class{constructor(c=[]){this.keyListeners=c}register(c){this.keyListeners.push(c)}deregister(c){const u=this.keyListeners.indexOf(c);u>=0&&this.keyListeners.splice(u,1)}handleEvent(c,u,f){const h=this.keyListeners.map(p=>p[c].apply(p,[u,f])).reduce((p,g)=>p.concat(g));h.length>0&&(f.preventDefault(),this.actionDispatcher.dispatchAll(h))}keyDown(c,u){this.handleEvent("keyDown",c,u)}keyUp(c,u){this.handleEvent("keyUp",c,u)}focus(){}decorate(c,u){return u instanceof o.SModelRootImpl&&((0,s.on)(c,"focus",this.focus.bind(this,u)),(0,s.on)(c,"keydown",this.keyDown.bind(this,u)),(0,s.on)(c,"keyup",this.keyUp.bind(this,u))),c}postUpdate(){}};Oi.KeyTool=r,e([(0,i.inject)(a.TYPES.IActionDispatcher),n("design:type",Object)],r.prototype,"actionDispatcher",void 0),Oi.KeyTool=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(a.TYPES.KeyListener)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],r);let d=class{keyDown(c,u){return[]}keyUp(c,u){return[]}};return Oi.KeyListener=d,Oi.KeyListener=d=e([(0,i.injectable)()],d),Oi}var yn={},Us={},TT;function th(){if(TT)return Us;TT=1;var e=Us&&Us.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n=Us&&Us.__metadata||function(o,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,s)};Object.defineProperty(Us,"__esModule",{value:!0}),Us.DOMHelper=void 0;const t=G(),i=Se();let a=class{getPrefix(){return this.viewerOptions!==void 0&&this.viewerOptions.baseDiv!==void 0?this.viewerOptions.baseDiv+"_":""}createUniqueDOMElementId(s){return this.getPrefix()+s.id}findSModelIdByDOMElement(s){return s.id.replace(this.getPrefix(),"")}};return Us.DOMHelper=a,e([(0,t.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],a.prototype,"viewerOptions",void 0),Us.DOMHelper=a=e([(0,t.injectable)()],a),Us}var DT;function Wr(){if(DT)return yn;DT=1;var e=yn&&yn.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=yn&&yn.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)},t=yn&&yn.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(yn,"__esModule",{value:!0}),yn.MousePositionTracker=yn.MouseListener=yn.PopupMouseTool=yn.MouseTool=void 0;const i=G(),a=lt(),o=ft(),s=Se(),r=th(),d=zn();let l=class{constructor(p=[]){this.mouseListeners=p}register(p){this.mouseListeners.push(p)}deregister(p){const g=this.mouseListeners.indexOf(p);g>=0&&this.mouseListeners.splice(g,1)}getTargetElement(p,g){let m=g.target;const v=p.index;for(;m;){if(m.id){const _=v.getById(this.domHelper.findSModelIdByDOMElement(m));if(_!==void 0)return _}m=m.parentNode}}handleEvent(p,g,m){this.focusOnMouseEvent(p,g);const v=this.getTargetElement(g,m);if(!v)return;const _=this.mouseListeners.map(S=>S[p](v,m)).reduce((S,E)=>S.concat(E));if(_.length>0){m.preventDefault();for(const S of _)(0,a.isAction)(S)?this.actionDispatcher.dispatch(S):S.then(E=>{this.actionDispatcher.dispatch(E)})}}focusOnMouseEvent(p,g){if(document&&p==="mouseDown"){const m=document.getElementById(this.domHelper.createUniqueDOMElementId(g));m!==null&&typeof m.focus=="function"&&m.focus()}}mouseOver(p,g){this.handleEvent("mouseOver",p,g)}mouseOut(p,g){this.handleEvent("mouseOut",p,g)}mouseEnter(p,g){this.handleEvent("mouseEnter",p,g)}mouseLeave(p,g){this.handleEvent("mouseLeave",p,g)}mouseDown(p,g){this.handleEvent("mouseDown",p,g)}mouseMove(p,g){this.handleEvent("mouseMove",p,g)}mouseUp(p,g){this.handleEvent("mouseUp",p,g)}wheel(p,g){this.handleEvent("wheel",p,g)}contextMenu(p,g){g.preventDefault(),this.handleEvent("contextMenu",p,g)}doubleClick(p,g){this.handleEvent("doubleClick",p,g)}decorate(p,g){return g instanceof o.SModelRootImpl&&((0,d.on)(p,"mouseover",this.mouseOver.bind(this,g)),(0,d.on)(p,"mouseout",this.mouseOut.bind(this,g)),(0,d.on)(p,"mouseenter",this.mouseEnter.bind(this,g)),(0,d.on)(p,"mouseleave",this.mouseLeave.bind(this,g)),(0,d.on)(p,"mousedown",this.mouseDown.bind(this,g)),(0,d.on)(p,"mouseup",this.mouseUp.bind(this,g)),(0,d.on)(p,"mousemove",this.mouseMove.bind(this,g)),(0,d.on)(p,"wheel",this.wheel.bind(this,g)),(0,d.on)(p,"contextmenu",this.contextMenu.bind(this,g)),(0,d.on)(p,"dblclick",this.doubleClick.bind(this,g)),(0,d.on)(p,"dragover",m=>this.handleEvent("dragOver",g,m)),(0,d.on)(p,"drop",m=>this.handleEvent("drop",g,m))),p=this.mouseListeners.reduce((m,v)=>v.decorate(m,g),p),p}postUpdate(){}};yn.MouseTool=l,e([(0,i.inject)(s.TYPES.IActionDispatcher),n("design:type",Object)],l.prototype,"actionDispatcher",void 0),e([(0,i.inject)(s.TYPES.DOMHelper),n("design:type",r.DOMHelper)],l.prototype,"domHelper",void 0),yn.MouseTool=l=e([(0,i.injectable)(),t(0,(0,i.multiInject)(s.TYPES.MouseListener)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],l);let c=class extends l{constructor(p=[]){super(p),this.mouseListeners=p}};yn.PopupMouseTool=c,yn.PopupMouseTool=c=e([(0,i.injectable)(),t(0,(0,i.multiInject)(s.TYPES.PopupMouseListener)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],c);let u=class{mouseOver(p,g){return[]}mouseOut(p,g){return[]}mouseEnter(p,g){return[]}mouseLeave(p,g){return[]}mouseDown(p,g){return[]}mouseMove(p,g){return[]}mouseUp(p,g){return[]}wheel(p,g){return[]}doubleClick(p,g){return[]}contextMenu(p,g){return[]}dragOver(p,g){return[]}drop(p,g){return[]}decorate(p,g){return p}};yn.MouseListener=u,yn.MouseListener=u=e([(0,i.injectable)()],u);let f=class extends u{mouseMove(p,g){return this.lastPosition=p.root.parentToLocal({x:g.offsetX,y:g.offsetY}),[]}get lastPositionOnDiagram(){return this.lastPosition}};return yn.MousePositionTracker=f,yn.MousePositionTracker=f=e([(0,i.injectable)()],f),yn}var $s={};function fz(e,n){return document.createElement(e,n)}function hz(e,n,t){return document.createElementNS(e,n,t)}function pz(){return Nd(document.createDocumentFragment())}function gz(e){return document.createTextNode(e)}function mz(e){return document.createComment(e)}function vz(e,n,t){if(kc(e)){let i=e;for(;i&&kc(i);)i=Nd(i).parent;e=i??e}kc(n)&&(n=Nd(n,e)),t&&kc(t)&&(t=Nd(t).firstChildNode),e.insertBefore(n,t)}function yz(e,n){e.removeChild(n)}function _z(e,n){kc(n)&&(n=Nd(n,e)),e.appendChild(n)}function h7(e){if(kc(e)){for(;e&&kc(e);)e=Nd(e).parent;return e??null}return e.parentNode}function bz(e){var n;if(kc(e)){const t=Nd(e),i=h7(t);if(i&&t.lastChildNode){const a=Array.from(i.childNodes),o=a.indexOf(t.lastChildNode);return(n=a[o+1])!==null&&n!==void 0?n:null}return null}return e.nextSibling}function Sz(e){return e.tagName}function Ez(e,n){e.textContent=n}function Cz(e){return e.textContent}function Pz(e){return e.nodeType===1}function Rz(e){return e.nodeType===3}function Mz(e){return e.nodeType===8}function kc(e){return e.nodeType===11}function Nd(e,n){var t,i,a;const o=e;return(t=o.parent)!==null&&t!==void 0||(o.parent=n??null),(i=o.firstChildNode)!==null&&i!==void 0||(o.firstChildNode=e.firstChild),(a=o.lastChildNode)!==null&&a!==void 0||(o.lastChildNode=e.lastChild),o}const IC={createElement:fz,createElementNS:hz,createTextNode:gz,createDocumentFragment:pz,createComment:mz,insertBefore:vz,removeChild:yz,appendChild:_z,parentNode:h7,nextSibling:bz,tagName:Sz,setTextContent:Ez,getTextContent:Cz,isElement:Pz,isText:Rz,isComment:Mz,isDocumentFragment:kc};function qi(e,n,t,i,a){const o=n===void 0?void 0:n.key;return{sel:e,data:n,children:t,text:i,elm:a,key:o}}const nm=Array.isArray;function Bd(e){return typeof e=="string"||typeof e=="number"||e instanceof String||e instanceof Number}function Eb(e){return e===void 0}function Zi(e){return e!==void 0}const Cb=qi("",{},[],void 0,void 0);function cp(e,n){var t,i;const a=e.key===n.key,o=((t=e.data)===null||t===void 0?void 0:t.is)===((i=n.data)===null||i===void 0?void 0:i.is),s=e.sel===n.sel,r=!e.sel&&e.sel===n.sel?typeof e.text==typeof n.text:!0;return s&&a&&o&&r}function Az(){throw new Error("The document fragment is not supported on this platform.")}function wz(e,n){return e.isElement(n)}function Iz(e,n){return e.isDocumentFragment(n)}function Tz(e,n,t){var i;const a={};for(let o=n;o<=t;++o){const s=(i=e[o])===null||i===void 0?void 0:i.key;s!==void 0&&(a[s]=o)}return a}const Dz=["create","update","remove","destroy","pre","post"];function Oz(e,n,t){const i={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},a=n!==void 0?n:IC;for(const p of Dz)for(const g of e){const m=g[p];m!==void 0&&i[p].push(m)}function o(p){const g=p.id?"#"+p.id:"",m=p.getAttribute("class"),v=m?"."+m.split(" ").join("."):"";return qi(a.tagName(p).toLowerCase()+g+v,{},[],void 0,p)}function s(p){return qi(void 0,{},[],void 0,p)}function r(p,g){return function(){if(--g===0){const v=a.parentNode(p);a.removeChild(v,p)}}}function d(p,g){var m,v,_,S;let E,C=p.data;if(C!==void 0){const I=(m=C.hook)===null||m===void 0?void 0:m.init;Zi(I)&&(I(p),C=p.data)}const M=p.children,L=p.sel;if(L==="!")Eb(p.text)&&(p.text=""),p.elm=a.createComment(p.text);else if(L!==void 0){const I=L.indexOf("#"),R=L.indexOf(".",I),w=I>0?I:L.length,T=R>0?R:L.length,j=I!==-1||R!==-1?L.slice(0,Math.min(w,T)):L,D=p.elm=Zi(C)&&Zi(E=C.ns)?a.createElementNS(E,j,C):a.createElement(j,C);for(w<T&&D.setAttribute("id",L.slice(w+1,T)),R>0&&D.setAttribute("class",L.slice(T+1).replace(/\./g," ")),E=0;E<i.create.length;++E)i.create[E](Cb,p);if(nm(M))for(E=0;E<M.length;++E){const H=M[E];H!=null&&a.appendChild(D,d(H,g))}else Bd(p.text)&&a.appendChild(D,a.createTextNode(p.text));const B=p.data.hook;Zi(B)&&((v=B.create)===null||v===void 0||v.call(B,Cb,p),B.insert&&g.push(p))}else if(!((_=t==null?void 0:t.experimental)===null||_===void 0)&&_.fragments&&p.children){for(p.elm=((S=a.createDocumentFragment)!==null&&S!==void 0?S:Az)(),E=0;E<i.create.length;++E)i.create[E](Cb,p);for(E=0;E<p.children.length;++E){const I=p.children[E];I!=null&&a.appendChild(p.elm,d(I,g))}}else p.elm=a.createTextNode(p.text);return p.elm}function l(p,g,m,v,_,S){for(;v<=_;++v){const E=m[v];E!=null&&a.insertBefore(p,d(E,S),g)}}function c(p){var g,m;const v=p.data;if(v!==void 0){(m=(g=v==null?void 0:v.hook)===null||g===void 0?void 0:g.destroy)===null||m===void 0||m.call(g,p);for(let _=0;_<i.destroy.length;++_)i.destroy[_](p);if(p.children!==void 0)for(let _=0;_<p.children.length;++_){const S=p.children[_];S!=null&&typeof S!="string"&&c(S)}}}function u(p,g,m,v){for(var _,S;m<=v;++m){let E,C;const M=g[m];if(M!=null)if(Zi(M.sel)){c(M),E=i.remove.length+1,C=r(M.elm,E);for(let I=0;I<i.remove.length;++I)i.remove[I](M,C);const L=(S=(_=M==null?void 0:M.data)===null||_===void 0?void 0:_.hook)===null||S===void 0?void 0:S.remove;Zi(L)?L(M,C):C()}else M.children?(c(M),u(p,M.children,0,M.children.length-1)):a.removeChild(p,M.elm)}}function f(p,g,m,v){let _=0,S=0,E=g.length-1,C=g[0],M=g[E],L=m.length-1,I=m[0],R=m[L],w,T,j,D;for(;_<=E&&S<=L;)C==null?C=g[++_]:M==null?M=g[--E]:I==null?I=m[++S]:R==null?R=m[--L]:cp(C,I)?(h(C,I,v),C=g[++_],I=m[++S]):cp(M,R)?(h(M,R,v),M=g[--E],R=m[--L]):cp(C,R)?(h(C,R,v),a.insertBefore(p,C.elm,a.nextSibling(M.elm)),C=g[++_],R=m[--L]):cp(M,I)?(h(M,I,v),a.insertBefore(p,M.elm,C.elm),M=g[--E],I=m[++S]):(w===void 0&&(w=Tz(g,_,E)),T=w[I.key],Eb(T)?a.insertBefore(p,d(I,v),C.elm):(j=g[T],j.sel!==I.sel?a.insertBefore(p,d(I,v),C.elm):(h(j,I,v),g[T]=void 0,a.insertBefore(p,j.elm,C.elm))),I=m[++S]);S<=L&&(D=m[L+1]==null?null:m[L+1].elm,l(p,D,m,S,L,v)),_<=E&&u(p,g,_,E)}function h(p,g,m){var v,_,S,E,C,M,L,I;const R=(v=g.data)===null||v===void 0?void 0:v.hook;(_=R==null?void 0:R.prepatch)===null||_===void 0||_.call(R,p,g);const w=g.elm=p.elm;if(p===g)return;if(g.data!==void 0||Zi(g.text)&&g.text!==p.text){(S=g.data)!==null&&S!==void 0||(g.data={}),(E=p.data)!==null&&E!==void 0||(p.data={});for(let D=0;D<i.update.length;++D)i.update[D](p,g);(L=(M=(C=g.data)===null||C===void 0?void 0:C.hook)===null||M===void 0?void 0:M.update)===null||L===void 0||L.call(M,p,g)}const T=p.children,j=g.children;Eb(g.text)?Zi(T)&&Zi(j)?T!==j&&f(w,T,j,m):Zi(j)?(Zi(p.text)&&a.setTextContent(w,""),l(w,null,j,0,j.length-1,m)):Zi(T)?u(w,T,0,T.length-1):Zi(p.text)&&a.setTextContent(w,""):p.text!==g.text&&(Zi(T)&&u(w,T,0,T.length-1),a.setTextContent(w,g.text)),(I=R==null?void 0:R.postpatch)===null||I===void 0||I.call(R,p,g)}return function(g,m){let v,_,S;const E=[];for(v=0;v<i.pre.length;++v)i.pre[v]();for(wz(a,g)?g=o(g):Iz(a,g)&&(g=s(g)),cp(g,m)?h(g,m,E):(_=g.elm,S=a.parentNode(_),d(m,E),S!==null&&(a.insertBefore(S,m.elm,a.nextSibling(_)),u(S,[g],0,0))),v=0;v<E.length;++v)E[v].data.hook.insert(E[v]);for(v=0;v<i.post.length;++v)i.post[v]();return m}}function e_(e,n,t){if(e.ns="http://www.w3.org/2000/svg",t!=="foreignObject"&&n!==void 0)for(let i=0;i<n.length;++i){const a=n[i];if(typeof a=="string")continue;const o=a.data;o!==void 0&&e_(o,a.children,a.sel)}}function xa(e,n,t){let i={},a,o,s;if(t!==void 0?(n!==null&&(i=n),nm(t)?a=t:Bd(t)?o=t.toString():t&&t.sel&&(a=[t])):n!=null&&(nm(n)?a=n:Bd(n)?o=n.toString():n&&n.sel?a=[n]:i=n),a!==void 0)for(s=0;s<a.length;++s)Bd(a[s])&&(a[s]=qi(void 0,void 0,void 0,a[s],void 0));return e[0]==="s"&&e[1]==="v"&&e[2]==="g"&&(e.length===3||e[3]==="."||e[3]==="#")&&e_(i,a,e),qi(e,i,a,o,void 0)}function Lz(e){let n,t;if(nm(e)?n=e:Bd(n)?t=e:n&&n.sel&&(n=[e]),n!==void 0)for(let i=0;i<n.length;++i)Bd(n[i])&&(n[i]=qi(void 0,void 0,void 0,n[i],void 0));return qi(void 0,{},n,t,void 0)}function oy(e,n){var t;const i=(t=n.data)===null||t===void 0?void 0:t.ns;e.data.fn=n.data.fn,e.data.args=n.data.args,n.data=e.data,n.children=e.children,n.text=e.text,n.elm=e.elm,i&&e_(n.data,n.children,n.sel)}function jz(e){const n=e.data,t=n.fn(...n.args);oy(t,e)}function Nz(e,n){let t;const i=e.data,a=n.data,o=i.args,s=a.args;if(i.fn!==a.fn||o.length!==s.length){oy(a.fn(...s),n);return}for(t=0;t<s.length;++t)if(o[t]!==s[t]){oy(a.fn(...s),n);return}oy(e,n)}const Bz=function(n,t,i,a){return a===void 0&&(a=i,i=t,t=void 0),xa(n,{key:t,hook:{init:jz,prepatch:Nz},fn:i,args:a})};function xz(e,n){const t=e.data.attachData;n.data.attachData.placeholder=t.placeholder,n.data.attachData.real=t.real,e.elm=e.data.attachData.real}function Fz(e,n){n.elm=n.data.attachData.placeholder}function kz(e){e.elm!==void 0&&e.elm.parentNode.removeChild(e.elm),e.elm=e.data.attachData.real}function Kz(e,n){const t=n.elm,i=n.data.attachData,a=document.createElement("span");n.elm=a,i.target.appendChild(t),i.real=t,i.placeholder=a}function qz(e,n){n.data===void 0&&(n.data={}),n.data.hook===void 0&&(n.data.hook={});const t=n.data,i=n.data.hook;return t.attachData={target:e,placeholder:void 0,real:void 0},i.create=Kz,i.prepatch=xz,i.postpatch=Fz,i.destroy=kz,n}function p7(e,n){const t=n!==void 0?n:IC;let i;if(t.isElement(e)){const a=e.id?"#"+e.id:"",o=e.getAttribute("class"),s=o?"."+o.split(" ").join("."):"",r=t.tagName(e).toLowerCase()+a+s,d={},l={},c={},u=[];let f,h,p;const g=e.attributes,m=e.childNodes;for(h=0,p=g.length;h<p;h++)f=g[h].nodeName,f[0]==="d"&&f[1]==="a"&&f[2]==="t"&&f[3]==="a"&&f[4]==="-"?l[f.slice(5)]=g[h].nodeValue||"":f!=="id"&&f!=="class"&&(d[f]=g[h].nodeValue);for(h=0,p=m.length;h<p;h++)u.push(p7(m[h],n));return Object.keys(d).length>0&&(c.attrs=d),Object.keys(l).length>0&&(c.dataset=l),r[0]==="s"&&r[1]==="v"&&r[2]==="g"&&(r.length===3||r[3]==="."||r[3]==="#")&&e_(c,u,r),qi(r,c,u,void 0,e)}else return t.isText(e)?(i=t.getTextContent(e),qi(void 0,void 0,void 0,i,e)):t.isComment(e)?(i=t.getTextContent(e),qi("!",{},[],i,e)):qi("",{},[],void 0,e)}const Hz="http://www.w3.org/1999/xlink",Vz="http://www.w3.org/XML/1998/namespace",OT=58,Gz=120;function LT(e,n){let t;const i=n.elm;let a=e.data.attrs,o=n.data.attrs;if(!(!a&&!o)&&a!==o){a=a||{},o=o||{};for(t in o){const s=o[t];a[t]!==s&&(s===!0?i.setAttribute(t,""):s===!1?i.removeAttribute(t):t.charCodeAt(0)!==Gz?i.setAttribute(t,s):t.charCodeAt(3)===OT?i.setAttributeNS(Vz,t,s):t.charCodeAt(5)===OT?i.setAttributeNS(Hz,t,s):i.setAttribute(t,s))}for(t in a)t in o||i.removeAttribute(t)}}const zz={create:LT,update:LT};function jT(e,n){let t,i;const a=n.elm;let o=e.data.class,s=n.data.class;if(!(!o&&!s)&&o!==s){o=o||{},s=s||{};for(i in o)o[i]&&!Object.prototype.hasOwnProperty.call(s,i)&&a.classList.remove(i);for(i in s)t=s[i],t!==o[i]&&a.classList[t?"add":"remove"](i)}}const Uz={create:jT,update:jT},NT=/[A-Z]/g;function BT(e,n){const t=n.elm;let i=e.data.dataset,a=n.data.dataset,o;if(!i&&!a||i===a)return;i=i||{},a=a||{};const s=t.dataset;for(o in i)a[o]||(s?o in s&&delete s[o]:t.removeAttribute("data-"+o.replace(NT,"-$&").toLowerCase()));for(o in a)i[o]!==a[o]&&(s?s[o]=a[o]:t.setAttribute("data-"+o.replace(NT,"-$&").toLowerCase(),a[o]))}const $z={create:BT,update:BT};function g7(e,n,t){if(typeof e=="function")e.call(n,t,n);else if(typeof e=="object")for(let i=0;i<e.length;i++)g7(e[i],n,t)}function Yz(e,n){const t=e.type,i=n.data.on;i&&i[t]&&g7(i[t],n,e)}function Wz(){return function e(n){Yz(n,e.vnode)}}function Pb(e,n){const t=e.data.on,i=e.listener,a=e.elm,o=n&&n.data.on,s=n&&n.elm;let r;if(t!==o){if(t&&i)if(o)for(r in t)o[r]||a.removeEventListener(r,i,!1);else for(r in t)a.removeEventListener(r,i,!1);if(o){const d=n.listener=e.listener||Wz();if(d.vnode=n,t)for(r in o)t[r]||s.addEventListener(r,d,!1);else for(r in o)s.addEventListener(r,d,!1)}}}const Zz={create:Pb,update:Pb,destroy:Pb};function xT(e,n){let t,i,a;const o=n.elm;let s=e.data.props,r=n.data.props;if(!(!s&&!r)&&s!==r){s=s||{},r=r||{};for(t in r)i=r[t],a=s[t],a!==i&&(t!=="value"||o[t]!==i)&&(o[t]=i)}}const Qz={create:xT,update:xT},FT=typeof window<"u"&&window.requestAnimationFrame.bind(window)||setTimeout,Jz=function(e){FT(function(){FT(e)})};let jS=!1;function Xz(e,n,t){Jz(function(){e[n]=t})}function kT(e,n){let t,i;const a=n.elm;let o=e.data.style,s=n.data.style;if(!o&&!s||o===s)return;o=o||{},s=s||{};const r="delayed"in o;for(i in o)s[i]||(i[0]==="-"&&i[1]==="-"?a.style.removeProperty(i):a.style[i]="");for(i in s)if(t=s[i],i==="delayed"&&s.delayed)for(const d in s.delayed)t=s.delayed[d],(!r||t!==o.delayed[d])&&Xz(a.style,d,t);else i!=="remove"&&t!==o[i]&&(i[0]==="-"&&i[1]==="-"?a.style.setProperty(i,t):a.style[i]=t)}function eU(e){let n,t;const i=e.elm,a=e.data.style;if(!(!a||!(n=a.destroy)))for(t in n)i.style[t]=n[t]}function tU(e,n){const t=e.data.style;if(!t||!t.remove){n();return}jS||(e.elm.offsetLeft,jS=!0);let i;const a=e.elm;let o=0;const s=t.remove;let r=0;const d=[];for(i in s)d.push(i),a.style[i]=s[i];const c=getComputedStyle(a)["transition-property"].split(", ");for(;o<c.length;++o)d.indexOf(c[o])!==-1&&r++;a.addEventListener("transitionend",function(u){u.target===a&&--r,r===0&&n()})}function nU(){jS=!1}const iU={pre:nU,create:kT,update:kT,destroy:eU,remove:tU};function rU(e,...n){const t=TC(n,[]);return t.length===1&&!t[0].sel&&t[0].text?qi(void 0,void 0,void 0,t[0].text,void 0):qi(void 0,e??{},t,void 0,void 0)}function TC(e,n){for(const t of e)t!=null&&t!==!1&&t!==""&&(Array.isArray(t)?TC(t,n):typeof t=="string"||typeof t=="number"||typeof t=="boolean"?n.push(qi(void 0,void 0,void 0,String(t),void 0)):n.push(t));return n}function NS(e,n,...t){const i=TC(t,[]);return typeof e=="function"?e(n,i):i.length===1&&!i[0].sel&&i[0].text?xa(e,n,i[0].text):xa(e,n,i)}NS||(NS={});const oU=Object.freeze(Object.defineProperty({__proto__:null,Fragment:rU,array:nm,attachTo:qz,attributesModule:zz,classModule:Uz,datasetModule:$z,eventListenersModule:Zz,fragment:Lz,h:xa,htmlDomApi:IC,init:Oz,get jsx(){return NS},primitive:Bd,propsModule:Qz,styleModule:iU,thunk:Bz,toVNode:p7,vnode:qi},Symbol.toStringTag,{value:"Module"})),nh=G8(oU);var KT;function DC(){if(KT)return $s;KT=1;var e=$s&&$s.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty($s,"__esModule",{value:!0}),$s.isThunk=$s.ThunkView=void 0;const n=nh,t=G();let i=class{render(s,r){return(0,n.h)(this.selector(s),{key:s.id,hook:{init:this.init.bind(this),prepatch:this.prepatch.bind(this)},fn:()=>this.renderAndDecorate(s,r),args:this.watchedArgs(s),thunk:!0})}renderAndDecorate(s,r){const d=this.doRender(s,r);return r.decorate(d,s),d}copyToThunk(s,r){r.elm=s.elm,s.data.fn=r.data.fn,s.data.args=r.data.args,r.data=s.data,r.children=s.children,r.text=s.text,r.elm=s.elm}init(s){const r=s.data,d=r.fn.apply(void 0,r.args);this.copyToThunk(d,s)}prepatch(s,r){const d=s.data,l=r.data;this.equals(d.args,l.args)?this.copyToThunk(s,r):this.copyToThunk(l.fn.apply(void 0,l.args),r)}equals(s,r){if(Array.isArray(s)&&Array.isArray(r)){if(s.length!==r.length)return!1;for(let d=0;d<r.length;++d)if(!this.equals(s[d],r[d]))return!1}else if(typeof s=="object"&&typeof r=="object"){if(Object.keys(s).length!==Object.keys(r).length)return!1;for(const d in s)if(d!=="parent"&&d!=="root"&&(!(d in r)||!this.equals(s[d],r[d])))return!1}else if(s!==r)return!1;return!0}};$s.ThunkView=i,$s.ThunkView=i=e([(0,t.injectable)()],i);function a(o){return"thunk"in o}return $s.isThunk=a,$s}var Ht={},pc={},qT;function Ds(){if(qT)return pc;qT=1,Object.defineProperty(pc,"__esModule",{value:!0}),pc.JSX=pc.svg=pc.html=void 0;const e=nh,n=["hook","on","style","class","props","attrs","dataset"],t="http://www.w3.org/2000/svg";function i(r,d,l){const c={};if(l&&(c.ns=l),r===null)return c;return n.forEach(f=>{r[f]&&(c[f]=r[f])}),Object.keys(r).forEach(f=>{if(f==="key"||f==="classNames"||f==="selector")return;const h=f.indexOf("-");if(h>0){const p=f.slice(0,h);n.includes(p)?u(p,f.slice(h+1),r[f]):u(d,f,r[f])}else c[f]||u(d,f,r[f])}),c;function u(f,h,p){const g=c[f]||(c[f]={});g[h]=p}}function a(r,d="props"){return(l,c,...u)=>{const f=typeof l=="function";return(0,e.jsx)(l,f?c:i(c,d,r),u)}}pc.JSX=a;const o=a();pc.html=o;const s=a(t,"attrs");return pc.svg=s,pc}var HT;function ih(){if(HT)return Ht;HT=1;var e=Ht&&Ht.__decorate||function(S,E,C,M){var L=arguments.length,I=L<3?E:M===null?M=Object.getOwnPropertyDescriptor(E,C):M,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,E,C,M);else for(var w=S.length-1;w>=0;w--)(R=S[w])&&(I=(L<3?R(I):L>3?R(E,C,I):R(E,C))||I);return L>3&&I&&Object.defineProperty(E,C,I),I},n=Ht&&Ht.__metadata||function(S,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,E)},t=Ht&&Ht.__param||function(S,E){return function(C,M){E(C,M,S)}},i;Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.MissingView=Ht.EmptyView=Ht.configureView=Ht.overrideModelElement=Ht.configureModelElement=Ht.ViewRegistry=Ht.findArgValue=void 0;const a=Ds(),o=G(),s=Se(),r=Ga(),d=Zd(),l=Yc(),c=gi(),u=Yr();function f(S,E){for(;S!==void 0&&!(E in S)&&S.parentArgs;)S=S.parentArgs;return S?S[E]:void 0}Ht.findArgValue=f;let h=class extends r.InstanceRegistry{constructor(E){super(),this.registerDefaults(),E.forEach(C=>{C.isOverride?this.override(C.type,C.factory()):this.register(C.type,C.factory())})}registerDefaults(){this.register(l.EMPTY_ROOT.type,new v)}missing(E){return this.logger.warn(this,`no registered view for type '${E}', please configure a view in the ContainerModule`),new _}};Ht.ViewRegistry=h,e([(0,o.inject)(s.TYPES.ILogger),n("design:type",Object)],h.prototype,"logger",void 0),Ht.ViewRegistry=h=e([(0,o.injectable)(),t(0,(0,o.multiInject)(s.TYPES.ViewRegistration)),t(0,(0,o.optional)()),n("design:paramtypes",[Array])],h);function p(S,E,C,M,L){(0,c.registerModelElement)(S,E,C,L),m(S,E,M)}Ht.configureModelElement=p;function g(S,E,C,M,L){(0,c.registerModelElement)(S,E,C,L,!0),m(S,E,M,!0)}Ht.overrideModelElement=g;function m(S,E,C,M){if(typeof C=="function"){if(!(0,d.isInjectable)(C))throw new Error(`Views should be @injectable: ${C.name}`);S.isBound(C)||S.bind(C).toSelf()}S.bind(s.TYPES.ViewRegistration).toDynamicValue(L=>({type:E,factory:()=>L.container.get(C),isOverride:M}))}Ht.configureView=m;let v=class{render(E,C){return(0,a.svg)("svg",{"class-sprotty-empty":!0})}};Ht.EmptyView=v,Ht.EmptyView=v=e([(0,o.injectable)()],v);let _=i=class{render(E,C){const M=E.position||this.getPostion(E.type);return(0,a.svg)("text",{"class-sprotty-missing":!0,x:M.x,y:M.y},'missing "',E.type,'" view')}getPostion(E){let C=i.positionMap.get(E);return C||(C=u.Point.ORIGIN,i.positionMap.forEach(M=>C=M.y>=C.y?{x:0,y:M.y+20}:C),i.positionMap.set(E,C)),C}};return Ht.MissingView=_,_.positionMap=new Map,Ht.MissingView=_=i=e([(0,o.injectable)()],_),Ht}var Ys={},VT;function OC(){if(VT)return Ys;VT=1;var e=Ys&&Ys.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Ys&&Ys.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.ViewerCache=void 0;const t=G(),i=Se(),a=eh();let o=class{update(r,d){if(d!==void 0)this.delegate.update(r,d),this.cachedModel=void 0;else{const l=this.cachedModel===void 0;this.cachedModel=r,l&&this.scheduleUpdate()}}scheduleUpdate(){this.syncer.onEndOfNextFrame(()=>{this.cachedModel&&(this.delegate.update(this.cachedModel),this.cachedModel=void 0)})}};return Ys.ViewerCache=o,e([(0,t.inject)(i.TYPES.IViewer),n("design:type",Object)],o.prototype,"delegate",void 0),e([(0,t.inject)(i.TYPES.AnimationFrameSyncer),n("design:type",a.AnimationFrameSyncer)],o.prototype,"syncer",void 0),Ys.ViewerCache=o=e([(0,t.injectable)()],o),Ys}var Rb={},GT;function LC(){return GT||(GT=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.overrideViewerOptions=e.configureViewerOptions=e.defaultViewerOptions=void 0;const n=$c(),t=Se(),i=()=>({baseDiv:"sprotty",baseClass:"sprotty",hiddenDiv:"sprotty-hidden",hiddenClass:"sprotty-hidden",popupDiv:"sprotty-popup",popupClass:"sprotty-popup",popupClosedClass:"sprotty-popup-closed",needsClientLayout:!0,needsServerLayout:!1,popupOpenDelay:1e3,popupCloseDelay:300,zoomLimits:{min:.01,max:10},horizontalScrollLimits:{min:-1e5,max:1e5},verticalScrollLimits:{min:-1e5,max:1e5}});e.defaultViewerOptions=i;function a(s,r){const d=Object.assign(Object.assign({},(0,e.defaultViewerOptions)()),r);s.isBound(t.TYPES.ViewerOptions)?s.rebind(t.TYPES.ViewerOptions).toConstantValue(d):s.bind(t.TYPES.ViewerOptions).toConstantValue(d)}e.configureViewerOptions=a;function o(s,r){const d=s.get(t.TYPES.ViewerOptions);return(0,n.safeAssign)(d,r),d}e.overrideViewerOptions=o}(Rb)),Rb}var nn={},zT;function jC(){if(zT)return nn;zT=1;var e=nn&&nn.__decorate||function(v,_,S,E){var C=arguments.length,M=C<3?_:E===null?E=Object.getOwnPropertyDescriptor(_,S):E,L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(v,_,S,E);else for(var I=v.length-1;I>=0;I--)(L=v[I])&&(M=(C<3?L(M):C>3?L(_,S,M):L(_,S))||M);return C>3&&M&&Object.defineProperty(_,S,M),M},n=nn&&nn.__metadata||function(v,_){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,_)},t=nn&&nn.__param||function(v,_){return function(S,E){_(S,E,v)}};Object.defineProperty(nn,"__esModule",{value:!0}),nn.PopupModelViewer=nn.HiddenModelViewer=nn.ModelViewer=nn.PatcherProvider=nn.ModelRenderer=void 0;const i=G(),a=nh,o=Ds(),s=Ts(),r=Im(),d=Yc(),l=Se(),c=DC(),u=zn();class f{constructor(_,S,E,C={}){this.viewRegistry=_,this.targetKind=S,this.postprocessors=E,this.args=C}decorate(_,S){return(0,c.isThunk)(_)?_:this.postprocessors.reduce((E,C)=>C.decorate(E,S),_)}renderElement(_){const E=this.viewRegistry.get(_.type).render(_,this,this.args);if(E)return this.decorate(E,_)}renderChildren(_,S){const E=S?new f(this.viewRegistry,this.targetKind,this.postprocessors,Object.assign(Object.assign({},S),{parentArgs:this.args})):this;return _.children.map(C=>E.renderElement(C)).filter(C=>C!==void 0)}postUpdate(_){this.postprocessors.forEach(S=>S.postUpdate(_))}}nn.ModelRenderer=f;let h=class{constructor(){this.patcher=(0,a.init)(this.createModules())}createModules(){return[a.propsModule,a.attributesModule,a.classModule,a.styleModule,a.eventListenersModule]}};nn.PatcherProvider=h,nn.PatcherProvider=h=e([(0,i.injectable)(),n("design:paramtypes",[])],h);let p=class{constructor(_,S,E){this.renderer=_("main",E),this.patcher=S.patcher}update(_,S){var E;this.logger.log(this,"rendering",_);const C=(0,o.html)("div",{id:this.options.baseDiv},this.renderer.renderElement(_));if(this.lastVDOM!==void 0){const M=this.hasFocus();(0,u.copyClassesFromVNode)(this.lastVDOM,C),this.lastVDOM=this.patcher.call(this,this.lastVDOM,C),this.restoreFocus(M)}else if(typeof document<"u"){let M=null;if(this.options.shadowRoot){const L=(E=document.getElementById(this.options.shadowRoot))===null||E===void 0?void 0:E.shadowRoot;L&&(M=L.getElementById(this.options.baseDiv))}else M=document.getElementById(this.options.baseDiv);M!==null?(typeof window<"u"&&window.addEventListener("resize",()=>{this.onWindowResize(C)}),(0,u.copyClassesFromElement)(M,C),(0,u.setClass)(C,this.options.baseClass,!0),this.lastVDOM=this.patcher.call(this,M,C)):this.logger.error(this,"element not in DOM:",this.options.baseDiv)}this.renderer.postUpdate(S)}hasFocus(){if(typeof document<"u"&&document.activeElement&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const _=this.lastVDOM.children[0];if(typeof _=="object"){const S=_.elm;return document.activeElement===S}}return!1}restoreFocus(_){if(_&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const S=this.lastVDOM.children[0];if(typeof S=="object"){const E=S.elm;E&&typeof E.focus=="function"&&E.focus()}}}onWindowResize(_){const S=document.getElementById(this.options.baseDiv);if(S!==null){const E=this.getBoundsInPage(S);this.actiondispatcher.dispatch(r.InitializeCanvasBoundsAction.create(E))}}getBoundsInPage(_){const S=_.getBoundingClientRect(),E=(0,s.getWindowScroll)();return{x:S.left+E.x,y:S.top+E.y,width:S.width,height:S.height}}};nn.ModelViewer=p,e([(0,i.inject)(l.TYPES.ViewerOptions),n("design:type",Object)],p.prototype,"options",void 0),e([(0,i.inject)(l.TYPES.ILogger),n("design:type",Object)],p.prototype,"logger",void 0),e([(0,i.inject)(l.TYPES.IActionDispatcher),n("design:type",Object)],p.prototype,"actiondispatcher",void 0),nn.ModelViewer=p=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.ModelRendererFactory)),t(1,(0,i.inject)(l.TYPES.PatcherProvider)),t(2,(0,i.multiInject)(l.TYPES.IVNodePostprocessor)),t(2,(0,i.optional)()),n("design:paramtypes",[Function,h,Array])],p);let g=class{constructor(_,S,E){this.hiddenRenderer=_("hidden",E),this.patcher=S.patcher}update(_,S){this.logger.log(this,"rendering hidden");let E;if(_.type===d.EMPTY_ROOT.type)E=(0,o.html)("div",{id:this.options.hiddenDiv});else{const C=this.hiddenRenderer.renderElement(_);C&&(0,u.setAttr)(C,"opacity",0),E=(0,o.html)("div",{id:this.options.hiddenDiv},C)}if(this.lastHiddenVDOM!==void 0)(0,u.copyClassesFromVNode)(this.lastHiddenVDOM,E),this.lastHiddenVDOM=this.patcher.call(this,this.lastHiddenVDOM,E);else{let C=document.getElementById(this.options.hiddenDiv);C===null?(C=document.createElement("div"),document.body.appendChild(C)):(0,u.copyClassesFromElement)(C,E),(0,u.setClass)(E,this.options.baseClass,!0),(0,u.setClass)(E,this.options.hiddenClass,!0),this.lastHiddenVDOM=this.patcher.call(this,C,E)}this.hiddenRenderer.postUpdate(S)}};nn.HiddenModelViewer=g,e([(0,i.inject)(l.TYPES.ViewerOptions),n("design:type",Object)],g.prototype,"options",void 0),e([(0,i.inject)(l.TYPES.ILogger),n("design:type",Object)],g.prototype,"logger",void 0),nn.HiddenModelViewer=g=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.ModelRendererFactory)),t(1,(0,i.inject)(l.TYPES.PatcherProvider)),t(2,(0,i.multiInject)(l.TYPES.HiddenVNodePostprocessor)),t(2,(0,i.optional)()),n("design:paramtypes",[Function,h,Array])],g);let m=class{constructor(_,S,E){this.modelRendererFactory=_,this.popupRenderer=this.modelRendererFactory("popup",E),this.patcher=S.patcher}update(_,S){this.logger.log(this,"rendering popup",_);const E=_.type===d.EMPTY_ROOT.type;let C;if(E)C=(0,o.html)("div",{id:this.options.popupDiv});else{const M=_.canvasBounds,L={top:M.y+"px",left:M.x+"px"};C=(0,o.html)("div",{id:this.options.popupDiv,style:L},this.popupRenderer.renderElement(_))}if(this.lastPopupVDOM!==void 0)(0,u.copyClassesFromVNode)(this.lastPopupVDOM,C),(0,u.setClass)(C,this.options.popupClosedClass,E),this.lastPopupVDOM=this.patcher.call(this,this.lastPopupVDOM,C);else if(typeof document<"u"){let M=document.getElementById(this.options.popupDiv);M===null?(M=document.createElement("div"),document.body.appendChild(M)):(0,u.copyClassesFromElement)(M,C),(0,u.setClass)(C,this.options.popupClass,!0),(0,u.setClass)(C,this.options.popupClosedClass,E),this.lastPopupVDOM=this.patcher.call(this,M,C)}this.popupRenderer.postUpdate(S)}};return nn.PopupModelViewer=m,e([(0,i.inject)(l.TYPES.ViewerOptions),n("design:type",Object)],m.prototype,"options",void 0),e([(0,i.inject)(l.TYPES.ILogger),n("design:type",Object)],m.prototype,"logger",void 0),nn.PopupModelViewer=m=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.ModelRendererFactory)),t(1,(0,i.inject)(l.TYPES.PatcherProvider)),t(2,(0,i.multiInject)(l.TYPES.PopupVNodePostprocessor)),t(2,(0,i.optional)()),n("design:paramtypes",[Function,h,Array])],m),nn}var hu={},UT;function NC(){if(UT)return hu;UT=1;var e=hu&&hu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(hu,"__esModule",{value:!0}),hu.FocusFixPostprocessor=void 0;const n=G(),t=zn();let i=class{decorate(o,s){return o.sel&&o.sel.startsWith("svg")&&(0,t.setAttr)(o,"tabindex",0),o}postUpdate(){}};return hu.FocusFixPostprocessor=i,hu.FocusFixPostprocessor=i=e([(0,n.injectable)()],i),hu}var R1={},Li={},$T;function t_(){if($T)return Li;$T=1;var e=Li&&Li.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Li&&Li.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Li,"__esModule",{value:!0}),Li.ConsoleLogger=Li.NullLogger=Li.LogLevel=void 0;const t=G(),i=Se();var a;(function(r){r[r.none=0]="none",r[r.error=1]="error",r[r.warn=2]="warn",r[r.info=3]="info",r[r.log=4]="log"})(a||(Li.LogLevel=a={}));let o=class{constructor(){this.logLevel=a.none}error(d,l,...c){}warn(d,l,...c){}info(d,l,...c){}log(d,l,...c){}};Li.NullLogger=o,Li.NullLogger=o=e([(0,t.injectable)()],o);let s=class{constructor(){this.logLevel=a.log,this.viewOptions={baseDiv:""}}error(d,l,...c){if(this.logLevel>=a.error)try{console.error.apply(d,this.consoleArguments(d,l,c))}catch{}}warn(d,l,...c){if(this.logLevel>=a.warn)try{console.warn.apply(d,this.consoleArguments(d,l,c))}catch{}}info(d,l,...c){if(this.logLevel>=a.info)try{console.info.apply(d,this.consoleArguments(d,l,c))}catch{}}log(d,l,...c){if(this.logLevel>=a.log)try{console.log.apply(d,this.consoleArguments(d,l,c))}catch{}}consoleArguments(d,l,c){let u;return typeof d=="object"?u=d.constructor.name:u=d,[new Date().toLocaleTimeString()+" "+this.viewOptions.baseDiv+" "+u+": "+l,...c]}};return Li.ConsoleLogger=s,e([(0,t.inject)(i.TYPES.LogLevel),n("design:type",Number)],s.prototype,"logLevel",void 0),e([(0,t.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],s.prototype,"viewOptions",void 0),Li.ConsoleLogger=s=e([(0,t.injectable)()],s),Li}var Ws={},YT;function sU(){if(YT)return Ws;YT=1;var e=Ws&&Ws.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Ws&&Ws.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Ws,"__esModule",{value:!0}),Ws.IdPostprocessor=void 0;const t=G(),i=Se(),a=th(),o=zn();let s=class{decorate(d,l){const c=(0,o.getAttrs)(d);return c.id!==void 0&&this.logger.warn(d,"Overriding id of vnode ("+c.id+"). Make sure not to set it manually in view."),c.id=this.domHelper.createUniqueDOMElementId(l),d.key||(d.key=l.id),d}postUpdate(){}};return Ws.IdPostprocessor=s,e([(0,t.inject)(i.TYPES.ILogger),n("design:type",Object)],s.prototype,"logger",void 0),e([(0,t.inject)(i.TYPES.DOMHelper),n("design:type",a.DOMHelper)],s.prototype,"domHelper",void 0),Ws.IdPostprocessor=s=e([(0,t.injectable)()],s),Ws}var pu={},WT;function aU(){if(WT)return pu;WT=1;var e=pu&&pu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(pu,"__esModule",{value:!0}),pu.CssClassPostprocessor=void 0;const n=Jd(),t=zn(),i=G();let a=class{decorate(s,r){if(r.cssClasses)for(const l of r.cssClasses)(0,t.setClass)(s,l,!0);const d=(0,n.getSubType)(r);return d&&d!==r.type&&(0,t.setClass)(s,d,!0),s}postUpdate(){}};return pu.CssClassPostprocessor=a,pu.CssClassPostprocessor=a=e([(0,i.injectable)()],a),pu}var ZT;function BC(){if(ZT)return R1;ZT=1,Object.defineProperty(R1,"__esModule",{value:!0});const e=G(),n=Se(),t=Im(),i=t_(),a=Qy(),o=wm(),s=wC(),r=AC(),d=Yc(),l=eh(),c=jC(),u=LC(),f=Wr(),h=za(),p=NC(),g=ih(),m=OC(),v=th(),_=sU(),S=br(),E=aU(),C=Jy(),M=Tm(),L=RC(),I=new e.ContainerModule((R,w,T)=>{R(n.TYPES.ILogger).to(i.NullLogger).inSingletonScope(),R(n.TYPES.LogLevel).toConstantValue(i.LogLevel.warn),R(n.TYPES.SModelRegistry).to(d.SModelRegistry).inSingletonScope(),R(o.ActionHandlerRegistry).toSelf().inSingletonScope(),R(n.TYPES.ActionHandlerRegistryProvider).toProvider(D=>()=>new Promise(B=>{B(D.container.get(o.ActionHandlerRegistry))})),R(n.TYPES.ViewRegistry).to(g.ViewRegistry).inSingletonScope(),R(n.TYPES.IModelFactory).to(d.SModelFactory).inSingletonScope(),R(n.TYPES.IActionDispatcher).to(a.ActionDispatcher).inSingletonScope(),R(n.TYPES.IActionDispatcherProvider).toProvider(D=>()=>new Promise(B=>{B(D.container.get(n.TYPES.IActionDispatcher))})),R(n.TYPES.IDiagramLocker).to(L.DefaultDiagramLocker).inSingletonScope(),R(S.CommandActionHandlerInitializer).toSelf().inSingletonScope(),R(n.TYPES.IActionHandlerInitializer).toService(S.CommandActionHandlerInitializer),R(n.TYPES.ICommandStack).to(s.CommandStack).inSingletonScope(),R(n.TYPES.ICommandStackProvider).toProvider(D=>()=>new Promise(B=>{B(D.container.get(n.TYPES.ICommandStack))})),R(n.TYPES.CommandStackOptions).toConstantValue((0,r.defaultCommandStackOptions)()),R(c.ModelViewer).toSelf().inSingletonScope(),R(c.HiddenModelViewer).toSelf().inSingletonScope(),R(c.PopupModelViewer).toSelf().inSingletonScope(),R(n.TYPES.ModelViewer).toDynamicValue(D=>{const B=D.container.createChild();return B.bind(n.TYPES.IViewer).toService(c.ModelViewer),B.bind(m.ViewerCache).toSelf(),B.get(m.ViewerCache)}).inSingletonScope(),R(n.TYPES.PopupModelViewer).toDynamicValue(D=>{const B=D.container.createChild();return B.bind(n.TYPES.IViewer).toService(c.PopupModelViewer),B.bind(m.ViewerCache).toSelf(),B.get(m.ViewerCache)}).inSingletonScope(),R(n.TYPES.HiddenModelViewer).toService(c.HiddenModelViewer),R(n.TYPES.IViewerProvider).toDynamicValue(D=>({get modelViewer(){return D.container.get(n.TYPES.ModelViewer)},get hiddenModelViewer(){return D.container.get(n.TYPES.HiddenModelViewer)},get popupModelViewer(){return D.container.get(n.TYPES.PopupModelViewer)}})),R(n.TYPES.ViewerOptions).toConstantValue((0,u.defaultViewerOptions)()),R(n.TYPES.PatcherProvider).to(c.PatcherProvider).inSingletonScope(),R(n.TYPES.DOMHelper).to(v.DOMHelper).inSingletonScope(),R(n.TYPES.ModelRendererFactory).toFactory(D=>(B,H,F={})=>{const K=D.container.get(n.TYPES.ViewRegistry);return new c.ModelRenderer(K,B,H,F)}),R(_.IdPostprocessor).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(_.IdPostprocessor),R(n.TYPES.HiddenVNodePostprocessor).toService(_.IdPostprocessor),R(E.CssClassPostprocessor).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(E.CssClassPostprocessor),R(n.TYPES.HiddenVNodePostprocessor).toService(E.CssClassPostprocessor),R(f.MouseTool).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(f.MouseTool),R(h.KeyTool).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(h.KeyTool),R(p.FocusFixPostprocessor).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(p.FocusFixPostprocessor),R(n.TYPES.PopupVNodePostprocessor).toService(_.IdPostprocessor),R(f.PopupMouseTool).toSelf().inSingletonScope(),R(n.TYPES.PopupVNodePostprocessor).toService(f.PopupMouseTool),R(n.TYPES.AnimationFrameSyncer).to(l.AnimationFrameSyncer).inSingletonScope();const j={bind:R,isBound:T};(0,S.configureCommand)(j,t.InitializeCanvasBoundsCommand),R(t.CanvasBoundsInitializer).toSelf().inSingletonScope(),R(n.TYPES.IVNodePostprocessor).toService(t.CanvasBoundsInitializer),(0,S.configureCommand)(j,C.SetModelCommand),R(n.TYPES.UIExtensionRegistry).to(M.UIExtensionRegistry).inSingletonScope(),(0,S.configureCommand)(j,M.SetUIExtensionVisibilityCommand),R(f.MousePositionTracker).toSelf().inSingletonScope(),R(n.TYPES.MouseListener).toService(f.MousePositionTracker)});return R1.default=I,R1}var ji={},Mb={},QT;function Ft(){return QT||(QT=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SShapeElementImpl=e.findChildrenAtPosition=e.getAbsoluteClientBounds=e.getAbsoluteBounds=e.isAlignable=e.isSizeable=e.isLayoutableChild=e.isLayoutContainer=e.isBoundsAware=e.alignFeature=e.layoutableChildFeature=e.layoutContainerFeature=e.boundsFeature=void 0;const n=at(),t=ft(),i=gi(),a=Ts();e.boundsFeature=Symbol("boundsFeature"),e.layoutContainerFeature=Symbol("layoutContainerFeature"),e.layoutableChildFeature=Symbol("layoutableChildFeature"),e.alignFeature=Symbol("alignFeature");function o(g){return"bounds"in g}e.isBoundsAware=o;function s(g){return o(g)&&g.hasFeature(e.layoutContainerFeature)&&"layout"in g}e.isLayoutContainer=s;function r(g){return o(g)&&g.hasFeature(e.layoutableChildFeature)}e.isLayoutableChild=r;function d(g){return g.hasFeature(e.boundsFeature)&&o(g)}e.isSizeable=d;function l(g){return g.hasFeature(e.alignFeature)&&"alignment"in g}e.isAlignable=l;function c(g){const m=(0,i.findParentByFeature)(g,o);if(m!==void 0){let v=m.bounds,_=m;for(;_ instanceof t.SChildElementImpl;){const S=_.parent;v=S.localToParent(v),_=S}return v}else if(g instanceof t.SModelRootImpl){const v=g.canvasBounds;return{x:0,y:0,width:v.width,height:v.height}}else return n.Bounds.EMPTY}e.getAbsoluteBounds=c;function u(g,m,v){let _=0,S=0,E=0,C=0;const M=m.createUniqueDOMElementId(g),L=document.getElementById(M);if(L){const R=L.getBoundingClientRect(),w=(0,a.getWindowScroll)();_=R.left+w.x,S=R.top+w.y,E=R.width,C=R.height}let I=document.getElementById(v.baseDiv);if(I)for(;I.offsetParent instanceof HTMLElement&&(I=I.offsetParent);)_-=I.offsetLeft,S-=I.offsetTop;return{x:_,y:S,width:E,height:C}}e.getAbsoluteClientBounds=u;function f(g,m){const v=[];return h(g,m,v),v}e.findChildrenAtPosition=f;function h(g,m,v){g.children.forEach(_=>{if(o(_)&&n.Bounds.includes(_.bounds,m)&&v.push(_),_ instanceof t.SParentElementImpl){const S=_.parentToLocal(m);h(_,S,v)}})}class p extends t.SChildElementImpl{constructor(){super(...arguments),this.position=n.Point.ORIGIN,this.size=n.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(m){this.position={x:m.x,y:m.y},this.size={width:m.width,height:m.height}}localToParent(m){const v={x:m.x+this.position.x,y:m.y+this.position.y,width:-1,height:-1};return(0,n.isBounds)(m)&&(v.width=m.width,v.height=m.height),v}parentToLocal(m){const v={x:m.x-this.position.x,y:m.y-this.position.y,width:-1,height:-1};return(0,n.isBounds)(m)&&(v.width=m.width,v.height=m.height),v}}e.SShapeElementImpl=p}(Mb)),Mb}var JT;function n_(){if(JT)return ji;JT=1;var e=ji&&ji.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=ji&&ji.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=ji&&ji.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(ji,"__esModule",{value:!0}),ji.RequestBoundsCommand=ji.SetBoundsCommand=void 0;const i=G(),a=lt(),o=sn(),s=Se(),r=Ft();let d=class extends o.SystemCommand{constructor(u){super(),this.action=u,this.bounds=[]}execute(u){return this.action.bounds.forEach(f=>{const h=u.root.index.getById(f.elementId);h&&(0,r.isBoundsAware)(h)&&this.bounds.push({element:h,oldBounds:h.bounds,newPosition:f.newPosition,newSize:f.newSize})}),this.redo(u)}undo(u){return this.bounds.forEach(f=>f.element.bounds=f.oldBounds),u.root}redo(u){return this.bounds.forEach(f=>{f.newPosition?f.element.bounds=Object.assign(Object.assign({},f.newPosition),f.newSize):f.element.bounds=Object.assign({x:f.element.bounds.x,y:f.element.bounds.y},f.newSize)}),u.root}};ji.SetBoundsCommand=d,d.KIND=a.SetBoundsAction.KIND,ji.SetBoundsCommand=d=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],d);let l=class extends o.HiddenCommand{constructor(u){super(),this.action=u}execute(u){return{model:u.modelFactory.createRoot(this.action.newRoot),modelChanged:!0,cause:this.action}}get blockUntil(){return u=>u.kind===a.ComputedBoundsAction.KIND}};return ji.RequestBoundsCommand=l,l.KIND=a.RequestBoundsAction.KIND,ji.RequestBoundsCommand=l=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],l),ji}var Dl={},jn={},XT;function i_(){if(XT)return jn;XT=1;var e=jn&&jn.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=jn&&jn.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)},t=jn&&jn.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(jn,"__esModule",{value:!0}),jn.configureLayout=jn.StatefulLayouter=jn.Layouter=jn.LayoutRegistry=void 0;const i=G(),a=at(),o=Se(),s=Ga(),r=Ft(),d=Zd();let l=class extends s.InstanceRegistry{constructor(p=[]){super(),p.forEach(g=>{this.hasKey(g.layoutKind)?this.logger.warn("Layout kind is already defined: ",g.layoutKind):this.register(g.layoutKind,g.factory())})}};jn.LayoutRegistry=l,e([(0,i.inject)(o.TYPES.ILogger),n("design:type",Object)],l.prototype,"logger",void 0),jn.LayoutRegistry=l=e([(0,i.injectable)(),t(0,(0,i.multiInject)(o.TYPES.LayoutRegistration)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],l);let c=class{layout(p){new u(p,this.layoutRegistry,this.logger).layout()}};jn.Layouter=c,e([(0,i.inject)(o.TYPES.LayoutRegistry),n("design:type",l)],c.prototype,"layoutRegistry",void 0),e([(0,i.inject)(o.TYPES.ILogger),n("design:type",Object)],c.prototype,"logger",void 0),jn.Layouter=c=e([(0,i.injectable)()],c);class u{constructor(p,g,m){this.element2boundsData=p,this.layoutRegistry=g,this.log=m,this.toBeLayouted=[],p.forEach((v,_)=>{(0,r.isLayoutContainer)(_)&&this.toBeLayouted.push(_)})}getBoundsData(p){let g=this.element2boundsData.get(p),m=p.bounds;return(0,r.isLayoutContainer)(p)&&this.toBeLayouted.indexOf(p)>=0&&(m=this.doLayout(p)),g||(g={bounds:m,boundsChanged:!1,alignmentChanged:!1},this.element2boundsData.set(p,g)),g}layout(){for(;this.toBeLayouted.length>0;){const p=this.toBeLayouted[0];this.doLayout(p)}}doLayout(p){const g=this.toBeLayouted.indexOf(p);g>=0&&this.toBeLayouted.splice(g,1);const m=this.layoutRegistry.get(p.layout);m&&m.layout(p,this);const v=this.element2boundsData.get(p);return v!==void 0&&v.bounds!==void 0?v.bounds:(this.log.error(p,"Layout failed"),a.Bounds.EMPTY)}}jn.StatefulLayouter=u;function f(h,p,g){if(typeof g=="function"){if(!(0,d.isInjectable)(g))throw new Error(`Layouts be @injectable: ${g.name}`);h.isBound(g)||h.bind(g).toSelf()}h.bind(o.TYPES.LayoutRegistration).toDynamicValue(m=>({layoutKind:p,factory:()=>m.container.get(g)}))}return jn.configureLayout=f,jn}var eD;function xC(){return eD||(eD=1,function(e){var n=Dl&&Dl.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},t=Dl&&Dl.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)};Object.defineProperty(e,"__esModule",{value:!0}),e.ATTR_BBOX_ELEMENT=e.HiddenBoundsUpdater=e.BoundsData=void 0;const i=G(),a=lt(),o=at(),s=Ts(),r=ft(),d=Se(),l=i_(),c=Ft();class u{}e.BoundsData=u;let f=class{constructor(){this.element2boundsData=new Map}decorate(p,g){return((0,c.isSizeable)(g)||(0,c.isLayoutContainer)(g))&&this.element2boundsData.set(g,{vnode:p,bounds:g.bounds,boundsChanged:!1,alignmentChanged:!1}),g instanceof r.SModelRootImpl&&(this.root=g),p}postUpdate(p){if(p===void 0||p.kind!==a.RequestBoundsAction.KIND)return;const g=p;this.getBoundsFromDOM(),this.layouter.layout(this.element2boundsData);const m=[],v=[];this.element2boundsData.forEach((S,E)=>{if(S.boundsChanged&&S.bounds!==void 0){const C={elementId:E.id,newSize:{width:S.bounds.width,height:S.bounds.height}};E instanceof r.SChildElementImpl&&(0,c.isLayoutContainer)(E.parent)&&(C.newPosition={x:S.bounds.x,y:S.bounds.y}),m.push(C)}S.alignmentChanged&&S.alignment!==void 0&&v.push({elementId:E.id,newAlignment:S.alignment})});const _=this.root!==void 0?this.root.revision:void 0;this.actionDispatcher.dispatch(a.ComputedBoundsAction.create(m,{revision:_,alignments:v,requestId:g.requestId})),this.element2boundsData.clear()}getBoundsFromDOM(){this.element2boundsData.forEach((p,g)=>{if(p.bounds&&(0,c.isSizeable)(g)){const m=p.vnode;if(m&&m.elm){const v=this.getBounds(m.elm,g);(0,c.isAlignable)(g)&&!((0,o.almostEquals)(v.x,0)&&(0,o.almostEquals)(v.y,0))&&(p.alignment={x:-v.x,y:-v.y},p.alignmentChanged=!0);const _={x:g.bounds.x,y:g.bounds.y,width:v.width,height:v.height};(0,o.almostEquals)(_.x,g.bounds.x)&&(0,o.almostEquals)(_.y,g.bounds.y)&&(0,o.almostEquals)(_.width,g.bounds.width)&&(0,o.almostEquals)(_.height,g.bounds.height)||(p.bounds=_,p.boundsChanged=!0)}}})}getBounds(p,g){if(!(0,s.isSVGGraphicsElement)(p))return this.logger.error(this,"Not an SVG element:",p),o.Bounds.EMPTY;if(p.tagName==="g"){for(const v of Array.from(p.children))if(v.getAttribute(e.ATTR_BBOX_ELEMENT)!==null)return this.getBounds(v,g)}const m=p.getBBox();return{x:m.x,y:m.y,width:m.width,height:m.height}}};e.HiddenBoundsUpdater=f,n([(0,i.inject)(d.TYPES.ILogger),t("design:type",Object)],f.prototype,"logger",void 0),n([(0,i.inject)(d.TYPES.IActionDispatcher),t("design:type",Object)],f.prototype,"actionDispatcher",void 0),n([(0,i.inject)(d.TYPES.Layouter),t("design:type",l.Layouter)],f.prototype,"layouter",void 0),e.HiddenBoundsUpdater=f=n([(0,i.injectable)()],f),e.ATTR_BBOX_ELEMENT="bboxElement"}(Dl)),Dl}var gu={},mu={},tD;function r_(){if(tD)return mu;tD=1;var e=mu&&mu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(mu,"__esModule",{value:!0}),mu.AbstractLayout=void 0;const n=at(),t=ft(),i=Ft(),a=G();let o=class{layout(r,d){const l=d.getBoundsData(r),c=this.getLayoutOptions(r),u=this.getChildrenSize(r,c,d),f=c.paddingFactor*(c.resizeContainer?Math.max(u.width,c.minWidth):Math.max(0,this.getFixedContainerBounds(r,c,d).width)-c.paddingLeft-c.paddingRight),h=c.paddingFactor*(c.resizeContainer?Math.max(u.height,c.minHeight):Math.max(0,this.getFixedContainerBounds(r,c,d).height)-c.paddingTop-c.paddingBottom);if(f>0&&h>0){const p=this.layoutChildren(r,d,c,f,h);l.bounds=this.getFinalContainerBounds(r,p,c,f,h),l.boundsChanged=!0}}getFinalContainerBounds(r,d,l,c,u){return{x:r.bounds.x,y:r.bounds.y,width:Math.max(l.minWidth,c+l.paddingLeft+l.paddingRight),height:Math.max(l.minHeight,u+l.paddingTop+l.paddingBottom)}}getFixedContainerBounds(r,d,l){let c=r;for(;;){if((0,i.isBoundsAware)(c)){const u=c.bounds;if((0,i.isLayoutContainer)(c)&&d.resizeContainer&&l.log.error(c,"Resizable container found while detecting fixed bounds"),n.Dimension.isValid(u))return u}if(c instanceof t.SChildElementImpl)c=c.parent;else return l.log.error(c,"Cannot detect fixed bounds"),n.Bounds.EMPTY}}layoutChildren(r,d,l,c,u){let f={x:l.paddingLeft+.5*(c-c/l.paddingFactor),y:l.paddingTop+.5*(u-u/l.paddingFactor)};return r.children.forEach(h=>{if((0,i.isLayoutableChild)(h)){const p=d.getBoundsData(h),g=p.bounds,m=this.getChildLayoutOptions(h,l);g!==void 0&&n.Dimension.isValid(g)&&(f=this.layoutChild(h,p,g,m,l,f,c,u))}}),f}getDx(r,d,l){switch(r){case"left":return 0;case"center":return .5*(l-d.width);case"right":return l-d.width}}getDy(r,d,l){switch(r){case"top":return 0;case"center":return .5*(l-d.height);case"bottom":return l-d.height}}getChildLayoutOptions(r,d){const l=r.layoutOptions;return l===void 0?d:this.spread(d,l)}getLayoutOptions(r){let d=r;const l=[];for(;d!==void 0;){const c=d.layoutOptions;if(c!==void 0&&l.push(c),d instanceof t.SChildElementImpl)d=d.parent;else break}return l.reverse().reduce((c,u)=>this.spread(c,u),this.getDefaultLayoutOptions())}};return mu.AbstractLayout=o,mu.AbstractLayout=o=e([(0,a.injectable)()],o),mu}var nD;function FC(){if(nD)return gu;nD=1;var e=gu&&gu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(gu,"__esModule",{value:!0}),gu.VBoxLayouter=void 0;const n=G(),t=at(),i=r_(),a=Ft();let o=class extends i.AbstractLayout{getChildrenSize(r,d,l){let c=-1,u=0,f=!0;return r.children.forEach(h=>{if((0,a.isLayoutableChild)(h)){const p=l.getBoundsData(h).bounds;p!==void 0&&t.Dimension.isValid(p)&&(u+=p.height,f?f=!1:u+=d.vGap,c=Math.max(c,p.width))}}),{width:c,height:u}}layoutChild(r,d,l,c,u,f,h,p){const g=this.getDx(c.hAlign,l,h);return d.bounds={x:u.paddingLeft+r.bounds.x-l.x+g,y:f.y+r.bounds.y-l.y,width:l.width,height:l.height},d.boundsChanged=!0,{x:f.x,y:f.y+l.height+u.vGap}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0}}spread(r,d){return Object.assign(Object.assign({},r),d)}};return gu.VBoxLayouter=o,o.KIND="vbox",gu.VBoxLayouter=o=e([(0,n.injectable)()],o),gu}var vu={},iD;function kC(){if(iD)return vu;iD=1;var e=vu&&vu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(vu,"__esModule",{value:!0}),vu.HBoxLayouter=void 0;const n=G(),t=at(),i=r_(),a=Ft();let o=class extends i.AbstractLayout{getChildrenSize(r,d,l){let c=0,u=-1,f=!0;return r.children.forEach(h=>{if((0,a.isLayoutableChild)(h)){const p=l.getBoundsData(h).bounds;p!==void 0&&t.Dimension.isValid(p)&&(f?f=!1:c+=d.hGap,c+=p.width,u=Math.max(u,p.height))}}),{width:c,height:u}}layoutChild(r,d,l,c,u,f,h,p){const g=this.getDy(c.vAlign,l,p);return d.bounds={x:f.x+r.bounds.x-l.x,y:u.paddingTop+r.bounds.y-l.y+g,width:l.width,height:l.height},d.boundsChanged=!0,{x:f.x+l.width+u.hGap,y:f.y}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0}}spread(r,d){return Object.assign(Object.assign({},r),d)}};return vu.HBoxLayouter=o,o.KIND="hbox",vu.HBoxLayouter=o=e([(0,n.injectable)()],o),vu}var yu={},rD;function m7(){if(rD)return yu;rD=1;var e=yu&&yu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(yu,"__esModule",{value:!0}),yu.StackLayouter=void 0;const n=G(),t=at(),i=r_(),a=Ft();let o=class extends i.AbstractLayout{getChildrenSize(r,d,l){let c=-1,u=-1;return r.children.forEach(f=>{if((0,a.isLayoutableChild)(f)){const h=l.getBoundsData(f).bounds;h!==void 0&&t.Dimension.isValid(h)&&(c=Math.max(c,h.width),u=Math.max(u,h.height))}}),{width:c,height:u}}layoutChild(r,d,l,c,u,f,h,p){const g=this.getDx(c.hAlign,l,h),m=this.getDy(c.vAlign,l,p);return d.bounds={x:u.paddingLeft+r.bounds.x-l.x+g,y:u.paddingTop+r.bounds.y-l.y+m,width:l.width,height:l.height},d.boundsChanged=!0,f}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hAlign:"center",vAlign:"center",minWidth:0,minHeight:0}}spread(r,d){return Object.assign(Object.assign({},r),d)}};return yu.StackLayouter=o,o.KIND="stack",yu.StackLayouter=o=e([(0,n.injectable)()],o),yu}var _u={},oD;function Dm(){if(oD)return _u;oD=1;var e=_u&&_u.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(_u,"__esModule",{value:!0}),_u.ShapeView=void 0;const n=G(),t=at(),i=Ft();let a=class{isVisible(s,r){if(r.targetKind==="hidden"||!t.Dimension.isValid(s.bounds))return!0;const d=(0,i.getAbsoluteBounds)(s),l=s.root.canvasBounds;return d.x<=l.width&&d.x+d.width>=0&&d.y<=l.height&&d.y+d.height>=0}};return _u.ShapeView=a,_u.ShapeView=a=e([(0,n.injectable)()],a),_u}var Qi={},sD;function Om(){if(sD)return Qi;sD=1;var e=Qi&&Qi.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Qi&&Qi.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=Qi&&Qi.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.configureButtonHandler=Qi.ButtonHandlerRegistry=void 0;const i=G(),a=Ga(),o=Se(),s=Zd();let r=class extends a.InstanceRegistry{constructor(c){super(),c.forEach(u=>this.register(u.TYPE,u.factory()))}};Qi.ButtonHandlerRegistry=r,Qi.ButtonHandlerRegistry=r=e([(0,i.injectable)(),t(0,(0,i.multiInject)(o.TYPES.IButtonHandlerRegistration)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],r);function d(l,c,u){if(typeof u=="function"){if(!(0,s.isInjectable)(u))throw new Error(`Button handlers should be @injectable: ${u.name}`);l.isBound(u)||l.bind(u).toSelf()}l.bind(o.TYPES.IButtonHandlerRegistration).toDynamicValue(f=>({TYPE:c,factory:()=>f.container.get(u)}))}return Qi.configureButtonHandler=d,Qi}var up={},Ab={},aD;function rh(){return aD||(aD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isFadeable=e.fadeFeature=void 0,e.fadeFeature=Symbol("fadeFeature");function n(t){return t.hasFeature(e.fadeFeature)&&t.opacity!==void 0}e.isFadeable=n}(Ab)),Ab}var cD;function KC(){if(cD)return up;cD=1,Object.defineProperty(up,"__esModule",{value:!0}),up.SButtonImpl=void 0;const e=Ft(),n=rh();class t extends e.SShapeElementImpl{constructor(){super(...arguments),this.enabled=!0}}return up.SButtonImpl=t,t.DEFAULT_FEATURES=[e.boundsFeature,e.layoutableChildFeature,n.fadeFeature],up}var Ni={},wb={},uD;function qC(){return uD||(uD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.name=e.isNameable=e.nameFeature=void 0,e.nameFeature=Symbol("nameableFeature");function n(i){return i.hasFeature(e.nameFeature)}e.isNameable=n;function t(i){if(n(i))return i.name}e.name=t}(wb)),wb}var lD;function o_(){if(lD)return Ni;lD=1;var e=Ni&&Ni.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=Ni&&Ni.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},t=Ni&&Ni.__param||function(u,f){return function(h,p){f(h,p,u)}};Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.RevealNamedElementActionProvider=Ni.CommandPaletteActionProviderRegistry=void 0;const i=G(),a=lt(),o=PC(),s=Se(),r=Wd(),d=qC();let l=class{constructor(f=[]){this.actionProviders=f}getActions(f,h,p,g){const m=this.actionProviders.map(v=>v.getActions(f,h,p,g));return Promise.all(m).then(v=>v.reduce((_,S)=>S!==void 0?_.concat(S):_))}};Ni.CommandPaletteActionProviderRegistry=l,Ni.CommandPaletteActionProviderRegistry=l=e([(0,i.injectable)(),t(0,(0,i.multiInject)(s.TYPES.ICommandPaletteActionProvider)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],l);let c=class{constructor(f){this.logger=f}getActions(f,h,p,g){return g!==void 0&&g%2===0?Promise.resolve(this.createSelectActions(f)):Promise.resolve([new o.LabeledAction("Select all",[a.SelectAllAction.create()])])}createSelectActions(f){return(0,r.toArray)(f.index.all().filter(p=>(0,d.isNameable)(p))).map(p=>new o.LabeledAction(`Reveal ${(0,d.name)(p)}`,[a.SelectAction.create({selectedElementsIDs:[p.id]}),a.CenterAction.create([p.id])],"eye"))}};return Ni.RevealNamedElementActionProvider=c,Ni.RevealNamedElementActionProvider=c=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.ILogger)),n("design:paramtypes",[Object])],c),Ni}var Ji={},Ib={},dD;function HC(){return dD||(dD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.codiconCSSClasses=e.codiconCSSString=e.ANIMATION_SPIN=e.ACTION_ITEM=void 0,e.ACTION_ITEM="action-item",e.ANIMATION_SPIN="animation-spin";function n(i,a=!1,o=!1,s=[]){return t(i,a,o,s).join(" ")}e.codiconCSSString=n;function t(i,a=!1,o=!1,s=[]){const r=["codicon",`codicon-${i}`];return a&&r.push(e.ACTION_ITEM),o&&r.push(e.ANIMATION_SPIN),s.length>0&&r.push(...s),r}e.codiconCSSClasses=t}(Ib)),Ib}var Ol={},fD;function Ua(){if(fD)return Ol;fD=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.getActualCode=Ol.matchesKeystroke=void 0;const e=Ts();function n(a,o,...s){if(t(a)!==o)return!1;if((0,e.isMac)()){if(a.ctrlKey!==s.findIndex(r=>r==="ctrl")>=0||a.metaKey!==s.findIndex(r=>r==="meta"||r==="ctrlCmd")>=0)return!1}else if(a.ctrlKey!==s.findIndex(r=>r==="ctrl"||r==="ctrlCmd")>=0||a.metaKey!==s.findIndex(r=>r==="meta")>=0)return!1;return!(a.altKey!==s.findIndex(r=>r==="alt")>=0||a.shiftKey!==s.findIndex(r=>r==="shift")>=0)}Ol.matchesKeystroke=n;function t(a){if(a.keyCode){const o=i[a.keyCode];if(o!==void 0)return o}return a.code}Ol.getActualCode=t;const i=new Array(256);return(()=>{function a(o,s){i[s]===void 0&&(i[s]=o)}a("Pause",3),a("Backspace",8),a("Tab",9),a("Enter",13),a("ShiftLeft",16),a("ShiftRight",16),a("ControlLeft",17),a("ControlRight",17),a("AltLeft",18),a("AltRight",18),a("CapsLock",20),a("Escape",27),a("Space",32),a("PageUp",33),a("PageDown",34),a("End",35),a("Home",36),a("ArrowLeft",37),a("ArrowUp",38),a("ArrowRight",39),a("ArrowDown",40),a("Insert",45),a("Delete",46),a("Digit1",49),a("Digit2",50),a("Digit3",51),a("Digit4",52),a("Digit5",53),a("Digit6",54),a("Digit7",55),a("Digit8",56),a("Digit9",57),a("Digit0",48),a("KeyA",65),a("KeyB",66),a("KeyC",67),a("KeyD",68),a("KeyE",69),a("KeyF",70),a("KeyG",71),a("KeyH",72),a("KeyI",73),a("KeyJ",74),a("KeyK",75),a("KeyL",76),a("KeyM",77),a("KeyN",78),a("KeyO",79),a("KeyP",80),a("KeyQ",81),a("KeyR",82),a("KeyS",83),a("KeyT",84),a("KeyU",85),a("KeyV",86),a("KeyW",87),a("KeyX",88),a("KeyY",89),a("KeyZ",90),a("OSLeft",91),a("MetaLeft",91),a("OSRight",92),a("MetaRight",92),a("ContextMenu",93),a("Numpad0",96),a("Numpad1",97),a("Numpad2",98),a("Numpad3",99),a("Numpad4",100),a("Numpad5",101),a("Numpad6",102),a("Numpad7",103),a("Numpad8",104),a("Numpad9",105),a("NumpadMultiply",106),a("NumpadAdd",107),a("NumpadSeparator",108),a("NumpadSubtract",109),a("NumpadDecimal",110),a("NumpadDivide",111),a("F1",112),a("F2",113),a("F3",114),a("F4",115),a("F5",116),a("F6",117),a("F7",118),a("F8",119),a("F9",120),a("F10",121),a("F11",122),a("F12",123),a("F13",124),a("F14",125),a("F15",126),a("F16",127),a("F17",128),a("F18",129),a("F19",130),a("F20",131),a("F21",132),a("F22",133),a("F23",134),a("F24",135),a("NumLock",144),a("ScrollLock",145),a("Semicolon",186),a("Equal",187),a("Comma",188),a("Minus",189),a("Period",190),a("Slash",191),a("Backquote",192),a("IntlRo",193),a("BracketLeft",219),a("Backslash",220),a("BracketRight",221),a("Quote",222),a("IntlYen",255)})(),Ol}var Tb={},hD;function Sr(){return hD||(hD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isSelected=e.isSelectable=e.selectFeature=void 0,e.selectFeature=Symbol("selectFeature");function n(i){return i.hasFeature(e.selectFeature)}e.isSelectable=n;function t(i){return i!==void 0&&n(i)&&i.selected}e.isSelected=t}(Tb)),Tb}var sy={exports:{}},cU=sy.exports,pD;function v7(){return pD||(pD=1,function(e,n){(function(t,i){e.exports=i()})(cU,function(){function t(i){var a=document,o=i.container||a.createElement("div"),s=i.preventSubmit||0;o.id=o.id||"autocomplete-"+C();var r=o.style,d=i.debounceWaitMs||0,l=i.disableAutoSelect||!1,c=o.parentElement,u=[],f="",h=2,p=i.showOnFocus,g,m=0,v,_=!1,S=!1;if(i.minLength!==void 0&&(h=i.minLength),!i.input)throw new Error("input undefined");var E=i.input;o.className=[o.className,"autocomplete",i.className||""].join(" ").trim(),o.setAttribute("role","listbox"),E.setAttribute("role","combobox"),E.setAttribute("aria-expanded","false"),E.setAttribute("aria-autocomplete","list"),E.setAttribute("aria-controls",o.id),E.setAttribute("aria-owns",o.id),E.setAttribute("aria-activedescendant",""),E.setAttribute("aria-haspopup","listbox"),r.position="absolute";function C(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function M(){var he=o.parentNode;he&&he.removeChild(o)}function L(){v&&window.clearTimeout(v)}function I(){o.parentNode||(c||a.body).appendChild(o)}function R(){return!!o.parentNode}function w(){m++,u=[],f="",g=void 0,E.setAttribute("aria-activedescendant",""),E.setAttribute("aria-expanded","false"),M()}function T(){if(!R())return;E.setAttribute("aria-expanded","true"),r.height="auto",r.width=E.offsetWidth+"px";var he=0,Ke;function Kt(){var At=a.documentElement,cn=At.clientTop||a.body.clientTop||0,gn=At.clientLeft||a.body.clientLeft||0,Kn=window.pageYOffset||At.scrollTop,dt=window.pageXOffset||At.scrollLeft;Ke=E.getBoundingClientRect();var Lt=Ke.top+E.offsetHeight+Kn-cn,Gi=Ke.left+dt-gn;r.top=Lt+"px",r.left=Gi+"px",he=window.innerHeight-(Ke.top+E.offsetHeight),he<0&&(he=0),r.top=Lt+"px",r.bottom="",r.left=Gi+"px",r.maxHeight=he+"px"}Kt(),Kt(),i.customize&&Ke&&i.customize(E,Ke,o,he)}function j(){o.textContent="",E.setAttribute("aria-activedescendant","");var he=function(gn,Kn,dt){var Lt=a.createElement("div");return Lt.textContent=gn.label||"",Lt};i.render&&(he=i.render);var Ke=function(gn,Kn){var dt=a.createElement("div");return dt.textContent=gn,dt};i.renderGroup&&(Ke=i.renderGroup);var Kt=a.createDocumentFragment(),At=C();if(u.forEach(function(gn,Kn){if(gn.group&&gn.group!==At){At=gn.group;var dt=Ke(gn.group,f);dt&&(dt.className+=" group",Kt.appendChild(dt))}var Lt=he(gn,f,Kn);Lt&&(Lt.id=o.id+"_"+Kn,Lt.setAttribute("role","option"),Lt.addEventListener("click",function(Gi){S=!0;try{i.onSelect(gn,E)}finally{S=!1}w(),Gi.preventDefault(),Gi.stopPropagation()}),gn===g&&(Lt.className+=" selected",Lt.setAttribute("aria-selected","true"),E.setAttribute("aria-activedescendant",Lt.id)),Kt.appendChild(Lt))}),o.appendChild(Kt),u.length<1)if(i.emptyMsg){var cn=a.createElement("div");cn.id=o.id+"_"+C(),cn.className="empty",cn.textContent=i.emptyMsg,o.appendChild(cn),E.setAttribute("aria-activedescendant",cn.id)}else{w();return}I(),T(),K()}function D(){R()&&j()}function B(){D()}function H(he){he.target!==o?D():he.preventDefault()}function F(){S||ee(0)}function K(){var he=o.getElementsByClassName("selected");if(he.length>0){var Ke=he[0],Kt=Ke.previousElementSibling;if(Kt&&Kt.className.indexOf("group")!==-1&&!Kt.previousElementSibling&&(Ke=Kt),Ke.offsetTop<o.scrollTop)o.scrollTop=Ke.offsetTop;else{var At=Ke.offsetTop+Ke.offsetHeight,cn=o.scrollTop+o.offsetHeight;At>cn&&(o.scrollTop+=At-cn)}}}function U(){var he=u.indexOf(g);g=he===-1?void 0:u[(he+u.length-1)%u.length],ce(he)}function Z(){var he=u.indexOf(g);g=u.length<1?void 0:he===-1?u[0]:u[(he+1)%u.length],ce(he)}function ce(he){u.length>0&&(ke(he),de(u.indexOf(g)),K())}function de(he){var Ke=a.getElementById(o.id+"_"+he);Ke&&(Ke.classList.add("selected"),Ke.setAttribute("aria-selected","true"),E.setAttribute("aria-activedescendant",Ke.id))}function ke(he){var Ke=a.getElementById(o.id+"_"+he);Ke&&(Ke.classList.remove("selected"),Ke.removeAttribute("aria-selected"),E.removeAttribute("aria-activedescendant"))}function pe(he,Ke){var Kt=R();if(Ke==="Escape")w();else{if(!Kt||u.length<1)return;Ke==="ArrowUp"?U():Z()}he.preventDefault(),Kt&&he.stopPropagation()}function et(he){if(g){s===2&&he.preventDefault(),S=!0;try{i.onSelect(g,E)}finally{S=!1}w()}s===1&&he.preventDefault()}function ot(he){var Ke=he.key;switch(Ke){case"ArrowUp":case"ArrowDown":case"Escape":pe(he,Ke);break;case"Enter":et(he);break}}function Be(){p&&ee(1)}function ee(he){E.value.length>=h||he===1?(L(),v=window.setTimeout(function(){return ge(E.value,he,E.selectionStart||0)},he===0||he===2?d:0)):w()}function ge(he,Ke,Kt){if(!_){var At=++m;i.fetch(he,function(cn){m===At&&cn&&(u=cn,f=he,g=u.length<1||l?void 0:u[0],j())},Ke,Kt)}}function fe(he){if(i.keyup){i.keyup({event:he,fetch:function(){return ee(0)}});return}!R()&&he.key==="ArrowDown"&&ee(0)}function Ae(he){i.click&&i.click({event:he,fetch:function(){return ee(2)}})}function Le(){setTimeout(function(){a.activeElement!==E&&w()},200)}function Ge(){ge(E.value,3,E.selectionStart||0)}o.addEventListener("mousedown",function(he){he.stopPropagation(),he.preventDefault()}),o.addEventListener("focus",function(){return E.focus()}),M();function pn(){E.removeEventListener("focus",Be),E.removeEventListener("keyup",fe),E.removeEventListener("click",Ae),E.removeEventListener("keydown",ot),E.removeEventListener("input",F),E.removeEventListener("blur",Le),window.removeEventListener("resize",B),a.removeEventListener("scroll",H,!0),E.removeAttribute("role"),E.removeAttribute("aria-expanded"),E.removeAttribute("aria-autocomplete"),E.removeAttribute("aria-controls"),E.removeAttribute("aria-activedescendant"),E.removeAttribute("aria-owns"),E.removeAttribute("aria-haspopup"),L(),w(),_=!0}return E.addEventListener("keyup",fe),E.addEventListener("click",Ae),E.addEventListener("keydown",ot),E.addEventListener("input",F),E.addEventListener("blur",Le),E.addEventListener("focus",Be),window.addEventListener("resize",B),a.addEventListener("scroll",H,!0),{destroy:pn,fetch:Ge}}return t})}(sy)),sy.exports}var gD;function VC(){if(gD)return Ji;gD=1;var e=Ji&&Ji.__decorate||function(I,R,w,T){var j=arguments.length,D=j<3?R:T===null?T=Object.getOwnPropertyDescriptor(R,w):T,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(I,R,w,T);else for(var H=I.length-1;H>=0;H--)(B=I[H])&&(D=(j<3?B(D):j>3?B(R,w,D):B(R,w))||D);return j>3&&D&&Object.defineProperty(R,w,D),D},n=Ji&&Ji.__metadata||function(I,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,R)},t=Ji&&Ji.__importDefault||function(I){return I&&I.__esModule?I:{default:I}},i;Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.CommandPaletteKeyListener=Ji.CommandPalette=void 0;const a=G(),o=lt(),s=PC(),r=Se(),d=Xy(),l=Tm(),c=th(),u=za(),f=HC(),h=Wd(),p=Ua(),g=Ft(),m=Sr(),v=o_(),_=Wr(),S=t(v7());let E=i=class extends d.AbstractUIExtension{constructor(){super(...arguments),this.loadingIndicatorClasses=(0,f.codiconCSSClasses)("loading",!1,!0,["loading"]),this.xOffset=20,this.yOffset=20,this.defaultWidth=400,this.debounceWaitMs=100,this.noCommandsMsg="No commands available",this.paletteIndex=0}id(){return i.ID}containerClass(){return"command-palette"}show(R,...w){super.show(R,...w),this.paletteIndex=0,this.contextActions=void 0,this.inputElement.value="",this.autoCompleteResult=(0,S.default)(this.autocompleteSettings(R)),this.inputElement.focus()}initializeContents(R){R.style.position="absolute",this.inputElement=document.createElement("input"),this.inputElement.style.width="100%",this.inputElement.addEventListener("keydown",w=>this.hideIfEscapeEvent(w)),this.inputElement.addEventListener("keydown",w=>this.cylceIfInvokePaletteKey(w)),this.inputElement.onblur=()=>window.setTimeout(()=>this.hide(),200),R.appendChild(this.inputElement)}hideIfEscapeEvent(R){(0,p.matchesKeystroke)(R,"Escape")&&this.hide()}cylceIfInvokePaletteKey(R){i.isInvokePaletteKey(R)&&this.cycle()}cycle(){this.contextActions=void 0,this.paletteIndex++}onBeforeShow(R,w,...T){let j=this.xOffset,D=this.yOffset;const B=(0,h.toArray)(w.index.all().filter(H=>(0,m.isSelectable)(H)&&H.selected));if(B.length===1){const H=(0,g.getAbsoluteClientBounds)(B[0],this.domHelper,this.viewerOptions);j+=H.x+H.width,D+=H.y}else{const H=(0,g.getAbsoluteClientBounds)(w,this.domHelper,this.viewerOptions);j+=H.x,D+=H.y}R.style.left=`${j}px`,R.style.top=`${D}px`,R.style.width=`${this.defaultWidth}px`}autocompleteSettings(R){return{input:this.inputElement,emptyMsg:this.noCommandsMsg,className:"command-palette-suggestions",debounceWaitMs:this.debounceWaitMs,showOnFocus:!0,minLength:-1,fetch:(w,T)=>this.updateAutoCompleteActions(T,w,R),onSelect:w=>this.onSelect(w),render:(w,T)=>this.renderLabeledActionSuggestion(w,T),customize:(w,T,j,D)=>{this.customizeSuggestionContainer(j,T,D)}}}onSelect(R){this.executeAction(R),this.hide()}updateAutoCompleteActions(R,w,T){this.onLoading(),this.contextActions?(R(this.filterActions(w,this.contextActions)),this.onLoaded("success")):this.actionProviderRegistry.getActions(T,w,this.mousePositionTracker.lastPositionOnDiagram,this.paletteIndex).then(j=>{this.contextActions=j,R(this.filterActions(w,j)),this.onLoaded("success")}).catch(j=>{this.logger.error(this,"Failed to obtain actions from command palette action providers",j),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}onLoaded(R){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator)}renderLabeledActionSuggestion(R,w){const T=document.createElement("div"),j=M(w).split(" ").join("|"),D=new RegExp(j,"gi");return R.icon&&this.renderIcon(T,R.icon),w.length>0?T.innerHTML+=R.label.replace(D,B=>"<em>"+B+"</em>").replace(/ /g,"&nbsp;"):T.innerHTML+=R.label.replace(/ /g,"&nbsp;"),T}renderIcon(R,w){R.innerHTML+=`<span class="icon ${this.getCodicon(w)}"></span>`}getFontAwesomeIcon(R){return`fa fa-${R}`}getCodicon(R){return(0,f.codiconCSSString)(R)}filterActions(R,w){return(0,h.toArray)(w.filter(T=>{const j=T.label.toLowerCase();return R.split(" ").every(B=>j.indexOf(B.toLowerCase())!==-1)}))}customizeSuggestionContainer(R,w,T){R.style.position="fixed",this.containerElement&&this.containerElement.appendChild(R)}hide(){super.hide(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}executeAction(R){this.actionDispatcherProvider().then(w=>w.dispatchAll(C(R))).catch(w=>this.logger.error(this,"No action dispatcher available to execute command palette action",w))}};Ji.CommandPalette=E,E.ID="command-palette",E.isInvokePaletteKey=I=>(0,p.matchesKeystroke)(I,"Space","ctrl"),e([(0,a.inject)(r.TYPES.IActionDispatcherProvider),n("design:type",Function)],E.prototype,"actionDispatcherProvider",void 0),e([(0,a.inject)(r.TYPES.ICommandPaletteActionProviderRegistry),n("design:type",v.CommandPaletteActionProviderRegistry)],E.prototype,"actionProviderRegistry",void 0),e([(0,a.inject)(r.TYPES.ViewerOptions),n("design:type",Object)],E.prototype,"viewerOptions",void 0),e([(0,a.inject)(r.TYPES.DOMHelper),n("design:type",c.DOMHelper)],E.prototype,"domHelper",void 0),e([(0,a.inject)(_.MousePositionTracker),n("design:type",_.MousePositionTracker)],E.prototype,"mousePositionTracker",void 0),Ji.CommandPalette=E=i=e([(0,a.injectable)()],E);function C(I){return(0,s.isLabeledAction)(I)?I.actions:(0,o.isAction)(I)?[I]:[]}function M(I){return I.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}class L extends u.KeyListener{keyDown(R,w){if((0,p.matchesKeystroke)(w,"Escape"))return[l.SetUIExtensionVisibilityAction.create({extensionId:E.ID,visible:!1,contextElementsId:[]})];if(E.isInvokePaletteKey(w)){const T=(0,h.toArray)(R.index.all().filter(j=>(0,m.isSelectable)(j)&&j.selected).map(j=>j.id));return[l.SetUIExtensionVisibilityAction.create({extensionId:E.ID,visible:!0,contextElementsId:T})]}return[]}}return Ji.CommandPaletteKeyListener=L,Ji}var lp={},mD;function uU(){if(mD)return lp;mD=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.toAnchor=void 0;function e(n){return n instanceof HTMLElement?{x:n.offsetLeft,y:n.offsetTop}:n}return lp.toAnchor=e,lp}var Bi={},gc={},vD;function oh(){return vD||(vD=1,function(e){var n=gc&&gc.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},t=gc&&gc.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)},i=gc&&gc.__param||function(f,h){return function(p,g){h(p,g,f)}};Object.defineProperty(e,"__esModule",{value:!0}),e.DeleteElementCommand=e.ResolvedDelete=e.isDeletable=e.deletableFeature=void 0;const a=G(),o=lt(),s=sn(),r=ft(),d=Se();e.deletableFeature=Symbol("deletableFeature");function l(f){return f instanceof r.SChildElementImpl&&f.hasFeature(e.deletableFeature)}e.isDeletable=l;class c{}e.ResolvedDelete=c;let u=class extends s.Command{constructor(h){super(),this.action=h,this.resolvedDeletes=[]}execute(h){const p=h.root.index;for(const g of this.action.elementIds){const m=p.getById(g);m&&l(m)&&(this.resolvedDeletes.push({child:m,parent:m.parent}),m.parent.remove(m))}return h.root}undo(h){for(const p of this.resolvedDeletes)p.parent.add(p.child);return h.root}redo(h){for(const p of this.resolvedDeletes)p.parent.remove(p.child);return h.root}};e.DeleteElementCommand=u,u.KIND=o.DeleteElementAction.KIND,e.DeleteElementCommand=u=n([(0,a.injectable)(),i(0,(0,a.inject)(d.TYPES.Action)),t("design:paramtypes",[Object])],u)}(gc)),gc}var yD;function s_(){if(yD)return Bi;yD=1;var e=Bi&&Bi.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Bi&&Bi.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=Bi&&Bi.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.DeleteContextMenuItemProvider=Bi.ContextMenuProviderRegistry=void 0;const i=G(),a=Se(),o=oh(),s=Sr(),r=Yr();let d=class{constructor(u=[]){this.menuProviders=u}getItems(u,f){const h=this.menuProviders.map(p=>p.getItems(u,f));return Promise.all(h).then(this.flattenAndRestructure)}flattenAndRestructure(u){let f=u.reduce((p,g)=>g!==void 0?p.concat(g):p,[]);const h=f.filter(p=>p.parentId);for(const p of h)if(p.parentId){const g=p.parentId.split(".");let m,v=f;for(const _ of g)m=v.find(S=>_===S.id),m&&m.children&&(v=m.children);m&&(m.children?m.children.push(p):m.children=[p],f=f.filter(_=>_!==p))}return f}};Bi.ContextMenuProviderRegistry=d,Bi.ContextMenuProviderRegistry=d=e([(0,i.injectable)(),t(0,(0,i.multiInject)(a.TYPES.IContextMenuItemProvider)),t(0,(0,i.optional)()),n("design:paramtypes",[Array])],d);let l=class{getItems(u,f){const h=Array.from(u.index.all().filter(s.isSelected).filter(o.isDeletable));return Promise.resolve([{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[r.DeleteElementAction.create(h.map(p=>p.id))],isEnabled:()=>h.length>0}])}};return Bi.DeleteContextMenuItemProvider=l,Bi.DeleteContextMenuItemProvider=l=e([(0,i.injectable)()],l),Bi}var lo={},_D;function GC(){if(_D)return lo;_D=1;var e=lo&&lo.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=lo&&lo.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},t=lo&&lo.__param||function(u,f){return function(h,p){f(h,p,u)}};Object.defineProperty(lo,"__esModule",{value:!0}),lo.ContextMenuMouseListener=void 0;const i=G(),a=lt(),o=gi(),s=Se(),r=Wr(),d=Sr(),l=s_();let c=class extends r.MouseListener{constructor(f,h){super(),this.contextMenuService=f,this.menuProvider=h}contextMenu(f,h){return this.showContextMenu(f,h),[]}async showContextMenu(f,h){let p;try{p=await this.contextMenuService()}catch{return}let g=!1;const m=(0,o.findParentByFeature)(f,d.isSelectable);m&&(g=m.selected,m.selected=!0);const v=f.root,_={x:h.x,y:h.y};if(f.id===v.id||(0,d.isSelected)(m)){const S=await this.menuProvider.getItems(v,_),E=()=>{m&&(m.selected=g)};p.show(S,_,E)}else{if((0,d.isSelectable)(f)){const E={selectedElementsIDs:[f.id],deselectedElementsIDs:Array.from(v.index.all().filter(d.isSelected),C=>C.id)};await this.actionDispatcher.dispatch(a.SelectAction.create(E))}const S=await this.menuProvider.getItems(v,_);p.show(S,_)}}};return lo.ContextMenuMouseListener=c,e([(0,i.inject)(s.TYPES.IActionDispatcher),n("design:type",Object)],c.prototype,"actionDispatcher",void 0),lo.ContextMenuMouseListener=c=e([t(0,(0,i.inject)(s.TYPES.IContextMenuServiceProvider)),t(1,(0,i.inject)(s.TYPES.IContextMenuProviderRegistry)),n("design:paramtypes",[Function,l.ContextMenuProviderRegistry])],c),lo}var M1={},Zs={},ii={},Db={},Ob={},Lb={},bD;function Xd(){return bD||(bD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.hasPopupFeature=e.popupFeature=e.isHoverable=e.hoverFeedbackFeature=void 0,e.hoverFeedbackFeature=Symbol("hoverFeedbackFeature");function n(i){return i.hasFeature(e.hoverFeedbackFeature)}e.isHoverable=n,e.popupFeature=Symbol("popupFeature");function t(i){return i.hasFeature(e.popupFeature)}e.hasPopupFeature=t}(Lb)),Lb}var jb={},SD;function Wc(){return SD||(SD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isMoveable=e.isLocateable=e.moveFeature=void 0;const n=$c();e.moveFeature=Symbol("moveFeature");function t(a){return(0,n.hasOwnProperty)(a,"position")}e.isLocateable=t;function i(a){return a.hasFeature(e.moveFeature)&&t(a)}e.isMoveable=i}(jb)),jb}var ED;function on(){return ED||(ED=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.edgeInProgressTargetHandleID=e.edgeInProgressID=e.SDanglingAnchorImpl=e.SRoutingHandleImpl=e.SConnectableElementImpl=e.getRouteBounds=e.getAbsoluteRouteBounds=e.isConnectable=e.connectableFeature=e.SRoutableElementImpl=void 0;const n=at(),t=ft(),i=Ft(),a=oh(),o=Sr(),s=Xd(),r=Wc();class d extends t.SChildElementImpl{constructor(){super(...arguments),this.routingPoints=[]}get source(){return this.index.getById(this.sourceId)}get target(){return this.index.getById(this.targetId)}get bounds(){return this.routingPoints.reduce((m,v)=>n.Bounds.combine(m,{x:v.x,y:v.y,width:0,height:0}),n.Bounds.EMPTY)}}e.SRoutableElementImpl=d,e.connectableFeature=Symbol("connectableFeature");function l(g){return g.hasFeature(e.connectableFeature)&&g.canConnect}e.isConnectable=l;function c(g,m=g.routingPoints){let v=u(m),_=g;for(;_ instanceof t.SChildElementImpl;){const S=_.parent;v=S.localToParent(v),_=S}return v}e.getAbsoluteRouteBounds=c;function u(g){const m={x:NaN,y:NaN,width:0,height:0};for(const v of g)isNaN(m.x)?(m.x=v.x,m.y=v.y):(v.x<m.x?(m.width+=m.x-v.x,m.x=v.x):v.x>m.x+m.width&&(m.width=v.x-m.x),v.y<m.y?(m.height+=m.y-v.y,m.y=v.y):v.y>m.y+m.height&&(m.height=v.y-m.y));return m}e.getRouteBounds=u;class f extends i.SShapeElementImpl{constructor(){super(...arguments),this.strokeWidth=0}get anchorKind(){}get incomingEdges(){return this.index.all().filter(v=>v instanceof d).filter(v=>v.targetId===this.id)}get outgoingEdges(){return this.index.all().filter(v=>v instanceof d).filter(v=>v.sourceId===this.id)}canConnect(m,v){return!0}}e.SConnectableElementImpl=f;class h extends t.SChildElementImpl{constructor(){super(...arguments),this.editMode=!1,this.hoverFeedback=!1,this.selected=!1}hasFeature(m){return h.DEFAULT_FEATURES.indexOf(m)!==-1}}e.SRoutingHandleImpl=h,h.DEFAULT_FEATURES=[o.selectFeature,r.moveFeature,s.hoverFeedbackFeature];class p extends f{constructor(){super(),this.type="dangling-anchor",this.size={width:0,height:0}}}e.SDanglingAnchorImpl=p,p.DEFAULT_FEATURES=[a.deletableFeature],e.edgeInProgressID="edge-in-progress",e.edgeInProgressTargetHandleID=e.edgeInProgressID+"-target-anchor"}(Ob)),Ob}var CD;function sh(){return CD||(CD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_EDGE_PLACEMENT=e.EdgePlacement=e.checkEdgePlacement=e.isEdgeLayoutable=e.edgeLayoutFeature=void 0;const n=ft(),t=Ft(),i=on();e.edgeLayoutFeature=Symbol("edgeLayout");function a(r){return r instanceof n.SChildElementImpl&&r.parent instanceof i.SRoutableElementImpl&&(0,t.isBoundsAware)(r)&&r.hasFeature(e.edgeLayoutFeature)}e.isEdgeLayoutable=a;function o(r){return"edgePlacement"in r}e.checkEdgePlacement=o;class s extends Object{}e.EdgePlacement=s,e.DEFAULT_EDGE_PLACEMENT={rotate:!0,side:"top",position:.5,offset:7}}(Db)),Db}var Nb={},PD;function ah(){return PD||(PD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isWithEditableLabel=e.withEditLabelFeature=e.isEditableLabel=e.editLabelFeature=e.canEditRouting=e.editFeature=void 0;const n=on();e.editFeature=Symbol("editFeature");function t(o){return o instanceof n.SRoutableElementImpl&&o.hasFeature(e.editFeature)}e.canEditRouting=t,e.editLabelFeature=Symbol("editLabelFeature");function i(o){return"text"in o&&o.hasFeature(e.editLabelFeature)}e.isEditableLabel=i,e.withEditLabelFeature=Symbol("withEditLabelFeature");function a(o){return"editableLabel"in o&&o.hasFeature(e.withEditLabelFeature)}e.isWithEditableLabel=a}(Nb)),Nb}var dp={},Bb={},fs={},RD;function Zc(){if(RD)return fs;RD=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.limit=fs.intersection=fs.PointToPointLine=fs.Diamond=void 0;const e=Yr();class n{constructor(s){this.bounds=s}get topPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y}}get rightPoint(){return{x:this.bounds.x+this.bounds.width,y:this.bounds.y+this.bounds.height/2}}get bottomPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y+this.bounds.height}}get leftPoint(){return{x:this.bounds.x,y:this.bounds.y+this.bounds.height/2}}get topRightSideLine(){return new t(this.topPoint,this.rightPoint)}get topLeftSideLine(){return new t(this.topPoint,this.leftPoint)}get bottomRightSideLine(){return new t(this.bottomPoint,this.rightPoint)}get bottomLeftSideLine(){return new t(this.bottomPoint,this.leftPoint)}closestSideLine(s){const r=e.Bounds.center(this.bounds);return s.x>r.x?s.y>r.y?this.bottomRightSideLine:this.topRightSideLine:s.y>r.y?this.bottomLeftSideLine:this.topLeftSideLine}}fs.Diamond=n;class t{constructor(s,r){this.p1=s,this.p2=r}get a(){return this.p1.y-this.p2.y}get b(){return this.p2.x-this.p1.x}get c(){return this.p2.x*this.p1.y-this.p1.x*this.p2.y}get angle(){return Math.atan2(-this.a,this.b)}get slope(){if(this.b!==0)return this.a/this.b}get slopeOrMax(){return this.slope===void 0?Number.MAX_SAFE_INTEGER:this.slope}get direction(){const s=(0,e.toDegrees)(this.angle),r=s<0?360+s:s;if(r===90)return"south";if(r===0||r===360)return"east";if(r===270)return"north";if(r===180)return"west";if(r>0&&r<90)return"south-east";if(r>90&&r<180)return"south-west";if(r>180&&r<270)return"north-west";if(r>270&&r<360)return"north-east";throw new Error(`Cannot determine direction of line (${this.p1.x},${this.p1.y}) to (${this.p2.x},${this.p2.y})`)}intersection(s){if(this.hasIndistinctPoints(s))return;const r=this.p1.x,d=this.p1.y,l=this.p2.x,c=this.p2.y,u=s.p1.x,f=s.p1.y,h=s.p2.x,p=s.p2.y,g=(p-f)*(l-r)-(h-u)*(c-d);if(g===0)return;const m=(h-u)*(d-f)-(p-f)*(r-u),v=(l-r)*(d-f)-(c-d)*(r-u);if(m===0&&v===0)return;const _=m/g,S=v/g;if(_<0||_>1||S<0||S>1)return;const E=r+_*(l-r),C=d+_*(c-d);return{x:E,y:C}}hasIndistinctPoints(s){return e.Point.equals(this.p1,s.p1)||e.Point.equals(this.p1,s.p2)||e.Point.equals(this.p2,s.p1)||e.Point.equals(this.p2,s.p2)}}fs.PointToPointLine=t;function i(o,s){return{x:(o.c*s.b-s.c*o.b)/(o.a*s.b-s.a*o.b),y:(o.a*s.c-s.a*o.c)/(o.a*s.b-s.a*o.b)}}fs.intersection=i;function a(o,s){return o<s.min?s.min:o>s.max?s.max:o}return fs.limit=a,fs}var MD;function $a(){return MD||(MD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.limitViewport=e.isViewport=e.viewportFeature=void 0;const n=Yr(),t=ft(),i=Zc();e.viewportFeature=Symbol("viewportFeature");function a(s){return s instanceof t.SModelRootImpl&&s.hasFeature(e.viewportFeature)&&"zoom"in s&&"scroll"in s}e.isViewport=a;function o(s,r,d,l,c){r&&!n.Dimension.isValid(r)&&(r=void 0);let u=c?(0,i.limit)(s.zoom,c):s.zoom;if(r&&d){const p=r.width/(d.max-d.min);u<p&&(u=p)}if(r&&l){const p=r.height/(l.max-l.min);u<p&&(u=p)}let f;if(d){const p=d.min,g=r?d.max-r.width/u:d.max;f=(0,i.limit)(s.scroll.x,{min:p,max:g})}else f=s.scroll.x;let h;if(l){const p=l.min,g=r?l.max-r.height/u:l.max;h=(0,i.limit)(s.scroll.y,{min:p,max:g})}else h=s.scroll.y;return{scroll:{x:f,y:h},zoom:u}}e.limitViewport=o}(Bb)),Bb}var xb={},AD;function a_(){return AD||(AD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isExportable=e.exportFeature=void 0,e.exportFeature=Symbol("exportFeature");function n(t){return t.hasFeature(e.exportFeature)}e.isExportable=n}(xb)),xb}var wD;function c_(){if(wD)return dp;wD=1,Object.defineProperty(dp,"__esModule",{value:!0}),dp.ViewportRootElementImpl=void 0;const e=at(),n=ft(),t=$a(),i=a_();class a extends n.SModelRootImpl{constructor(s){super(s),this.scroll={x:0,y:0},this.zoom=1,this.position=e.Point.ORIGIN,this.size=e.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(s){this.position={x:s.x,y:s.y},this.size={width:s.width,height:s.height}}localToParent(s){const r={x:(s.x-this.scroll.x)*this.zoom,y:(s.y-this.scroll.y)*this.zoom,width:-1,height:-1};return(0,e.isBounds)(s)&&(r.width=s.width*this.zoom,r.height=s.height*this.zoom),r}parentToLocal(s){const r={x:s.x/this.zoom+this.scroll.x,y:s.y/this.zoom+this.scroll.y,width:-1,height:-1};return(0,e.isBounds)(s)&&e.Dimension.isValid(s)&&(r.width=s.width/this.zoom,r.height=s.height/this.zoom),r}}return dp.ViewportRootElementImpl=a,a.DEFAULT_FEATURES=[t.viewportFeature,i.exportFeature],dp}var ID;function ef(){if(ID)return ii;ID=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.SGraphIndex=ii.SCompartmentImpl=ii.SLabelImpl=ii.SEdgeImpl=ii.SPortImpl=ii.SNodeImpl=ii.SGraphImpl=void 0;const e=at(),n=ft(),t=Ft(),i=sh(),a=oh(),o=ah(),s=rh(),r=Xd(),d=Wc(),l=on(),c=Sr(),u=c_(),f=Wd();class h extends u.ViewportRootElementImpl{constructor(C=new S){super(C)}}ii.SGraphImpl=h;class p extends l.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}canConnect(C,M){return this.children.find(L=>L instanceof g)===void 0}get incomingEdges(){const C=this.index;return C instanceof S?C.getIncomingEdges(this):this.index.all().filter(L=>L instanceof m).filter(L=>L.targetId===this.id)}get outgoingEdges(){const C=this.index;return C instanceof S?C.getOutgoingEdges(this):this.index.all().filter(L=>L instanceof m).filter(L=>L.sourceId===this.id)}}ii.SNodeImpl=p,p.DEFAULT_FEATURES=[l.connectableFeature,a.deletableFeature,c.selectFeature,t.boundsFeature,d.moveFeature,t.layoutContainerFeature,s.fadeFeature,r.hoverFeedbackFeature,r.popupFeature];class g extends l.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}get incomingEdges(){const C=this.index;return C instanceof S?C.getIncomingEdges(this):super.incomingEdges.filter(M=>M instanceof m)}get outgoingEdges(){const C=this.index;return C instanceof S?C.getOutgoingEdges(this):super.outgoingEdges.filter(M=>M instanceof m)}}ii.SPortImpl=g,g.DEFAULT_FEATURES=[l.connectableFeature,c.selectFeature,t.boundsFeature,s.fadeFeature,r.hoverFeedbackFeature];class m extends l.SRoutableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}}ii.SEdgeImpl=m,m.DEFAULT_FEATURES=[o.editFeature,a.deletableFeature,c.selectFeature,s.fadeFeature,r.hoverFeedbackFeature];class v extends t.SShapeElementImpl{constructor(){super(...arguments),this.selected=!1,this.alignment=e.Point.ORIGIN,this.opacity=1}}ii.SLabelImpl=v,v.DEFAULT_FEATURES=[t.boundsFeature,t.alignFeature,t.layoutableChildFeature,i.edgeLayoutFeature,s.fadeFeature];class _ extends t.SShapeElementImpl{constructor(){super(...arguments),this.opacity=1}}ii.SCompartmentImpl=_,_.DEFAULT_FEATURES=[t.boundsFeature,t.layoutContainerFeature,t.layoutableChildFeature,s.fadeFeature];class S extends n.ModelIndexImpl{constructor(){super(...arguments),this.outgoing=new Map,this.incoming=new Map}add(C){if(super.add(C),C instanceof m){if(C.sourceId){const M=this.outgoing.get(C.sourceId);M===void 0?this.outgoing.set(C.sourceId,[C]):M.push(C)}if(C.targetId){const M=this.incoming.get(C.targetId);M===void 0?this.incoming.set(C.targetId,[C]):M.push(C)}}}remove(C){if(super.remove(C),C instanceof m){const M=this.outgoing.get(C.sourceId);if(M!==void 0){const I=M.indexOf(C);I>=0&&(M.length===1?this.outgoing.delete(C.sourceId):M.splice(I,1))}const L=this.incoming.get(C.targetId);if(L!==void 0){const I=L.indexOf(C);I>=0&&(L.length===1?this.incoming.delete(C.targetId):L.splice(I,1))}}}getAttachedElements(C){return new f.FluentIterableImpl(()=>({outgoing:this.outgoing.get(C.id),incoming:this.incoming.get(C.id),nextOutgoingIndex:0,nextIncomingIndex:0}),M=>{let L=M.nextOutgoingIndex;if(M.outgoing!==void 0&&L<M.outgoing.length)return M.nextOutgoingIndex=L+1,{done:!1,value:M.outgoing[L]};if(L=M.nextIncomingIndex,M.incoming!==void 0)for(;L<M.incoming.length;){const I=M.incoming[L];if(I.sourceId!==I.targetId)return M.nextIncomingIndex=L+1,{done:!1,value:I};L++}return{done:!0,value:void 0}})}getIncomingEdges(C){return this.incoming.get(C.id)||[]}getOutgoingEdges(C){return this.outgoing.get(C.id)||[]}}return ii.SGraphIndex=S,ii}var Xi={},Qs={},mc={},TD;function Qc(){return TD||(TD=1,function(e){var n=mc&&mc.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},t=mc&&mc.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)},i=mc&&mc.__param||function(d,l){return function(c,u){l(c,u,d)}};Object.defineProperty(e,"__esModule",{value:!0}),e.AnchorComputerRegistry=e.RECTANGULAR_ANCHOR_KIND=e.ELLIPTIC_ANCHOR_KIND=e.DIAMOND_ANCHOR_KIND=void 0;const a=G(),o=Se(),s=Ga();e.DIAMOND_ANCHOR_KIND="diamond",e.ELLIPTIC_ANCHOR_KIND="elliptic",e.RECTANGULAR_ANCHOR_KIND="rectangular";let r=class extends s.InstanceRegistry{constructor(l){super(),l.forEach(c=>this.register(c.kind,c))}get defaultAnchorKind(){return e.RECTANGULAR_ANCHOR_KIND}get(l,c){return super.get(`${l}:${c||this.defaultAnchorKind}`)}};e.AnchorComputerRegistry=r,e.AnchorComputerRegistry=r=n([(0,a.injectable)(),i(0,(0,a.multiInject)(o.TYPES.IAnchorComputer)),t("design:paramtypes",[Array])],r)}(mc)),mc}var er={},DD;function Lm(){if(DD)return er;DD=1;var e=er&&er.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=er&&er.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)};Object.defineProperty(er,"__esModule",{value:!0}),er.AbstractEdgeRouter=er.DefaultAnchors=er.Side=void 0;const t=G(),i=at(),a=gi(),o=on(),s=Qc(),r=on();var d;(function(u){u[u.RIGHT=0]="RIGHT",u[u.LEFT=1]="LEFT",u[u.TOP=2]="TOP",u[u.BOTTOM=3]="BOTTOM"})(d||(er.Side=d={}));class l{constructor(f,h,p){this.element=f,this.kind=p;const g=f.bounds;this.bounds=(0,a.translateBounds)(g,f.parent,h),this.left={x:this.bounds.x,y:this.bounds.y+.5*this.bounds.height,kind:p},this.right={x:this.bounds.x+this.bounds.width,y:this.bounds.y+.5*this.bounds.height,kind:p},this.top={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y,kind:p},this.bottom={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y+this.bounds.height,kind:p}}get(f){return this[d[f].toLowerCase()]}getNearestSide(f){const h=i.Point.euclideanDistance(f,this.left),p=i.Point.euclideanDistance(f,this.right),g=i.Point.euclideanDistance(f,this.top),m=i.Point.euclideanDistance(f,this.bottom);let v=d.LEFT,_=h;return p<_&&(_=p,v=d.RIGHT),g<_&&(_=g,v=d.TOP),m<_&&(_=m,v=d.BOTTOM),v}}er.DefaultAnchors=l;let c=class{findOrthogonalIntersection(f,h){const p=(S,E)=>{const C=i.Point.subtract(E,S),M=i.Point.subtract(h,S),L=i.Point.dotProduct(M,C)/i.Point.dotProduct(C,C);return L>=0&&L<=1?i.Point.linear(S,E,L):L<0?S:E},g=this.route(f);let m=g[0],v=0;for(let S=0;S<g.length-1;++S){const E=p(g[S],g[S+1]);i.Point.euclideanDistance(h,E)<i.Point.euclideanDistance(h,m)&&(m=E,v=S)}const _=i.Point.subtract(g[v+1],g[v]);return{point:m,derivative:_}}pointAt(f,h){const p=this.calculateSegment(f,h);if(!p)return;const{segmentStart:g,segmentEnd:m,lambda:v}=p;return i.Point.linear(g,m,v)}derivativeAt(f,h){const p=this.calculateSegment(f,h);if(!p)return;const{segmentStart:g,segmentEnd:m}=p;return{x:m.x-g.x,y:m.y-g.y}}calculateSegment(f,h){if(h<0||h>1)return;const p=this.route(f);if(p.length<2)return;const g=[];let m=0;for(let S=0;S<p.length-1;++S)g[S]=i.Point.euclideanDistance(p[S],p[S+1]),m+=g[S];let v=0;const _=h*m;for(let S=0;S<p.length-1;++S){const E=v+g[S];if(g[S]>1e-8&&E>=_){const C=Math.max(0,_-v)/g[S];return{segmentStart:p[S],segmentEnd:p[S+1],lambda:C}}v=E}return{segmentEnd:p.pop(),segmentStart:p.pop(),lambda:1}}addHandle(f,h,p,g){const m=new o.SRoutingHandleImpl;return m.kind=h,m.pointIndex=g,m.type=p,h==="target"&&f.id===o.edgeInProgressID&&(m.id=o.edgeInProgressTargetHandleID),f.add(m),m}getHandlePosition(f,h,p){switch(p.kind){case"source":return f.source instanceof o.SDanglingAnchorImpl?f.source.position:h[0];case"target":return f.target instanceof o.SDanglingAnchorImpl?f.target.position:h[h.length-1];default:const g=this.getInnerHandlePosition(f,h,p);if(g!==void 0)return g;if(p.pointIndex>=0&&p.pointIndex<f.routingPoints.length)return f.routingPoints[p.pointIndex]}}findRouteSegment(f,h,p){const g=_=>_.pointIndex!==void 0?_.pointIndex:_.kind==="target"?f.routingPoints.length:-2;let m,v;for(const _ of h){const S=g(_);S<=p&&(m===void 0||S>g(m))&&(m=_),S>p&&(v===void 0||S<g(v))&&(v=_)}return{start:m,end:v}}getTranslatedAnchor(f,h,p,g,m=0){const v=(0,a.translatePoint)(h,p,f.parent),_=this.getAnchorComputer(f),S=.5*f.strokeWidth,E=_.getAnchor(f,v,m+S);return(0,a.translatePoint)(E,f.parent,g.parent)}getAnchorComputer(f){return this.anchorRegistry.get(this.kind,f.anchorKind)}applyHandleMoves(f,h){const p=h.slice();h.forEach(g=>{const m=g.handle;if(m.kind==="source"&&!(f.source instanceof o.SDanglingAnchorImpl)){const v=new o.SDanglingAnchorImpl;v.id=f.id+"_dangling-source",v.original=f.source,v.position=g.toPosition,m.root.add(v),m.danglingAnchor=v,f.sourceId=v.id}else if(m.kind==="target"&&!(f.target instanceof o.SDanglingAnchorImpl)){const v=new o.SDanglingAnchorImpl;v.id=f.id+"_dangling-target",v.original=f.target,v.position=g.toPosition,m.root.add(v),m.danglingAnchor=v,f.targetId=v.id}m.danglingAnchor&&(m.danglingAnchor.position=g.toPosition,p.splice(p.indexOf(g),1))}),p.length>0&&this.applyInnerHandleMoves(f,p),this.cleanupRoutingPoints(f,f.routingPoints,!0,!0)}cleanupRoutingPoints(f,h,p,g){const m=new l(f.source,f.parent,"source"),v=new l(f.target,f.parent,"target");this.resetRoutingPointsOnReconnect(f,h,p,m,v)}resetRoutingPointsOnReconnect(f,h,p,g,m){if(h.length===0||f.source instanceof o.SDanglingAnchorImpl||f.target instanceof o.SDanglingAnchorImpl){const v=this.getOptions(f),_=this.calculateDefaultCorners(f,g,m,v);if(h.splice(0,h.length,..._),p){let S=-2;f.children.forEach(E=>{E instanceof o.SRoutingHandleImpl&&(E.kind==="target"?E.pointIndex=h.length:E.kind==="line"&&E.pointIndex>=h.length?f.remove(E):S=Math.max(E.pointIndex,S))});for(let E=S;E<h.length-1;++E)this.addHandle(f,"manhattan-50%","volatile-routing-point",E)}return!0}return!1}applyReconnect(f,h,p){let g=!1;if(h){const m=f.root.index.getById(h);m instanceof r.SConnectableElementImpl&&(f.sourceId=m.id,g=!0)}if(p){const m=f.root.index.getById(p);m instanceof r.SConnectableElementImpl&&(f.targetId=m.id,g=!0)}if(g){if(f.index.remove(f),f.id===o.edgeInProgressID){const m=E=>`${f.sourceId}_to_${f.targetId}_${E}`;let v=0,_=m(v);for(;f.index.getById(_)!==void 0;)_=m(++v);f.id=_;const S=f.children.find(E=>E.id===o.edgeInProgressTargetHandleID);S instanceof o.SRoutingHandleImpl&&(f.remove(S),S.danglingAnchor&&S.danglingAnchor.parent.remove(S.danglingAnchor))}f.index.add(f),this.getSelfEdgeIndex(f)>-1&&(f.routingPoints=[],this.cleanupRoutingPoints(f,f.routingPoints,!0,!0))}}takeSnapshot(f){return{routingPoints:f.routingPoints.slice(),routingHandles:f.children.filter(h=>h instanceof o.SRoutingHandleImpl).map(h=>h),routedPoints:this.route(f),router:this,source:f.source,target:f.target}}applySnapshot(f,h){f.routingPoints=h.routingPoints,f.removeAll(p=>p instanceof o.SRoutingHandleImpl),f.routerKind=h.router.kind,h.routingHandles.forEach(p=>f.add(p)),h.source&&(f.sourceId=h.source.id),h.target&&(f.targetId=h.target.id),f.root.index.remove(f),f.root.index.add(f)}calculateDefaultCorners(f,h,p,g){const m=this.getSelfEdgeIndex(f);if(m>=0){const v=g.standardDistance,_=g.selfEdgeOffset*Math.min(h.bounds.width,h.bounds.height);switch(m%4){case 0:return[{x:h.get(d.RIGHT).x+v,y:h.get(d.RIGHT).y+_},{x:h.get(d.RIGHT).x+v,y:h.get(d.BOTTOM).y+v},{x:h.get(d.BOTTOM).x+_,y:h.get(d.BOTTOM).y+v}];case 1:return[{x:h.get(d.BOTTOM).x-_,y:h.get(d.BOTTOM).y+v},{x:h.get(d.LEFT).x-v,y:h.get(d.BOTTOM).y+v},{x:h.get(d.LEFT).x-v,y:h.get(d.LEFT).y+_}];case 2:return[{x:h.get(d.LEFT).x-v,y:h.get(d.LEFT).y-_},{x:h.get(d.LEFT).x-v,y:h.get(d.TOP).y-v},{x:h.get(d.TOP).x-_,y:h.get(d.TOP).y-v}];case 3:return[{x:h.get(d.TOP).x+_,y:h.get(d.TOP).y-v},{x:h.get(d.RIGHT).x+v,y:h.get(d.TOP).y-v},{x:h.get(d.RIGHT).x+v,y:h.get(d.RIGHT).y-_}]}}return[]}getSelfEdgeIndex(f){return!f.source||f.source!==f.target?-1:f.source.outgoingEdges.filter(h=>h.target===f.source).indexOf(f)}commitRoute(f,h){const p=[];for(let g=1;g<h.length-1;++g)p.push({x:h[g].x,y:h[g].y});f.routingPoints=p}};return er.AbstractEdgeRouter=c,e([(0,t.inject)(s.AnchorComputerRegistry),n("design:type",s.AnchorComputerRegistry)],c.prototype,"anchorRegistry",void 0),er.AbstractEdgeRouter=c=e([(0,t.injectable)()],c),er}var OD;function jm(){if(OD)return Qs;OD=1;var e=Qs&&Qs.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Qs&&Qs.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t;Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.PolylineEdgeRouter=void 0;const i=G(),a=at(),o=on(),s=Qc(),r=Lm();let d=t=class extends r.AbstractEdgeRouter{get kind(){return t.KIND}getOptions(c){return{minimalPointDistance:2,removeAngleThreshold:.1,standardDistance:20,selfEdgeOffset:.25}}route(c){const u=c.source,f=c.target;if(u===void 0||f===void 0)return[];let h,p;const g=this.getOptions(c),m=c.routingPoints.length>0?c.routingPoints:[];this.cleanupRoutingPoints(c,m,!1,!1);const v=m!==void 0?m.length:0;if(v===0){const S=a.Bounds.center(f.bounds);h=this.getTranslatedAnchor(u,S,f.parent,c,c.sourceAnchorCorrection);const E=a.Bounds.center(u.bounds);p=this.getTranslatedAnchor(f,E,u.parent,c,c.targetAnchorCorrection)}else{const S=m[0];h=this.getTranslatedAnchor(u,S,c.parent,c,c.sourceAnchorCorrection);const E=m[v-1];p=this.getTranslatedAnchor(f,E,c.parent,c,c.targetAnchorCorrection)}const _=[];_.push({kind:"source",x:h.x,y:h.y});for(let S=0;S<v;S++){const E=m[S];(S>0&&S<v-1||S===0&&a.Point.maxDistance(h,E)>=g.minimalPointDistance+(c.sourceAnchorCorrection||0)||S===v-1&&a.Point.maxDistance(E,p)>=g.minimalPointDistance+(c.targetAnchorCorrection||0))&&_.push({kind:"linear",x:E.x,y:E.y,pointIndex:S})}return _.push({kind:"target",x:p.x,y:p.y}),this.filterEditModeHandles(_,c,g)}filterEditModeHandles(c,u,f){if(u.children.length===0)return c;let h=0;for(;h<c.length;){const p=c[h];if(p.pointIndex!==void 0){const g=u.children.find(m=>m instanceof o.SRoutingHandleImpl&&m.kind==="junction"&&m.pointIndex===p.pointIndex);if(g!==void 0&&g.editMode&&h>0&&h<c.length-1){const m=c[h-1],v=c[h+1],_={x:m.x-p.x,y:m.y-p.y},S={x:v.x-p.x,y:v.y-p.y},E=(0,a.angleBetweenPoints)(_,S);if(Math.abs(Math.PI-E)<f.removeAngleThreshold){c.splice(h,1);continue}}}h++}return c}createRoutingHandles(c){const u=c.routingPoints.length;this.addHandle(c,"source","routing-point",-2),this.addHandle(c,"line","volatile-routing-point",-1);for(let f=0;f<u;f++)this.addHandle(c,"junction","routing-point",f),this.addHandle(c,"line","volatile-routing-point",f);this.addHandle(c,"target","routing-point",u)}getInnerHandlePosition(c,u,f){if(f.kind==="line"){const{start:h,end:p}=this.findRouteSegment(c,u,f.pointIndex);if(h!==void 0&&p!==void 0)return(0,a.centerOfLine)(h,p)}}applyInnerHandleMoves(c,u){u.forEach(f=>{const h=f.handle,p=c.routingPoints;let g=h.pointIndex;h.kind==="line"&&(h.kind="junction",h.type="routing-point",p.splice(g+1,0,f.fromPosition||p[Math.max(g,0)]),c.children.forEach(m=>{m instanceof o.SRoutingHandleImpl&&(m===h||m.pointIndex>g)&&m.pointIndex++}),this.addHandle(c,"line","volatile-routing-point",g),g++,this.addHandle(c,"line","volatile-routing-point",g)),g>=0&&g<p.length&&(p[g]=f.toPosition)})}};return Qs.PolylineEdgeRouter=d,d.KIND="polyline",e([(0,i.inject)(s.AnchorComputerRegistry),n("design:type",s.AnchorComputerRegistry)],d.prototype,"anchorRegistry",void 0),Qs.PolylineEdgeRouter=d=t=e([(0,i.injectable)()],d),Qs}var LD;function Os(){if(LD)return Xi;LD=1;var e=Xi&&Xi.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=Xi&&Xi.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)},t=Xi&&Xi.__param||function(h,p){return function(g,m){p(g,m,h)}};Object.defineProperty(Xi,"__esModule",{value:!0}),Xi.EdgeRouting=Xi.EdgeRouterRegistry=void 0;const i=G(),a=ft(),o=Se(),s=ih(),r=Ga(),d=on(),l=jm();function c(h){return h.routeAll!==void 0}let u=class extends r.InstanceRegistry{constructor(p){super(),p.forEach(g=>this.register(g.kind,g))}get defaultKind(){return l.PolylineEdgeRouter.KIND}get(p){return super.get(p||this.defaultKind)}routeAllChildren(p){const g=this.doRouteAllChildren(p);for(const m of this.postProcessors)m.apply(g,p);return g}doRouteAllChildren(p){const g=new f,m=new Map,v=[p];for(;v.length>0;){const _=v.shift();for(const S of _.children){if(S instanceof d.SRoutableElementImpl){const E=S.routerKind||this.defaultKind;m.has(E)?m.get(E).push(S):m.set(E,[S])}S instanceof a.SParentElementImpl&&v.push(S)}}return m.forEach((_,S)=>{const E=this.get(S);if(c(E))g.setAll(E.routeAll(_,p));else for(const C of _)g.set(C.id,this.route(C))}),g}route(p,g){const m=(0,s.findArgValue)(g,"edgeRouting");if(m){const _=m.get(p.id);if(_)return _}return this.get(p.routerKind).route(p)}};Xi.EdgeRouterRegistry=u,e([(0,i.multiInject)(o.TYPES.IEdgeRoutePostprocessor),(0,i.optional)(),n("design:type",Array)],u.prototype,"postProcessors",void 0),Xi.EdgeRouterRegistry=u=e([(0,i.injectable)(),t(0,(0,i.multiInject)(o.TYPES.IEdgeRouter)),n("design:paramtypes",[Array])],u);class f{constructor(){this.routesMap=new Map}set(p,g){this.routesMap.set(p,g)}setAll(p){p.routes.forEach((g,m)=>this.set(m,g))}get(p){return this.routesMap.get(p)}get routes(){return this.routesMap}}return Xi.EdgeRouting=f,Xi}var jD;function zC(){if(jD)return Zs;jD=1;var e=Zs&&Zs.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=Zs&&Zs.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)};Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.EdgeLayoutPostprocessor=void 0;const t=G(),i=at(),a=ft(),o=zn(),s=ef(),r=Ft(),d=sh(),l=Os(),c=Se(),u=Wc();let f=class{decorate(p,g){var m,v,_,S;if((0,d.isEdgeLayoutable)(g)&&g.parent instanceof s.SEdgeImpl&&g.bounds!==i.Bounds.EMPTY){const E=g.bounds,C=(0,d.checkEdgePlacement)(g),M=this.getEdgePlacement(g),L=g.parent,I=Math.min(1,Math.max(0,M.position)),R=this.edgeRouterRegistry.get(L.routerKind),w=R.pointAt(L,I);let T="",j=R.derivativeAt(L,I);if(w)if(C){switch(M.moveMode){case"edge":const D=R.findOrthogonalIntersection(L,i.Point.add(w,E));D&&(j=D.derivative,T+=`translate(${D.point.x}, ${D.point.y})`);break;case"free":T+=`translate(${((m=w==null?void 0:w.x)!==null&&m!==void 0?m:0)+E.x}, ${((v=w==null?void 0:w.y)!==null&&v!==void 0?v:0)+E.y})`;break;case"none":T+=`translate(${w.x}, ${w.y})`;break;default:this.logger.error({},"No moveMode set for edge label. Skipping edge placement.");break}if(j){const D=(0,i.toDegrees)(Math.atan2(j.y,j.x));if(M.rotate){let B=D;Math.abs(D)>90&&(D<0?B+=180:D>0&&(B-=180)),T+=` rotate(${B})`;const H=this.getRotatedAlignment(g,M,B!==D);T+=` translate(${H.x}, ${H.y})`}else{const B=this.getAlignment(g,M,D);T+=` translate(${B.x}, ${B.y})`}}}else(0,u.isMoveable)(g)?T+=`translate(${((_=w==null?void 0:w.x)!==null&&_!==void 0?_:0)+E.x}, ${((S=w==null?void 0:w.y)!==null&&S!==void 0?S:0)+E.y})`:T+=`translate(${w.x}, ${w.y})`;(0,o.setAttr)(p,"transform",T)}return p}getRotatedAlignment(p,g,m){let v=(0,r.isAlignable)(p)?p.alignment.x:0,_=(0,r.isAlignable)(p)?p.alignment.y:0;const S=p.bounds;if(g.side==="on")return{x:v-.5*S.height,y:_-.5*S.height};if(m)switch(g.position<.3333333?v-=S.width+g.offset:g.position<.6666666?v-=.5*S.width:v+=g.offset,g.side){case"left":case"bottom":_-=g.offset+S.height;break;case"right":case"top":_+=g.offset}else switch(g.position<.3333333?v+=g.offset:g.position<.6666666?v-=.5*S.width:v-=S.width+g.offset,g.side){case"right":case"bottom":_+=-g.offset-S.height;break;case"left":case"top":_+=g.offset}return{x:v,y:_}}getEdgePlacement(p){let g=p;const m=[];for(;g!==void 0;){const _=g.edgePlacement;if(_!==void 0&&m.push(_),g instanceof a.SChildElementImpl)g=g.parent;else break}const v=m.reverse().reduce((_,S)=>Object.assign(Object.assign({},_),S),d.DEFAULT_EDGE_PLACEMENT);return v.moveMode||(v.moveMode=(0,u.isMoveable)(p)?"edge":"none"),v}getAlignment(p,g,m){const v=p.bounds,_=(0,r.isAlignable)(p)?p.alignment.x-v.width:0,S=(0,r.isAlignable)(p)?p.alignment.y-v.height:0;if(g.side==="on")return{x:_+.5*v.width,y:S+.5*v.height};const E=this.getQuadrant(m),C={x:g.offset,y:S+.5*v.height},M={x:g.offset,y:S+v.height+g.offset},L={x:-v.width-g.offset,y:S+v.height+g.offset},I={x:-v.width-g.offset,y:S+.5*v.height},R={x:-v.width-g.offset,y:S-g.offset},w={x:g.offset,y:S-g.offset};switch(g.side){case"left":switch(E.orientation){case"west":return i.Point.linear(M,L,E.position);case"north":return i.Point.linear(L,R,E.position);case"east":return i.Point.linear(R,w,E.position);case"south":return i.Point.linear(w,M,E.position)}break;case"right":switch(E.orientation){case"west":return i.Point.linear(R,w,E.position);case"north":return i.Point.linear(w,M,E.position);case"east":return i.Point.linear(M,L,E.position);case"south":return i.Point.linear(L,R,E.position)}break;case"top":switch(E.orientation){case"west":return i.Point.linear(R,w,E.position);case"north":return this.linearFlip(w,C,I,R,E.position);case"east":return i.Point.linear(R,w,E.position);case"south":return this.linearFlip(w,C,I,R,E.position)}break;case"bottom":switch(E.orientation){case"west":return i.Point.linear(M,L,E.position);case"north":return this.linearFlip(L,I,C,M,E.position);case"east":return i.Point.linear(M,L,E.position);case"south":return this.linearFlip(L,I,C,M,E.position)}break}return{x:0,y:0}}getQuadrant(p){return Math.abs(p)>135?{orientation:"west",position:(p>0?p-135:p+225)/90}:p<-45?{orientation:"north",position:(p+135)/90}:p<45?{orientation:"east",position:(p+45)/90}:{orientation:"south",position:(p-45)/90}}linearFlip(p,g,m,v,_){return _<.5?i.Point.linear(p,g,2*_):i.Point.linear(m,v,2*_-1)}postUpdate(){}};return Zs.EdgeLayoutPostprocessor=f,e([(0,t.inject)(l.EdgeRouterRegistry),n("design:type",l.EdgeRouterRegistry)],f.prototype,"edgeRouterRegistry",void 0),e([(0,t.inject)(c.TYPES.ILogger),n("design:type",Object)],f.prototype,"logger",void 0),Zs.EdgeLayoutPostprocessor=f=e([(0,t.injectable)()],f),Zs}var ND;function im(){if(ND)return M1;ND=1,Object.defineProperty(M1,"__esModule",{value:!0});const e=G(),n=Se(),t=zC(),i=new e.ContainerModule(a=>{a(t.EdgeLayoutPostprocessor).toSelf().inSingletonScope(),a(n.TYPES.IVNodePostprocessor).toService(t.EdgeLayoutPostprocessor),a(n.TYPES.HiddenVNodePostprocessor).toService(t.EdgeLayoutPostprocessor)});return M1.default=i,M1}var fo={},BD;function lU(){if(BD)return fo;BD=1;var e=fo&&fo.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=fo&&fo.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=fo&&fo.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(fo,"__esModule",{value:!0}),fo.CreateElementCommand=void 0;const i=G(),a=lt(),o=sn(),s=ft(),r=Se();let d=class extends o.Command{constructor(c){super(),this.action=c}execute(c){const u=c.root.index.getById(this.action.containerId);return u instanceof s.SParentElementImpl&&(this.container=u,this.newElement=c.modelFactory.createElement(this.action.elementSchema),this.container.add(this.newElement)),c.root}undo(c){return this.container.remove(this.newElement),c.root}redo(c){return this.container.add(this.newElement),c.root}};return fo.CreateElementCommand=d,d.KIND=a.CreateElementAction.KIND,fo.CreateElementCommand=d=e([(0,i.injectable)(),t(0,(0,i.inject)(r.TYPES.Action)),n("design:paramtypes",[Object])],d),fo}var Fb={},xD;function y7(){return xD||(xD=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isCreatingOnDrag=e.creatingOnDragFeature=void 0,e.creatingOnDragFeature=Symbol("creatingOnDragFeature");function n(t){return t.hasFeature(e.creatingOnDragFeature)&&t.createAction!==void 0}e.isCreatingOnDrag=n}(Fb)),Fb}var vc={},Rn={},FD;function UC(){if(FD)return Rn;FD=1;var e=Rn&&Rn.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.EmptyGroupView=Rn.DiamondNodeView=Rn.RectangularNodeView=Rn.CircularNodeView=Rn.SvgViewportView=void 0;const n=Ds(),t=ef(),i=Dm(),a=Zc(),o=G();let s=class{render(h,p,g){const m=`scale(${h.zoom}) translate(${-h.scroll.x},${-h.scroll.y})`;return(0,n.svg)("svg",null,(0,n.svg)("g",{transform:m},p.renderChildren(h)))}};Rn.SvgViewportView=s,Rn.SvgViewportView=s=e([(0,o.injectable)()],s);let r=class extends i.ShapeView{render(h,p,g){if(!this.isVisible(h,p))return;const m=this.getRadius(h);return(0,n.svg)("g",null,(0,n.svg)("circle",{"class-sprotty-node":h instanceof t.SNodeImpl,"class-sprotty-port":h instanceof t.SPortImpl,"class-mouseover":h.hoverFeedback,"class-selected":h.selected,r:m,cx:m,cy:m}),p.renderChildren(h))}getRadius(h){const p=Math.min(h.size.width,h.size.height);return p>0?p/2:0}};Rn.CircularNodeView=r,Rn.CircularNodeView=r=e([(0,o.injectable)()],r);let d=class extends i.ShapeView{render(h,p,g){if(this.isVisible(h,p))return(0,n.svg)("g",null,(0,n.svg)("rect",{"class-sprotty-node":h instanceof t.SNodeImpl,"class-sprotty-port":h instanceof t.SPortImpl,"class-mouseover":h.hoverFeedback,"class-selected":h.selected,x:"0",y:"0",width:Math.max(h.size.width,0),height:Math.max(h.size.height,0)}),p.renderChildren(h))}};Rn.RectangularNodeView=d,Rn.RectangularNodeView=d=e([(0,o.injectable)()],d);let l=class extends i.ShapeView{render(h,p,g){if(!this.isVisible(h,p))return;const m=new a.Diamond({height:Math.max(h.size.height,0),width:Math.max(h.size.width,0),x:0,y:0}),v=`${c(m.topPoint)} ${c(m.rightPoint)} ${c(m.bottomPoint)} ${c(m.leftPoint)}`;return(0,n.svg)("g",null,(0,n.svg)("polygon",{"class-sprotty-node":h instanceof t.SNodeImpl,"class-sprotty-port":h instanceof t.SPortImpl,"class-mouseover":h.hoverFeedback,"class-selected":h.selected,points:v}),p.renderChildren(h))}};Rn.DiamondNodeView=l,Rn.DiamondNodeView=l=e([(0,o.injectable)()],l);function c(f){return`${f.x},${f.y}`}let u=class{render(h,p){return(0,n.svg)("g",null)}};return Rn.EmptyGroupView=u,Rn.EmptyGroupView=u=e([(0,o.injectable)()],u),Rn}var Vt={},kD;function u_(){if(kD)return Vt;kD=1;var e=Vt&&Vt.__decorate||function(C,M,L,I){var R=arguments.length,w=R<3?M:I===null?I=Object.getOwnPropertyDescriptor(M,L):I,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(C,M,L,I);else for(var j=C.length-1;j>=0;j--)(T=C[j])&&(w=(R<3?T(w):R>3?T(M,L,w):T(M,L))||w);return R>3&&w&&Object.defineProperty(M,L,w),w},n=Vt&&Vt.__metadata||function(C,M){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,M)},t=Vt&&Vt.__param||function(C,M){return function(L,I){M(L,I,C)}};Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.getEditableLabel=Vt.EditLabelKeyListener=Vt.EditLabelMouseListener=Vt.ApplyLabelEditCommand=Vt.ResolvedLabelEdit=Vt.isApplyLabelEditAction=Vt.isEditLabelAction=Vt.EditLabelAction=void 0;const i=G(),a=lt(),o=sn(),s=Se(),r=Wr(),d=za(),l=Ua(),c=Sr(),u=Wd(),f=ah();var h;(function(C){C.KIND="EditLabel";function M(L){return{kind:C.KIND,labelId:L}}C.create=M})(h||(Vt.EditLabelAction=h={}));function p(C){return(0,a.isAction)(C)&&C.kind===h.KIND&&"labelId"in C}Vt.isEditLabelAction=p;function g(C){return(0,a.isAction)(C)&&C.kind===a.ApplyLabelEditAction.KIND&&"labelId"in C&&"text"in C}Vt.isApplyLabelEditAction=g;class m{}Vt.ResolvedLabelEdit=m;let v=class extends o.Command{constructor(M){super(),this.action=M}execute(M){const I=M.root.index.getById(this.action.labelId);return I&&(0,f.isEditableLabel)(I)&&(this.resolvedLabelEdit={label:I,oldLabel:I.text,newLabel:this.action.text},I.text=this.action.text),M.root}undo(M){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.oldLabel),M.root}redo(M){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.newLabel),M.root}};Vt.ApplyLabelEditCommand=v,v.KIND=a.ApplyLabelEditAction.KIND,Vt.ApplyLabelEditCommand=v=e([t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],v);class _ extends r.MouseListener{doubleClick(M,L){const I=E(M);return I?[h.create(I.id)]:[]}}Vt.EditLabelMouseListener=_;class S extends d.KeyListener{keyDown(M,L){if((0,l.matchesKeystroke)(L,"F2")){const I=(0,u.toArray)(M.index.all().filter(R=>(0,c.isSelectable)(R)&&R.selected)).map(E).filter(R=>R!==void 0);if(I.length===1)return[h.create(I[0].id)]}return[]}}Vt.EditLabelKeyListener=S;function E(C){if((0,f.isEditableLabel)(C))return C;if((0,f.isWithEditableLabel)(C)&&C.editableLabel)return C.editableLabel}return Vt.getEditableLabel=E,Vt}var Or={},tr={},Lr={},KD;function tf(){if(KD)return Lr;KD=1;var e=Lr&&Lr.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=Lr&&Lr.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)};Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.ComputedBoundsApplicator=Lr.ModelSource=void 0;const t=G(),i=lt(),a=Jd(),o=Se();let s=class{initialize(l){l.register(i.RequestModelAction.KIND,this),l.register(i.ExportSvgAction.KIND,this)}};Lr.ModelSource=s,e([(0,t.inject)(o.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),e([(0,t.inject)(o.TYPES.ViewerOptions),n("design:type",Object)],s.prototype,"viewerOptions",void 0),Lr.ModelSource=s=e([(0,t.injectable)()],s);let r=class{apply(l,c){const u=new a.SModelIndex;u.add(l);for(const f of c.bounds){const h=u.getById(f.elementId);h!==void 0&&this.applyBounds(h,f.newPosition,f.newSize)}if(c.alignments!==void 0)for(const f of c.alignments){const h=u.getById(f.elementId);h!==void 0&&this.applyAlignment(h,f.newAlignment)}return u}applyAlignment(l,c){const u=l;u.alignment={x:c.x,y:c.y}}applyBounds(l,c,u){const f=l;c&&(f.position=Object.assign({},c)),f.size=Object.assign({},u)}};return Lr.ComputedBoundsApplicator=r,Lr.ComputedBoundsApplicator=r=e([(0,t.injectable)()],r),Lr}var qD;function Nm(){if(qD)return tr;qD=1;var e=tr&&tr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=tr&&tr.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=tr&&tr.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(tr,"__esModule",{value:!0}),tr.CommitModelCommand=tr.CommitModelAction=void 0;const i=G(),a=sn(),o=Se(),s=tf();var r;(function(l){l.KIND="commitModel";function c(){return{kind:l.KIND}}l.create=c})(r||(tr.CommitModelAction=r={}));let d=class extends a.SystemCommand{constructor(c){super(),this.action=c}execute(c){return this.newModel=c.modelFactory.createSchema(c.root),this.doCommit(this.newModel,c.root,!0)}doCommit(c,u,f){const h=this.modelSource.commitModel(c);return h instanceof Promise?h.then(p=>(f&&(this.originalModel=p),u)):(f&&(this.originalModel=h),u)}undo(c){return this.doCommit(this.originalModel,c.root,!1)}redo(c){return this.doCommit(this.newModel,c.root,!1)}};return tr.CommitModelCommand=d,d.KIND=r.KIND,e([(0,i.inject)(o.TYPES.ModelSource),n("design:type",s.ModelSource)],d.prototype,"modelSource",void 0),tr.CommitModelCommand=d=e([(0,i.injectable)(),t(0,(0,i.inject)(o.TYPES.Action)),n("design:paramtypes",[Object])],d),tr}var hs={},HD;function l_(){if(HD)return hs;HD=1;var e=hs&&hs.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=hs&&hs.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)};Object.defineProperty(hs,"__esModule",{value:!0}),hs.ZoomMouseListener=hs.getZoom=void 0;const t=G(),i=lt(),a=at(),o=gi(),s=Se(),r=Wr(),d=Ts(),l=$a(),c=Zc();function u(h){let p=1;const g=(0,o.findParentByFeature)(h,l.isViewport);return g&&(p=g.zoom),p}hs.getZoom=u;class f extends r.MouseListener{wheel(p,g){const m=(0,o.findParentByFeature)(p,l.isViewport);if(!m)return[];const v=this.isScrollMode(g)?this.processScroll(m,g):this.processZoom(m,p,g);return v?[i.SetViewportAction.create(m.id,v,{animate:!1})]:[]}isScrollMode(p){return p.altKey}processScroll(p,g){return{scroll:{x:p.scroll.x+g.deltaX,y:p.scroll.y+g.deltaY},zoom:p.zoom}}processZoom(p,g,m){const v=this.getZoomFactor(m);if(v>1&&(0,a.almostEquals)(p.zoom,this.viewerOptions.zoomLimits.max)||v<1&&(0,a.almostEquals)(p.zoom,this.viewerOptions.zoomLimits.min))return;const _=(0,c.limit)(p.zoom*v,this.viewerOptions.zoomLimits),S=this.getViewportOffset(g.root,m),E=1/_-1/p.zoom;return{scroll:{x:p.scroll.x-E*S.x,y:p.scroll.y-E*S.y},zoom:_}}getViewportOffset(p,g){const m=p.canvasBounds,v=(0,d.getWindowScroll)();return{x:g.clientX+v.x-m.x,y:g.clientY+v.y-m.y}}getZoomFactor(p){return p.deltaMode===p.DOM_DELTA_PAGE?Math.exp(-p.deltaY*.5):p.deltaMode===p.DOM_DELTA_LINE?Math.exp(-p.deltaY*.05):Math.exp(-p.deltaY*.005)}}return hs.ZoomMouseListener=f,e([(0,t.inject)(s.TYPES.ViewerOptions),n("design:type",Object)],f.prototype,"viewerOptions",void 0),hs}var VD;function $C(){if(VD)return Or;VD=1;var e=Or&&Or.__decorate||function(E,C,M,L){var I=arguments.length,R=I<3?C:L===null?L=Object.getOwnPropertyDescriptor(C,M):L,w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(E,C,M,L);else for(var T=E.length-1;T>=0;T--)(w=E[T])&&(R=(I<3?w(R):I>3?w(C,M,R):w(C,M))||R);return I>3&&R&&Object.defineProperty(C,M,R),R},n=Or&&Or.__metadata||function(E,C){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(E,C)},t;Object.defineProperty(Or,"__esModule",{value:!0}),Or.EditLabelUI=Or.EditLabelActionHandler=void 0;const i=G(),a=lt(),o=Se(),s=Xy(),r=Tm(),d=th(),l=Nm(),c=Ua(),u=Ft(),f=l_(),h=u_(),p=ah();let g=class{handle(C){if((0,h.isEditLabelAction)(C))return r.SetUIExtensionVisibilityAction.create({extensionId:m.ID,visible:!0,contextElementsId:[C.labelId]})}};Or.EditLabelActionHandler=g,Or.EditLabelActionHandler=g=e([(0,i.injectable)()],g);let m=t=class extends s.AbstractUIExtension{constructor(){super(...arguments),this.validationTimeout=void 0,this.isActive=!1,this.blockApplyEditOnInvalidInput=!0,this.isCurrentLabelValid=!0}id(){return t.ID}containerClass(){return"label-edit"}get labelId(){return this.label?this.label.id:"unknown"}initializeContents(C){C.style.position="absolute",this.inputElement=document.createElement("input"),this.textAreaElement=document.createElement("textarea"),[this.inputElement,this.textAreaElement].forEach(M=>{M.onkeydown=L=>this.applyLabelEditOnEvent(L,"Enter"),this.configureAndAdd(M,C)})}configureAndAdd(C,M){C.style.visibility="hidden",C.style.position="absolute",C.style.top="0px",C.style.left="0px",C.addEventListener("keydown",L=>this.hideIfEscapeEvent(L)),C.addEventListener("keyup",L=>this.validateLabelIfContentChange(L,C.value)),C.addEventListener("blur",()=>window.setTimeout(()=>this.applyLabelEdit(),200)),M.appendChild(C)}get editControl(){return this.label&&this.label.isMultiLine?this.textAreaElement:this.inputElement}hideIfEscapeEvent(C){(0,c.matchesKeystroke)(C,"Escape")&&this.hide()}applyLabelEditOnEvent(C,M,...L){(0,c.matchesKeystroke)(C,M||"Enter",...L)&&(C.preventDefault(),this.applyLabelEdit())}validateLabelIfContentChange(C,M){(this.previousLabelContent===void 0||this.previousLabelContent!==M)&&(this.previousLabelContent=M,this.performLabelValidation(C,this.editControl.value))}async applyLabelEdit(){var C;if(this.isActive){if(((C=this.label)===null||C===void 0?void 0:C.text)===this.editControl.value){this.hide();return}if(this.blockApplyEditOnInvalidInput&&(await this.validateLabel(this.editControl.value)).severity==="error"){this.editControl.focus();return}this.actionDispatcherProvider().then(M=>M.dispatchAll([a.ApplyLabelEditAction.create(this.labelId,this.editControl.value),l.CommitModelAction.create()])).catch(M=>this.logger.error(this,"No action dispatcher available to execute apply label edit action",M)),this.hide()}}performLabelValidation(C,M){this.validationTimeout&&window.clearTimeout(this.validationTimeout),this.validationTimeout=window.setTimeout(()=>this.validateLabel(M),200)}async validateLabel(C){if(this.labelValidator&&this.label)try{const M=await this.labelValidator.validate(C,this.label);return this.isCurrentLabelValid=M.severity!=="error",this.showValidationResult(M),M}catch(M){this.logger.error(this,"Error validating edited label",M)}return this.isCurrentLabelValid=!0,{severity:"ok",message:void 0}}showValidationResult(C){this.clearValidationResult(),this.validationDecorator&&this.validationDecorator.decorate(this.editControl,C)}clearValidationResult(){this.validationDecorator&&this.validationDecorator.dispose(this.editControl)}show(C,...M){!v(M,C)||this.isActive||(super.show(C,...M),this.isActive=!0)}hide(){this.editControl.style.visibility="hidden",super.hide(),this.clearValidationResult(),this.isActive=!1,this.isCurrentLabelValid=!0,this.previousLabelContent=void 0,this.labelElement&&(this.labelElement.style.visibility="visible")}onBeforeShow(C,M,...L){this.label=_(L,M)[0],this.previousLabelContent=this.label.text,this.setPosition(C),this.applyTextContents(),this.applyFontStyling(),this.editControl.style.visibility="visible",this.editControl.focus()}setPosition(C){let M=0,L=0,I=100,R=20;if(this.label){const w=(0,f.getZoom)(this.label),T=(0,u.getAbsoluteClientBounds)(this.label,this.domHelper,this.viewerOptions);M=T.x+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.x:0)*w,L=T.y+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.y:0)*w,R=(this.label.editControlDimension?this.label.editControlDimension.height:R)*w,I=(this.label.editControlDimension?this.label.editControlDimension.width:I)*w}C.style.left=`${M}px`,C.style.top=`${L}px`,C.style.width=`${I}px`,this.editControl.style.width=`${I}px`,C.style.height=`${R}px`,this.editControl.style.height=`${R}px`}applyTextContents(){this.label&&(this.editControl.value=this.label.text,this.editControl instanceof HTMLTextAreaElement?(this.editControl.selectionStart=0,this.editControl.selectionEnd=0,this.editControl.scrollTop=0,this.editControl.scrollLeft=0):this.editControl.setSelectionRange(0,this.editControl.value.length))}applyFontStyling(){if(this.label&&(this.labelElement=document.getElementById(this.domHelper.createUniqueDOMElementId(this.label)),this.labelElement)){this.labelElement.style.visibility="hidden";const C=window.getComputedStyle(this.labelElement);this.editControl.style.font=C.font,this.editControl.style.fontStyle=C.fontStyle,this.editControl.style.fontFamily=C.fontFamily,this.editControl.style.fontSize=S(C.fontSize,(0,f.getZoom)(this.label)),this.editControl.style.fontWeight=C.fontWeight,this.editControl.style.lineHeight=C.lineHeight}}};Or.EditLabelUI=m,m.ID="editLabelUi",e([(0,i.inject)(o.TYPES.IActionDispatcherProvider),n("design:type",Function)],m.prototype,"actionDispatcherProvider",void 0),e([(0,i.inject)(o.TYPES.ViewerOptions),n("design:type",Object)],m.prototype,"viewerOptions",void 0),e([(0,i.inject)(o.TYPES.DOMHelper),n("design:type",d.DOMHelper)],m.prototype,"domHelper",void 0),e([(0,i.inject)(o.TYPES.IEditLabelValidator),(0,i.optional)(),n("design:type",Object)],m.prototype,"labelValidator",void 0),e([(0,i.inject)(o.TYPES.IEditLabelValidationDecorator),(0,i.optional)(),n("design:type",Object)],m.prototype,"validationDecorator",void 0),Or.EditLabelUI=m=t=e([(0,i.injectable)()],m);function v(E,C){return _(E,C).length===1}function _(E,C){return E.map(M=>C.index.getById(M)).filter(p.isEditableLabel)}function S(E,C){return E.replace(/\d+(\.\d+)?/,M=>String(Number.parseInt(M,10)*C))}return Or}var nr={},GD;function Bm(){if(GD)return nr;GD=1;var e=nr&&nr.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=nr&&nr.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)},t=nr&&nr.__param||function(f,h){return function(p,g){h(p,g,f)}};Object.defineProperty(nr,"__esModule",{value:!0}),nr.SwitchEditModeCommand=nr.SwitchEditModeAction=void 0;const i=G(),a=sn(),o=ft(),s=Se(),r=on(),d=Os(),l=ah();var c;(function(f){f.KIND="switchEditMode";function h(p){var g,m;return{kind:f.KIND,elementsToActivate:(g=p.elementsToActivate)!==null&&g!==void 0?g:[],elementsToDeactivate:(m=p.elementsToDeactivate)!==null&&m!==void 0?m:[]}}f.create=h})(c||(nr.SwitchEditModeAction=c={}));let u=class extends a.Command{constructor(h){super(),this.action=h,this.elementsToActivate=[],this.elementsToDeactivate=[],this.handlesToRemove=[]}execute(h){const p=h.root.index;return this.action.elementsToActivate.forEach(g=>{const m=p.getById(g);m!==void 0&&this.elementsToActivate.push(m)}),this.action.elementsToDeactivate.forEach(g=>{const m=p.getById(g);if(m!==void 0&&this.elementsToDeactivate.push(m),m instanceof r.SRoutingHandleImpl&&m.parent instanceof r.SRoutableElementImpl){const v=m.parent;this.shouldRemoveHandle(m,v)&&(this.handlesToRemove.push({handle:m,parent:v}),this.elementsToDeactivate.push(v),this.elementsToActivate.push(v))}}),this.doExecute(h)}doExecute(h){return this.handlesToRemove.forEach(p=>{p.point=p.parent.routingPoints.splice(p.handle.pointIndex,1)[0]}),this.elementsToDeactivate.forEach(p=>{p instanceof r.SRoutableElementImpl?p.removeAll(g=>g instanceof r.SRoutingHandleImpl):p instanceof r.SRoutingHandleImpl&&(p.editMode=!1,p.danglingAnchor&&p.parent instanceof r.SRoutableElementImpl&&p.danglingAnchor.original&&(p.parent.source===p.danglingAnchor?p.parent.sourceId=p.danglingAnchor.original.id:p.parent.target===p.danglingAnchor&&(p.parent.targetId=p.danglingAnchor.original.id),p.danglingAnchor.parent.remove(p.danglingAnchor),p.danglingAnchor=void 0))}),this.elementsToActivate.forEach(p=>{(0,l.canEditRouting)(p)&&p instanceof o.SParentElementImpl?this.edgeRouterRegistry.get(p.routerKind).createRoutingHandles(p):p instanceof r.SRoutingHandleImpl&&(p.editMode=!0)}),h.root}shouldRemoveHandle(h,p){return h.kind==="junction"?this.edgeRouterRegistry.route(p).find(m=>m.pointIndex===h.pointIndex)===void 0:!1}undo(h){return this.handlesToRemove.forEach(p=>{p.point!==void 0&&p.parent.routingPoints.splice(p.handle.pointIndex,0,p.point)}),this.elementsToActivate.forEach(p=>{p instanceof r.SRoutableElementImpl?p.removeAll(g=>g instanceof r.SRoutingHandleImpl):p instanceof r.SRoutingHandleImpl&&(p.editMode=!1)}),this.elementsToDeactivate.forEach(p=>{(0,l.canEditRouting)(p)?this.edgeRouterRegistry.get(p.routerKind).createRoutingHandles(p):p instanceof r.SRoutingHandleImpl&&(p.editMode=!0)}),h.root}redo(h){return this.doExecute(h)}};return nr.SwitchEditModeCommand=u,u.KIND=c.KIND,e([(0,i.inject)(d.EdgeRouterRegistry),n("design:type",d.EdgeRouterRegistry)],u.prototype,"edgeRouterRegistry",void 0),nr.SwitchEditModeCommand=u=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],u),nr}var ho={},zD;function YC(){if(zD)return ho;zD=1;var e=ho&&ho.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=ho&&ho.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=ho&&ho.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(ho,"__esModule",{value:!0}),ho.ReconnectCommand=void 0;const i=G(),a=lt(),o=sn(),s=Se(),r=on(),d=Os();let l=class extends o.Command{constructor(u){super(),this.action=u}execute(u){return this.doExecute(u),u.root}doExecute(u){const h=u.root.index.getById(this.action.routableId);if(h instanceof r.SRoutableElementImpl){const p=this.edgeRouterRegistry.get(h.routerKind),g=p.takeSnapshot(h);p.applyReconnect(h,this.action.newSourceId,this.action.newTargetId);const m=p.takeSnapshot(h);this.memento={edge:h,before:g,after:m}}}undo(u){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.before),u.root}redo(u){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.after),u.root}};return ho.ReconnectCommand=l,l.KIND=a.ReconnectAction.KIND,e([(0,i.inject)(d.EdgeRouterRegistry),n("design:type",d.EdgeRouterRegistry)],l.prototype,"edgeRouterRegistry",void 0),ho.ReconnectCommand=l=e([(0,i.injectable)(),t(0,(0,i.inject)(s.TYPES.Action)),n("design:paramtypes",[Object])],l),ho}var UD;function WC(){if(UD)return vc;UD=1,Object.defineProperty(vc,"__esModule",{value:!0}),vc.labelEditUiModule=vc.labelEditModule=vc.edgeEditModule=void 0;const e=G(),n=Se(),t=br(),i=wm(),a=ih(),o=on(),s=UC(),r=oh(),d=u_(),l=$C(),c=Bm(),u=YC();return vc.edgeEditModule=new e.ContainerModule((f,h,p)=>{const g={bind:f,isBound:p};(0,t.configureCommand)(g,c.SwitchEditModeCommand),(0,t.configureCommand)(g,u.ReconnectCommand),(0,t.configureCommand)(g,r.DeleteElementCommand),(0,a.configureModelElement)(g,"dangling-anchor",o.SDanglingAnchorImpl,s.EmptyGroupView)}),vc.labelEditModule=new e.ContainerModule((f,h,p)=>{f(d.EditLabelMouseListener).toSelf().inSingletonScope(),f(n.TYPES.MouseListener).toService(d.EditLabelMouseListener),f(d.EditLabelKeyListener).toSelf().inSingletonScope(),f(n.TYPES.KeyListener).toService(d.EditLabelKeyListener),(0,t.configureCommand)({bind:f,isBound:p},d.ApplyLabelEditCommand)}),vc.labelEditUiModule=new e.ContainerModule((f,h,p)=>{const g={bind:f,isBound:p};(0,i.configureActionHandler)(g,d.EditLabelAction.KIND,l.EditLabelActionHandler),f(l.EditLabelUI).toSelf().inSingletonScope(),f(n.TYPES.IUIExtension).toService(l.EditLabelUI)}),vc}var bu={},kb={},$D;function d_(){return $D||($D=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isExpandable=e.expandFeature=void 0,e.expandFeature=Symbol("expandFeature");function n(t){return t.hasFeature(e.expandFeature)&&"expanded"in t}e.isExpandable=n}(kb)),kb}var YD;function ZC(){if(YD)return bu;YD=1;var e=bu&&bu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(bu,"__esModule",{value:!0}),bu.ExpandButtonHandler=void 0;const n=G(),t=lt(),i=gi(),a=d_();let o=class{buttonPressed(r){const d=(0,i.findParentByFeature)(r,a.isExpandable);return d!==void 0?[t.CollapseExpandAction.create({expandIds:d.expanded?[]:[d.id],collapseIds:d.expanded?[d.id]:[]})]:[]}};return bu.ExpandButtonHandler=o,o.TYPE="button:expand",bu.ExpandButtonHandler=o=e([(0,n.injectable)()],o),bu}var Su={},WD;function _7(){if(WD)return Su;WD=1;var e=Su&&Su.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(Su,"__esModule",{value:!0}),Su.ExpandButtonView=void 0;const n=Ds(),t=d_(),i=gi(),a=G();let o=class{render(r,d){const l=(0,i.findParentByFeature)(r,t.isExpandable),c=l!==void 0&&l.expanded?"M 1,5 L 8,12 L 15,5 Z":"M 1,8 L 8,15 L 8,1 Z";return(0,n.svg)("g",{"class-sprotty-button":"{true}","class-enabled":"{button.enabled}"},(0,n.svg)("rect",{x:0,y:0,width:16,height:16,opacity:0}),(0,n.svg)("path",{d:c}))}};return Su.ExpandButtonView=o,Su.ExpandButtonView=o=e([(0,a.injectable)()],o),Su}var Mn={},po={},ZD;function f_(){if(ZD)return po;ZD=1;var e=po&&po.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=po&&po.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(po,"__esModule",{value:!0}),po.SvgExporter=po.ExportSvgAction=void 0;const t=G(),i=at(),a=Qy(),o=Se(),s=Ft();var r;(function(l){l.KIND="exportSvg";function c(u,f,h){return{kind:l.KIND,svg:u,responseId:f,options:h}}l.create=c})(r||(po.ExportSvgAction=r={}));let d=class{constructor(){this.postprocessors=[]}export(c,u){var f;if(typeof document<"u"){const h=document.getElementById(this.options.hiddenDiv);if(h===null){this.log.warn(this,`Element with id ${this.options.hiddenDiv} not found. Nothing to export.`);return}const p=h.querySelector("svg");if(p===null){this.log.warn(this,`No svg element found in ${this.options.hiddenDiv} div. Nothing to export.`);return}const g=this.createSvg(p,c,(f=u==null?void 0:u.options)!==null&&f!==void 0?f:{},u);this.actionDispatcher.dispatch(r.create(g,u?u.requestId:"",u==null?void 0:u.options))}}createSvg(c,u,f,h){const p=new XMLSerializer,g=p.serializeToString(c),m=document.createElement("iframe");if(document.body.appendChild(m),!m.contentWindow)throw new Error("IFrame has no contentWindow");const v=m.contentWindow.document;v.open(),v.write(g),v.close();const _=v.querySelector("svg");_.removeAttribute("opacity"),f!=null&&f.skipCopyStyles||this.copyStyles(c,_,["width","height","opacity","inline-size"]),_.setAttribute("version","1.1");const S=this.getBounds(u,v);_.setAttribute("viewBox",`${S.x} ${S.y} ${S.width} ${S.height}`),_.setAttribute("width",`${S.width}`),_.setAttribute("height",`${S.height}`),this.postprocessors.forEach(C=>{C.postUpdate(_,h)});const E=p.serializeToString(_);return document.body.removeChild(m),E}copyStyles(c,u,f){const h=getComputedStyle(c),p=getComputedStyle(u);let g="";for(let m=0;m<h.length;m++){const v=h[m];if(f.indexOf(v)===-1){const _=h.getPropertyValue(v);p.getPropertyValue(v)!==_&&(g+=v+":"+_+";")}}g!==""&&u.setAttribute("style",g);for(let m=0;m<c.childNodes.length;++m){const v=c.childNodes[m],_=u.childNodes[m];v instanceof Element&&this.copyStyles(v,_,[])}}getBounds(c,u){const f=u.querySelector("svg");if(f)return f.getBBox();const h=[i.Bounds.EMPTY];return c.children.forEach(p=>{(0,s.isBoundsAware)(p)&&h.push(p.bounds)}),h.reduce((p,g)=>i.Bounds.combine(p,g))}};return po.SvgExporter=d,e([(0,t.inject)(o.TYPES.ViewerOptions),n("design:type",Object)],d.prototype,"options",void 0),e([(0,t.inject)(o.TYPES.IActionDispatcher),n("design:type",a.ActionDispatcher)],d.prototype,"actionDispatcher",void 0),e([(0,t.inject)(o.TYPES.ILogger),n("design:type",Object)],d.prototype,"log",void 0),e([(0,t.multiInject)(o.TYPES.ISvgExportPostprocessor),(0,t.optional)(),n("design:type",Array)],d.prototype,"postprocessors",void 0),po.SvgExporter=d=e([(0,t.injectable)()],d),po}var QD;function QC(){if(QD)return Mn;QD=1;var e=Mn&&Mn.__decorate||function(S,E,C,M){var L=arguments.length,I=L<3?E:M===null?M=Object.getOwnPropertyDescriptor(E,C):M,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,E,C,M);else for(var w=S.length-1;w>=0;w--)(R=S[w])&&(I=(L<3?R(I):L>3?R(E,C,I):R(E,C))||I);return L>3&&I&&Object.defineProperty(E,C,I),I},n=Mn&&Mn.__metadata||function(S,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,E)},t=Mn&&Mn.__param||function(S,E){return function(C,M){E(C,M,S)}};Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.ExportSvgPostprocessor=Mn.ExportSvgCommand=Mn.RequestExportSvgAction=Mn.ExportSvgKeyListener=void 0;const i=G(),a=lt(),o=sn(),s=Sr(),r=ft(),d=za(),l=Ua(),c=a_(),u=f_(),f=$a(),h=Xd(),p=Se();let g=class extends d.KeyListener{keyDown(E,C){return(0,l.matchesKeystroke)(C,"KeyE","ctrlCmd","shift")?[m.create()]:[]}};Mn.ExportSvgKeyListener=g,Mn.ExportSvgKeyListener=g=e([(0,i.injectable)()],g);var m;(function(S){S.KIND="requestExportSvg";function E(C={}){return{kind:S.KIND,requestId:(0,a.generateRequestId)(),options:C}}S.create=E})(m||(Mn.RequestExportSvgAction=m={}));let v=class extends o.HiddenCommand{constructor(E){super(),this.action=E}execute(E){if((0,c.isExportable)(E.root)){const C=E.modelFactory.createRoot(E.root);if((0,c.isExportable)(C))return(0,f.isViewport)(C)&&(C.zoom=1,C.scroll={x:0,y:0}),C.index.all().forEach(M=>{(0,s.isSelectable)(M)&&M.selected&&(M.selected=!1),(0,h.isHoverable)(M)&&M.hoverFeedback&&(M.hoverFeedback=!1)}),{model:C,modelChanged:!0,cause:this.action}}return{model:E.root,modelChanged:!1}}};Mn.ExportSvgCommand=v,v.KIND=m.KIND,Mn.ExportSvgCommand=v=e([t(0,(0,i.inject)(p.TYPES.Action)),n("design:paramtypes",[Object])],v);let _=class{decorate(E,C){return C instanceof r.SModelRootImpl&&(this.root=C),E}postUpdate(E){this.root&&E!==void 0&&E.kind===m.KIND&&this.svgExporter.export(this.root,E)}};return Mn.ExportSvgPostprocessor=_,e([(0,i.inject)(p.TYPES.SvgExporter),n("design:type",u.SvgExporter)],_.prototype,"svgExporter",void 0),Mn.ExportSvgPostprocessor=_=e([(0,i.injectable)()],_),Mn}var Kb={},JD;function dU(){return JD||(JD=1,Object.defineProperty(Kb,"__esModule",{value:!0})),Kb}var Js={},XD;function h_(){if(XD)return Js;XD=1;var e=Js&&Js.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h};Object.defineProperty(Js,"__esModule",{value:!0}),Js.ElementFader=Js.FadeAnimation=void 0;const n=G(),t=Qd(),i=ft(),a=zn(),o=rh();class s extends t.Animation{constructor(l,c,u,f=!1){super(u),this.model=l,this.elementFades=c,this.removeAfterFadeOut=f}tween(l,c){for(const u of this.elementFades){const f=u.element;u.type==="in"?f.opacity=l:u.type==="out"&&(f.opacity=1-l,l===1&&this.removeAfterFadeOut&&f instanceof i.SChildElementImpl&&f.parent.remove(f))}return this.model}}Js.FadeAnimation=s;let r=class{decorate(l,c){return(0,o.isFadeable)(c)&&c.opacity!==1&&(0,a.setAttr)(l,"opacity",c.opacity),l}postUpdate(){}};return Js.ElementFader=r,Js.ElementFader=r=e([(0,n.injectable)()],r),Js}var Tt={},eO;function JC(){if(eO)return Tt;eO=1;var e=Tt&&Tt.__decorate||function(L,I,R,w){var T=arguments.length,j=T<3?I:w===null?w=Object.getOwnPropertyDescriptor(I,R):w,D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")j=Reflect.decorate(L,I,R,w);else for(var B=L.length-1;B>=0;B--)(D=L[B])&&(j=(T<3?D(j):T>3?D(I,R,j):D(I,R))||j);return T>3&&j&&Object.defineProperty(I,R,j),j},n=Tt&&Tt.__metadata||function(L,I){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(L,I)},t=Tt&&Tt.__param||function(L,I){return function(R,w){I(R,w,L)}};Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.ClosePopupActionHandler=Tt.HoverKeyListener=Tt.PopupHoverMouseListener=Tt.HoverMouseListener=Tt.AbstractHoverMouseListener=Tt.SetPopupModelCommand=Tt.HoverFeedbackCommand=void 0;const i=G(),a=lt(),o=at(),s=Ua(),r=Se(),d=ft(),l=Wr(),c=sn(),u=Yc(),f=za(),h=gi(),p=Ft(),g=Xd();let m=class extends c.SystemCommand{constructor(I){super(),this.action=I}execute(I){const w=I.root.index.getById(this.action.mouseoverElement);return w&&(0,g.isHoverable)(w)&&(w.hoverFeedback=this.action.mouseIsOver),this.redo(I)}undo(I){return I.root}redo(I){return I.root}};Tt.HoverFeedbackCommand=m,m.KIND=a.HoverFeedbackAction.KIND,Tt.HoverFeedbackCommand=m=e([(0,i.injectable)(),t(0,(0,i.inject)(r.TYPES.Action)),n("design:paramtypes",[Object])],m);let v=class extends c.PopupCommand{constructor(I){super(),this.action=I}execute(I){return this.oldRoot=I.root,this.newRoot=I.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(I){return this.oldRoot}redo(I){return this.newRoot}};Tt.SetPopupModelCommand=v,v.KIND=a.SetPopupModelAction.KIND,Tt.SetPopupModelCommand=v=e([(0,i.injectable)(),t(0,(0,i.inject)(r.TYPES.Action)),n("design:paramtypes",[Object])],v);class _ extends l.MouseListener{mouseDown(I,R){return this.mouseIsDown=!0,[]}mouseUp(I,R){return this.mouseIsDown=!1,[]}stopMouseOutTimer(){this.state.mouseOutTimer!==void 0&&(window.clearTimeout(this.state.mouseOutTimer),this.state.mouseOutTimer=void 0)}startMouseOutTimer(){return this.stopMouseOutTimer(),new Promise(I=>{this.state.mouseOutTimer=window.setTimeout(()=>{this.state.popupOpen=!1,this.state.previousPopupElement=void 0,I(a.SetPopupModelAction.create({type:u.EMPTY_ROOT.type,id:u.EMPTY_ROOT.id}))},this.options.popupCloseDelay)})}stopMouseOverTimer(){this.state.mouseOverTimer!==void 0&&(window.clearTimeout(this.state.mouseOverTimer),this.state.mouseOverTimer=void 0)}}Tt.AbstractHoverMouseListener=_,e([(0,i.inject)(r.TYPES.ViewerOptions),n("design:type",Object)],_.prototype,"options",void 0),e([(0,i.inject)(r.TYPES.HoverState),n("design:type",Object)],_.prototype,"state",void 0);let S=class extends _{computePopupBounds(I,R){let w={x:-5,y:20};const T=(0,p.getAbsoluteBounds)(I),j=I.root.canvasBounds,D=o.Bounds.translate(T,j),B=D.x+D.width-R.x,H=D.y+D.height-R.y;H<=B&&this.allowSidePosition(I,"below",H)?w={x:-5,y:Math.round(H+5)}:B<=H&&this.allowSidePosition(I,"right",B)&&(w={x:Math.round(B+5),y:-5});let F=R.x+w.x;const K=j.x+j.width;F>K&&(F=K);let U=R.y+w.y;const Z=j.y+j.height;return U>Z&&(U=Z),{x:F,y:U,width:-1,height:-1}}allowSidePosition(I,R,w){return!(I instanceof d.SModelRootImpl)&&w<=150}startMouseOverTimer(I,R){return this.stopMouseOverTimer(),new Promise(w=>{this.state.mouseOverTimer=window.setTimeout(()=>{const T=this.computePopupBounds(I,{x:R.pageX,y:R.pageY});w(a.RequestPopupModelAction.create({elementId:I.id,bounds:T})),this.state.popupOpen=!0,this.state.previousPopupElement=I},this.options.popupOpenDelay)})}mouseOver(I,R){const w=[];if(!this.mouseIsDown){const T=(0,h.findParent)(I,g.hasPopupFeature);this.state.popupOpen&&(T===void 0||this.state.previousPopupElement!==void 0&&this.state.previousPopupElement.id!==T.id)?w.push(this.startMouseOutTimer()):(this.stopMouseOverTimer(),this.stopMouseOutTimer()),T!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==T.id)&&w.push(this.startMouseOverTimer(T,R)),this.lastHoverFeedbackElementId&&(w.push(a.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0);const j=(0,h.findParentByFeature)(I,g.isHoverable);j!==void 0&&(w.push(a.HoverFeedbackAction.create({mouseoverElement:j.id,mouseIsOver:!0})),this.lastHoverFeedbackElementId=j.id)}return w}mouseOut(I,R){const w=[];if(!this.mouseIsDown){const T=this.getElementFromEventPosition(R);if(!this.isSprottyPopup(T)){if(this.state.popupOpen){const D=(0,h.findParent)(I,g.hasPopupFeature);this.state.previousPopupElement!==void 0&&D!==void 0&&this.state.previousPopupElement.id===D.id&&w.push(this.startMouseOutTimer())}this.stopMouseOverTimer();const j=(0,h.findParentByFeature)(I,g.isHoverable);j!==void 0&&(w.push(a.HoverFeedbackAction.create({mouseoverElement:j.id,mouseIsOver:!1})),this.lastHoverFeedbackElementId&&this.lastHoverFeedbackElementId!==j.id&&w.push(a.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0)}}return w}getElementFromEventPosition(I){return document.elementFromPoint(I.x,I.y)}isSprottyPopup(I){return I?I.id===this.options.popupDiv||!!I.parentElement&&this.isSprottyPopup(I.parentElement):!1}mouseMove(I,R){const w=[];if(!this.mouseIsDown){this.state.previousPopupElement!==void 0&&this.closeOnMouseMove(this.state.previousPopupElement,R)&&w.push(this.startMouseOutTimer());const T=(0,h.findParent)(I,g.hasPopupFeature);T!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==T.id)&&w.push(this.startMouseOverTimer(T,R))}return w}closeOnMouseMove(I,R){return I instanceof d.SModelRootImpl}};Tt.HoverMouseListener=S,e([(0,i.inject)(r.TYPES.ViewerOptions),n("design:type",Object)],S.prototype,"options",void 0),Tt.HoverMouseListener=S=e([(0,i.injectable)()],S);let E=class extends _{mouseOut(I,R){return[this.startMouseOutTimer()]}mouseOver(I,R){return this.stopMouseOutTimer(),this.stopMouseOverTimer(),[]}};Tt.PopupHoverMouseListener=E,Tt.PopupHoverMouseListener=E=e([(0,i.injectable)()],E);class C extends f.KeyListener{keyDown(I,R){return(0,s.matchesKeystroke)(R,"Escape")?[a.SetPopupModelAction.create({type:u.EMPTY_ROOT.type,id:u.EMPTY_ROOT.id})]:[]}}Tt.HoverKeyListener=C;let M=class{constructor(){this.popupOpen=!1}handle(I){if(I.kind===v.KIND)this.popupOpen=I.newRoot.type!==u.EMPTY_ROOT.type;else if(this.popupOpen)return a.SetPopupModelAction.create({id:u.EMPTY_ROOT.id,type:u.EMPTY_ROOT.type})}};return Tt.ClosePopupActionHandler=M,Tt.ClosePopupActionHandler=M=e([(0,i.injectable)()],M),Tt}var qb={},tO;function p_(){return tO||(tO=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SIssue=e.SIssueMarker=e.SIssueMarkerImpl=e.SDecoration=e.isDecoration=e.decorationFeature=void 0;const n=Ft(),t=Xd();e.decorationFeature=Symbol("decorationFeature");function i(r){return r.hasFeature(e.decorationFeature)}e.isDecoration=i;class a extends n.SShapeElementImpl{}e.SDecoration=a,a.DEFAULT_FEATURES=[e.decorationFeature,n.boundsFeature,t.hoverFeedbackFeature,t.popupFeature];class o extends a{}e.SIssueMarkerImpl=o,e.SIssueMarker=o;class s{}e.SIssue=s}(qb)),qb}var Eu={},nO;function XC(){if(nO)return Eu;nO=1;var e=Eu&&Eu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Eu,"__esModule",{value:!0}),Eu.IssueMarkerView=void 0;const n=Ds(),t=zn(),i=G();let a=class{render(s,r){const d=.008928571428571428,l=`scale(${d}, ${d})`,c=this.getMaxSeverity(s),u=(0,n.svg)("g",{"class-sprotty-issue":!0},(0,n.svg)("g",{transform:l},(0,n.svg)("path",{d:this.getPath(c)})));return(0,t.setClass)(u,"sprotty-"+c,!0),u}getMaxSeverity(s){let r="info";for(const d of s.issues.map(l=>l.severity))(d==="error"||d==="warning"&&r==="info")&&(r=d);return r}getPath(s){switch(s){case"error":case"warning":return"M768 128q209 0 385.5 103t279.5 279.5 103 385.5-103 385.5-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103zm128 1247v-190q0-14-9-23.5t-22-9.5h-192q-13 0-23 10t-10 23v190q0 13 10 23t23 10h192q13 0 22-9.5t9-23.5zm-2-344l18-621q0-12-10-18-10-8-24-8h-220q-14 0-24 8-10 6-10 18l17 621q0 10 10 17.5t24 7.5h185q14 0 23.5-7.5t10.5-17.5z";case"info":return"M1024 1376v-160q0-14-9-23t-23-9h-96v-512q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v160q0 14 9 23t23 9h96v320h-96q-14 0-23 9t-9 23v160q0 14 9 23t23 9h448q14 0 23-9t9-23zm-128-896v-160q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v160q0 14 9 23t23 9h192q14 0 23-9t9-23zm640 416q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}}};return Eu.IssueMarkerView=a,Eu.IssueMarkerView=a=e([(0,i.injectable)()],a),Eu}var Xs={},iO;function eP(){if(iO)return Xs;iO=1;var e=Xs&&Xs.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=Xs&&Xs.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)};Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.DecorationPlacer=void 0;const t=G(),i=ft(),a=p_(),o=zn(),s=Ft(),r=on(),d=Os(),l=Yr();let c=class{decorate(f,h){if((0,a.isDecoration)(h)){const p=this.getPosition(h),g="translate("+p.x+", "+p.y+")";(0,o.setAttr)(f,"transform",g)}return f}getPosition(f){if(f instanceof i.SChildElementImpl&&f.parent instanceof r.SRoutableElementImpl){const h=this.edgeRouterRegistry.route(f.parent);if(h.length>1){const p=Math.floor(.5*(h.length-1)),g=(0,s.isSizeable)(f)?{x:-.5*f.bounds.width,y:-.5*f.bounds.width}:l.Point.ORIGIN;return{x:.5*(h[p].x+h[p+1].x)+g.x,y:.5*(h[p].y+h[p+1].y)+g.y}}}return(0,s.isSizeable)(f)?{x:-.666*f.bounds.width,y:-.666*f.bounds.height}:l.Point.ORIGIN}postUpdate(){}};return Xs.DecorationPlacer=c,e([(0,t.inject)(d.EdgeRouterRegistry),n("design:type",d.EdgeRouterRegistry)],c.prototype,"edgeRouterRegistry",void 0),Xs.DecorationPlacer=c=e([(0,t.injectable)()],c),Xs}var An={};class fU{constructor(n=[],t=hU){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:i}=this,a=t[n];for(;n>0;){const o=n-1>>1,s=t[o];if(i(a,s)>=0)break;t[n]=s,n=o}t[n]=a}_down(n){const{data:t,compare:i}=this,a=this.length>>1,o=t[n];for(;n<a;){let s=(n<<1)+1,r=t[s];const d=s+1;if(d<this.length&&i(t[d],r)<0&&(s=d,r=t[d]),i(r,o)>=0)break;t[n]=r,n=s}t[n]=o}}function hU(e,n){return e<n?-1:e>n?1:0}const pU=Object.freeze(Object.defineProperty({__proto__:null,default:fU},Symbol.toStringTag,{value:"Module"})),b7=G8(pU);var _n={},rO;function tP(){if(rO)return _n;rO=1;var e=_n&&_n.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(_n,"__esModule",{value:!0}),_n.intersectionOfSegments=_n.getSegmentIndex=_n.checkWhichSegmentHasRightEndpointFirst=_n.runSweep=_n.Segment=_n.SweepEvent=_n.checkWhichEventIsLeft=_n.addRoute=void 0;const n=e(b7),t=Zc();function i(u,f,h){if(f.length<1)return;let p=f[0],g;for(let m=0;m<f.length-1;m++){g=f[m+1];const v=new o(u,p,m),_=new o(u,g,m+1);v.otherEvent=_,_.otherEvent=v,a(v,_)>0?(_.isLeftEndpoint=!0,v.isLeftEndpoint=!1):(v.isLeftEndpoint=!0,_.isLeftEndpoint=!1),h.push(v),h.push(_),p=g}}_n.addRoute=i;function a(u,f){return u.point.x>f.point.x?1:u.point.x<f.point.x?-1:u.point.y!==f.point.y?u.point.y>f.point.y?1:-1:1}_n.checkWhichEventIsLeft=a;class o{constructor(f,h,p){this.edgeId=f,this.point=h,this.segmentIndex=p}}_n.SweepEvent=o;class s{constructor(f){this.leftSweepEvent=f,this.rightSweepEvent=f.otherEvent}}_n.Segment=s;function r(u){const f=[],h=new n.default([],d);for(;u.length;){const p=u.pop();if(p!=null&&p.isLeftEndpoint){const g=new s(p);for(let m=0;m<h.data.length;m++){const v=h.data[m],_=c(g,v);_&&f.push({routable1:p.edgeId,routable2:v.leftSweepEvent.edgeId,segmentIndex1:l(g),segmentIndex2:l(v),intersectionPoint:_})}h.push(g)}else(p==null?void 0:p.isLeftEndpoint)===!1&&h.pop()}return f}_n.runSweep=r;function d(u,f){return u.rightSweepEvent.point.x>f.rightSweepEvent.point.x?1:u.rightSweepEvent.point.x<f.rightSweepEvent.point.x?-1:u.rightSweepEvent.point.y!==f.rightSweepEvent.point.y?u.rightSweepEvent.point.y<f.rightSweepEvent.point.y?1:-1:1}_n.checkWhichSegmentHasRightEndpointFirst=d;function l(u){return Math.min(u.leftSweepEvent.segmentIndex,u.rightSweepEvent.segmentIndex)}_n.getSegmentIndex=l;function c(u,f){if(u.leftSweepEvent.edgeId===f.leftSweepEvent.edgeId)return;const h=new t.PointToPointLine(u.leftSweepEvent.point,u.rightSweepEvent.point),p=new t.PointToPointLine(f.leftSweepEvent.point,f.rightSweepEvent.point);return h.intersection(p)}return _n.intersectionOfSegments=c,_n}var oO;function g_(){if(oO)return An;oO=1;var e=An&&An.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=An&&An.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(An,"__esModule",{value:!0}),An.IntersectionFinder=An.BY_DESCENDING_X_THEN_DESCENDING_Y=An.BY_X_THEN_DESCENDING_Y=An.BY_DESCENDING_X_THEN_Y=An.BY_X_THEN_Y=An.isIntersectingRoutedPoint=void 0;const t=G(),i=n(b7),a=tP();function o(u){return u!==void 0&&"intersections"in u&&"kind"in u}An.isIntersectingRoutedPoint=o;const s=(u,f)=>u.intersectionPoint.x===f.intersectionPoint.x?u.intersectionPoint.y-f.intersectionPoint.y:u.intersectionPoint.x-f.intersectionPoint.x;An.BY_X_THEN_Y=s;const r=(u,f)=>u.intersectionPoint.x===f.intersectionPoint.x?u.intersectionPoint.y-f.intersectionPoint.y:f.intersectionPoint.x-u.intersectionPoint.x;An.BY_DESCENDING_X_THEN_Y=r;const d=(u,f)=>u.intersectionPoint.x===f.intersectionPoint.x?f.intersectionPoint.y-u.intersectionPoint.y:u.intersectionPoint.x-f.intersectionPoint.x;An.BY_X_THEN_DESCENDING_Y=d;const l=(u,f)=>u.intersectionPoint.x===f.intersectionPoint.x?f.intersectionPoint.y-u.intersectionPoint.y:f.intersectionPoint.x-u.intersectionPoint.x;An.BY_DESCENDING_X_THEN_DESCENDING_Y=l;let c=class{apply(f){const h=this.find(f);this.addToRouting(h,f)}find(f){const h=new i.default(void 0,a.checkWhichEventIsLeft);return f.routes.forEach((p,g)=>{this.isSupportedRoute(p)&&(0,a.addRoute)(g,p,h)}),(0,a.runSweep)(h)}isSupportedRoute(f){return f.find(h=>h.kind!=="source"&&h.kind!=="target"&&h.kind!=="linear")===void 0}addToRouting(f,h){for(const p of f){const g=h.get(p.routable1),m=h.get(p.routable2);this.addIntersectionToRoutedPoint(p,g,p.segmentIndex1),this.addIntersectionToRoutedPoint(p,m,p.segmentIndex2)}}addIntersectionToRoutedPoint(f,h,p){if(h&&h.length>p){const g=h[p+1];if(o(g))g.intersections.push(f);else{const m=Object.assign(Object.assign({},g),{intersections:[f]});h[p+1]=m}}}};return An.IntersectionFinder=c,An.IntersectionFinder=c=e([(0,t.injectable)()],c),An}var Cu={},sO;function nP(){if(sO)return Cu;sO=1;var e=Cu&&Cu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Cu,"__esModule",{value:!0}),Cu.JunctionFinder=void 0;const n=G(),t=ef();let i=class{constructor(){this.edgesMap=new Map,this.sourcesMap=new Map,this.targetsMap=new Map}apply(o,s){this.findJunctions(o,s)}findJunctions(o,s){Array.from(s.index.all().filter(d=>d instanceof t.SEdgeImpl)).forEach(d=>{this.edgesMap.set(d.id,d);const l=this.sourcesMap.get(d.sourceId);l?l.add(d.id):this.sourcesMap.set(d.sourceId,new Set([d.id]));const c=this.targetsMap.get(d.targetId);c?c.add(d.id):this.targetsMap.set(d.targetId,new Set([d.id]))}),o.routes.forEach((d,l)=>{const c=this.edgesMap.get(l);c&&(this.findJunctionPointsWithSameSource(c,d,o),this.findJunctionPointsWithSameTarget(c,d,o))})}findJunctionPointsWithSameSource(o,s,r){const d=this.sourcesMap.get(o.sourceId);if(!d)return;const c=Array.from(d).filter(u=>u!==o.id).map(u=>r.get(u)).filter(u=>u!==void 0);for(const u of c){const f=this.getJunctionIndex(s,u);f===-1||f===0||this.setJunctionPoints(s,u,f)}}findJunctionPointsWithSameTarget(o,s,r){const d=this.targetsMap.get(o.targetId);if(!d)return;const c=Array.from(d).filter(u=>u!==o.id).map(u=>r.get(u)).filter(u=>u!==void 0);s.reverse();for(const u of c){u.reverse();const f=this.getJunctionIndex(s,u);f===-1||f===0||(this.setJunctionPoints(s,u,f),u.reverse())}s.reverse()}setJunctionPoints(o,s,r){const d=this.getSegmentDirection(o[r-1],o[r]),l=this.getSegmentDirection(s[r-1],s[r]);if(d!==l)this.setPreviousPointAsJunction(o,s,r);else if(d==="left"||d==="right"){if(o[r].y!==s[r].y){this.setPreviousPointAsJunction(o,s,r);return}o[r].isJunction=d==="left"?o[r].x>s[r].x:o[r].x<s[r].x,s[r].isJunction=d==="left"?s[r].x>o[r].x:s[r].x<o[r].x}else{if(o[r].x!==s[r].x){this.setPreviousPointAsJunction(o,s,r);return}o[r].isJunction=d==="up"?o[r].y>s[r].y:o[r].y<s[r].y,s[r].isJunction=d==="up"?s[r].y>o[r].y:s[r].y<o[r].y}}setPreviousPointAsJunction(o,s,r){o[r-1].isJunction=!0,s[r-1].isJunction=!0}getSegmentDirection(o,s){const r=s.x-o.x,d=s.y-o.y;let l="horizontal";return Math.abs(r)<Math.abs(d)&&(l="vertical"),l==="horizontal"?r>0?"right":"left":d>0?"down":"up"}getJunctionIndex(o,s){let r=0;for(;r<o.length&&r<s.length;){if(o[r].x!==s[r].x||o[r].y!==s[r].y)return r;r++}return-1}};return Cu.JunctionFinder=i,Cu.JunctionFinder=i=e([(0,n.injectable)()],i),Cu}var ea={},aO;function S7(){if(aO)return ea;aO=1;var e=ea&&ea.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ea&&ea.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(ea,"__esModule",{value:!0}),ea.JunctionPostProcessor=void 0;const t=G(),i=Yr(),a=Se(),o=tf();let s=class{constructor(){this.isFirstRender=!0}decorate(d,l){return d}postUpdate(d){this.currentModel!==this.modelSource.model&&(this.isFirstRender=!0),(d==null?void 0:d.kind)===i.RequestBoundsAction.KIND&&this.isFirstRender&&(document.querySelectorAll(`#${this.viewerOptions.hiddenDiv} > svg > g > g.sprotty-junction`).forEach(h=>h.remove()),document.querySelectorAll(`#${this.viewerOptions.baseDiv} > svg > g > g.sprotty-junction`).forEach(h=>h.remove()));const l=document.querySelector(`#${this.viewerOptions.hiddenDiv} > svg > g`),c=document.querySelector(`#${this.viewerOptions.baseDiv} > svg > g`);if(l){const u=Array.from(document.querySelectorAll(`#${this.viewerOptions.hiddenDiv} > svg > g > g > g.sprotty-junction`));u.forEach(f=>{f.remove()}),l.append(...u)}if(c){const u=Array.from(document.querySelectorAll(`#${this.viewerOptions.baseDiv} > svg > g > g > g.sprotty-junction`));u.forEach(f=>{f.remove()}),c.append(...u)}this.currentModel=this.modelSource.model,this.isFirstRender=!1}};return ea.JunctionPostProcessor=s,e([(0,t.inject)(a.TYPES.ViewerOptions),n("design:type",Object)],s.prototype,"viewerOptions",void 0),e([(0,t.inject)(a.TYPES.ModelSource),n("design:type",o.ModelSource)],s.prototype,"modelSource",void 0),ea.JunctionPostProcessor=s=e([(0,t.injectable)()],s),ea}var bn={},cO;function xm(){if(cO)return bn;cO=1;var e=bn&&bn.__decorate||function(H,F,K,U){var Z=arguments.length,ce=Z<3?F:U===null?U=Object.getOwnPropertyDescriptor(F,K):U,de;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ce=Reflect.decorate(H,F,K,U);else for(var ke=H.length-1;ke>=0;ke--)(de=H[ke])&&(ce=(Z<3?de(ce):Z>3?de(F,K,ce):de(F,K))||ce);return Z>3&&ce&&Object.defineProperty(F,K,ce),ce},n=bn&&bn.__metadata||function(H,F){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(H,F)},t=bn&&bn.__param||function(H,F){return function(K,U){F(K,U,H)}},i;Object.defineProperty(bn,"__esModule",{value:!0}),bn.LocationPostprocessor=bn.MoveMouseListener=bn.MorphEdgesAnimation=bn.MoveAnimation=bn.MoveCommand=void 0;const a=G(),o=at(),s=lt(),r=Qd(),d=sn(),l=ft(),c=gi(),u=Se(),f=Wr(),h=zn(),p=ef(),g=Nm(),m=Ft(),v=y7(),_=Bm(),S=YC(),E=on(),C=Os(),M=sh(),L=Sr(),I=$a(),R=Wc();let w=i=class extends d.MergeableCommand{constructor(F){super(),this.action=F,this.resolvedMoves=new Map,this.edgeMementi=[],this.stoppableCommandKey=i.KIND}stopExecution(){this.animation&&(this.animation.stop(),this.animation=void 0)}execute(F){const K=F.root.index,U=new Map,Z=new Map;return this.action.moves.forEach(ce=>{const de=K.getById(ce.elementId);if(de instanceof E.SRoutingHandleImpl&&this.edgeRouterRegistry){const ke=de.parent;if(ke instanceof E.SRoutableElementImpl){const pe=this.resolveHandleMove(de,ke,ce);if(pe){let et=U.get(ke);et||(et=[],U.set(ke,et)),et.push(pe)}}}else if(de&&(0,R.isLocateable)(de)){const ke=this.resolveElementMove(de,ce);if(ke&&(this.resolvedMoves.set(ke.element.id,ke),this.edgeRouterRegistry)){const pe=ot=>{K.getAttachedElements(ot).forEach(Be=>{if(Be instanceof E.SRoutableElementImpl&&!this.isChildOfMovedElements(Be)){const ee=Z.get(Be),ge=o.Point.subtract(ke.toPosition,ke.fromPosition),fe=ee?o.Point.linear(ee,ge,.5):ge;Z.set(Be,fe)}})},et=ot=>{(0,l.isParent)(ot)&&ot.children.forEach(Be=>{Be instanceof l.SModelElementImpl&&(Be instanceof E.SConnectableElementImpl&&pe(Be),et(Be))})};et(de),pe(de)}}}),this.doMove(U,Z),this.action.animate?(this.undoMove(),(this.animation=new r.CompoundAnimation(F.root,F,[new T(F.root,this.resolvedMoves,F,!1),new j(F.root,this.edgeMementi,F,!1)])).start()):F.root}resolveHandleMove(F,K,U){let Z=U.fromPosition;if(!Z){const ce=this.edgeRouterRegistry.get(K.routerKind);Z=ce.getHandlePosition(K,ce.route(K),F)}if(Z)return{handle:F,fromPosition:Z,toPosition:U.toPosition}}resolveElementMove(F,K){const U=K.fromPosition||{x:F.position.x,y:F.position.y};return{element:F,fromPosition:U,toPosition:K.toPosition}}doMove(F,K){this.resolvedMoves.forEach(U=>{U.element.position=U.toPosition}),F.forEach((U,Z)=>{const ce=this.edgeRouterRegistry.get(Z.routerKind),de=ce.takeSnapshot(Z);ce.applyHandleMoves(Z,U);const ke=ce.takeSnapshot(Z);this.edgeMementi.push({edge:Z,before:de,after:ke})}),K.forEach((U,Z)=>{if(!F.get(Z)){const ce=this.edgeRouterRegistry.get(Z.routerKind),de=ce.takeSnapshot(Z);if(this.isAttachedEdge(Z))Z.routingPoints=Z.routingPoints.map(pe=>o.Point.add(pe,U));else{const pe=(0,L.isSelectable)(Z)&&Z.selected;ce.cleanupRoutingPoints(Z,Z.routingPoints,pe,this.action.finished)}const ke=ce.takeSnapshot(Z);this.edgeMementi.push({edge:Z,before:de,after:ke})}})}isChildOfMovedElements(F){const K=F.parent;return Array.from(this.resolvedMoves.values()).map(U=>U.element.id).includes(K.id)?!0:K instanceof l.SChildElementImpl?this.isChildOfMovedElements(K):!1}isAttachedEdge(F){const K=F.source,U=F.target,Z=ce=>!!this.resolvedMoves.get(ce.id)||this.isChildOfMovedElements(ce);return!!(K&&U&&Z(K)&&Z(U))}undoMove(){this.resolvedMoves.forEach(F=>{F.element.position=F.fromPosition}),this.edgeMementi.forEach(F=>{this.edgeRouterRegistry.get(F.edge.routerKind).applySnapshot(F.edge,F.before)})}undo(F){return new r.CompoundAnimation(F.root,F,[new T(F.root,this.resolvedMoves,F,!0),new j(F.root,this.edgeMementi,F,!0)]).start()}redo(F){return new r.CompoundAnimation(F.root,F,[new T(F.root,this.resolvedMoves,F,!1),new j(F.root,this.edgeMementi,F,!1)]).start()}merge(F,K){if(!this.action.animate&&F instanceof i)return F.resolvedMoves.forEach((U,Z)=>{const ce=this.resolvedMoves.get(Z);ce?ce.toPosition=U.toPosition:this.resolvedMoves.set(Z,U)}),F.edgeMementi.forEach(U=>{const Z=this.edgeMementi.find(ce=>ce.edge.id===U.edge.id);Z?Z.after=U.after:this.edgeMementi.push(U)}),!0;if(F instanceof S.ReconnectCommand){const U=F.memento;if(U){const Z=this.edgeMementi.find(ce=>ce.edge.id===U.edge.id);Z?Z.after=U.after:this.edgeMementi.push(U)}return!0}return!1}};bn.MoveCommand=w,w.KIND=s.MoveAction.KIND,e([(0,a.inject)(C.EdgeRouterRegistry),(0,a.optional)(),n("design:type",C.EdgeRouterRegistry)],w.prototype,"edgeRouterRegistry",void 0),bn.MoveCommand=w=i=e([(0,a.injectable)(),t(0,(0,a.inject)(u.TYPES.Action)),n("design:paramtypes",[Object])],w);class T extends r.Animation{constructor(F,K,U,Z=!1){super(U),this.model=F,this.elementMoves=K,this.reverse=Z}tween(F){return this.elementMoves.forEach(K=>{this.reverse?K.element.position={x:(1-F)*K.toPosition.x+F*K.fromPosition.x,y:(1-F)*K.toPosition.y+F*K.fromPosition.y}:K.element.position={x:(1-F)*K.fromPosition.x+F*K.toPosition.x,y:(1-F)*K.fromPosition.y+F*K.toPosition.y}}),this.model}}bn.MoveAnimation=T;class j extends r.Animation{constructor(F,K,U,Z=!1){super(U),this.model=F,this.reverse=Z,this.expanded=[],K.forEach(ce=>{const de=this.reverse?ce.after:ce.before,ke=this.reverse?ce.before:ce.after,pe=de.routedPoints,et=ke.routedPoints,ot=Math.max(pe.length,et.length);this.expanded.push({startExpandedRoute:this.growToSize(pe,ot),endExpandedRoute:this.growToSize(et,ot),memento:ce})})}midPoint(F){const K=F.edge,U=F.edge.source,Z=F.edge.target;return o.Point.linear((0,c.translatePoint)(o.Bounds.center(U.bounds),U.parent,K.parent),(0,c.translatePoint)(o.Bounds.center(Z.bounds),Z.parent,K.parent),.5)}start(){return this.expanded.forEach(F=>{F.memento.edge.removeAll(K=>K instanceof E.SRoutingHandleImpl)}),super.start()}tween(F){return F===1?this.expanded.forEach(K=>{const U=K.memento;this.reverse?U.before.router.applySnapshot(U.edge,U.before):U.after.router.applySnapshot(U.edge,U.after)}):this.expanded.forEach(K=>{const U=[];for(let de=1;de<K.startExpandedRoute.length-1;++de)U.push(o.Point.linear(K.startExpandedRoute[de],K.endExpandedRoute[de],F));const Z=F<.5?K.memento.before:K.memento.after,ce=Object.assign(Object.assign({},Z),{routingPoints:U,routingHandles:[]});Z.router.applySnapshot(K.memento.edge,ce)}),this.model}growToSize(F,K){const U=K-F.length;if(U<=0)return F;const Z=[];Z.push(F[0]);const ce=1/(U+1),de=1/(F.length-1);let ke=1;for(let pe=1;pe<F.length;++pe){const et=de*pe;let ot=0;for(;et>(ke+ot)*ce;)++ot;ke+=ot;for(let Be=0;Be<ot;++Be){const ee=o.Point.linear(F[pe-1],F[pe],(Be+1)/(ot+1));Z.push(ee)}Z.push(F[pe])}return Z}}bn.MorphEdgesAnimation=j;class D extends f.MouseListener{constructor(){super(...arguments),this.hasDragged=!1,this.elementId2startPos=new Map}mouseDown(F,K){if(K.button===0){const U=(0,c.findParentByFeature)(F,R.isMoveable),Z=F instanceof E.SRoutingHandleImpl;if(U!==void 0||Z||(0,v.isCreatingOnDrag)(F)?this.startDragPosition={x:K.pageX,y:K.pageY}:this.startDragPosition=void 0,this.hasDragged=!1,(0,v.isCreatingOnDrag)(F))return this.startCreatingOnDrag(F,K);if(Z)return this.activateRoutingHandle(F,K)}return[]}startCreatingOnDrag(F,K){const U=[];return U.push(s.SelectAllAction.create({select:!1})),U.push(F.createAction(E.edgeInProgressID)),U.push(s.SelectAction.create({selectedElementsIDs:[E.edgeInProgressID]})),U.push(_.SwitchEditModeAction.create({elementsToActivate:[E.edgeInProgressID]})),U.push(s.SelectAction.create({selectedElementsIDs:[E.edgeInProgressTargetHandleID]})),U.push(_.SwitchEditModeAction.create({elementsToActivate:[E.edgeInProgressTargetHandleID]})),U}activateRoutingHandle(F,K){return[_.SwitchEditModeAction.create({elementsToActivate:[F.id]})]}mouseMove(F,K){const U=[];if(K.buttons===0)this.mouseUp(F,K);else if(this.startDragPosition){this.elementId2startPos.size===0&&this.collectStartPositions(F.root),this.hasDragged=!0;const Z=this.getElementMoves(F,K,!1);Z&&U.push(Z)}return U}collectStartPositions(F){const K=new Set(F.index.all().filter(U=>(0,L.isSelectable)(U)&&U.selected));K.forEach(U=>{if(!this.isChildOfSelected(K,U)){if((0,R.isMoveable)(U))this.elementId2startPos.set(U.id,U.position);else if(U instanceof E.SRoutingHandleImpl){const Z=this.getHandlePosition(U);Z&&this.elementId2startPos.set(U.id,Z)}}})}isChildOfSelected(F,K){for(;K instanceof l.SChildElementImpl;)if(K=K.parent,(0,R.isMoveable)(K)&&F.has(K))return!0;return!1}getElementMoves(F,K,U){if(!this.startDragPosition)return;const Z=[],ce=(0,c.findParentByFeature)(F,I.isViewport),de=ce?ce.zoom:1,ke={x:(K.pageX-this.startDragPosition.x)/de,y:(K.pageY-this.startDragPosition.y)/de};if(this.elementId2startPos.forEach((pe,et)=>{const ot=F.root.index.getById(et);if(ot){const Be=this.createElementMove(ot,pe,ke,K);Be&&Z.push(Be)}}),Z.length>0)return s.MoveAction.create(Z,{animate:!1,finished:U})}createElementMove(F,K,U,Z){const ce=this.snap({x:K.x+U.x,y:K.y+U.y},F,!Z.shiftKey);if((0,R.isMoveable)(F))return{elementId:F.id,elementType:F.type,fromPosition:{x:F.position.x,y:F.position.y},toPosition:ce};if(F instanceof E.SRoutingHandleImpl){const de=this.getHandlePosition(F);if(de!==void 0)return{elementId:F.id,elementType:F.type,fromPosition:de,toPosition:ce}}}snap(F,K,U){return U&&this.snapper?this.snapper.snap(F,K):F}getHandlePosition(F){if(this.edgeRouterRegistry){const K=F.parent;if(!(K instanceof E.SRoutableElementImpl))return;const U=this.edgeRouterRegistry.get(K.routerKind),Z=U.route(K);return U.getHandlePosition(K,Z,F)}}mouseEnter(F,K){return F instanceof l.SModelRootImpl&&K.buttons===0&&!this.startDragPosition&&this.mouseUp(F,K),[]}mouseUp(F,K){const U=[];if(this.startDragPosition){const Z=this.getElementMoves(F,K,!0);Z&&U.push(Z),F.root.index.all().forEach(ce=>{ce instanceof E.SRoutingHandleImpl&&U.push(...this.deactivateRoutingHandle(ce,F,K))})}if(!U.some(Z=>Z.kind===s.ReconnectAction.KIND)){const Z=F.root.index.getById(E.edgeInProgressID);Z instanceof l.SChildElementImpl&&U.push(this.deleteEdgeInProgress(Z))}return this.hasDragged&&U.push(g.CommitModelAction.create()),this.hasDragged=!1,this.startDragPosition=void 0,this.elementId2startPos.clear(),U}deactivateRoutingHandle(F,K,U){const Z=[],ce=F.parent;if(ce instanceof E.SRoutableElementImpl&&F.danglingAnchor){const de=this.getHandlePosition(F);if(de){const ke=(0,c.translatePoint)(de,F.parent,F.root),pe=(0,m.findChildrenAtPosition)(K.root,ke).find(et=>(0,E.isConnectable)(et)&&et.canConnect(ce,F.kind));pe&&this.hasDragged&&Z.push(s.ReconnectAction.create({routableId:F.parent.id,newSourceId:F.kind==="source"?pe.id:ce.sourceId,newTargetId:F.kind==="target"?pe.id:ce.targetId}))}}return F.editMode&&Z.push(_.SwitchEditModeAction.create({elementsToDeactivate:[F.id]})),Z}deleteEdgeInProgress(F){const K=[];return K.push(E.edgeInProgressID),F.children.forEach(U=>{U instanceof E.SRoutingHandleImpl&&U.danglingAnchor&&K.push(U.danglingAnchor.id)}),s.DeleteElementAction.create(K)}decorate(F,K){return F}}bn.MoveMouseListener=D,e([(0,a.inject)(C.EdgeRouterRegistry),(0,a.optional)(),n("design:type",C.EdgeRouterRegistry)],D.prototype,"edgeRouterRegistry",void 0),e([(0,a.inject)(u.TYPES.ISnapper),(0,a.optional)(),n("design:type",Object)],D.prototype,"snapper",void 0);let B=class{decorate(F,K){if((0,M.isEdgeLayoutable)(K)&&K.parent instanceof p.SEdgeImpl)return F;let U="";if((0,R.isLocateable)(K)&&K instanceof l.SChildElementImpl&&K.parent!==void 0){const Z=K.position;(Z.x!==0||Z.y!==0)&&(U="translate("+Z.x+", "+Z.y+")")}if((0,m.isAlignable)(K)){const Z=K.alignment;(Z.x!==0||Z.y!==0)&&(U.length>0&&(U+=" "),U+="translate("+Z.x+", "+Z.y+")")}return U.length>0&&(0,h.setAttr)(F,"transform",U),F}postUpdate(){}};return bn.LocationPostprocessor=B,bn.LocationPostprocessor=B=e([(0,a.injectable)()],B),bn}var Pu={},uO;function E7(){if(uO)return Pu;uO=1;var e=Pu&&Pu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.CenterGridSnapper=void 0;const n=G(),t=Ft();let i=class{get gridX(){return 10}get gridY(){return 10}snap(o,s){return s&&(0,t.isBoundsAware)(s)?{x:Math.round((o.x+.5*s.bounds.width)/this.gridX)*this.gridX-.5*s.bounds.width,y:Math.round((o.y+.5*s.bounds.height)/this.gridY)*this.gridY-.5*s.bounds.height}:{x:Math.round(o.x/this.gridX)*this.gridX,y:Math.round(o.y/this.gridY)*this.gridY}}};return Pu.CenterGridSnapper=i,Pu.CenterGridSnapper=i=e([(0,n.injectable)()],i),Pu}var fp={},Hb={},lO;function iP(){return lO||(lO=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isOpenable=e.openFeature=void 0,e.openFeature=Symbol("openFeature");function n(t){return t.hasFeature(e.openFeature)}e.isOpenable=n}(Hb)),Hb}var dO;function rP(){if(dO)return fp;dO=1,Object.defineProperty(fp,"__esModule",{value:!0}),fp.OpenMouseListener=void 0;const e=lt(),n=Wr(),t=gi(),i=iP();class a extends n.MouseListener{doubleClick(s,r){const d=(0,t.findParentByFeature)(s,i.isOpenable);return d!==void 0?[e.OpenAction.create(d.id)]:[]}}return fp.OpenMouseListener=a,fp}var ps={},fO;function m_(){if(fO)return ps;fO=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.getModelBounds=ps.getProjectedBounds=ps.getProjections=ps.isProjectable=void 0;const e=at(),n=$c(),t=gi(),i=Ft();function a(l){return(0,n.hasOwnProperty)(l,"projectionCssClasses")}ps.isProjectable=a;function o(l){let c;for(const u of l.children){if(a(u)&&u.projectionCssClasses.length>0){const f=s(u);if(f){const h={elementId:u.id,projectedBounds:f,cssClasses:u.projectionCssClasses};c?c.push(h):c=[h]}}if(u.children.length>0){const f=o(u);f&&(c?c.push(...f):c=f)}}return c}ps.getProjections=o;function s(l){const c=l.parent;if(l.projectedBounds){let u=l.projectedBounds;return(0,i.isBoundsAware)(c)&&(u=(0,t.transformToRootBounds)(c,u)),u}else if((0,i.isBoundsAware)(l)){let u=l.bounds;return u=(0,t.transformToRootBounds)(c,u),u}}ps.getProjectedBounds=s;const r=1e9;function d(l){let c=r,u=r,f=-1e9,h=-1e9;const p=(0,i.isBoundsAware)(l)?l.bounds:void 0;if(p&&e.Dimension.isValid(p))c=p.x,u=p.y,f=c+p.width,h=u+p.height;else for(const g of l.children)if((0,i.isBoundsAware)(g)){const m=g.bounds;c=Math.min(c,m.x),u=Math.min(u,m.y),f=Math.max(f,m.x+m.width),h=Math.max(h,m.y+m.height)}if(c=Math.min(c,l.scroll.x),u=Math.min(u,l.scroll.y),f=Math.max(f,l.scroll.x+l.canvasBounds.width/l.zoom),h=Math.max(h,l.scroll.y+l.canvasBounds.height/l.zoom),c<f&&u<h)return{x:c,y:u,width:f-c,height:h-u}}return ps.getModelBounds=d,ps}var Ru={},hO;function C7(){if(hO)return Ru;hO=1;var e=Ru&&Ru.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f};Object.defineProperty(Ru,"__esModule",{value:!0}),Ru.ProjectedViewportView=void 0;const n=Ds(),t=G(),i=nh,a=zn(),o=m_();let s=class{render(d,l,c){const u=(0,n.html)("div",{"class-sprotty-root":!0},this.renderSvg(d,l,c),this.renderProjections(d,l,c));return(0,a.setAttr)(u,"tabindex",0),u}renderSvg(d,l,c){const u=`scale(${d.zoom}) translate(${-d.scroll.x},${-d.scroll.y})`,f="http://www.w3.org/2000/svg";return(0,i.h)("svg",{ns:f},(0,i.h)("g",{ns:f,attrs:{transform:u}},l.renderChildren(d)))}renderProjections(d,l,c){var u;if(d.zoom<=0)return[];const f=(0,o.getModelBounds)(d);if(!f)return[];const h=(u=(0,o.getProjections)(d))!==null&&u!==void 0?u:[];return[this.renderProjectionBar(h,d,f,"vertical"),this.renderProjectionBar(h,d,f,"horizontal")]}renderProjectionBar(d,l,c,u){const f={modelBounds:c,orientation:u};return f.factor=u==="horizontal"?l.canvasBounds.width/c.width:l.canvasBounds.height/c.height,f.zoomedFactor=f.factor/l.zoom,(0,n.html)("div",{"class-sprotty-projection-bar":!0,"class-horizontal":u==="horizontal","class-vertical":u==="vertical"},this.renderViewport(l,f),d.map(h=>this.renderProjection(h,l,f)))}renderViewport(d,l){let c,u;l.orientation==="horizontal"?(c=d.canvasBounds.width,u=(d.scroll.x-l.modelBounds.x)*l.factor):(c=d.canvasBounds.height,u=(d.scroll.y-l.modelBounds.y)*l.factor);let f=c*l.zoomedFactor;u<0?(f+=u,u=0):u>c&&(u=c),f<0?f=0:u+f>c&&(f=c-u);const h=l.orientation==="horizontal"?{left:`${u}px`,width:`${f}px`}:{top:`${u}px`,height:`${f}px`};return(0,n.html)("div",{"class-sprotty-viewport":!0,style:h})}renderProjection(d,l,c){let u,f,h;c.orientation==="horizontal"?(u=l.canvasBounds.width,f=(d.projectedBounds.x-c.modelBounds.x)*c.factor,h=d.projectedBounds.width*c.factor):(u=l.canvasBounds.height,f=(d.projectedBounds.y-c.modelBounds.y)*c.factor,h=d.projectedBounds.height*c.factor),f<0?(h+=f,f=0):f>u&&(f=u),h<0?h=0:f+h>u&&(h=u-f);const p=c.orientation==="horizontal"?{left:`${f}px`,width:`${h}px`}:{top:`${f}px`,height:`${h}px`},g=(0,n.html)("div",{id:`${c.orientation}-projection:${d.elementId}`,"class-sprotty-projection":!0,style:p});return d.cssClasses.forEach(m=>(0,a.setClass)(g,m,!0)),g}};return Ru.ProjectedViewportView=s,Ru.ProjectedViewportView=s=e([(0,t.injectable)()],s),Ru}var ir={},rr={},pO;function v_(){if(pO)return rr;pO=1;var e=rr&&rr.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g};Object.defineProperty(rr,"__esModule",{value:!0}),rr.DiamondAnchor=rr.RectangleAnchor=rr.EllipseAnchor=void 0;const n=Qc(),t=Zc(),i=G(),a=jm(),o=at();let s=class{get kind(){return a.PolylineEdgeRouter.KIND+":"+n.ELLIPTIC_ANCHOR_KIND}getAnchor(u,f,h=0){const p=u.bounds,g=o.Bounds.center(p),m=g.x-f.x,v=g.y-f.y,_=Math.sqrt(m*m+v*v),S=m/_||0,E=v/_||0;return{x:g.x-S*(.5*p.width+h),y:g.y-E*(.5*p.height+h)}}};rr.EllipseAnchor=s,rr.EllipseAnchor=s=e([(0,i.injectable)()],s);let r=class{get kind(){return a.PolylineEdgeRouter.KIND+":"+n.RECTANGULAR_ANCHOR_KIND}getAnchor(u,f,h=0){const p=u.bounds,g=o.Bounds.center(p),m=new d(g,f);if(!(0,o.almostEquals)(g.y,f.y)){const v=this.getXIntersection(p.y,g,f);v>=p.x&&v<=p.x+p.width&&m.addCandidate(v,p.y-h);const _=this.getXIntersection(p.y+p.height,g,f);_>=p.x&&_<=p.x+p.width&&m.addCandidate(_,p.y+p.height+h)}if(!(0,o.almostEquals)(g.x,f.x)){const v=this.getYIntersection(p.x,g,f);v>=p.y&&v<=p.y+p.height&&m.addCandidate(p.x-h,v);const _=this.getYIntersection(p.x+p.width,g,f);_>=p.y&&_<=p.y+p.height&&m.addCandidate(p.x+p.width+h,_)}return m.best}getXIntersection(u,f,h){const p=(u-f.y)/(h.y-f.y);return(h.x-f.x)*p+f.x}getYIntersection(u,f,h){const p=(u-f.x)/(h.x-f.x);return(h.y-f.y)*p+f.y}};rr.RectangleAnchor=r,rr.RectangleAnchor=r=e([(0,i.injectable)()],r);class d{constructor(u,f){this.centerPoint=u,this.refPoint=f,this.currentDist=-1}addCandidate(u,f){const h=this.refPoint.x-u,p=this.refPoint.y-f,g=h*h+p*p;(this.currentDist<0||g<this.currentDist)&&(this.currentBest={x:u,y:f},this.currentDist=g)}get best(){return this.currentBest===void 0?this.centerPoint:this.currentBest}}let l=class{get kind(){return a.PolylineEdgeRouter.KIND+":"+n.DIAMOND_ANCHOR_KIND}getAnchor(u,f,h){const p=u.bounds,g=new t.PointToPointLine(o.Bounds.center(p),f),m=new t.Diamond(p).closestSideLine(f),v=(0,t.intersection)(m,g);return o.Point.shiftTowards(v,f,h)}};return rr.DiamondAnchor=l,rr.DiamondAnchor=l=e([(0,i.injectable)()],l),rr}var Nn={},gO;function y_(){if(gO)return Nn;gO=1;var e=Nn&&Nn.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=Nn&&Nn.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)},t=Nn&&Nn.__param||function(m,v){return function(_,S){v(_,S,m)}},i;Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.AddRemoveBezierSegmentCommand=Nn.AddRemoveBezierSegmentAction=Nn.BezierMouseListener=Nn.BezierEdgeRouter=void 0;const a=G(),o=at(),s=on(),r=Os(),d=Lm(),l=Wr(),c=sn(),u=Se();let f=i=class extends d.AbstractEdgeRouter{get kind(){return i.KIND}route(v){if(!v.source||!v.target)return[];const _=v.routingPoints.length,S=v.source,E=v.target,C=[];if(C.push({kind:"source",x:0,y:0}),_===0){const[w,T]=this.createDefaultBezierHandles(S.position,E.position);C.push({kind:"bezier-control-after",x:w.x,y:w.y,pointIndex:0}),C.push({kind:"bezier-control-before",x:T.x,y:T.y,pointIndex:1}),v.routingPoints.push(w),v.routingPoints.push(T)}else if(_>=2)for(let w=0;w<_;w++){const T=v.routingPoints[w];w%3===0&&C.push({kind:"bezier-control-after",x:T.x,y:T.y,pointIndex:w}),(w+1)%3===0?C.push({kind:"bezier-junction",x:T.x,y:T.y,pointIndex:w}):(w+2)%3===0&&C.push({kind:"bezier-control-before",x:T.x,y:T.y,pointIndex:w})}C.push({kind:"target",x:0,y:0});const M=_>2?v.routingPoints[2]:E.position,L=_>2?v.routingPoints[v.routingPoints.length-3]:S.position,I=this.getTranslatedAnchor(S,M,E.parent,v,v.sourceAnchorCorrection),R=this.getTranslatedAnchor(E,L,S.parent,v,v.targetAnchorCorrection);return C[0]={kind:"source",x:I.x,y:I.y},C[C.length-1]={kind:"target",x:R.x,y:R.y},C}createDefaultBezierHandles(v,_){const S={x:v.x-i.DEFAULT_BEZIER_HANDLE_OFFSET,y:v.y},E={x:_.x+i.DEFAULT_BEZIER_HANDLE_OFFSET,y:_.y};return[S,E]}createRoutingHandles(v){this.route(v),this.rebuildHandles(v)}rebuildHandles(v){this.addHandle(v,"source","routing-point",-2),this.addHandle(v,"bezier-control-after","bezier-routing-point",0),this.addHandle(v,"bezier-add","bezier-create-routing-point",0);const _=v.routingPoints.length;if(_>2)for(let S=1;S<_-1;S+=3)this.addHandle(v,"bezier-control-before","bezier-routing-point",S),this.addHandle(v,"bezier-add","bezier-create-routing-point",S+1),this.addHandle(v,"bezier-junction","routing-point",S+1),this.addHandle(v,"bezier-remove","bezier-remove-routing-point",S+1),this.addHandle(v,"bezier-control-after","bezier-routing-point",S+2),this.moveBezierControlPair(v.routingPoints[S],S,v);this.addHandle(v,"bezier-control-before","bezier-routing-point",_-1),this.addHandle(v,"target","routing-point",-1)}getInnerHandlePosition(v,_,S){if(S.kind==="bezier-control-before"||S.kind==="bezier-junction"||S.kind==="bezier-control-after")for(let E=0;E<_.length;E++){const C=_[E];if(C.pointIndex===S.pointIndex&&C.kind===S.kind)return C}else if(S.kind==="bezier-add"){const E=this.findBezierControl(v,_,S.pointIndex);return{x:E.x,y:E.y+12.5}}else if(S.kind==="bezier-remove"){const E=this.findBezierControl(v,_,S.pointIndex);return{x:E.x,y:E.y-12.5}}}findBezierControl(v,_,S){let E={x:_[0].x,y:_[0].y};if(S>0){for(const C of _)if(C.pointIndex!==void 0&&C.pointIndex===S&&C.kind==="bezier-junction"){E={x:C.x,y:C.y};break}}return E}applyHandleMoves(v,_){_.forEach(S=>{const E=S.handle;let C={x:0,y:0},M,L,I;const R=S.toPosition;switch(E.kind){case"bezier-control-before":case"bezier-control-after":this.moveBezierControlPair(R,S.handle.pointIndex,v);break;case"bezier-junction":const w=E.pointIndex;w>=0&&w<v.routingPoints.length&&(I=w-1,C=v.routingPoints[w],M=v.routingPoints[I],L=this.calcRelativeMove(C,R,M),v.routingPoints[w]=R,this.moveBezierControlPair(L,I,v));break;case"source":if(I=0,M=v.routingPoints[I],v.source instanceof s.SDanglingAnchorImpl)E.danglingAnchor&&(C=E.danglingAnchor.position,E.danglingAnchor.position=R);else{const T=new s.SDanglingAnchorImpl;T.id=v.id+"_dangling-source",T.original=v.source,T.position=S.toPosition,E.root.add(T),E.danglingAnchor=T,v.sourceId=T.id,v.source&&(C=v.source.position)}L=this.calcRelativeMove(C,R,M),this.moveBezierControlPair(L,I,v);break;case"target":if(I=v.routingPoints.length-1,M=v.routingPoints[I],v.target instanceof s.SDanglingAnchorImpl)E.danglingAnchor&&(C=E.danglingAnchor.position,E.danglingAnchor.position=R);else{const T=new s.SDanglingAnchorImpl;T.id=v.id+"_dangling-target",T.original=v.target,T.position=R,E.root.add(T),E.danglingAnchor=T,v.targetId=T.id,v.target&&(C=v.target.position)}L=this.calcRelativeMove(C,R,M),this.moveBezierControlPair(L,I,v);break}})}applyInnerHandleMoves(v,_){}getOptions(v){return{minimalPointDistance:2,standardDistance:.1,selfEdgeOffset:20}}calcRelativeMove(v,_,S){return{x:S.x-(v.x-_.x),y:S.y-(v.y-_.y)}}createNewBezierSegment(v,_){const S=_.routingPoints;let E,C,M;S.length===2?(C=S[v<0?0:v],M=S[S.length-1],E=(0,o.centerOfLine)(C,M)):(C=S[v],M=S[v+2],E=(0,o.centerOfLine)(C,M));const[L,I]=this.createDefaultBezierHandles(E,E);S.splice(v+1,0,L),S.splice(v+2,0,E),S.splice(v+3,0,I),this.moveBezierControlPair(L,v+1,_),_.removeAll(R=>R instanceof s.SRoutingHandleImpl),this.rebuildHandles(_)}removeBezierSegment(v,_){_.routingPoints.splice(v-1,3),_.removeAll(E=>E instanceof s.SRoutingHandleImpl),this.rebuildHandles(_)}moveBezierControlPair(v,_,S){if(_>=0&&_<S.routingPoints.length){const E=_-1,C=_+1;E<0||C===S.routingPoints.length?S.routingPoints[_]=v:_%3===0?this.setBezierMirror(S,v,_,!1):(_+2)%3===0&&this.setBezierMirror(S,v,_,!0)}}setBezierMirror(v,_,S,E){v.routingPoints[S]=_;const C=v.routingPoints[E?S+1:S-1];v.routingPoints[E?S+2:S-2]={x:C.x-(_.x-C.x),y:C.y-(_.y-C.y)}}};Nn.BezierEdgeRouter=f,f.KIND="bezier",f.DEFAULT_BEZIER_HANDLE_OFFSET=25,Nn.BezierEdgeRouter=f=i=e([(0,a.injectable)()],f);class h extends l.MouseListener{mouseDown(v,_){const S=[];return v instanceof s.SRoutingHandleImpl&&(v.kind==="bezier-add"||v.kind==="bezier-remove")&&(v.type==="bezier-create-routing-point"?S.push(p.create("add",v.id)):v.type==="bezier-remove-routing-point"&&S.push(p.create("remove",v.id))),S}}Nn.BezierMouseListener=h;var p;(function(m){m.KIND="addRemoveBezierSegment";function v(_,S){return{kind:m.KIND,actionTask:_,targetId:S}}m.create=v})(p||(Nn.AddRemoveBezierSegmentAction=p={}));let g=class extends c.Command{constructor(v,_){super(),this.action=v,this.edgeRouterRegistry=_}execute(v){const S=v.root.index.getById(this.action.targetId);if(this.edgeRouterRegistry&&S instanceof s.SRoutingHandleImpl){const E=this.edgeRouterRegistry.get(S.parent.routerKind);if(E instanceof f){const C=E;for(const M of v.root.children)if(M.id===S.parent.id){this.action.actionTask==="add"?C.createNewBezierSegment(S.pointIndex,M):this.action.actionTask==="remove"&&C.removeBezierSegment(S.pointIndex,M);break}}}return v.root}undo(v){throw new Error("Method not implemented.")}redo(v){throw new Error("Method not implemented.")}};return Nn.AddRemoveBezierSegmentCommand=g,g.KIND=p.KIND,Nn.AddRemoveBezierSegmentCommand=g=e([(0,a.injectable)(),t(0,(0,a.inject)(u.TYPES.Action)),t(1,(0,a.inject)(r.EdgeRouterRegistry)),n("design:paramtypes",[Object,r.EdgeRouterRegistry])],g),Nn}var mO;function oP(){if(mO)return ir;mO=1;var e=ir&&ir.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h};Object.defineProperty(ir,"__esModule",{value:!0}),ir.BezierDiamondAnchor=ir.BezierRectangleAnchor=ir.BezierEllipseAnchor=void 0;const n=Qc(),t=G(),i=v_(),a=y_();let o=class extends i.EllipseAnchor{get kind(){return a.BezierEdgeRouter.KIND+":"+n.ELLIPTIC_ANCHOR_KIND}};ir.BezierEllipseAnchor=o,ir.BezierEllipseAnchor=o=e([(0,t.injectable)()],o);let s=class extends i.RectangleAnchor{get kind(){return a.BezierEdgeRouter.KIND+":"+n.RECTANGULAR_ANCHOR_KIND}};ir.BezierRectangleAnchor=s,ir.BezierRectangleAnchor=s=e([(0,t.injectable)()],s);let r=class extends i.DiamondAnchor{get kind(){return a.BezierEdgeRouter.KIND+":"+n.DIAMOND_ANCHOR_KIND}};return ir.BezierDiamondAnchor=r,ir.BezierDiamondAnchor=r=e([(0,t.injectable)()],r),ir}var or={},hp={},vO;function __(){if(vO)return hp;vO=1,Object.defineProperty(hp,"__esModule",{value:!0}),hp.ManhattanEdgeRouter=void 0;const e=at(),n=gi(),t=Lm(),i=on();class a extends t.AbstractEdgeRouter{get kind(){return a.KIND}getOptions(s){return{standardDistance:20,minimalPointDistance:3,selfEdgeOffset:.25}}route(s){if(!s.source||!s.target)return[];const r=this.createRoutedCorners(s),d=r[0]||(0,n.translatePoint)(e.Bounds.center(s.target.bounds),s.target.parent,s.parent),l=this.getTranslatedAnchor(s.source,d,s.parent,s,s.sourceAnchorCorrection),c=r[r.length-1]||(0,n.translatePoint)(e.Bounds.center(s.source.bounds),s.source.parent,s.parent),u=this.getTranslatedAnchor(s.target,c,s.parent,s,s.targetAnchorCorrection);if(!l||!u)return[];const f=[];return f.push(Object.assign({kind:"source"},l)),r.forEach(h=>f.push(h)),f.push(Object.assign({kind:"target"},u)),f}createRoutedCorners(s){const r=new t.DefaultAnchors(s.source,s.parent,"source"),d=new t.DefaultAnchors(s.target,s.parent,"target");if(s.routingPoints.length>0){const u=s.routingPoints.slice();if(this.cleanupRoutingPoints(s,u,!1,!0),u.length>0)return u.map((f,h)=>Object.assign({kind:"linear",pointIndex:h},f))}const l=this.getOptions(s);return this.calculateDefaultCorners(s,r,d,l).map(u=>Object.assign({kind:"linear"},u))}createRoutingHandles(s){const r=this.route(s);if(this.commitRoute(s,r),r.length>0){this.addHandle(s,"source","routing-point",-2);for(let d=0;d<r.length-1;++d)this.addHandle(s,"manhattan-50%","volatile-routing-point",d-1);this.addHandle(s,"target","routing-point",r.length-2)}}getInnerHandlePosition(s,r,d){const l=this.getFraction(d.kind);if(l!==void 0){const{start:c,end:u}=this.findRouteSegment(s,r,d.pointIndex);if(c!==void 0&&u!==void 0)return e.Point.linear(c,u,l)}}getFraction(s){switch(s){case"manhattan-50%":return .5;default:return}}applyInnerHandleMoves(s,r){const d=this.route(s),l=s.routingPoints,c=this.getOptions(s).minimalPointDistance;r.forEach(u=>{const f=u.handle,h=f.pointIndex,p=this.correctX(l,h,u.toPosition.x,c),g=this.correctY(l,h,u.toPosition.y,c);switch(f.kind){case"manhattan-50%":h<0?l.length===0?(l.push({x:p,y:g}),f.pointIndex=0):(0,e.almostEquals)(d[0].x,d[1].x)?this.alignX(l,0,p):this.alignY(l,0,g):h<l.length-1?(0,e.almostEquals)(l[h].x,l[h+1].x)?(this.alignX(l,h,p),this.alignX(l,h+1,p)):(this.alignY(l,h,g),this.alignY(l,h+1,g)):(0,e.almostEquals)(d[d.length-2].x,d[d.length-1].x)?this.alignX(l,l.length-1,p):this.alignY(l,l.length-1,g);break}})}correctX(s,r,d,l){return r>0&&Math.abs(d-s[r-1].x)<l?s[r-1].x:r<s.length-2&&Math.abs(d-s[r+2].x)<l?s[r+2].x:d}alignX(s,r,d){r>=0&&r<s.length&&(s[r]={x:d,y:s[r].y})}correctY(s,r,d,l){return r>0&&Math.abs(d-s[r-1].y)<l?s[r-1].y:r<s.length-2&&Math.abs(d-s[r+2].y)<l?s[r+2].y:d}alignY(s,r,d){r>=0&&r<s.length&&(s[r]={x:s[r].x,y:d})}cleanupRoutingPoints(s,r,d,l){const c=new t.DefaultAnchors(s.source,s.parent,"source"),u=new t.DefaultAnchors(s.target,s.parent,"target");if(!this.resetRoutingPointsOnReconnect(s,r,d,c,u)){for(let f=0;f<r.length&&e.Bounds.includes(c.bounds,r[f]);++f)r.splice(0,1),d&&this.removeHandle(s,-1);for(let f=r.length-1;f>=0&&e.Bounds.includes(u.bounds,r[f]);--f)r.splice(f,1),d&&this.removeHandle(s,f);if(r.length>=2){const f=this.getOptions(s);for(let h=r.length-2;h>=0;--h)e.Point.manhattanDistance(r[h],r[h+1])<f.minimalPointDistance&&(r.splice(h,2),--h,d&&(this.removeHandle(s,h-1),this.removeHandle(s,h)))}l&&(this.addAdditionalCorner(s,r,c,u,d),this.addAdditionalCorner(s,r,u,c,d),this.manhattanify(s,r))}}removeHandle(s,r){const d=[];s.children.forEach(l=>{l instanceof i.SRoutingHandleImpl&&(l.pointIndex>r?--l.pointIndex:l.pointIndex===r&&d.push(l))}),d.forEach(l=>s.remove(l))}addAdditionalCorner(s,r,d,l,c){if(r.length===0)return;const u=d.kind==="source"?r[0]:r[r.length-1],f=d.kind==="source"?0:r.length,h=f-(d.kind==="source"?1:0);let p;if(r.length>1)p=f===0?(0,e.almostEquals)(r[0].x,r[1].x):(0,e.almostEquals)(r[r.length-1].x,r[r.length-2].x);else{const g=l.getNearestSide(u);p=g===t.Side.TOP||g===t.Side.BOTTOM}if(p){if(u.y<d.get(t.Side.TOP).y||u.y>d.get(t.Side.BOTTOM).y){const g={x:d.get(t.Side.TOP).x,y:u.y};r.splice(f,0,g),c&&(s.children.forEach(m=>{m instanceof i.SRoutingHandleImpl&&m.pointIndex>=h&&++m.pointIndex}),this.addHandle(s,"manhattan-50%","volatile-routing-point",h))}}else if(u.x<d.get(t.Side.LEFT).x||u.x>d.get(t.Side.RIGHT).x){const g={x:u.x,y:d.get(t.Side.LEFT).y};r.splice(f,0,g),c&&(s.children.forEach(m=>{m instanceof i.SRoutingHandleImpl&&m.pointIndex>=h&&++m.pointIndex}),this.addHandle(s,"manhattan-50%","volatile-routing-point",h))}}manhattanify(s,r){for(let d=1;d<r.length;++d){const l=Math.abs(r[d-1].x-r[d].x)<1,c=Math.abs(r[d-1].y-r[d].y)<1;!l&&!c&&(r.splice(d,0,{x:r[d-1].x,y:r[d].y}),++d)}}calculateDefaultCorners(s,r,d,l){const c=super.calculateDefaultCorners(s,r,d,l);if(c.length>0)return c;const u=this.getBestConnectionAnchors(s,r,d,l),f=u.source,h=u.target,p=[],g=r.get(f);let m=d.get(h);switch(f){case t.Side.RIGHT:switch(h){case t.Side.BOTTOM:p.push({x:m.x,y:g.y});break;case t.Side.TOP:p.push({x:m.x,y:g.y});break;case t.Side.RIGHT:p.push({x:Math.max(g.x,m.x)+1.5*l.standardDistance,y:g.y}),p.push({x:Math.max(g.x,m.x)+1.5*l.standardDistance,y:m.y});break;case t.Side.LEFT:m.y!==g.y&&(p.push({x:(g.x+m.x)/2,y:g.y}),p.push({x:(g.x+m.x)/2,y:m.y}));break}break;case t.Side.LEFT:switch(h){case t.Side.BOTTOM:p.push({x:m.x,y:g.y});break;case t.Side.TOP:p.push({x:m.x,y:g.y});break;default:m=d.get(t.Side.RIGHT),m.y!==g.y&&(p.push({x:(g.x+m.x)/2,y:g.y}),p.push({x:(g.x+m.x)/2,y:m.y}));break}break;case t.Side.TOP:switch(h){case t.Side.RIGHT:m.x-g.x>0?(p.push({x:g.x,y:g.y-l.standardDistance}),p.push({x:m.x+1.5*l.standardDistance,y:g.y-l.standardDistance}),p.push({x:m.x+1.5*l.standardDistance,y:m.y})):p.push({x:g.x,y:m.y});break;case t.Side.LEFT:m.x-g.x<0?(p.push({x:g.x,y:g.y-l.standardDistance}),p.push({x:m.x-1.5*l.standardDistance,y:g.y-l.standardDistance}),p.push({x:m.x-1.5*l.standardDistance,y:m.y})):p.push({x:g.x,y:m.y});break;case t.Side.TOP:p.push({x:g.x,y:Math.min(g.y,m.y)-1.5*l.standardDistance}),p.push({x:m.x,y:Math.min(g.y,m.y)-1.5*l.standardDistance});break;case t.Side.BOTTOM:m.x!==g.x&&(p.push({x:g.x,y:(g.y+m.y)/2}),p.push({x:m.x,y:(g.y+m.y)/2}));break}break;case t.Side.BOTTOM:switch(h){case t.Side.RIGHT:m.x-g.x>0?(p.push({x:g.x,y:g.y+l.standardDistance}),p.push({x:m.x+1.5*l.standardDistance,y:g.y+l.standardDistance}),p.push({x:m.x+1.5*l.standardDistance,y:m.y})):p.push({x:g.x,y:m.y});break;case t.Side.LEFT:m.x-g.x<0?(p.push({x:g.x,y:g.y+l.standardDistance}),p.push({x:m.x-1.5*l.standardDistance,y:g.y+l.standardDistance}),p.push({x:m.x-1.5*l.standardDistance,y:m.y})):p.push({x:g.x,y:m.y});break;default:m=d.get(t.Side.TOP),m.x!==g.x&&(p.push({x:g.x,y:(g.y+m.y)/2}),p.push({x:m.x,y:(g.y+m.y)/2}));break}break}return p}getBestConnectionAnchors(s,r,d,l){let c=r.get(t.Side.RIGHT),u=d.get(t.Side.LEFT);if(u.x-c.x>l.standardDistance)return{source:t.Side.RIGHT,target:t.Side.LEFT};if(c=r.get(t.Side.LEFT),u=d.get(t.Side.RIGHT),c.x-u.x>l.standardDistance)return{source:t.Side.LEFT,target:t.Side.RIGHT};if(c=r.get(t.Side.TOP),u=d.get(t.Side.BOTTOM),c.y-u.y>l.standardDistance)return{source:t.Side.TOP,target:t.Side.BOTTOM};if(c=r.get(t.Side.BOTTOM),u=d.get(t.Side.TOP),u.y-c.y>l.standardDistance)return{source:t.Side.BOTTOM,target:t.Side.TOP};if(c=r.get(t.Side.RIGHT),u=d.get(t.Side.TOP),u.x-c.x>.5*l.standardDistance&&u.y-c.y>l.standardDistance)return{source:t.Side.RIGHT,target:t.Side.TOP};if(u=d.get(t.Side.BOTTOM),u.x-c.x>.5*l.standardDistance&&c.y-u.y>l.standardDistance)return{source:t.Side.RIGHT,target:t.Side.BOTTOM};if(c=r.get(t.Side.LEFT),u=d.get(t.Side.BOTTOM),c.x-u.x>.5*l.standardDistance&&c.y-u.y>l.standardDistance)return{source:t.Side.LEFT,target:t.Side.BOTTOM};if(u=d.get(t.Side.TOP),c.x-u.x>.5*l.standardDistance&&u.y-c.y>l.standardDistance)return{source:t.Side.LEFT,target:t.Side.TOP};if(c=r.get(t.Side.TOP),u=d.get(t.Side.RIGHT),c.y-u.y>.5*l.standardDistance&&c.x-u.x>l.standardDistance)return{source:t.Side.TOP,target:t.Side.RIGHT};if(u=d.get(t.Side.LEFT),c.y-u.y>.5*l.standardDistance&&u.x-c.x>l.standardDistance)return{source:t.Side.TOP,target:t.Side.LEFT};if(c=r.get(t.Side.BOTTOM),u=d.get(t.Side.RIGHT),u.y-c.y>.5*l.standardDistance&&c.x-u.x>l.standardDistance)return{source:t.Side.BOTTOM,target:t.Side.RIGHT};if(u=d.get(t.Side.LEFT),u.y-c.y>.5*l.standardDistance&&u.x-c.x>l.standardDistance)return{source:t.Side.BOTTOM,target:t.Side.LEFT};if(c=r.get(t.Side.TOP),u=d.get(t.Side.TOP),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)){if(c.y-u.y<0){if(Math.abs(c.x-u.x)>(r.bounds.width+l.standardDistance)/2)return{source:t.Side.TOP,target:t.Side.TOP}}else if(Math.abs(c.x-u.x)>d.bounds.width/2)return{source:t.Side.TOP,target:t.Side.TOP}}if(c=r.get(t.Side.RIGHT),u=d.get(t.Side.RIGHT),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)){if(c.x-u.x>0){if(Math.abs(c.y-u.y)>(r.bounds.height+l.standardDistance)/2)return{source:t.Side.RIGHT,target:t.Side.RIGHT}}else if(Math.abs(c.y-u.y)>d.bounds.height/2)return{source:t.Side.RIGHT,target:t.Side.RIGHT}}return c=r.get(t.Side.TOP),u=d.get(t.Side.RIGHT),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)?{source:t.Side.TOP,target:t.Side.RIGHT}:(u=d.get(t.Side.LEFT),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)?{source:t.Side.TOP,target:t.Side.LEFT}:(c=r.get(t.Side.BOTTOM),u=d.get(t.Side.RIGHT),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)?{source:t.Side.BOTTOM,target:t.Side.RIGHT}:(u=d.get(t.Side.LEFT),!e.Bounds.includes(d.bounds,c)&&!e.Bounds.includes(r.bounds,u)?{source:t.Side.BOTTOM,target:t.Side.LEFT}:{source:t.Side.RIGHT,target:t.Side.BOTTOM})))}}return hp.ManhattanEdgeRouter=a,a.KIND="manhattan",hp}var yO;function sP(){if(yO)return or;yO=1;var e=or&&or.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n,t,i;Object.defineProperty(or,"__esModule",{value:!0}),or.ManhattanEllipticAnchor=or.ManhattanDiamondAnchor=or.ManhattanRectangularAnchor=void 0;const a=at(),o=Zc(),s=Qc(),r=__(),d=G();let l=n=class{get kind(){return n.KIND}getAnchor(h,p,g){const m=h.bounds;if(m.width<=0||m.height<=0)return m;const v={x:m.x-g,y:m.y-g,width:m.width+2*g,height:m.height+2*g};return p.x>=v.x&&v.x+v.width>=p.x?p.y<v.y+.5*v.height?{x:p.x,y:v.y}:{x:p.x,y:v.y+v.height}:p.y>=v.y&&v.y+v.height>=p.y?p.x<v.x+.5*v.width?{x:v.x,y:p.y}:{x:v.x+v.width,y:p.y}:a.Bounds.center(v)}};or.ManhattanRectangularAnchor=l,l.KIND=r.ManhattanEdgeRouter.KIND+":"+s.RECTANGULAR_ANCHOR_KIND,or.ManhattanRectangularAnchor=l=n=e([(0,d.injectable)()],l);let c=t=class{get kind(){return t.KIND}getAnchor(h,p,g=0){const m=h.bounds;if(m.width<=0||m.height<=0)return m;const v={x:m.x-g,y:m.y-g,width:m.width+2*g,height:m.height+2*g},_=a.Bounds.center(v);let S,E;return p.x>=v.x&&p.x<=v.x+v.width?v.x+.5*v.width>=p.x?(E=new o.PointToPointLine(p,{x:p.x,y:_.y}),p.y<_.y?S=new o.PointToPointLine({x:v.x,y:_.y},{x:_.x,y:v.y}):S=new o.PointToPointLine({x:v.x,y:_.y},{x:_.x,y:v.y+v.height})):(E=new o.PointToPointLine(p,{x:p.x,y:_.y}),p.y<_.y?S=new o.PointToPointLine({x:v.x+v.width,y:_.y},{x:_.x,y:v.y}):S=new o.PointToPointLine({x:v.x+v.width,y:_.y},{x:_.x,y:v.y+v.height})):p.y>=v.y&&p.y<=v.y+v.height&&(v.y+.5*v.height>=p.y?(E=new o.PointToPointLine(p,{x:_.x,y:p.y}),p.x<_.x?S=new o.PointToPointLine({x:v.x,y:_.y},{x:_.x,y:v.y}):S=new o.PointToPointLine({x:v.x+v.width,y:_.y},{x:_.x,y:v.y})):(E=new o.PointToPointLine(p,{x:_.x,y:p.y}),p.x<_.x?S=new o.PointToPointLine({x:v.x,y:_.y},{x:_.x,y:v.y+v.height}):S=new o.PointToPointLine({x:v.x+v.width,y:_.y},{x:_.x,y:v.y+v.height}))),E&&S?(0,o.intersection)(S,E):_}};or.ManhattanDiamondAnchor=c,c.KIND=r.ManhattanEdgeRouter.KIND+":"+s.DIAMOND_ANCHOR_KIND,or.ManhattanDiamondAnchor=c=t=e([(0,d.injectable)()],c);let u=i=class{get kind(){return i.KIND}getAnchor(h,p,g=0){const m=h.bounds;if(m.width<=0||m.height<=0)return m;const v={x:m.x-g,y:m.y-g,width:m.width+2*g,height:m.height+2*g},_=a.Bounds.center(v),S=a.Point.subtract(p,_);let E=_.x,C=_.y;if(p.x>=v.x&&v.x+v.width>=p.x){E+=S.x;const M=.5*v.height*Math.sqrt(1-S.x*S.x/(.25*v.width*v.width));S.y<0?C-=M:C+=M}else if(p.y>=v.y&&v.y+v.height>=p.y){C+=S.y;const M=.5*v.width*Math.sqrt(1-S.y*S.y/(.25*v.height*v.height));S.x<0?E-=M:E+=M}return{x:E,y:C}}};return or.ManhattanEllipticAnchor=u,u.KIND=r.ManhattanEdgeRouter.KIND+":"+s.ELLIPTIC_ANCHOR_KIND,or.ManhattanEllipticAnchor=u=i=e([(0,d.injectable)()],u),or}var Mu={},_O;function aP(){if(_O)return Mu;_O=1;var e=Mu&&Mu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Mu,"__esModule",{value:!0}),Mu.RoutableView=void 0;const n=G(),t=on();let i=class{isVisible(o,s,r){if(r.targetKind==="hidden"||s.length===0)return!0;const d=(0,t.getAbsoluteRouteBounds)(o,s),l=o.root.canvasBounds;return d.x<=l.width&&d.x+d.width>=0&&d.y<=l.height&&d.y+d.height>=0}};return Mu.RoutableView=i,Mu.RoutableView=i=e([(0,n.injectable)()],i),Mu}var ln={},ta={},bO;function P7(){if(bO)return ta;bO=1;var e=ta&&ta.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=ta&&ta.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(ta,"__esModule",{value:!0}),ta.ModelRequestCommand=void 0;const t=G(),i=Se(),a=sn();let o=class extends a.SystemCommand{execute(r){const d=this.retrieveResult(r);return this.actionDispatcher.dispatch(d),{model:r.root,modelChanged:!1}}undo(r){return{model:r.root,modelChanged:!1}}redo(r){return{model:r.root,modelChanged:!1}}};return ta.ModelRequestCommand=o,e([(0,t.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],o.prototype,"actionDispatcher",void 0),ta.ModelRequestCommand=o=e([(0,t.injectable)()],o),ta}var gs={},SO;function b_(){if(SO)return gs;SO=1;var e=gs&&gs.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=gs&&gs.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)};Object.defineProperty(gs,"__esModule",{value:!0}),gs.findViewportScrollbar=gs.ScrollMouseListener=void 0;const t=G(),i=lt(),a=at(),o=ft(),s=Wr(),r=gi(),d=$a(),l=Wc(),c=on(),u=m_(),f=Ts(),h=Se();class p extends s.MouseListener{constructor(){super(...arguments),this.scrollbarMouseDownDelay=200}mouseDown(v,_){if((0,r.findParentByFeature)(v,l.isMoveable)===void 0&&!(v instanceof c.SRoutingHandleImpl)){const E=(0,r.findParentByFeature)(v,d.isViewport);if(E){if(this.lastScrollPosition={x:_.pageX,y:_.pageY},this.scrollbar=this.getScrollbar(_),this.scrollbar)return window.clearTimeout(this.scrollbarMouseDownTimeout),this.moveScrollBar(E,_,this.scrollbar,!0).map(C=>new Promise(M=>{this.scrollbarMouseDownTimeout=window.setTimeout(()=>M(C),this.scrollbarMouseDownDelay)}))}else this.lastScrollPosition=void 0,this.scrollbar=void 0}return[]}mouseMove(v,_){if(_.buttons===0)return this.mouseUp(v,_);if(this.scrollbar){window.clearTimeout(this.scrollbarMouseDownTimeout);const S=(0,r.findParentByFeature)(v,d.isViewport);if(S)return this.moveScrollBar(S,_,this.scrollbar)}if(this.lastScrollPosition){const S=(0,r.findParentByFeature)(v,d.isViewport);if(S)return this.dragCanvas(S,_,this.lastScrollPosition)}return[]}mouseEnter(v,_){return v instanceof o.SModelRootImpl&&_.buttons===0&&this.mouseUp(v,_),[]}mouseUp(v,_){return this.lastScrollPosition=void 0,this.scrollbar=void 0,[]}doubleClick(v,_){if((0,r.findParentByFeature)(v,d.isViewport)){const E=this.getScrollbar(_);if(E){window.clearTimeout(this.scrollbarMouseDownTimeout);const C=this.findClickTarget(E,_);let M;if(C&&C.id.startsWith("horizontal-projection:")?M=C.id.substring(22):C&&C.id.startsWith("vertical-projection:")&&(M=C.id.substring(20)),M)return[i.CenterAction.create([M],{animate:!0,retainZoom:!0})]}}return[]}dragCanvas(v,_,S){let E=(_.pageX-S.x)/v.zoom;(E>0&&(0,a.almostEquals)(v.scroll.x,this.viewerOptions.horizontalScrollLimits.min)||E<0&&(0,a.almostEquals)(v.scroll.x,this.viewerOptions.horizontalScrollLimits.max-v.canvasBounds.width/v.zoom))&&(E=0);let C=(_.pageY-S.y)/v.zoom;if((C>0&&(0,a.almostEquals)(v.scroll.y,this.viewerOptions.verticalScrollLimits.min)||C<0&&(0,a.almostEquals)(v.scroll.y,this.viewerOptions.verticalScrollLimits.max-v.canvasBounds.height/v.zoom))&&(C=0),E===0&&C===0)return[];const M={scroll:{x:v.scroll.x-E,y:v.scroll.y-C},zoom:v.zoom};return this.lastScrollPosition={x:_.pageX,y:_.pageY},[i.SetViewportAction.create(v.id,M,{animate:!1})]}moveScrollBar(v,_,S,E=!1){const C=(0,u.getModelBounds)(v);if(!C||v.zoom<=0)return[];const M=S.getBoundingClientRect();let L;if(this.getScrollbarOrientation(S)==="horizontal"){if(M.width<=0)return[];const I=v.canvasBounds.width/(v.zoom*C.width)*M.width;let R=_.clientX-M.x-I/2;if(R<0?R=0:R>M.width-I&&(R=M.width-I),L={x:C.x+R/M.width*C.width,y:v.scroll.y},L.x<this.viewerOptions.horizontalScrollLimits.min?L.x=this.viewerOptions.horizontalScrollLimits.min:L.x>this.viewerOptions.horizontalScrollLimits.max-v.canvasBounds.width/v.zoom&&(L.x=this.viewerOptions.horizontalScrollLimits.max-v.canvasBounds.width/v.zoom),(0,a.almostEquals)(L.x,v.scroll.x))return[]}else{if(M.height<=0)return[];const I=v.canvasBounds.height/(v.zoom*C.height)*M.height;let R=_.clientY-M.y-I/2;if(R<0?R=0:R>M.height-I&&(R=M.height-I),L={x:v.scroll.x,y:C.y+R/M.height*C.height},L.y<this.viewerOptions.verticalScrollLimits.min?L.y=this.viewerOptions.verticalScrollLimits.min:L.y>this.viewerOptions.verticalScrollLimits.max-v.canvasBounds.height/v.zoom&&(L.y=this.viewerOptions.verticalScrollLimits.max-v.canvasBounds.height/v.zoom),(0,a.almostEquals)(L.y,v.scroll.y))return[]}return[i.SetViewportAction.create(v.id,{scroll:L,zoom:v.zoom},{animate:E})]}getScrollbar(v){return g(v)}getScrollbarOrientation(v){return v.classList.contains("horizontal")?"horizontal":"vertical"}findClickTarget(v,_){const S=Array.from(v.children).filter(E=>E.id&&E.classList.contains("sprotty-projection")&&(0,f.hitsMouseEvent)(E,_));if(S.length>0)return S[S.length-1]}}gs.ScrollMouseListener=p,e([(0,t.inject)(h.TYPES.ViewerOptions),n("design:type",Object)],p.prototype,"viewerOptions",void 0);function g(m){let v=m.target;for(;v;){if(v.classList&&v.classList.contains("sprotty-projection-bar"))return v;v=v.parentElement}}return gs.findViewportScrollbar=g,gs}var EO;function cP(){if(EO)return ln;EO=1;var e=ln&&ln.__decorate||function(j,D,B,H){var F=arguments.length,K=F<3?D:H===null?H=Object.getOwnPropertyDescriptor(D,B):H,U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")K=Reflect.decorate(j,D,B,H);else for(var Z=j.length-1;Z>=0;Z--)(U=j[Z])&&(K=(F<3?U(K):F>3?U(D,B,K):U(D,B))||K);return F>3&&K&&Object.defineProperty(D,B,K),K},n=ln&&ln.__metadata||function(j,D){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(j,D)},t=ln&&ln.__param||function(j,D){return function(B,H){D(B,H,j)}};Object.defineProperty(ln,"__esModule",{value:!0}),ln.SelectKeyboardListener=ln.GetSelectionCommand=ln.SelectMouseListener=ln.SelectAllCommand=ln.SelectCommand=void 0;const i=G(),a=lt(),o=sn(),s=P7(),r=ft(),d=gi(),l=Se(),c=za(),u=Wr(),f=zn(),h=Ts(),p=Wd(),g=Ua(),m=Om(),v=KC(),_=Bm(),S=on(),E=on(),C=b_(),M=Sr();let L=class extends o.Command{constructor(D){super(),this.action=D,this.selected=[],this.deselected=[]}execute(D){const B=D.root;return this.action.selectedElementsIDs.forEach(H=>{const F=B.index.getById(H);F instanceof r.SChildElementImpl&&(0,M.isSelectable)(F)&&this.selected.push(F)}),this.action.deselectedElementsIDs.forEach(H=>{const F=B.index.getById(H);F instanceof r.SChildElementImpl&&(0,M.isSelectable)(F)&&this.deselected.push(F)}),this.redo(D)}undo(D){for(const B of this.selected)B.selected=!1;for(const B of this.deselected)B.selected=!0;return D.root}redo(D){for(const B of this.deselected)B.selected=!1;for(const B of this.selected)B.selected=!0;return D.root}};ln.SelectCommand=L,L.KIND=a.SelectAction.KIND,ln.SelectCommand=L=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.Action)),n("design:paramtypes",[Object])],L);let I=class extends o.Command{constructor(D){super(),this.action=D,this.previousSelection={}}execute(D){return this.selectAll(D.root,this.action.select),D.root}selectAll(D,B){(0,M.isSelectable)(D)&&(this.previousSelection[D.id]=D.selected,D.selected=B);for(const H of D.children)this.selectAll(H,B)}undo(D){const B=D.root.index;return Object.keys(this.previousSelection).forEach(H=>{const F=B.getById(H);F!==void 0&&(0,M.isSelectable)(F)&&(F.selected=this.previousSelection[H])}),D.root}redo(D){return this.selectAll(D.root,this.action.select),D.root}};ln.SelectAllCommand=I,I.KIND=a.SelectAllAction.KIND,ln.SelectAllCommand=I=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.Action)),n("design:paramtypes",[Object])],I);class R extends u.MouseListener{constructor(){super(...arguments),this.wasSelected=!1,this.hasDragged=!1,this.isMouseDown=!1}mouseDown(D,B){if(B.button!==0)return[];this.isMouseDown=!0;const H=this.handleButton(D,B);if(H)return H;const F=(0,d.findParentByFeature)(D,M.isSelectable);if((F!==void 0||D instanceof r.SModelRootImpl)&&(this.hasDragged=!1),F!==void 0){let K=[];if((0,h.isCtrlOrCmd)(B)||(K=this.collectElementsToDeselect(D,F)),F.selected){if((0,h.isCtrlOrCmd)(B))return this.wasSelected=!1,this.handleDeselectTarget(F,B);this.wasSelected=!0}else return this.wasSelected=!1,this.handleSelectTarget(F,K,B)}return[]}collectElementsToDeselect(D,B){return(0,p.toArray)(D.root.index.all().filter(H=>(0,M.isSelectable)(H)&&H.selected&&!(B instanceof S.SRoutingHandleImpl&&H===B.parent)))}handleButton(D,B){if(this.buttonHandlerRegistry!==void 0&&D instanceof v.SButtonImpl&&D.enabled){const H=this.buttonHandlerRegistry.get(D.type);if(H!==void 0)return H.buttonPressed(D)}}handleSelectTarget(D,B,H){const F=[];F.push(a.SelectAction.create({selectedElementsIDs:[D.id],deselectedElementsIDs:B.map(U=>U.id)})),F.push(a.BringToFrontAction.create([D.id]));const K=B.filter(U=>U instanceof E.SRoutableElementImpl).map(U=>U.id);return D instanceof E.SRoutableElementImpl?F.push(_.SwitchEditModeAction.create({elementsToActivate:[D.id],elementsToDeactivate:K})):K.length>0&&F.push(_.SwitchEditModeAction.create({elementsToDeactivate:K})),F}handleDeselectTarget(D,B){const H=[];return H.push(a.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[D.id]})),D instanceof E.SRoutableElementImpl&&H.push(_.SwitchEditModeAction.create({elementsToDeactivate:[D.id]})),H}handleDeselectAll(D,B){const H=[];H.push(a.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:D.map(K=>K.id)}));const F=D.filter(K=>K instanceof E.SRoutableElementImpl).map(K=>K.id);return F.length>0&&H.push(_.SwitchEditModeAction.create({elementsToDeactivate:F})),H}mouseMove(D,B){return this.hasDragged=this.isMouseDown,[]}mouseUp(D,B){if(B.button===0&&!this.hasDragged){const H=(0,d.findParentByFeature)(D,M.isSelectable);if(H!==void 0){if(this.wasSelected)return[a.SelectAction.create({selectedElementsIDs:[H.id],deselectedElementsIDs:[]})]}else if(D instanceof r.SModelRootImpl&&!(0,C.findViewportScrollbar)(B)||!(D instanceof r.SModelRootImpl))return this.handleDeselectAll(this.collectElementsToDeselect(D,void 0),B)}return this.isMouseDown=!1,this.hasDragged=!1,[]}decorate(D,B){const H=(0,d.findParentByFeature)(B,M.isSelectable);return H!==void 0&&(0,f.setClass)(D,"selected",H.selected),D}}ln.SelectMouseListener=R,e([(0,i.inject)(m.ButtonHandlerRegistry),(0,i.optional)(),n("design:type",m.ButtonHandlerRegistry)],R.prototype,"buttonHandlerRegistry",void 0);let w=class extends s.ModelRequestCommand{constructor(D){super(),this.action=D,this.previousSelection={}}retrieveResult(D){const B=D.root.index.all().filter(H=>(0,M.isSelectable)(H)&&H.selected).map(H=>H.id);return a.SelectionResult.create((0,p.toArray)(B),this.action.requestId)}};ln.GetSelectionCommand=w,w.KIND=a.GetSelectionAction.KIND,ln.GetSelectionCommand=w=e([(0,i.injectable)(),t(0,(0,i.inject)(l.TYPES.Action)),n("design:paramtypes",[Object])],w);class T extends c.KeyListener{keyDown(D,B){return(0,g.matchesKeystroke)(B,"KeyA","ctrlCmd")?[a.SelectAllAction.create()]:[]}}return ln.SelectKeyboardListener=T,ln}var pp={},CO;function R7(){if(CO)return pp;CO=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.UndoRedoKeyListener=void 0;const e=lt(),n=Ua(),t=za(),i=Ts();class a extends t.KeyListener{keyDown(s,r){return(0,n.matchesKeystroke)(r,"KeyZ","ctrlCmd")?[e.UndoAction.create()]:(0,n.matchesKeystroke)(r,"KeyZ","ctrlCmd","shift")||!(0,i.isMac)()&&(0,n.matchesKeystroke)(r,"KeyY","ctrlCmd")?[e.RedoAction.create()]:[]}}return pp.UndoRedoKeyListener=a,pp}var yc={},PO;function S_(){if(PO)return yc;PO=1,Object.defineProperty(yc,"__esModule",{value:!0}),yc.applyMatches=yc.ModelMatcher=yc.forEachMatch=void 0;const e=ft(),n=Yr();function t(o,s){Object.keys(o).forEach(r=>s(r,o[r]))}yc.forEachMatch=t;class i{match(s,r){const d={};return this.matchLeft(s,d),this.matchRight(r,d),d}matchLeft(s,r,d){let l=r[s.id];if(l!==void 0?(l.left=s,l.leftParentId=d):(l={left:s,leftParentId:d},r[s.id]=l),(0,e.isParent)(s))for(const c of s.children)this.matchLeft(c,r,s.id)}matchRight(s,r,d){let l=r[s.id];if(l!==void 0?(l.right=s,l.rightParentId=d):(l={right:s,rightParentId:d},r[s.id]=l),(0,e.isParent)(s))for(const c of s.children)this.matchRight(c,r,s.id)}}yc.ModelMatcher=i;function a(o,s,r){o instanceof e.SModelRootImpl?r=o.index:r===void 0&&(r=new n.SModelIndex,r.add(o));for(const d of s){let l=!1;if(d.left!==void 0&&d.leftParentId!==void 0){const c=r.getById(d.leftParentId);if(c!==void 0&&c.children!==void 0){const u=c.children.indexOf(d.left);u>=0&&(d.right!==void 0&&d.leftParentId===d.rightParentId?(c.children.splice(u,1,d.right),l=!0):c.children.splice(u,1)),r.remove(d.left)}}if(!l&&d.right!==void 0&&d.rightParentId!==void 0){const c=r.getById(d.rightParentId);c!==void 0&&(c.children===void 0&&(c.children=[]),c.children.push(d.right))}}}return yc.applyMatches=a,yc}var go={},gp={},RO;function gU(){if(RO)return gp;RO=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.ResizeAnimation=void 0;const e=Qd();class n extends e.Animation{constructor(i,a,o,s=!1){super(o),this.model=i,this.elementResizes=a,this.reverse=s}tween(i){return this.elementResizes.forEach(a=>{const o=a.element,s=this.reverse?{width:(1-i)*a.toDimension.width+i*a.fromDimension.width,height:(1-i)*a.toDimension.height+i*a.fromDimension.height}:{width:(1-i)*a.fromDimension.width+i*a.toDimension.width,height:(1-i)*a.fromDimension.height+i*a.toDimension.height};o.bounds={x:o.bounds.x,y:o.bounds.y,width:s.width,height:s.height}}),this.model}}return gp.ResizeAnimation=n,gp}var MO;function E_(){if(MO)return go;MO=1;var e=go&&go.__decorate||function(I,R,w,T){var j=arguments.length,D=j<3?R:T===null?T=Object.getOwnPropertyDescriptor(R,w):T,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(I,R,w,T);else for(var H=I.length-1;H>=0;H--)(B=I[H])&&(D=(j<3?B(D):j>3?B(R,w,D):B(R,w))||D);return j>3&&D&&Object.defineProperty(R,w,D),D},n=go&&go.__metadata||function(I,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,R)},t=go&&go.__param||function(I,R){return function(w,T){R(w,T,I)}};Object.defineProperty(go,"__esModule",{value:!0}),go.UpdateModelCommand=void 0;const i=G(),a=lt(),o=at(),s=Qd(),r=sn(),d=h_(),l=ft(),c=xm(),u=rh(),f=Wc(),h=Ft(),p=c_(),g=Sr(),m=S_(),v=gU(),_=Se(),S=$a(),E=Os(),C=on(),M=gi();let L=class extends r.Command{constructor(R){super(),this.action=R}execute(R){let w;return this.action.newRoot!==void 0?w=R.modelFactory.createRoot(this.action.newRoot):(w=R.modelFactory.createRoot(R.root),this.action.matches!==void 0&&this.applyMatches(w,this.action.matches,R)),this.oldRoot=R.root,this.newRoot=w,this.performUpdate(this.oldRoot,this.newRoot,R)}performUpdate(R,w,T){if((this.action.animate===void 0||this.action.animate)&&R.id===w.id){let j;this.action.matches===void 0?j=new m.ModelMatcher().match(R,w):j=this.convertToMatchResult(this.action.matches,R,w);const D=this.computeAnimation(w,j,T);return D instanceof s.Animation?D.start():D}else return R.type===w.type&&o.Dimension.isValid(R.canvasBounds)&&(w.canvasBounds=R.canvasBounds),(0,S.isViewport)(R)&&(0,S.isViewport)(w)&&(w.zoom=R.zoom,w.scroll=R.scroll),w}applyMatches(R,w,T){const j=R.index;for(const D of w)if(D.left!==void 0){const B=j.getById(D.left.id);B instanceof l.SChildElementImpl&&B.parent.remove(B)}for(const D of w)if(D.right!==void 0){const B=T.modelFactory.createElement(D.right);let H;D.rightParentId!==void 0&&(H=j.getById(D.rightParentId)),H instanceof l.SParentElementImpl?H.add(B):R.add(B)}}convertToMatchResult(R,w,T){const j={};for(const D of R){const B={};let H;D.left!==void 0&&(H=D.left.id,B.left=w.index.getById(H),B.leftParentId=D.leftParentId),D.right!==void 0&&(H=D.right.id,B.right=T.index.getById(H),B.rightParentId=D.rightParentId),H!==void 0&&(j[H]=B)}return j}computeAnimation(R,w,T){const j={fades:[]};(0,m.forEachMatch)(w,(B,H)=>{if(H.left!==void 0&&H.right!==void 0)this.updateElement(H.left,H.right,j);else if(H.right!==void 0){const F=H.right;(0,u.isFadeable)(F)&&(F.opacity=0,j.fades.push({element:F,type:"in"}))}else if(H.left instanceof l.SChildElementImpl){const F=H.left;if((0,u.isFadeable)(F)&&H.leftParentId!==void 0&&!(0,M.containsSome)(R,F)){const K=R.index.getById(H.leftParentId);if(K instanceof l.SParentElementImpl){const U=T.modelFactory.createElement(F);K.add(U),j.fades.push({element:U,type:"out"})}}}});const D=this.createAnimations(j,R,T);return D.length>=2?new s.CompoundAnimation(R,T,D):D.length===1?D[0]:R}updateElement(R,w,T){if((0,f.isLocateable)(R)&&(0,f.isLocateable)(w)){const j=R.position,D=w.position;(!(0,o.almostEquals)(j.x,D.x)||!(0,o.almostEquals)(j.y,D.y))&&(T.moves===void 0&&(T.moves=[]),T.moves.push({element:w,fromPosition:j,toPosition:D}),w.position=j)}(0,h.isSizeable)(R)&&(0,h.isSizeable)(w)&&(o.Dimension.isValid(w.bounds)?(!(0,o.almostEquals)(R.bounds.width,w.bounds.width)||!(0,o.almostEquals)(R.bounds.height,w.bounds.height))&&(T.resizes===void 0&&(T.resizes=[]),T.resizes.push({element:w,fromDimension:{width:R.bounds.width,height:R.bounds.height},toDimension:{width:w.bounds.width,height:w.bounds.height}})):w.bounds={x:w.bounds.x,y:w.bounds.y,width:R.bounds.width,height:R.bounds.height}),R instanceof C.SRoutableElementImpl&&w instanceof C.SRoutableElementImpl&&this.edgeRouterRegistry&&(T.edgeMementi===void 0&&(T.edgeMementi=[]),T.edgeMementi.push({edge:w,before:this.takeSnapshot(R),after:this.takeSnapshot(w)})),(0,g.isSelectable)(R)&&(0,g.isSelectable)(w)&&(w.selected=R.selected),R instanceof l.SModelRootImpl&&w instanceof l.SModelRootImpl&&(w.canvasBounds=R.canvasBounds),R instanceof p.ViewportRootElementImpl&&w instanceof p.ViewportRootElementImpl&&(w.scroll=R.scroll,w.zoom=R.zoom)}takeSnapshot(R){return this.edgeRouterRegistry.get(R.routerKind).takeSnapshot(R)}createAnimations(R,w,T){const j=[];if(R.fades.length>0&&j.push(new d.FadeAnimation(w,R.fades,T,!0)),R.moves!==void 0&&R.moves.length>0){const D=new Map;for(const B of R.moves)D.set(B.element.id,B);j.push(new c.MoveAnimation(w,D,T,!1))}if(R.resizes!==void 0&&R.resizes.length>0){const D=new Map;for(const B of R.resizes)D.set(B.element.id,B);j.push(new v.ResizeAnimation(w,D,T,!1))}return R.edgeMementi!==void 0&&R.edgeMementi.length>0&&j.push(new c.MorphEdgesAnimation(w,R.edgeMementi,T,!1)),j}undo(R){return this.performUpdate(this.newRoot,this.oldRoot,R)}redo(R){return this.performUpdate(this.oldRoot,this.newRoot,R)}};return go.UpdateModelCommand=L,L.KIND=a.UpdateModelAction.KIND,e([(0,i.inject)(E.EdgeRouterRegistry),(0,i.optional)(),n("design:type",E.EdgeRouterRegistry)],L.prototype,"edgeRouterRegistry",void 0),go.UpdateModelCommand=L=e([(0,i.injectable)(),t(0,(0,i.inject)(_.TYPES.Action)),n("design:paramtypes",[Object])],L),go}var wn={},ri={},AO;function Fm(){if(AO)return ri;AO=1;var e=ri&&ri.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},n=ri&&ri.__metadata||function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},t=ri&&ri.__param||function(g,m){return function(v,_){m(v,_,g)}},i;Object.defineProperty(ri,"__esModule",{value:!0}),ri.ViewportAnimation=ri.GetViewportCommand=ri.SetViewportCommand=void 0;const a=G(),o=lt(),s=at(),r=sn(),d=Qd(),l=$a(),c=Se(),u=P7();let f=i=class extends r.MergeableCommand{constructor(m){super(),this.action=m,this.newViewport=m.newViewport}execute(m){const v=m.root,_=v.index.getById(this.action.elementId);if(_&&(0,l.isViewport)(_)){this.element=_,this.oldViewport={scroll:this.element.scroll,zoom:this.element.zoom};const{zoomLimits:S,horizontalScrollLimits:E,verticalScrollLimits:C}=this.viewerOptions;return this.newViewport=(0,l.limitViewport)(this.newViewport,v.canvasBounds,E,C,S),this.setViewport(_,this.oldViewport,this.newViewport,m)}return m.root}setViewport(m,v,_,S){if(m&&(0,l.isViewport)(m)){if(this.action.animate)return new p(m,v,_,S).start();m.scroll=_.scroll,m.zoom=_.zoom}return S.root}undo(m){return this.setViewport(this.element,this.newViewport,this.oldViewport,m)}redo(m){return this.setViewport(this.element,this.oldViewport,this.newViewport,m)}merge(m,v){return!this.action.animate&&m instanceof i&&this.element===m.element?(this.newViewport=m.newViewport,!0):!1}};ri.SetViewportCommand=f,f.KIND=o.SetViewportAction.KIND,e([(0,a.inject)(c.TYPES.ViewerOptions),n("design:type",Object)],f.prototype,"viewerOptions",void 0),ri.SetViewportCommand=f=i=e([(0,a.injectable)(),t(0,(0,a.inject)(c.TYPES.Action)),n("design:paramtypes",[Object])],f);let h=class extends u.ModelRequestCommand{constructor(m){super(),this.action=m}retrieveResult(m){const v=m.root;let _;return(0,l.isViewport)(v)?_={scroll:v.scroll,zoom:v.zoom}:_={scroll:s.Point.ORIGIN,zoom:1},o.ViewportResult.create(_,v.canvasBounds,this.action.requestId)}};ri.GetViewportCommand=h,h.KIND=o.GetViewportAction.KIND,ri.GetViewportCommand=h=e([t(0,(0,a.inject)(c.TYPES.Action)),n("design:paramtypes",[Object])],h);class p extends d.Animation{constructor(m,v,_,S){super(S),this.element=m,this.oldViewport=v,this.newViewport=_,this.context=S,this.zoomFactor=Math.log(_.zoom/v.zoom)}tween(m,v){return this.element.scroll={x:(1-m)*this.oldViewport.scroll.x+m*this.newViewport.scroll.x,y:(1-m)*this.oldViewport.scroll.y+m*this.newViewport.scroll.y},this.element.zoom=this.oldViewport.zoom*Math.exp(m*this.zoomFactor),v.root}}return ri.ViewportAnimation=p,ri}var wO;function C_(){if(wO)return wn;wO=1;var e=wn&&wn.__decorate||function(S,E,C,M){var L=arguments.length,I=L<3?E:M===null?M=Object.getOwnPropertyDescriptor(E,C):M,R;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")I=Reflect.decorate(S,E,C,M);else for(var w=S.length-1;w>=0;w--)(R=S[w])&&(I=(L<3?R(I):L>3?R(E,C,I):R(E,C))||I);return L>3&&I&&Object.defineProperty(E,C,I),I},n=wn&&wn.__metadata||function(S,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,E)},t=wn&&wn.__param||function(S,E){return function(C,M){E(C,M,S)}};Object.defineProperty(wn,"__esModule",{value:!0}),wn.CenterKeyboardListener=wn.FitToScreenCommand=wn.CenterCommand=wn.BoundsAwareViewportCommand=void 0;const i=lt(),a=at(),o=Ua(),s=ft(),r=sn(),d=za(),l=Ft(),c=Sr(),u=Fm(),f=$a(),h=G(),p=Se();let g=class extends r.Command{constructor(E){super(),this.animate=E}initialize(E){if(!(0,f.isViewport)(E))return;this.oldViewport={scroll:E.scroll,zoom:E.zoom};const C=[];if(this.getElementIds().forEach(M=>{const L=E.index.getById(M);L&&(0,l.isBoundsAware)(L)&&C.push(this.boundsInViewport(L,L.bounds,E))}),C.length===0&&E.index.all().forEach(M=>{(0,c.isSelectable)(M)&&M.selected&&(0,l.isBoundsAware)(M)&&C.push(this.boundsInViewport(M,M.bounds,E))}),C.length===0&&E.index.all().forEach(M=>{(0,l.isBoundsAware)(M)&&C.push(this.boundsInViewport(M,M.bounds,E))}),C.length!==0){const M=C.reduce((L,I)=>a.Bounds.combine(L,I));if(a.Dimension.isValid(M)){const L=this.getNewViewport(M,E);if(L){const{zoomLimits:I,horizontalScrollLimits:R,verticalScrollLimits:w}=this.viewerOptions;this.newViewport=(0,f.limitViewport)(L,E.canvasBounds,R,w,I)}}}}boundsInViewport(E,C,M){return E instanceof s.SChildElementImpl&&E.parent!==M?this.boundsInViewport(E.parent,E.parent.localToParent(C),M):C}execute(E){return this.initialize(E.root),this.redo(E)}undo(E){const C=E.root;if((0,f.isViewport)(C)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new u.ViewportAnimation(C,this.newViewport,this.oldViewport,E).start();C.scroll=this.oldViewport.scroll,C.zoom=this.oldViewport.zoom}return C}redo(E){const C=E.root;if((0,f.isViewport)(C)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new u.ViewportAnimation(C,this.oldViewport,this.newViewport,E).start();C.scroll=this.newViewport.scroll,C.zoom=this.newViewport.zoom}return C}equal(E,C){return(0,a.almostEquals)(E.zoom,C.zoom)&&(0,a.almostEquals)(E.scroll.x,C.scroll.x)&&(0,a.almostEquals)(E.scroll.y,C.scroll.y)}};wn.BoundsAwareViewportCommand=g,e([(0,h.inject)(p.TYPES.ViewerOptions),n("design:type",Object)],g.prototype,"viewerOptions",void 0),wn.BoundsAwareViewportCommand=g=e([(0,h.injectable)(),n("design:paramtypes",[Boolean])],g);let m=class extends g{constructor(E){super(E.animate),this.action=E}getElementIds(){return this.action.elementIds}getNewViewport(E,C){if(!a.Dimension.isValid(C.canvasBounds))return;let M=1;this.action.retainZoom&&(0,f.isViewport)(C)?M=C.zoom:this.action.zoomScale&&(M=this.action.zoomScale);const L=a.Bounds.center(E);return{scroll:{x:L.x-.5*C.canvasBounds.width/M,y:L.y-.5*C.canvasBounds.height/M},zoom:M}}};wn.CenterCommand=m,m.KIND=i.CenterAction.KIND,wn.CenterCommand=m=e([t(0,(0,h.inject)(p.TYPES.Action)),n("design:paramtypes",[Object])],m);let v=class extends g{constructor(E){super(E.animate),this.action=E}getElementIds(){return this.action.elementIds}getNewViewport(E,C){if(!a.Dimension.isValid(C.canvasBounds))return;const M=a.Bounds.center(E),L=this.action.padding===void 0?0:2*this.action.padding;let I=Math.min(C.canvasBounds.width/(E.width+L),C.canvasBounds.height/(E.height+L));return this.action.maxZoom!==void 0&&(I=Math.min(I,this.action.maxZoom)),I===1/0&&(I=1),{scroll:{x:M.x-.5*C.canvasBounds.width/I,y:M.y-.5*C.canvasBounds.height/I},zoom:I}}};wn.FitToScreenCommand=v,v.KIND=i.FitToScreenAction.KIND,wn.FitToScreenCommand=v=e([t(0,(0,h.inject)(p.TYPES.Action)),n("design:paramtypes",[Object])],v);class _ extends d.KeyListener{keyDown(E,C){return(0,o.matchesKeystroke)(C,"KeyC","ctrlCmd","shift")?[i.CenterAction.create([])]:(0,o.matchesKeystroke)(C,"KeyF","ctrlCmd","shift")?[i.FitToScreenAction.create([])]:[]}}return wn.CenterKeyboardListener=_,wn}var mo={},IO;function uP(){if(IO)return mo;IO=1;var e=mo&&mo.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=mo&&mo.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=mo&&mo.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(mo,"__esModule",{value:!0}),mo.BringToFrontCommand=void 0;const i=G(),a=lt(),o=Se(),s=ft(),r=sn(),d=on();let l=class extends r.Command{constructor(u){super(),this.action=u,this.selected=[]}execute(u){const f=u.root;return this.action.elementIDs.forEach(h=>{const p=f.index.getById(h);p instanceof d.SRoutableElementImpl&&(p.source&&this.addToSelection(p.source),p.target&&this.addToSelection(p.target)),p instanceof s.SChildElementImpl&&this.addToSelection(p),this.includeConnectedEdges(p)}),this.redo(u)}includeConnectedEdges(u){if(u instanceof d.SConnectableElementImpl&&(u.incomingEdges.forEach(f=>this.addToSelection(f)),u.outgoingEdges.forEach(f=>this.addToSelection(f))),u instanceof s.SParentElementImpl)for(const f of u.children)this.includeConnectedEdges(f)}addToSelection(u){this.selected.push({element:u,index:u.parent.children.indexOf(u)})}undo(u){for(let f=this.selected.length-1;f>=0;f--){const h=this.selected[f],p=h.element;p.parent.move(p,h.index)}return u.root}redo(u){for(let f=0;f<this.selected.length;f++)this.bringToFront(this.selected[f]);return u.root}bringToFront(u){const f=u.element,h=f.parent.children.length;f.parent.move(f,h-1)}};return mo.BringToFrontCommand=l,l.KIND=a.BringToFrontAction.KIND,mo.BringToFrontCommand=l=e([(0,i.injectable)(),t(0,(0,i.inject)(o.TYPES.Action)),n("design:paramtypes",[Object])],l),mo}var A1={},TO;function M7(){if(TO)return A1;TO=1,Object.defineProperty(A1,"__esModule",{value:!0});const e=G(),n=Se(),t=n_(),i=xC(),a=i_(),o=br(),s=kC(),r=FC(),d=m7(),l=new e.ContainerModule((c,u,f)=>{(0,o.configureCommand)({bind:c,isBound:f},t.SetBoundsCommand),(0,o.configureCommand)({bind:c,isBound:f},t.RequestBoundsCommand),c(i.HiddenBoundsUpdater).toSelf().inSingletonScope(),c(n.TYPES.HiddenVNodePostprocessor).toService(i.HiddenBoundsUpdater),c(n.TYPES.Layouter).to(a.Layouter).inSingletonScope(),c(n.TYPES.LayoutRegistry).to(a.LayoutRegistry).inSingletonScope(),(0,a.configureLayout)({bind:c,isBound:f},r.VBoxLayouter.KIND,r.VBoxLayouter),(0,a.configureLayout)({bind:c,isBound:f},s.HBoxLayouter.KIND,s.HBoxLayouter),(0,a.configureLayout)({bind:c,isBound:f},d.StackLayouter.KIND,d.StackLayouter)});return A1.default=l,A1}var w1={},DO;function lP(){if(DO)return w1;DO=1,Object.defineProperty(w1,"__esModule",{value:!0});const e=G(),n=Om(),t=new e.ContainerModule(i=>{i(n.ButtonHandlerRegistry).toSelf().inSingletonScope()});return w1.default=t,w1}var I1={},OO;function A7(){if(OO)return I1;OO=1,Object.defineProperty(I1,"__esModule",{value:!0});const e=G(),n=Se(),t=o_(),i=VC(),a=new e.ContainerModule(o=>{o(i.CommandPalette).toSelf().inSingletonScope(),o(n.TYPES.IUIExtension).toService(i.CommandPalette),o(i.CommandPaletteKeyListener).toSelf().inSingletonScope(),o(n.TYPES.KeyListener).toService(i.CommandPaletteKeyListener),o(t.CommandPaletteActionProviderRegistry).toSelf().inSingletonScope(),o(n.TYPES.ICommandPaletteActionProviderRegistry).toService(t.CommandPaletteActionProviderRegistry)});return I1.default=a,I1}var T1={},LO;function w7(){if(LO)return T1;LO=1,Object.defineProperty(T1,"__esModule",{value:!0});const e=G(),n=s_(),t=GC(),i=Se(),a=new e.ContainerModule(o=>{o(i.TYPES.IContextMenuServiceProvider).toProvider(s=>()=>new Promise((r,d)=>{s.container.isBound(i.TYPES.IContextMenuService)?r(s.container.get(i.TYPES.IContextMenuService)):d()})),o(t.ContextMenuMouseListener).toSelf().inSingletonScope(),o(i.TYPES.MouseListener).toService(t.ContextMenuMouseListener),o(i.TYPES.IContextMenuProviderRegistry).to(n.ContextMenuProviderRegistry)});return T1.default=a,T1}var D1={},jO;function I7(){if(jO)return D1;jO=1,Object.defineProperty(D1,"__esModule",{value:!0});const e=ih(),n=G(),t=p_(),i=XC(),a=Se(),o=eP(),s=new n.ContainerModule((r,d,l)=>{(0,e.configureModelElement)({bind:r,isBound:l},"marker",t.SIssueMarkerImpl,i.IssueMarkerView),r(o.DecorationPlacer).toSelf().inSingletonScope(),r(a.TYPES.IVNodePostprocessor).toService(o.DecorationPlacer)});return D1.default=s,D1}var O1={},NO;function T7(){if(NO)return O1;NO=1,Object.defineProperty(O1,"__esModule",{value:!0});const e=G(),n=Se(),t=g_(),i=new e.ContainerModule(a=>{a(t.IntersectionFinder).toSelf().inSingletonScope(),a(n.TYPES.IEdgeRoutePostprocessor).toService(t.IntersectionFinder)});return O1.default=i,O1}var L1={},BO;function D7(){if(BO)return L1;BO=1,Object.defineProperty(L1,"__esModule",{value:!0});const e=G(),n=Se(),t=nP(),i=S7(),a=new e.ContainerModule(o=>{o(t.JunctionFinder).toSelf().inSingletonScope(),o(n.TYPES.IEdgeRoutePostprocessor).toService(t.JunctionFinder),o(i.JunctionPostProcessor).toSelf().inSingletonScope(),o(n.TYPES.IVNodePostprocessor).toService(i.JunctionPostProcessor),o(n.TYPES.HiddenVNodePostprocessor).toService(i.JunctionPostProcessor)});return L1.default=a,L1}var j1={},xO;function dP(){if(xO)return j1;xO=1,Object.defineProperty(j1,"__esModule",{value:!0});const e=G(),n=Om(),t=ZC(),i=new e.ContainerModule((a,o,s)=>{(0,n.configureButtonHandler)({bind:a,isBound:s},t.ExpandButtonHandler.TYPE,t.ExpandButtonHandler)});return j1.default=i,j1}var N1={},FO;function O7(){if(FO)return N1;FO=1,Object.defineProperty(N1,"__esModule",{value:!0});const e=G(),n=Se(),t=QC(),i=f_(),a=br(),o=new e.ContainerModule((s,r,d)=>{s(t.ExportSvgKeyListener).toSelf().inSingletonScope(),s(n.TYPES.KeyListener).toService(t.ExportSvgKeyListener),s(t.ExportSvgPostprocessor).toSelf().inSingletonScope(),s(n.TYPES.HiddenVNodePostprocessor).toService(t.ExportSvgPostprocessor),(0,a.configureCommand)({bind:s,isBound:d},t.ExportSvgCommand),s(n.TYPES.SvgExporter).to(i.SvgExporter).inSingletonScope()});return N1.default=o,N1}var B1={},kO;function fP(){if(kO)return B1;kO=1,Object.defineProperty(B1,"__esModule",{value:!0});const e=G(),n=Se(),t=h_(),i=new e.ContainerModule(a=>{a(t.ElementFader).toSelf().inSingletonScope(),a(n.TYPES.IVNodePostprocessor).toService(t.ElementFader)});return B1.default=i,B1}var x1={},na={},KO;function L7(){if(KO)return na;KO=1;var e=na&&na.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n=na&&na.__metadata||function(o,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,s)};Object.defineProperty(na,"__esModule",{value:!0}),na.PopupPositionUpdater=void 0;const t=G(),i=Se();let a=class{decorate(s,r){return s}postUpdate(){const s=document.getElementById(this.options.popupDiv);if(s!==null&&typeof window<"u"){const r=s.getBoundingClientRect();window.innerHeight<r.height+r.top&&(s.style.top=window.pageYOffset+window.innerHeight-r.height-5+"px"),window.innerWidth<r.left+r.width&&(s.style.left=window.pageXOffset+window.innerWidth-r.width-5+"px"),r.left<0&&(s.style.left="0px"),r.top<0&&(s.style.top="0px")}}};return na.PopupPositionUpdater=a,e([(0,t.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],a.prototype,"options",void 0),na.PopupPositionUpdater=a=e([(0,t.injectable)()],a),na}var qO;function j7(){if(qO)return x1;qO=1,Object.defineProperty(x1,"__esModule",{value:!0});const e=G(),n=Se(),t=JC(),i=L7(),a=br(),o=wm(),s=C_(),r=Fm(),d=xm(),l=new e.ContainerModule((c,u,f)=>{c(i.PopupPositionUpdater).toSelf().inSingletonScope(),c(n.TYPES.PopupVNodePostprocessor).toService(i.PopupPositionUpdater),c(t.HoverMouseListener).toSelf().inSingletonScope(),c(n.TYPES.MouseListener).toService(t.HoverMouseListener),c(t.PopupHoverMouseListener).toSelf().inSingletonScope(),c(n.TYPES.PopupMouseListener).toService(t.PopupHoverMouseListener),c(t.HoverKeyListener).toSelf().inSingletonScope(),c(n.TYPES.KeyListener).toService(t.HoverKeyListener),c(n.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),c(t.ClosePopupActionHandler).toSelf().inSingletonScope();const h={bind:c,isBound:f};(0,a.configureCommand)(h,t.HoverFeedbackCommand),(0,a.configureCommand)(h,t.SetPopupModelCommand),(0,o.configureActionHandler)(h,t.SetPopupModelCommand.KIND,t.ClosePopupActionHandler),(0,o.configureActionHandler)(h,s.FitToScreenCommand.KIND,t.ClosePopupActionHandler),(0,o.configureActionHandler)(h,s.CenterCommand.KIND,t.ClosePopupActionHandler),(0,o.configureActionHandler)(h,r.SetViewportCommand.KIND,t.ClosePopupActionHandler),(0,o.configureActionHandler)(h,d.MoveCommand.KIND,t.ClosePopupActionHandler)});return x1.default=l,x1}var F1={},HO;function hP(){if(HO)return F1;HO=1,Object.defineProperty(F1,"__esModule",{value:!0});const e=G(),n=Se(),t=xm(),i=br(),a=new e.ContainerModule((o,s,r)=>{o(t.MoveMouseListener).toSelf().inSingletonScope(),o(n.TYPES.MouseListener).toService(t.MoveMouseListener),(0,i.configureCommand)({bind:o,isBound:r},t.MoveCommand),o(t.LocationPostprocessor).toSelf().inSingletonScope(),o(n.TYPES.IVNodePostprocessor).toService(t.LocationPostprocessor),o(n.TYPES.HiddenVNodePostprocessor).toService(t.LocationPostprocessor)});return F1.default=a,F1}var k1={},VO;function pP(){if(VO)return k1;VO=1,Object.defineProperty(k1,"__esModule",{value:!0});const e=G(),n=Se(),t=rP(),i=new e.ContainerModule(a=>{a(t.OpenMouseListener).toSelf().inSingletonScope(),a(n.TYPES.MouseListener).toService(t.OpenMouseListener)});return k1.default=i,k1}var K1={},GO;function N7(){if(GO)return K1;GO=1,Object.defineProperty(K1,"__esModule",{value:!0});const e=G(),n=Se(),t=__(),i=jm(),a=sP(),o=v_(),s=Qc(),r=Os(),d=y_(),l=oP(),c=br(),u=new e.ContainerModule((f,h,p)=>{f(r.EdgeRouterRegistry).toSelf().inSingletonScope(),f(s.AnchorComputerRegistry).toSelf().inSingletonScope(),f(t.ManhattanEdgeRouter).toSelf().inSingletonScope(),f(n.TYPES.IEdgeRouter).toService(t.ManhattanEdgeRouter),f(a.ManhattanEllipticAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(a.ManhattanEllipticAnchor),f(a.ManhattanRectangularAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(a.ManhattanRectangularAnchor),f(a.ManhattanDiamondAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(a.ManhattanDiamondAnchor),f(i.PolylineEdgeRouter).toSelf().inSingletonScope(),f(n.TYPES.IEdgeRouter).toService(i.PolylineEdgeRouter),f(o.EllipseAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(o.EllipseAnchor),f(o.RectangleAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(o.RectangleAnchor),f(o.DiamondAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(o.DiamondAnchor),f(d.BezierEdgeRouter).toSelf().inSingletonScope(),f(n.TYPES.IEdgeRouter).toService(d.BezierEdgeRouter),f(l.BezierEllipseAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(l.BezierEllipseAnchor),f(l.BezierRectangleAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(l.BezierRectangleAnchor),f(l.BezierDiamondAnchor).toSelf().inSingletonScope(),f(n.TYPES.IAnchorComputer).toService(l.BezierDiamondAnchor),(0,c.configureCommand)({bind:f,isBound:p},d.AddRemoveBezierSegmentCommand)});return K1.default=u,K1}var q1={},zO;function B7(){if(zO)return q1;zO=1,Object.defineProperty(q1,"__esModule",{value:!0});const e=G(),n=Se(),t=cP(),i=br(),a=new e.ContainerModule((o,s,r)=>{(0,i.configureCommand)({bind:o,isBound:r},t.SelectCommand),(0,i.configureCommand)({bind:o,isBound:r},t.SelectAllCommand),(0,i.configureCommand)({bind:o,isBound:r},t.GetSelectionCommand),o(t.SelectKeyboardListener).toSelf().inSingletonScope(),o(n.TYPES.KeyListener).toService(t.SelectKeyboardListener),o(t.SelectMouseListener).toSelf().inSingletonScope(),o(n.TYPES.MouseListener).toService(t.SelectMouseListener)});return q1.default=a,q1}var H1={},UO;function x7(){if(UO)return H1;UO=1,Object.defineProperty(H1,"__esModule",{value:!0});const e=G(),n=Se(),t=R7(),i=new e.ContainerModule(a=>{a(t.UndoRedoKeyListener).toSelf().inSingletonScope(),a(n.TYPES.KeyListener).toService(t.UndoRedoKeyListener)});return H1.default=i,H1}var V1={},$O;function gP(){if($O)return V1;$O=1,Object.defineProperty(V1,"__esModule",{value:!0});const e=G(),n=br(),t=E_(),i=new e.ContainerModule((a,o,s)=>{(0,n.configureCommand)({bind:a,isBound:s},t.UpdateModelCommand)});return V1.default=i,V1}var G1={},YO;function F7(){if(YO)return G1;YO=1,Object.defineProperty(G1,"__esModule",{value:!0});const e=G(),n=Se(),t=C_(),i=Fm(),a=b_(),o=l_(),s=br(),r=new e.ContainerModule((d,l,c)=>{(0,s.configureCommand)({bind:d,isBound:c},t.CenterCommand),(0,s.configureCommand)({bind:d,isBound:c},t.FitToScreenCommand),(0,s.configureCommand)({bind:d,isBound:c},i.SetViewportCommand),(0,s.configureCommand)({bind:d,isBound:c},i.GetViewportCommand),d(t.CenterKeyboardListener).toSelf().inSingletonScope(),d(n.TYPES.KeyListener).toService(t.CenterKeyboardListener),d(a.ScrollMouseListener).toSelf().inSingletonScope(),d(o.ZoomMouseListener).toSelf().inSingletonScope(),d(n.TYPES.MouseListener).toService(a.ScrollMouseListener),d(n.TYPES.MouseListener).toService(o.ZoomMouseListener)});return G1.default=r,G1}var z1={},WO;function mP(){if(WO)return z1;WO=1,Object.defineProperty(z1,"__esModule",{value:!0});const e=G(),n=br(),t=uP(),i=new e.ContainerModule((a,o,s)=>{(0,n.configureCommand)({bind:a,isBound:s},t.BringToFrontCommand)});return z1.default=i,z1}var it={},ZO;function k7(){if(ZO)return it;ZO=1;var e=it&&it.__decorate||function(I,R,w,T){var j=arguments.length,D=j<3?R:T===null?T=Object.getOwnPropertyDescriptor(R,w):T,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(I,R,w,T);else for(var H=I.length-1;H>=0;H--)(B=I[H])&&(D=(j<3?B(D):j>3?B(R,w,D):B(R,w))||D);return j>3&&D&&Object.defineProperty(R,w,D),D},n=it&&it.__metadata||function(I,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,R)};Object.defineProperty(it,"__esModule",{value:!0}),it.SBezierControlHandleView=it.SBezierCreateHandleView=it.SCompartmentView=it.SLabelView=it.SRoutingHandleView=it.BezierCurveEdgeView=it.PolylineEdgeViewWithGapsOnIntersections=it.JumpingPolylineEdgeView=it.PolylineEdgeView=it.SGraphView=void 0;const t=G(),i=at(),a=Jd(),o=zn(),s=Dm(),r=g_(),d=sh(),l=on(),c=Os(),u=aP(),f=Ds(),h=Zc();let p=class{render(R,w){const T=this.edgeRouterRegistry.routeAllChildren(R),j=`scale(${R.zoom}) translate(${-R.scroll.x},${-R.scroll.y})`;return(0,f.svg)("svg",{"class-sprotty-graph":!0},(0,f.svg)("g",{transform:j},w.renderChildren(R,{edgeRouting:T})))}};it.SGraphView=p,e([(0,t.inject)(c.EdgeRouterRegistry),n("design:type",c.EdgeRouterRegistry)],p.prototype,"edgeRouterRegistry",void 0),it.SGraphView=p=e([(0,t.injectable)()],p);let g=class extends u.RoutableView{render(R,w,T){const j=this.edgeRouterRegistry.route(R,T);return j.length===0?this.renderDanglingEdge("Cannot compute route",R,w):this.isVisible(R,j,w)?(0,f.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":R.hoverFeedback},this.renderLine(R,j,w,T),this.renderAdditionals(R,j,w),this.renderJunctionPoints(R,j,w,T),w.renderChildren(R,{route:j})):R.children.length===0?void 0:(0,f.svg)("g",null,w.renderChildren(R,{route:j}))}renderJunctionPoints(R,w,T,j){const B=[];for(let H=1;H<w.length;H++)w[H].isJunction&&B.push((0,f.svg)("circle",{cx:w[H].x,cy:w[H].y,r:5}));if(B.length>0)return(0,f.svg)("g",{"class-sprotty-junction":!0},B)}renderLine(R,w,T,j){const D=w[0];let B=`M ${D.x},${D.y}`;for(let H=1;H<w.length;H++){const F=w[H];B+=` L ${F.x},${F.y}`}return(0,f.svg)("path",{d:B})}renderAdditionals(R,w,T){return[]}renderDanglingEdge(R,w,T){return(0,f.svg)("text",{"class-sprotty-edge-dangling":!0,title:R},"?")}};it.PolylineEdgeView=g,e([(0,t.inject)(c.EdgeRouterRegistry),n("design:type",c.EdgeRouterRegistry)],g.prototype,"edgeRouterRegistry",void 0),it.PolylineEdgeView=g=e([(0,t.injectable)()],g);let m=class extends g{constructor(){super(...arguments),this.jumpOffsetBefore=5,this.jumpOffsetAfter=5,this.skipOffsetBefore=3,this.skipOffsetAfter=2}renderLine(R,w,T,j){let D="";for(let B=0;B<w.length;B++){const H=w[B];B===0&&(D=`M ${H.x},${H.y}`),(0,r.isIntersectingRoutedPoint)(H)&&(D+=this.intersectionPath(R,w,H,j)),B!==0&&(D+=` L ${H.x},${H.y}`)}return(0,f.svg)("path",{d:D})}intersectionPath(R,w,T,j){if(T.intersections.length<1)return"";const D=this.getLineSegment(R,T.intersections[0],j,w),B=this.getIntersectionsSortedBySegmentDirection(D,T);let H="";for(const F of B){const K=this.getOtherLineSegment(R,F,j);if(K===void 0)continue;const U=this.getLineSegment(R,F,j,w),Z=F.intersectionPoint;this.shouldDrawLineJumpOnIntersection(U,K)?H+=this.createJumpPath(Z,U):this.shouldDrawLineGapOnIntersection(U,K)&&(H+=this.createGapPath(Z,U))}return H}getIntersectionsSortedBySegmentDirection(R,w){switch(R.direction){case"north":case"north-east":return w.intersections.sort(r.BY_X_THEN_DESCENDING_Y);case"south":case"south-east":case"east":return w.intersections.sort(r.BY_X_THEN_Y);case"south-west":case"west":return w.intersections.sort(r.BY_DESCENDING_X_THEN_Y);case"north-west":return w.intersections.sort(r.BY_DESCENDING_X_THEN_DESCENDING_Y)}}shouldDrawLineJumpOnIntersection(R,w){return Math.abs(R.slopeOrMax)<Math.abs(w.slopeOrMax)}shouldDrawLineGapOnIntersection(R,w){return!this.shouldDrawLineJumpOnIntersection(R,w)}getLineSegment(R,w,T,j){const D=j||this.edgeRouterRegistry.route(R,T),B=w.routable1===R.id?w.segmentIndex1:w.segmentIndex2;return new h.PointToPointLine(D[B],D[B+1])}getOtherLineSegment(R,w,T){const j=w.routable1===R.id?w.routable2:w.routable1,D=R.index.getById(j);if(D instanceof l.SRoutableElementImpl)return this.getLineSegment(D,w,T)}createJumpPath(R,w){const T=i.Point.shiftTowards(R,w.p1,this.jumpOffsetBefore),j=i.Point.shiftTowards(R,w.p2,this.jumpOffsetAfter),D=w.p1.x<w.p2.x?1:0;return` L ${T.x},${T.y} A 1,1 0,0 ${D} ${j.x},${j.y}`}createGapPath(R,w){let T,j;R.y<w.p1.y?(T=-this.skipOffsetBefore,j=this.jumpOffsetAfter+this.skipOffsetAfter):(T=this.jumpOffsetBefore+this.skipOffsetAfter,j=-this.skipOffsetBefore);const D=i.Point.shiftTowards(R,w.p1,T),B=i.Point.shiftTowards(R,w.p2,j);return` L ${D.x},${D.y} M ${B.x},${B.y}`}};it.JumpingPolylineEdgeView=m,it.JumpingPolylineEdgeView=m=e([(0,t.injectable)()],m);let v=class extends m{constructor(){super(...arguments),this.skipOffsetBefore=3,this.skipOffsetAfter=3}shouldDrawLineJumpOnIntersection(R,w){return!1}shouldDrawLineGapOnIntersection(R,w){return Math.abs(R.slopeOrMax)>=Math.abs(w.slopeOrMax)}createGapPath(R,w){const T=i.Point.shiftTowards(R,w.p1,this.skipOffsetBefore),j=i.Point.shiftTowards(R,w.p2,this.skipOffsetAfter);return` L ${T.x},${T.y} M ${j.x},${j.y}`}};it.PolylineEdgeViewWithGapsOnIntersections=v,it.PolylineEdgeViewWithGapsOnIntersections=v=e([(0,t.injectable)()],v);let _=class extends u.RoutableView{render(R,w,T){const j=this.edgeRouterRegistry.route(R,T);return j.length===0?this.renderDanglingEdge("Cannot compute route",R,w):this.isVisible(R,j,w)?(0,f.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":R.hoverFeedback},this.renderLine(R,j,w,T),this.renderAdditionals(R,j,w),w.renderChildren(R,{route:j})):R.children.length===0?void 0:(0,f.svg)("g",null,w.renderChildren(R,{route:j}))}renderLine(R,w,T,j){let D="";if(w.length>=4){D+=this.buildMainSegment(w);const B=w.length-4;if(B>0&&B%3===0)for(let H=4;H<w.length;H+=3)D+=this.addSpline(w,H)}return(0,f.svg)("path",{d:D})}buildMainSegment(R){const w=R[0],T=R[1],j=R[2],D=R[3];return`M${w.x},${w.y} C${T.x},${T.y} ${j.x},${j.y} ${D.x},${D.y}`}addSpline(R,w){const T=R[w+1],j=R[w+2];return` S${T.x},${T.y} ${j.x},${j.y}`}renderAdditionals(R,w,T){return[]}renderDanglingEdge(R,w,T){return(0,f.svg)("text",{"class-sprotty-edge-dangling":!0,title:R},"?")}};it.BezierCurveEdgeView=_,e([(0,t.inject)(c.EdgeRouterRegistry),n("design:type",c.EdgeRouterRegistry)],_.prototype,"edgeRouterRegistry",void 0),it.BezierCurveEdgeView=_=e([(0,t.injectable)()],_);let S=class{constructor(){this.minimalPointDistance=10}render(R,w,T){if(T&&T.route&&R.parent instanceof l.SRoutableElementImpl){const j=this.edgeRouterRegistry.get(R.parent.routerKind),D=T.route===void 0?this.edgeRouterRegistry.route(R.parent,T):T.route,B=j.getHandlePosition(R.parent,D,R);if(B!==void 0){const H=(0,f.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":R.selected,"class-mouseover":R.hoverFeedback,cx:B.x,cy:B.y,r:this.getRadius()});return(0,o.setAttr)(H,"data-kind",R.kind),H}}return(0,f.svg)("g",null)}getRadius(){return 7}};it.SRoutingHandleView=S,e([(0,t.inject)(c.EdgeRouterRegistry),n("design:type",c.EdgeRouterRegistry)],S.prototype,"edgeRouterRegistry",void 0),it.SRoutingHandleView=S=e([(0,t.injectable)()],S);let E=class extends s.ShapeView{render(R,w){if(!(0,d.isEdgeLayoutable)(R)&&!this.isVisible(R,w))return;const T=(0,f.svg)("text",{"class-sprotty-label":!0},R.text),j=(0,a.getSubType)(R);return j&&(0,o.setAttr)(T,"class",j),T}};it.SLabelView=E,it.SLabelView=E=e([(0,t.injectable)()],E);let C=class{render(R,w,T){const j=`translate(${R.bounds.x}, ${R.bounds.y})`,D=(0,f.svg)("g",{transform:j,"class-sprotty-comp":"{true}"},w.renderChildren(R)),B=(0,a.getSubType)(R);return B&&(0,o.setAttr)(D,"class",B),D}};it.SCompartmentView=C,it.SCompartmentView=C=e([(0,t.injectable)()],C);let M=class extends S{render(R,w,T){if(T){const j=T.route;if(j&&R.parent instanceof l.SRoutableElementImpl){const B=this.edgeRouterRegistry.get(R.parent.routerKind).getHandlePosition(R.parent,j,R);if(B!==void 0){const H="translate("+B.x+", "+B.y+")",F=-5.5,K=5.5,U=R.kind==="bezier-add"?"+":"-",Z=(0,f.svg)("g",{transform:H,"class-sprotty-routing-handle":!0,"class-selected":R.selected,"class-mouseover":R.hoverFeedback},(0,f.svg)("circle",{r:this.getRadius()}),(0,f.svg)("text",{x:F,y:K,"attrs-text-align":"middle","style-font-family":"monospace","style-pointer-events":"none","style-fill":"white"},U));return(0,o.setAttr)(Z,"data-kind",R.kind),Z}}}return(0,f.svg)("g",null)}};it.SBezierCreateHandleView=M,it.SBezierCreateHandleView=M=e([(0,t.injectable)()],M);let L=class extends S{render(R,w,T){if(T){const j=T.route;if(j&&R.parent instanceof l.SRoutableElementImpl){const B=this.edgeRouterRegistry.get(R.parent.routerKind).getHandlePosition(R.parent,j,R);if(B!==void 0){let H;for(let K=0;K<j.length;K++){const U=j[K];if(U.kind===B.kind&&U.pointIndex===B.pointIndex){R.kind==="bezier-control-before"?H=j[K+1]:H=j[K-1];break}}let F;if(H){const K=`M ${B.x}, ${B.y} L ${H.x}, ${H.y}`;F=(0,f.svg)("g",{"class-sprotty-routing-handle":!0,"class-selected":R.selected,"class-mouseover":R.hoverFeedback},(0,f.svg)("path",{d:K,stroke:"grey","style-stroke-width":"2px"}),(0,f.svg)("circle",{cx:B.x,cy:B.y,r:this.getRadius()}))}else F=(0,f.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":R.selected,"class-mouseover":R.hoverFeedback,cx:B.x,cy:B.y,r:this.getRadius()});return(0,o.setAttr)(F,"data-kind",R.kind),F}}}return(0,f.svg)("g",null)}};return it.SBezierControlHandleView=L,it.SBezierControlHandleView=L=e([(0,t.injectable)()],L),it}var Ll={},U1={},QO;function vP(){if(QO)return U1;QO=1,Object.defineProperty(U1,"__esModule",{value:!0});const e=G(),n=br(),t=Se(),i=Nm(),a=tf(),o=new e.ContainerModule((s,r,d)=>{s(t.TYPES.ModelSourceProvider).toProvider(l=>()=>new Promise(c=>{c(l.container.get(t.TYPES.ModelSource))})),(0,n.configureCommand)({bind:s,isBound:d},i.CommitModelCommand),s(t.TYPES.IActionHandlerInitializer).toService(t.TYPES.ModelSource),s(a.ComputedBoundsApplicator).toSelf().inSingletonScope()});return U1.default=o,U1}var JO;function K7(){if(JO)return Ll;JO=1;var e=Ll&&Ll.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.loadDefaultModules=void 0;const n=e(BC()),t=e(vP()),i=e(M7()),a=e(lP()),o=e(A7()),s=e(w7()),r=e(I7()),d=e(im()),l=WC(),c=e(dP()),u=e(O7()),f=e(fP()),h=e(j7()),p=e(hP()),g=e(pP()),m=e(N7()),v=e(B7()),_=e(x7()),S=e(gP()),E=e(F7()),C=e(mP());function M(L,I){const R=[n.default,t.default,i.default,a.default,o.default,s.default,r.default,l.edgeEditModule,d.default,c.default,u.default,f.default,h.default,l.labelEditModule,l.labelEditUiModule,p.default,g.default,m.default,v.default,_.default,S.default,E.default,C.default];if(I&&I.exclude)for(const w of I.exclude){const T=R.indexOf(w);T>=0&&R.splice(T,1)}L.load(...R)}return Ll.loadDefaultModules=M,Ll}var jr={},$1={},XO;function q7(){if(XO)return $1;XO=1,Object.defineProperty($1,"__esModule",{value:!0});const e=nh;function n(g){const m={},v=(C,M)=>{if(M!=="style"&&M!=="class"){const L=r(g[M]);C?C[M]=L:C={[M]:L}}return C},_=Object.keys(g).reduce(v,null);_&&(m.attrs=_);const S=t(g);S&&(m.style=S);const E=i(g);return E&&(m.class=E),m}function t(g){const m=(v,_)=>{const S=_.split(":"),E=a(S[0].trim());if(E){const C=S[1].replace("!important","").trim();v?v[E]=C:v={[E]:C}}return v};try{return g.style.split(";").reduce(m,null)}catch{return null}}function i(g){const m=(v,_)=>(_=_.trim(),_&&(v?v[_]=!0:v={[_]:!0}),v);try{return g.class.split(" ").reduce(m,null)}catch{return null}}function a(g){return g=g.replace(/-(\w)/g,function(_,S){return S.toUpperCase()}),`${g.charAt(0).toLowerCase()}${g.substring(1)}`}const o=new RegExp("&[a-z0-9#]+;","gi");let s=null;function r(g){return s||(s=document.createElement("div")),g.replace(o,m=>s===null?"":(s.innerHTML=m,s.textContent===null?"":s.textContent))}function d(g,m){let v=g,_=null;const S=[],E=C=>{const M=C.firstChild;M!==null&&(_=C),v=M};for(m(v,_),E(v);;){for(;v;)S.push(v),m(v,_),E(v);const C=S.pop();if(v=C||null,!S.length)break;if(_=S[S.length-1],v){const M=v.nextSibling;M==null&&(_=S[S.length-1]),v=M}}}let l=null;const c=new Map;let u=!1;function f(g,m){let v;switch(m!==null&&(v=c.get(m)),g==null?void 0:g.nodeType){case 1:{if(v===void 0)return;v.children=v.children?v.children:[];const _=v.children,S=g.attributes,E={};for(let M=0;M<S.length;M++){const L=S.item(M);L&&(E[L.name]=L.value)}const C=(0,e.h)(g.nodeName,n(E));_.push(C),c.set(g,C);break}case 3:{const _=g.textContent;if(_!==null&&v!==void 0){v.children=v.children?v.children:[];const S=v.children,E=S.length>0?S[S.length-1]:null;!u&&typeof E!="string"&&E!==null&&E.sel===void 0?E.text=E.text+_:S.push((0,e.vnode)(void 0,void 0,void 0,_,void 0)),u=!1}break}case 8:{u=!0;break}case 9:{l=(0,e.vnode)(void 0,void 0,[],void 0,void 0),c.set(g,l);break}}}function h(g){const m=g==null?void 0:g.children;return typeof m>"u"?null:m.length===1&&typeof m[0]!="string"?m[0]:null}function p(g){var m,v;const _=new window.DOMParser;if(_===void 0||g===void 0||g==="")return null;const S=_.parseFromString(g,"application/xml");if(((m=S==null?void 0:S.firstChild)===null||m===void 0?void 0:m.nodeName)==="parsererror"){const E=`${(v=S==null?void 0:S.firstChild)===null||v===void 0?void 0:v.textContent}`;return(0,e.h)("parsererror",[E])}return u=!1,l=null,d(S,f),l===null?null:h(l)}return $1.default=p,$1}var Pt={},e3;function yP(){if(e3)return Pt;e3=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ForeignObjectElement=Pt.ForeignObjectElementImpl=Pt.ShapedPreRenderedElement=Pt.ShapedPreRenderedElementImpl=Pt.PreRenderedElement=Pt.PreRenderedElementImpl=Pt.HtmlRoot=Pt.HtmlRootImpl=Pt.RectangularPort=Pt.CircularPort=Pt.DiamondNode=Pt.RectangularNode=Pt.CircularNode=void 0;const e=at(),n=ft(),t=Ft(),i=Wc(),a=Sr(),o=ef(),s=Qc();class r extends o.SNodeImpl{get anchorKind(){return s.ELLIPTIC_ANCHOR_KIND}}Pt.CircularNode=r;class d extends o.SNodeImpl{get anchorKind(){return s.RECTANGULAR_ANCHOR_KIND}}Pt.RectangularNode=d;class l extends o.SNodeImpl{get anchorKind(){return s.DIAMOND_ANCHOR_KIND}}Pt.DiamondNode=l;class c extends o.SPortImpl{get anchorKind(){return s.ELLIPTIC_ANCHOR_KIND}}Pt.CircularPort=c;class u extends o.SPortImpl{get anchorKind(){return s.RECTANGULAR_ANCHOR_KIND}}Pt.RectangularPort=u;class f extends n.SModelRootImpl{constructor(){super(...arguments),this.classes=[]}}Pt.HtmlRootImpl=f,Pt.HtmlRoot=f;class h extends n.SChildElementImpl{}Pt.PreRenderedElementImpl=h,Pt.PreRenderedElement=h;class p extends h{constructor(){super(...arguments),this.position=e.Point.ORIGIN,this.size=e.Dimension.EMPTY,this.selected=!1,this.alignment=e.Point.ORIGIN}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(v){this.position={x:v.x,y:v.y},this.size={width:v.width,height:v.height}}}Pt.ShapedPreRenderedElementImpl=p,p.DEFAULT_FEATURES=[i.moveFeature,t.boundsFeature,a.selectFeature,t.alignFeature],Pt.ShapedPreRenderedElement=p;class g extends p{get bounds(){return e.Dimension.isValid(this.size)?{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}:(0,t.isBoundsAware)(this.parent)?{x:this.position.x,y:this.position.y,width:this.parent.bounds.width,height:this.parent.bounds.height}:e.Bounds.EMPTY}}return Pt.ForeignObjectElementImpl=g,Pt.ForeignObjectElement=g,Pt}var t3;function H7(){if(t3)return jr;t3=1;var e=jr&&jr.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=jr&&jr.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(jr,"__esModule",{value:!0}),jr.ForeignObjectView=jr.PreRenderedView=void 0;const t=Ds(),i=G(),a=n(q7()),o=zn(),s=Dm(),r=yP();let d=class extends s.ShapeView{render(u,f){if(u instanceof r.ShapedPreRenderedElementImpl&&!this.isVisible(u,f))return;const h=(0,a.default)(u.code);if(h!==null)return this.correctNamespace(h),h}correctNamespace(u){(u.sel==="svg"||u.sel==="g")&&(0,o.setNamespace)(u,"http://www.w3.org/2000/svg")}};jr.PreRenderedView=d,jr.PreRenderedView=d=e([(0,i.injectable)()],d);let l=class{render(u,f){const h=(0,a.default)(u.code);if(h===null)return;const p=(0,t.svg)("g",null,(0,t.svg)("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:u.bounds.height,width:u.bounds.width,x:0,y:0},h),f.renderChildren(u));return(0,o.setAttr)(p,"class",u.type),(0,o.setNamespace)(h,u.namespace),p}};return jr.ForeignObjectView=l,jr.ForeignObjectView=l=e([(0,i.injectable)()],l),jr}var Au={},n3;function V7(){if(n3)return Au;n3=1;var e=Au&&Au.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Au,"__esModule",{value:!0}),Au.HtmlRootView=void 0;const n=Ds(),t=G(),i=zn();let a=class{render(s,r){const d=(0,n.html)("div",null,r.renderChildren(s));for(const l of s.classes)(0,i.setClass)(d,l,!0);return d}};return Au.HtmlRootView=a,Au.HtmlRootView=a=e([(0,t.injectable)()],a),Au}var vo={},ay={exports:{}},mU=ay.exports,i3;function _P(){return i3||(i3=1,function(e,n){(function(t,i){i()})(mU,function(){function t(l,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function i(l,c,u){var f=new XMLHttpRequest;f.open("GET",l),f.responseType="blob",f.onload=function(){d(f.response,c,u)},f.onerror=function(){console.error("could not download file")},f.send()}function a(l){var c=new XMLHttpRequest;c.open("HEAD",l,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function o(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(c)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ka=="object"&&ka.global===ka?ka:void 0,r=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(l,c,u){var f=s.URL||s.webkitURL,h=document.createElement("a");c=c||l.name||"download",h.download=c,h.rel="noopener",typeof l=="string"?(h.href=l,h.origin===location.origin?o(h):a(h.href)?i(l,c,u):o(h,h.target="_blank")):(h.href=f.createObjectURL(l),setTimeout(function(){f.revokeObjectURL(h.href)},4e4),setTimeout(function(){o(h)},0))}:"msSaveOrOpenBlob"in navigator?function(l,c,u){if(c=c||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(t(l,u),c);else if(a(l))i(l,c,u);else{var f=document.createElement("a");f.href=l,f.target="_blank",setTimeout(function(){o(f)})}}:function(l,c,u,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof l=="string")return i(l,c,u);var h=l.type==="application/octet-stream",p=/constructor/i.test(s.HTMLElement)||s.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||h&&p||r)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var S=m.result;S=g?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=S:location=S,f=null},m.readAsDataURL(l)}else{var v=s.URL||s.webkitURL,_=v.createObjectURL(l);f?f.location=_:location.href=_,f=null,setTimeout(function(){v.revokeObjectURL(_)},4e4)}});s.saveAs=d.saveAs=d,e.exports=d})}(ay)),ay.exports}var r3;function G7(){if(r3)return vo;r3=1;var e=vo&&vo.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=vo&&vo.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)};Object.defineProperty(vo,"__esModule",{value:!0}),vo.DiagramServerProxy=vo.ServerStatusAction=void 0;const t=_P(),i=G(),a=lt(),o=Jy(),s=Se(),r=n_(),d=E_(),l=tf();class c{constructor(){this.kind=c.KIND}}vo.ServerStatusAction=c,c.KIND="serverStatus";const u="__receivedFromServer";let f=class extends l.ModelSource{constructor(){super(...arguments),this.currentRoot={type:"NONE",id:"ROOT"}}get model(){return this.currentRoot}initialize(p){super.initialize(p),p.register(a.ComputedBoundsAction.KIND,this),p.register(r.RequestBoundsCommand.KIND,this),p.register(a.RequestPopupModelAction.KIND,this),p.register(a.CollapseExpandAction.KIND,this),p.register(a.CollapseExpandAllAction.KIND,this),p.register(a.OpenAction.KIND,this),p.register(c.KIND,this),this.clientId||(this.clientId=this.viewerOptions.baseDiv)}handle(p){this.handleLocally(p)&&this.forwardToServer(p)}forwardToServer(p){const g={clientId:this.clientId,action:p};this.logger.log(this,"sending",g),this.sendMessage(g)}messageReceived(p){const g=typeof p=="string"?JSON.parse(p):p;(0,a.isActionMessage)(g)&&g.action?(!g.clientId||g.clientId===this.clientId)&&(g.action[u]=!0,this.logger.log(this,"receiving",g),this.actionDispatcher.dispatch(g.action).then(()=>{this.storeNewModel(g.action)})):this.logger.error(this,"received data is not an action message",g)}handleLocally(p){switch(this.storeNewModel(p),p.kind){case a.ComputedBoundsAction.KIND:return this.handleComputedBounds(p);case a.RequestModelAction.KIND:return this.handleRequestModel(p);case r.RequestBoundsCommand.KIND:return!1;case a.ExportSvgAction.KIND:return this.handleExportSvgAction(p);case c.KIND:return this.handleServerStateAction(p)}return!p[u]}storeNewModel(p){if(p.kind===o.SetModelCommand.KIND||p.kind===d.UpdateModelCommand.KIND||p.kind===r.RequestBoundsCommand.KIND){const g=p.newRoot;g&&(this.currentRoot=g,(p.kind===o.SetModelCommand.KIND||p.kind===d.UpdateModelCommand.KIND)&&(this.lastSubmittedModelType=g.type))}}handleRequestModel(p){const g=Object.assign({needsClientLayout:this.viewerOptions.needsClientLayout,needsServerLayout:this.viewerOptions.needsServerLayout},p.options),m=Object.assign(Object.assign({},p),{options:g});return this.forwardToServer(m),!1}handleComputedBounds(p){if(this.viewerOptions.needsServerLayout)return!0;{const g=this.currentRoot;return this.computedBoundsApplicator.apply(g,p),g.type===this.lastSubmittedModelType?this.actionDispatcher.dispatch(a.UpdateModelAction.create(g)):this.actionDispatcher.dispatch(a.SetModelAction.create(g)),this.lastSubmittedModelType=g.type,!1}}handleExportSvgAction(p){const g=new Blob([p.svg],{type:"text/plain;charset=utf-8"});return(0,t.saveAs)(g,"diagram.svg"),!1}handleServerStateAction(p){return!1}commitModel(p){const g=this.currentRoot;return this.currentRoot=p,g}};return vo.DiagramServerProxy=f,e([(0,i.inject)(s.TYPES.ILogger),n("design:type",Object)],f.prototype,"logger",void 0),e([(0,i.inject)(l.ComputedBoundsApplicator),n("design:type",l.ComputedBoundsApplicator)],f.prototype,"computedBoundsApplicator",void 0),vo.DiagramServerProxy=f=e([(0,i.injectable)()],f),vo}var ia={},o3;function vU(){if(o3)return ia;o3=1;var e=ia&&ia.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=ia&&ia.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)};Object.defineProperty(ia,"__esModule",{value:!0}),ia.LocalModelSource=void 0;const t=_P(),i=G(),a=lt(),o=Yr(),s=Jd(),r=Se(),d=Yc(),l=S_(),c=tf();let u=class extends c.ModelSource{constructor(){super(...arguments),this.currentRoot=d.EMPTY_ROOT}get model(){return this.currentRoot}set model(h){this.setModel(h)}initialize(h){super.initialize(h),h.register(a.ComputedBoundsAction.KIND,this),h.register(a.RequestPopupModelAction.KIND,this)}setModel(h){return this.currentRoot=h,this.submitModel(h,!1)}commitModel(h){const p=this.currentRoot;return this.currentRoot=h,p}updateModel(h){return h===void 0?this.submitModel(this.currentRoot,!0):(this.currentRoot=h,this.submitModel(h,!0))}async getSelection(){const h=await this.actionDispatcher.request(o.GetSelectionAction.create()),p=[];return this.gatherSelectedElements(this.currentRoot,new Set(h.selectedElementsIDs),p),p}gatherSelectedElements(h,p,g){if(p.has(h.id)&&g.push(h),h.children)for(const m of h.children)this.gatherSelectedElements(m,p,g)}async getViewport(){const h=await this.actionDispatcher.request(o.GetViewportAction.create());return{scroll:h.viewport.scroll,zoom:h.viewport.zoom,canvasBounds:h.canvasBounds}}async submitModel(h,p,g){if(this.viewerOptions.needsClientLayout){const m=await this.actionDispatcher.request(a.RequestBoundsAction.create(h)),v=this.computedBoundsApplicator.apply(this.currentRoot,m);await this.doSubmitModel(h,p,g,v)}else await this.doSubmitModel(h,p,g)}async doSubmitModel(h,p,g,m){if(this.layoutEngine!==void 0)try{const _=this.layoutEngine.layout(h,m);_ instanceof Promise?h=await _:_!==void 0&&(h=_)}catch(_){this.logger.error(this,_.toString(),_.stack)}const v=this.lastSubmittedModelType;if(this.lastSubmittedModelType=h.type,g&&g.kind===a.RequestModelAction.KIND&&g.requestId){const _=g;await this.actionDispatcher.dispatch(a.SetModelAction.create(h,_.requestId))}else if(p&&h.type===v){const _=Array.isArray(p)?p:h;await this.actionDispatcher.dispatch(a.UpdateModelAction.create(_,{animate:!0,cause:g}))}else await this.actionDispatcher.dispatch(a.SetModelAction.create(h))}applyMatches(h){const p=this.currentRoot;return(0,l.applyMatches)(p,h),this.submitModel(p,h)}addElements(h){const p=[];for(const g of h){const m=g;typeof m.element=="object"&&typeof m.parentId=="string"?p.push({right:m.element,rightParentId:m.parentId}):typeof m.id=="string"&&p.push({right:m,rightParentId:this.currentRoot.id})}return this.applyMatches(p)}removeElements(h){const p=[],g=new s.SModelIndex;g.add(this.currentRoot);for(const m of h){const v=m;if(v.elementId!==void 0&&v.parentId!==void 0){const _=g.getById(v.elementId);_!==void 0&&p.push({left:_,leftParentId:v.parentId})}else{const _=g.getById(v);_!==void 0&&p.push({left:_,leftParentId:this.currentRoot.id})}}return this.applyMatches(p)}handle(h){switch(h.kind){case a.RequestModelAction.KIND:this.handleRequestModel(h);break;case a.ComputedBoundsAction.KIND:this.computedBoundsApplicator.apply(this.currentRoot,h);break;case a.RequestPopupModelAction.KIND:this.handleRequestPopupModel(h);break;case a.ExportSvgAction.KIND:this.handleExportSvgAction(h);break}}handleRequestModel(h){this.submitModel(this.currentRoot,!1,h)}handleRequestPopupModel(h){if(this.popupModelProvider!==void 0){const p=(0,s.findElement)(this.currentRoot,h.elementId),g=this.popupModelProvider.getPopupModel(h,p);g!==void 0&&(g.canvasBounds=h.bounds,this.actionDispatcher.dispatch(a.SetPopupModelAction.create(g,h.requestId)))}}handleExportSvgAction(h){const p=new Blob([h.svg],{type:"text/plain;charset=utf-8"});(0,t.saveAs)(p,"diagram.svg")}};return ia.LocalModelSource=u,e([(0,i.inject)(r.TYPES.ILogger),n("design:type",Object)],u.prototype,"logger",void 0),e([(0,i.inject)(c.ComputedBoundsApplicator),n("design:type",c.ComputedBoundsApplicator)],u.prototype,"computedBoundsApplicator",void 0),e([(0,i.inject)(r.TYPES.IPopupModelProvider),(0,i.optional)(),n("design:type",Object)],u.prototype,"popupModelProvider",void 0),e([(0,i.inject)(r.TYPES.IModelLayoutEngine),(0,i.optional)(),n("design:type",Object)],u.prototype,"layoutEngine",void 0),ia.LocalModelSource=u=e([(0,i.injectable)()],u),ia}var ra={},s3;function z7(){if(s3)return ra;s3=1;var e=ra&&ra.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ra&&ra.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(ra,"__esModule",{value:!0}),ra.ForwardingLogger=void 0;const t=G(),i=lt(),a=t_(),o=Se();let s=class{error(d,l,...c){this.logLevel>=a.LogLevel.error&&this.forward(d,l,a.LogLevel.error,c)}warn(d,l,...c){this.logLevel>=a.LogLevel.warn&&this.forward(d,l,a.LogLevel.warn,c)}info(d,l,...c){this.logLevel>=a.LogLevel.info&&this.forward(d,l,a.LogLevel.info,c)}log(d,l,...c){if(this.logLevel>=a.LogLevel.log)try{const u=typeof d=="object"?d.constructor.name:String(d);console.log.apply(d,[u+": "+l,...c])}catch{}}forward(d,l,c,u){const f=new Date,h=i.LoggingAction.create({message:l,severity:a.LogLevel[c],time:f.toLocaleTimeString(),caller:typeof d=="object"?d.constructor.name:String(d),params:u.map(p=>JSON.stringify(p))});this.modelSourceProvider().then(p=>{try{p.handle(h)}catch(g){try{console.log.apply(d,[l,h,g])}catch{}}})}};return ra.ForwardingLogger=s,e([(0,t.inject)(o.TYPES.ModelSourceProvider),n("design:type",Function)],s.prototype,"modelSourceProvider",void 0),e([(0,t.inject)(o.TYPES.LogLevel),n("design:type",Number)],s.prototype,"logLevel",void 0),ra.ForwardingLogger=s=e([(0,t.injectable)()],s),ra}var wu={},a3;function yU(){if(a3)return wu;a3=1;var e=wu&&wu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(wu,"__esModule",{value:!0}),wu.WebSocketDiagramServerProxy=void 0;const n=G(),t=G7();let i=class extends t.DiagramServerProxy{listen(o){o.addEventListener("message",s=>{this.messageReceived(s.data)}),o.addEventListener("error",s=>{this.logger.error(this,"error event received",s)}),this.webSocket=o}disconnect(){this.webSocket&&(this.webSocket.close(),this.webSocket=void 0)}sendMessage(o){if(this.webSocket)this.webSocket.send(JSON.stringify(o));else throw new Error("WebSocket is not connected")}};return wu.WebSocketDiagramServerProxy=i,wu.WebSocketDiagramServerProxy=i=e([(0,n.injectable)()],i),wu}var _c={},c3;function U7(){if(c3)return _c;c3=1,Object.defineProperty(_c,"__esModule",{value:!0}),_c.ColorMap=_c.toSVG=_c.rgb=void 0;function e(i,a,o){return{red:i,green:a,blue:o}}_c.rgb=e;function n(i){return"rgb("+i.red+","+i.green+","+i.blue+")"}_c.toSVG=n;class t{constructor(a){this.stops=a}getColor(a){a=Math.max(0,Math.min(.99999999,a));const o=Math.floor(a*this.stops.length);return this.stops[o]}}return _c.ColorMap=t,_c}var u3;function P_(){return u3||(u3=1,function(e){var n=fc&&fc.__createBinding||(Object.create?function(w,T,j,D){D===void 0&&(D=j);var B=Object.getOwnPropertyDescriptor(T,j);(!B||("get"in B?!T.__esModule:B.writable||B.configurable))&&(B={enumerable:!0,get:function(){return T[j]}}),Object.defineProperty(w,D,B)}:function(w,T,j,D){D===void 0&&(D=j),w[D]=T[j]}),t=fc&&fc.__exportStar||function(w,T){for(var j in w)j!=="default"&&!Object.prototype.hasOwnProperty.call(T,j)&&n(T,w,j)},i=fc&&fc.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(e,"__esModule",{value:!0}),e.modelSourceModule=e.zorderModule=e.viewportModule=e.updateModule=e.undoRedoModule=e.selectModule=e.routingModule=e.openModule=e.moveModule=e.hoverModule=e.fadeModule=e.exportModule=e.expandModule=e.edgeLayoutModule=e.edgeJunctionModule=e.edgeIntersectionModule=e.decorationModule=e.contextMenuModule=e.commandPaletteModule=e.buttonModule=e.boundsModule=e.defaultModule=void 0,t(PC(),e),t(Qy(),e),t(wm(),e),t(RC(),e),t(eh(),e),t(Qd(),e),t(MC(),e),t(sn(),e),t(br(),e),t(AC(),e),t(wC(),e),t(Im(),e),t(Jy(),e),t(Yc(),e),t(gi(),e),t(ft(),e),t(Tm(),e),t(Xy(),e),t(za(),e),t(Wr(),e),t(DC(),e),t(ih(),e),t(OC(),e),t(LC(),e),t(jC(),e),t(NC(),e),t(zn(),e),t(Se(),e);const a=i(BC());e.defaultModule=a.default,t(n_(),e),t(xC(),e),t(i_(),e),t(Ft(),e),t(FC(),e),t(kC(),e),t(m7(),e),t(Dm(),e),t(Om(),e),t(KC(),e),t(o_(),e),t(VC(),e),t(uU(),e),t(s_(),e),t(GC(),e),t(im(),e),t(zC(),e),t(sh(),e),t(lU(),e),t(y7(),e),t(WC(),e),t(oh(),e),t(u_(),e),t($C(),e),t(Bm(),e),t(ah(),e),t(YC(),e),t(ZC(),e),t(d_(),e),t(_7(),e),t(QC(),e),t(a_(),e),t(f_(),e),t(dU(),e),t(h_(),e),t(rh(),e),t(JC(),e),t(Xd(),e),t(p_(),e),t(XC(),e),t(eP(),e),t(g_(),e),t(tP(),e),t(nP(),e),t(S7(),e),t(Wc(),e),t(xm(),e),t(E7(),e),t(qC(),e),t(rP(),e),t(iP(),e),t(m_(),e),t(C7(),e),t(Qc(),e),t(Lm(),e),t(oP(),e),t(y_(),e),t(sP(),e),t(__(),e),t(on(),e),t(v_(),e),t(jm(),e),t(Os(),e),t(aP(),e),t(Sr(),e),t(cP(),e),t(R7(),e),t(S_(),e),t(E_(),e),t(C_(),e),t($a(),e),t(b_(),e),t(c_(),e),t(Fm(),e),t(l_(),e),t(uP(),e);const o=i(M7());e.boundsModule=o.default;const s=i(lP());e.buttonModule=s.default;const r=i(A7());e.commandPaletteModule=r.default;const d=i(w7());e.contextMenuModule=d.default;const l=i(I7());e.decorationModule=l.default;const c=i(T7());e.edgeIntersectionModule=c.default;const u=i(D7());e.edgeJunctionModule=u.default;const f=i(im());e.edgeLayoutModule=f.default;const h=i(dP());e.expandModule=h.default;const p=i(O7());e.exportModule=p.default;const g=i(fP());e.fadeModule=g.default;const m=i(j7());e.hoverModule=m.default;const v=i(hP());e.moveModule=v.default;const _=i(pP());e.openModule=_.default;const S=i(N7());e.routingModule=S.default;const E=i(B7());e.selectModule=E.default;const C=i(x7());e.undoRedoModule=C.default;const M=i(gP());e.updateModule=M.default;const L=i(F7());e.viewportModule=L.default;const I=i(mP());e.zorderModule=I.default,t(ef(),e),t(k7(),e),t(K7(),e),t(H7(),e),t(V7(),e),t(Ds(),e),t(yP(),e),t(UC(),e),t(Nm(),e),t(G7(),e),t(vU(),e),t(z7(),e),t(tf(),e),t(yU(),e);const R=i(vP());e.modelSourceModule=R.default,t(Ts(),e),t(HC(),e),t(U7(),e),t(Zc(),e),t(Zd(),e),t(t_(),e),t(Ga(),e)}(fc)),fc}var l3;function _U(){if(l3)return ns;l3=1;var e=ns&&ns.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(ns,"__esModule",{value:!0}),ns.MouseListener=ns.KeyListener=void 0;const n=G(),t=P_();let i=class extends t.KeyListener{keyDown(s,r){return[]}keyUp(s,r){return[]}};ns.KeyListener=i,ns.KeyListener=i=e([(0,n.injectable)()],i);let a=class extends t.MouseListener{mouseOver(s,r){return[]}mouseOut(s,r){return[]}mouseEnter(s,r){return[]}mouseLeave(s,r){return[]}mouseDown(s,r){return[]}mouseMove(s,r){return[]}mouseUp(s,r){return[]}wheel(s,r){return[]}doubleClick(s,r){return[]}contextMenu(s,r){return[]}dragOver(s,r){return[]}drop(s,r){return[]}decorate(s,r){return s}};return ns.MouseListener=a,ns.MouseListener=a=e([(0,n.injectable)()],a),ns}var Rt={},jl={},Nl={},mt={},d3;function nf(){if(d3)return mt;d3=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.arrayOf=mt.partition=mt.isArrayMatching=mt.isStringArray=mt.isArrayOfPrimitive=mt.isArrayOfClass=mt.isArrayOfType=mt.distinctAdd=mt.asArray=mt.flatPush=mt.remove=mt.pluck=mt.last=mt.first=void 0;function e(p,g){return g?p.filter((m,v)=>v<g):p[0]}mt.first=e;function n(p,g){return g?p.filter((m,v)=>p.length-v<=g):p[p.length-1]}mt.last=n;function t(p,g){return p.map(m=>m[g])}mt.pluck=t;function i(p,...g){g.forEach(m=>{const v=p.indexOf(m);v>=0&&p.splice(v,1)})}mt.remove=i;function a(p,g){g.forEach(m=>Array.isArray(m)?p.push(...m):p.push(m))}mt.flatPush=a;function o(p){return Array.isArray(p)?p:[p]}mt.asArray=o;function s(p,...g){g.forEach(m=>{p.includes(m)||p.push(m)})}mt.distinctAdd=s;function r(p,g,m=!1){return u(p,v=>g(v),m)}mt.isArrayOfType=r;function d(p,g,m=!1){return u(p,v=>v instanceof g,m)}mt.isArrayOfClass=d;function l(p,g,m=!1){return u(p,v=>typeof v===g,m)}mt.isArrayOfPrimitive=l;function c(p,g=!1){return l(p,"string",g)}mt.isStringArray=c;function u(p,g,m=!1){return Array.isArray(p)&&p.every(g)&&(m||p.length>0)}mt.isArrayMatching=u;function f(p,g){const m=[],v=[];return p.forEach(_=>{g(_)?m.push(_):v.push(_)}),{match:m,rest:v}}mt.partition=f;function h(...p){return p.filter(g=>g!==void 0)}return mt.arrayOf=h,mt}var xt={},f3;function vt(){if(f3)return xt;f3=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.hasArrayProp=xt.hasFunctionProp=xt.hasObjectProp=xt.hasNumberProp=xt.hasBooleanProp=xt.hasStringProp=xt.MaybeActions=xt.call=xt.toTypeGuard=xt.typeGuardOr=xt.typeGuard=xt.AnyObject=void 0;const e=nf();var n;(function(h){function p(g){return g!==null&&typeof g=="object"}h.is=p})(n||(xt.AnyObject=n={}));function t(h,p){return g=>h(g)&&p(g)}xt.typeGuard=t;function i(h,p){return g=>h(g)||p(g)}xt.typeGuardOr=i;function a(h){return p=>p instanceof h}xt.toTypeGuard=a;function o(h,...p){return typeof h=="function"?h(...p):h}xt.call=o;var s;(function(h){function p(g){const m=g?o(g):[];return m?(0,e.asArray)(m):[]}h.asArray=p})(s||(xt.MaybeActions=s={}));function r(h,p,g=!1){const m=h[p];return m!==void 0?typeof m=="string":g}xt.hasStringProp=r;function d(h,p,g=!1){const m=h[p];return m!==void 0?typeof m=="boolean":g}xt.hasBooleanProp=d;function l(h,p,g=!1){const m=h[p];return m!==void 0?typeof m=="number":g}xt.hasNumberProp=l;function c(h,p,g=!1){const m=h[p];return m!==void 0?n.is(m):g}xt.hasObjectProp=c;function u(h,p,g=!1){const m=h[p];return m!==void 0?typeof m=="function":g}xt.hasFunctionProp=u;function f(h,p,g=!1){const m=h[p];return m!==void 0?Array.isArray(m):g}return xt.hasArrayProp=f,xt}var mp={},h3;function $7(){if(h3)return mp;h3=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.FeatureModule=void 0;const e=G(),n=nf();class t extends e.ContainerModule{constructor(a,o={}){var s;super((r,d,l,...c)=>{this.configure(r,l)&&(a(r,d,l,...c),this.debugLog(`Loading of feature module with id '${this.featureId.toString()}' completed`))}),this.featureId=(s=o.featureId)!==null&&s!==void 0?s:this.createFeatureId(),this.requires=o.requires}createFeatureId(){return Symbol(this.id)}configure(a,o){if(this.debugLog(`Trying to load feature module with id '${this.featureId.toString()}'`),this.isLoaded({isBound:o})){const s=`Could not load feature module. Another module with id '${this.featureId.toString()}' is already loaded`;throw this.debugLog(s),new Error(s)}return this.checkRequirements(o)?(this.debugLog(`Requirements are met, continue loading of feature module with id '${this.featureId.toString()}'`),a(this.featureId).toConstantValue(this.featureId),!0):!1}debugLog(a,...o){t.DEBUG_LOG_ENABLED&&console.log(a,...o)}checkRequirements(a){var o;const s=(0,n.asArray)((o=this.requires)!==null&&o!==void 0?o:[]);if(s.length===0)return!0;const r=s.filter(d=>!d.isLoaded({isBound:a}));return r.length>0?(this.debugLog(`Could not load feature module. Required modules are not loaded. Feature ids: ${r.map(d=>d.featureId.toString()).join(", ")}`),!1):!0}isLoaded(a){return a.isBound(this.featureId)}}return mp.FeatureModule=t,t.DEBUG_LOG_ENABLED=!1,mp}var p3;function bU(){if(p3)return Nl;p3=1,Object.defineProperty(Nl,"__esModule",{value:!0}),Nl.resolveContainerConfiguration=Nl.initializeContainer=void 0;const e=nf(),n=vt(),t=$7();function i(s,...r){const d=a(...r);return s.load(...d),s}Nl.initializeContainer=i;function a(...s){const r=[];s.forEach(c=>{o(c)?(0,e.distinctAdd)(r,c):(c.remove&&(0,e.remove)(r,...(0,e.asArray)(c.remove)),c.add&&(0,e.distinctAdd)(r,...(0,e.asArray)(c.add)),c.replace&&(0,e.asArray)(c.replace).forEach(u=>{const f=r.findIndex(h=>h instanceof t.FeatureModule&&h.featureId===u.featureId);f>=0?r[f]=u:(console.warn(`Could not find module to replace with feature id ${u.featureId.toString()}.Adding replacement module to the end of the resolved configurations.`),(0,e.distinctAdd)(r,u))}))});const d=new Set,l=[];if(r.forEach(c=>{c instanceof t.FeatureModule&&(d.has(c.featureId)?l.push(c):d.add(c.featureId))}),l.length>0){const c=l.map(u=>u.featureId.toString()).join(", ");throw new Error(`Could not resolve container configuration. Non-unique feature ids found in container configuration: ${c}`)}return r}Nl.resolveContainerConfiguration=a;function o(s){return(0,n.hasNumberProp)(s,"id")&&(0,n.hasFunctionProp)(s,"registry")}return Nl}var bc={},g3;function SU(){if(g3)return bc;g3=1,Object.defineProperty(bc,"__esModule",{value:!0}),bc.bindAsService=bc.lazyBind=bc.bindOrRebind=void 0;function e(i,a){return i.isBound(a)?i.rebind(a):i.bind(a)}bc.bindOrRebind=e;function n(i,a){if(!i.isBound(a))return i.bind(a)}bc.lazyBind=n;function t(i,a,o){const s=typeof i=="object"?i.bind.bind(i):i;s(o).toSelf().inSingletonScope(),s(a).toService(o)}return bc.bindAsService=t,bc}var Vb={},m3;function EU(){return m3||(m3=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bindLazyInjector=e.DefaultLazyInjector=e.LazyInjector=void 0;const n=G();e.LazyInjector=Symbol("LazyInjector");class t{constructor(o){this.container=o,this.cache=new Map}get(o){const s=this.getOptional(o);if(s===void 0)throw new Error("No matching bindings found for serviceIdentifier:"+(0,n.getServiceIdentifierAsString)(o));return s}getOptional(o){if(this.cache.has(o))return this.cache.get(o);const s=this.container.isBound(o)?this.container.get(o):void 0;return this.cache.set(o,s),s}getAll(o){if(this.cache.has(o))return this.cache.get(o);const s=this.container.isBound(o)?this.container.getAll(o):[];return this.cache.set(o,s),s}}e.DefaultLazyInjector=t;function i(a){(typeof a=="object"?a.bind.bind(a):a)(e.LazyInjector).toDynamicValue(s=>new t(s.container))}e.bindLazyInjector=i}(Vb)),Vb}var Gb={},Bl={},xl={},Fl={},Y1={},zb={},je={},oi={},v3;function km(){if(v3)return oi;v3=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.stringArray=oi.array=oi.func=oi.error=oi.number=oi.string=oi.boolean=void 0;function e(r){return r===!0||r===!1}oi.boolean=e;function n(r){return typeof r=="string"||r instanceof String}oi.string=n;function t(r){return typeof r=="number"||r instanceof Number}oi.number=t;function i(r){return r instanceof Error}oi.error=i;function a(r){return typeof r=="function"}oi.func=a;function o(r){return Array.isArray(r)}oi.array=o;function s(r){return o(r)&&r.every(d=>n(d))}return oi.stringArray=s,oi}var y3;function Y7(){if(y3)return je;y3=1,Object.defineProperty(je,"__esModule",{value:!0}),je.Message=je.NotificationType9=je.NotificationType8=je.NotificationType7=je.NotificationType6=je.NotificationType5=je.NotificationType4=je.NotificationType3=je.NotificationType2=je.NotificationType1=je.NotificationType0=je.NotificationType=je.RequestType9=je.RequestType8=je.RequestType7=je.RequestType6=je.RequestType5=je.RequestType4=je.RequestType3=je.RequestType2=je.RequestType1=je.RequestType=je.RequestType0=je.AbstractMessageSignature=je.ParameterStructures=je.ResponseError=je.ErrorCodes=void 0;const e=km();var n;(function(j){j.ParseError=-32700,j.InvalidRequest=-32600,j.MethodNotFound=-32601,j.InvalidParams=-32602,j.InternalError=-32603,j.jsonrpcReservedErrorRangeStart=-32099,j.serverErrorStart=-32099,j.MessageWriteError=-32099,j.MessageReadError=-32098,j.PendingResponseRejected=-32097,j.ConnectionInactive=-32096,j.ServerNotInitialized=-32002,j.UnknownErrorCode=-32001,j.jsonrpcReservedErrorRangeEnd=-32e3,j.serverErrorEnd=-32e3})(n||(je.ErrorCodes=n={}));class t extends Error{constructor(D,B,H){super(B),this.code=e.number(D)?D:n.UnknownErrorCode,this.data=H,Object.setPrototypeOf(this,t.prototype)}toJson(){const D={code:this.code,message:this.message};return this.data!==void 0&&(D.data=this.data),D}}je.ResponseError=t;class i{constructor(D){this.kind=D}static is(D){return D===i.auto||D===i.byName||D===i.byPosition}toString(){return this.kind}}je.ParameterStructures=i,i.auto=new i("auto"),i.byPosition=new i("byPosition"),i.byName=new i("byName");class a{constructor(D,B){this.method=D,this.numberOfParams=B}get parameterStructures(){return i.auto}}je.AbstractMessageSignature=a;class o extends a{constructor(D){super(D,0)}}je.RequestType0=o;class s extends a{constructor(D,B=i.auto){super(D,1),this._parameterStructures=B}get parameterStructures(){return this._parameterStructures}}je.RequestType=s;class r extends a{constructor(D,B=i.auto){super(D,1),this._parameterStructures=B}get parameterStructures(){return this._parameterStructures}}je.RequestType1=r;class d extends a{constructor(D){super(D,2)}}je.RequestType2=d;class l extends a{constructor(D){super(D,3)}}je.RequestType3=l;class c extends a{constructor(D){super(D,4)}}je.RequestType4=c;class u extends a{constructor(D){super(D,5)}}je.RequestType5=u;class f extends a{constructor(D){super(D,6)}}je.RequestType6=f;class h extends a{constructor(D){super(D,7)}}je.RequestType7=h;class p extends a{constructor(D){super(D,8)}}je.RequestType8=p;class g extends a{constructor(D){super(D,9)}}je.RequestType9=g;class m extends a{constructor(D,B=i.auto){super(D,1),this._parameterStructures=B}get parameterStructures(){return this._parameterStructures}}je.NotificationType=m;class v extends a{constructor(D){super(D,0)}}je.NotificationType0=v;class _ extends a{constructor(D,B=i.auto){super(D,1),this._parameterStructures=B}get parameterStructures(){return this._parameterStructures}}je.NotificationType1=_;class S extends a{constructor(D){super(D,2)}}je.NotificationType2=S;class E extends a{constructor(D){super(D,3)}}je.NotificationType3=E;class C extends a{constructor(D){super(D,4)}}je.NotificationType4=C;class M extends a{constructor(D){super(D,5)}}je.NotificationType5=M;class L extends a{constructor(D){super(D,6)}}je.NotificationType6=L;class I extends a{constructor(D){super(D,7)}}je.NotificationType7=I;class R extends a{constructor(D){super(D,8)}}je.NotificationType8=R;class w extends a{constructor(D){super(D,9)}}je.NotificationType9=w;var T;return function(j){function D(F){const K=F;return K&&e.string(K.method)&&(e.string(K.id)||e.number(K.id))}j.isRequest=D;function B(F){const K=F;return K&&e.string(K.method)&&F.id===void 0}j.isNotification=B;function H(F){const K=F;return K&&(K.result!==void 0||!!K.error)&&(e.string(K.id)||e.number(K.id)||K.id===null)}j.isResponse=H}(T||(je.Message=T={})),je}var Sc={},_3;function W7(){if(_3)return Sc;_3=1;var e;Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.LRUCache=Sc.LinkedMap=Sc.Touch=void 0;var n;(function(a){a.None=0,a.First=1,a.AsOld=a.First,a.Last=2,a.AsNew=a.Last})(n||(Sc.Touch=n={}));class t{constructor(){this[e]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var o;return(o=this._head)==null?void 0:o.value}get last(){var o;return(o=this._tail)==null?void 0:o.value}has(o){return this._map.has(o)}get(o,s=n.None){const r=this._map.get(o);if(r)return s!==n.None&&this.touch(r,s),r.value}set(o,s,r=n.None){let d=this._map.get(o);if(d)d.value=s,r!==n.None&&this.touch(d,r);else{switch(d={key:o,value:s,next:void 0,previous:void 0},r){case n.None:this.addItemLast(d);break;case n.First:this.addItemFirst(d);break;case n.Last:this.addItemLast(d);break;default:this.addItemLast(d);break}this._map.set(o,d),this._size++}return this}delete(o){return!!this.remove(o)}remove(o){const s=this._map.get(o);if(s)return this._map.delete(o),this.removeItem(s),this._size--,s.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const o=this._head;return this._map.delete(o.key),this.removeItem(o),this._size--,o.value}forEach(o,s){const r=this._state;let d=this._head;for(;d;){if(s?o.bind(s)(d.value,d.key,this):o(d.value,d.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");d=d.next}}keys(){const o=this._state;let s=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==o)throw new Error("LinkedMap got modified during iteration.");if(s){const d={value:s.key,done:!1};return s=s.next,d}else return{value:void 0,done:!0}}};return r}values(){const o=this._state;let s=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==o)throw new Error("LinkedMap got modified during iteration.");if(s){const d={value:s.value,done:!1};return s=s.next,d}else return{value:void 0,done:!0}}};return r}entries(){const o=this._state;let s=this._head;const r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==o)throw new Error("LinkedMap got modified during iteration.");if(s){const d={value:[s.key,s.value],done:!1};return s=s.next,d}else return{value:void 0,done:!0}}};return r}[(e=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(o){if(o>=this.size)return;if(o===0){this.clear();return}let s=this._head,r=this.size;for(;s&&r>o;)this._map.delete(s.key),s=s.next,r--;this._head=s,this._size=r,s&&(s.previous=void 0),this._state++}addItemFirst(o){if(!this._head&&!this._tail)this._tail=o;else if(this._head)o.next=this._head,this._head.previous=o;else throw new Error("Invalid list");this._head=o,this._state++}addItemLast(o){if(!this._head&&!this._tail)this._head=o;else if(this._tail)o.previous=this._tail,this._tail.next=o;else throw new Error("Invalid list");this._tail=o,this._state++}removeItem(o){if(o===this._head&&o===this._tail)this._head=void 0,this._tail=void 0;else if(o===this._head){if(!o.next)throw new Error("Invalid list");o.next.previous=void 0,this._head=o.next}else if(o===this._tail){if(!o.previous)throw new Error("Invalid list");o.previous.next=void 0,this._tail=o.previous}else{const s=o.next,r=o.previous;if(!s||!r)throw new Error("Invalid list");s.previous=r,r.next=s}o.next=void 0,o.previous=void 0,this._state++}touch(o,s){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(s!==n.First&&s!==n.Last)){if(s===n.First){if(o===this._head)return;const r=o.next,d=o.previous;o===this._tail?(d.next=void 0,this._tail=d):(r.previous=d,d.next=r),o.previous=void 0,o.next=this._head,this._head.previous=o,this._head=o,this._state++}else if(s===n.Last){if(o===this._tail)return;const r=o.next,d=o.previous;o===this._head?(r.previous=void 0,this._head=r):(r.previous=d,d.next=r),o.next=void 0,o.previous=this._tail,this._tail.next=o,this._tail=o,this._state++}}}toJSON(){const o=[];return this.forEach((s,r)=>{o.push([r,s])}),o}fromJSON(o){this.clear();for(const[s,r]of o)this.set(s,r)}}Sc.LinkedMap=t;class i extends t{constructor(o,s=1){super(),this._limit=o,this._ratio=Math.min(Math.max(0,s),1)}get limit(){return this._limit}set limit(o){this._limit=o,this.checkTrim()}get ratio(){return this._ratio}set ratio(o){this._ratio=Math.min(Math.max(0,o),1),this.checkTrim()}get(o,s=n.AsNew){return super.get(o,s)}peek(o){return super.get(o,n.None)}set(o,s){return super.set(o,s,n.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}return Sc.LRUCache=i,Sc}var vp={},b3;function CU(){if(b3)return vp;b3=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.Disposable=void 0;var e;return function(n){function t(i){return{dispose:i}}n.create=t}(e||(vp.Disposable=e={})),vp}var kl={},W1={},S3;function rf(){if(S3)return W1;S3=1,Object.defineProperty(W1,"__esModule",{value:!0});let e;function n(){if(e===void 0)throw new Error("No runtime abstraction layer installed");return e}return function(t){function i(a){if(a===void 0)throw new Error("No runtime abstraction layer provided");e=a}t.install=i}(n||(n={})),W1.default=n,W1}var E3;function Km(){if(E3)return kl;E3=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.Emitter=kl.Event=void 0;const e=rf();var n;(function(a){const o={dispose(){}};a.None=function(){return o}})(n||(kl.Event=n={}));class t{add(o,s=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(o),this._contexts.push(s),Array.isArray(r)&&r.push({dispose:()=>this.remove(o,s)})}remove(o,s=null){if(!this._callbacks)return;let r=!1;for(let d=0,l=this._callbacks.length;d<l;d++)if(this._callbacks[d]===o)if(this._contexts[d]===s){this._callbacks.splice(d,1),this._contexts.splice(d,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...o){if(!this._callbacks)return[];const s=[],r=this._callbacks.slice(0),d=this._contexts.slice(0);for(let l=0,c=r.length;l<c;l++)try{s.push(r[l].apply(d[l],o))}catch(u){(0,e.default)().console.error(u)}return s}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}class i{constructor(o){this._options=o}get event(){return this._event||(this._event=(o,s,r)=>{this._callbacks||(this._callbacks=new t),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(o,s);const d={dispose:()=>{this._callbacks&&(this._callbacks.remove(o,s),d.dispose=i._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(d),d}),this._event}fire(o){this._callbacks&&this._callbacks.invoke.call(this._callbacks,o)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}return kl.Emitter=i,i._noop=function(){},kl}var Kl={},C3;function bP(){if(C3)return Kl;C3=1,Object.defineProperty(Kl,"__esModule",{value:!0}),Kl.CancellationTokenSource=Kl.CancellationToken=void 0;const e=rf(),n=km(),t=Km();var i;(function(r){r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:t.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:t.Event.None});function d(l){const c=l;return c&&(c===r.None||c===r.Cancelled||n.boolean(c.isCancellationRequested)&&!!c.onCancellationRequested)}r.is=d})(i||(Kl.CancellationToken=i={}));const a=Object.freeze(function(r,d){const l=(0,e.default)().timer.setTimeout(r.bind(d),0);return{dispose(){l.dispose()}}});class o{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?a:(this._emitter||(this._emitter=new t.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class s{get token(){return this._token||(this._token=new o),this._token}cancel(){this._token?this._token.cancel():this._token=i.Cancelled}dispose(){this._token?this._token instanceof o&&this._token.dispose():this._token=i.None}}return Kl.CancellationTokenSource=s,Kl}var ql={},P3;function PU(){if(P3)return ql;P3=1,Object.defineProperty(ql,"__esModule",{value:!0}),ql.SharedArrayReceiverStrategy=ql.SharedArraySenderStrategy=void 0;const e=bP();var n;(function(s){s.Continue=0,s.Cancelled=1})(n||(n={}));class t{constructor(){this.buffers=new Map}enableCancellation(r){if(r.id===null)return;const d=new SharedArrayBuffer(4),l=new Int32Array(d,0,1);l[0]=n.Continue,this.buffers.set(r.id,d),r.$cancellationData=d}async sendCancellation(r,d){const l=this.buffers.get(d);if(l===void 0)return;const c=new Int32Array(l,0,1);Atomics.store(c,0,n.Cancelled)}cleanup(r){this.buffers.delete(r)}dispose(){this.buffers.clear()}}ql.SharedArraySenderStrategy=t;class i{constructor(r){this.data=new Int32Array(r,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===n.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class a{constructor(r){this.token=new i(r)}cancel(){}dispose(){}}class o{constructor(){this.kind="request"}createCancellationTokenSource(r){const d=r.$cancellationData;return d===void 0?new e.CancellationTokenSource:new a(d)}}return ql.SharedArrayReceiverStrategy=o,ql}var Ec={},yp={},R3;function Z7(){if(R3)return yp;R3=1,Object.defineProperty(yp,"__esModule",{value:!0}),yp.Semaphore=void 0;const e=rf();class n{constructor(i=1){if(i<=0)throw new Error("Capacity must be greater than 0");this._capacity=i,this._active=0,this._waiting=[]}lock(i){return new Promise((a,o)=>{this._waiting.push({thunk:i,resolve:a,reject:o}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,e.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const i=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const a=i.thunk();a instanceof Promise?a.then(o=>{this._active--,i.resolve(o),this.runNext()},o=>{this._active--,i.reject(o),this.runNext()}):(this._active--,i.resolve(a),this.runNext())}catch(a){this._active--,i.reject(a),this.runNext()}}}return yp.Semaphore=n,yp}var M3;function RU(){if(M3)return Ec;M3=1,Object.defineProperty(Ec,"__esModule",{value:!0}),Ec.ReadableStreamMessageReader=Ec.AbstractMessageReader=Ec.MessageReader=void 0;const e=rf(),n=km(),t=Km(),i=Z7();var a;(function(d){function l(c){let u=c;return u&&n.func(u.listen)&&n.func(u.dispose)&&n.func(u.onError)&&n.func(u.onClose)&&n.func(u.onPartialMessage)}d.is=l})(a||(Ec.MessageReader=a={}));class o{constructor(){this.errorEmitter=new t.Emitter,this.closeEmitter=new t.Emitter,this.partialMessageEmitter=new t.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(l){this.errorEmitter.fire(this.asError(l))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(l){this.partialMessageEmitter.fire(l)}asError(l){return l instanceof Error?l:new Error(`Reader received error. Reason: ${n.string(l.message)?l.message:"unknown"}`)}}Ec.AbstractMessageReader=o;var s;(function(d){function l(c){let u,f;const h=new Map;let p;const g=new Map;if(c===void 0||typeof c=="string")u=c??"utf-8";else{if(u=c.charset??"utf-8",c.contentDecoder!==void 0&&(f=c.contentDecoder,h.set(f.name,f)),c.contentDecoders!==void 0)for(const m of c.contentDecoders)h.set(m.name,m);if(c.contentTypeDecoder!==void 0&&(p=c.contentTypeDecoder,g.set(p.name,p)),c.contentTypeDecoders!==void 0)for(const m of c.contentTypeDecoders)g.set(m.name,m)}return p===void 0&&(p=(0,e.default)().applicationJson.decoder,g.set(p.name,p)),{charset:u,contentDecoder:f,contentDecoders:h,contentTypeDecoder:p,contentTypeDecoders:g}}d.fromOptions=l})(s||(s={}));class r extends o{constructor(l,c){super(),this.readable=l,this.options=s.fromOptions(c),this.buffer=(0,e.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new i.Semaphore(1)}set partialMessageTimeout(l){this._partialMessageTimeout=l}get partialMessageTimeout(){return this._partialMessageTimeout}listen(l){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=l;const c=this.readable.onData(u=>{this.onData(u)});return this.readable.onError(u=>this.fireError(u)),this.readable.onClose(()=>this.fireClose()),c}onData(l){try{for(this.buffer.append(l);;){if(this.nextMessageLength===-1){const u=this.buffer.tryReadHeaders(!0);if(!u)return;const f=u.get("content-length");if(!f){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(u))}`));return}const h=parseInt(f);if(isNaN(h)){this.fireError(new Error(`Content-Length value must be a number. Got ${f}`));return}this.nextMessageLength=h}const c=this.buffer.tryReadBody(this.nextMessageLength);if(c===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const u=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(c):c,f=await this.options.contentTypeDecoder.decode(u,this.options);this.callback(f)}).catch(u=>{this.fireError(u)})}}catch(c){this.fireError(c)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,e.default)().timer.setTimeout((l,c)=>{this.partialMessageTimer=void 0,l===this.messageToken&&(this.firePartialMessage({messageToken:l,waitingTime:c}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}return Ec.ReadableStreamMessageReader=r,Ec}var Cc={},A3;function MU(){if(A3)return Cc;A3=1,Object.defineProperty(Cc,"__esModule",{value:!0}),Cc.WriteableStreamMessageWriter=Cc.AbstractMessageWriter=Cc.MessageWriter=void 0;const e=rf(),n=km(),t=Z7(),i=Km(),a="Content-Length: ",o=`\r
`;var s;(function(c){function u(f){let h=f;return h&&n.func(h.dispose)&&n.func(h.onClose)&&n.func(h.onError)&&n.func(h.write)}c.is=u})(s||(Cc.MessageWriter=s={}));class r{constructor(){this.errorEmitter=new i.Emitter,this.closeEmitter=new i.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(u,f,h){this.errorEmitter.fire([this.asError(u),f,h])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(u){return u instanceof Error?u:new Error(`Writer received error. Reason: ${n.string(u.message)?u.message:"unknown"}`)}}Cc.AbstractMessageWriter=r;var d;(function(c){function u(f){return f===void 0||typeof f=="string"?{charset:f??"utf-8",contentTypeEncoder:(0,e.default)().applicationJson.encoder}:{charset:f.charset??"utf-8",contentEncoder:f.contentEncoder,contentTypeEncoder:f.contentTypeEncoder??(0,e.default)().applicationJson.encoder}}c.fromOptions=u})(d||(d={}));class l extends r{constructor(u,f){super(),this.writable=u,this.options=d.fromOptions(f),this.errorCount=0,this.writeSemaphore=new t.Semaphore(1),this.writable.onError(h=>this.fireError(h)),this.writable.onClose(()=>this.fireClose())}async write(u){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(u,this.options).then(h=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(h):h).then(h=>{const p=[];return p.push(a,h.byteLength.toString(),o),p.push(o),this.doWrite(u,p,h)},h=>{throw this.fireError(h),h}))}async doWrite(u,f,h){try{return await this.writable.write(f.join(""),"ascii"),this.writable.write(h)}catch(p){return this.handleError(p,u),Promise.reject(p)}}handleError(u,f){this.errorCount++,this.fireError(u,f,this.errorCount)}end(){this.writable.end()}}return Cc.WriteableStreamMessageWriter=l,Cc}var _p={},w3;function AU(){if(w3)return _p;w3=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.AbstractMessageBuffer=void 0;const e=13,n=10,t=`\r
`;class i{constructor(o="utf-8"){this._encoding=o,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(o){const s=typeof o=="string"?this.fromString(o,this._encoding):o;this._chunks.push(s),this._totalLength+=s.byteLength}tryReadHeaders(o=!1){if(this._chunks.length===0)return;let s=0,r=0,d=0,l=0;e:for(;r<this._chunks.length;){const h=this._chunks[r];for(d=0;d<h.length;){switch(h[d]){case e:switch(s){case 0:s=1;break;case 2:s=3;break;default:s=0}break;case n:switch(s){case 1:s=2;break;case 3:s=4,d++;break e;default:s=0}break;default:s=0}d++}l+=h.byteLength,r++}if(s!==4)return;const c=this._read(l+d),u=new Map,f=this.toString(c,"ascii").split(t);if(f.length<2)return u;for(let h=0;h<f.length-2;h++){const p=f[h],g=p.indexOf(":");if(g===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);const m=p.substr(0,g),v=p.substr(g+1).trim();u.set(o?m.toLowerCase():m,v)}return u}tryReadBody(o){if(!(this._totalLength<o))return this._read(o)}get numberOfBytes(){return this._totalLength}_read(o){if(o===0)return this.emptyBuffer();if(o>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===o){const l=this._chunks[0];return this._chunks.shift(),this._totalLength-=o,this.asNative(l)}if(this._chunks[0].byteLength>o){const l=this._chunks[0],c=this.asNative(l,o);return this._chunks[0]=l.slice(o),this._totalLength-=o,c}const s=this.allocNative(o);let r=0,d=0;for(;o>0;){const l=this._chunks[d];if(l.byteLength>o){const c=l.slice(0,o);s.set(c,r),r+=o,this._chunks[d]=l.slice(o),this._totalLength-=o,o-=o}else s.set(l,r),r+=l.byteLength,this._chunks.shift(),this._totalLength-=l.byteLength,o-=l.byteLength}return s}}return _p.AbstractMessageBuffer=i,_p}var Ub={},I3;function wU(){return I3||(I3=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.ConnectionOptions=e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.RequestCancellationReceiverStrategy=e.IdCancellationReceiverStrategy=e.ConnectionStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=e.NullLogger=e.ProgressType=e.ProgressToken=void 0;const n=rf(),t=km(),i=Y7(),a=W7(),o=Km(),s=bP();var r;(function(D){D.type=new i.NotificationType("$/cancelRequest")})(r||(r={}));var d;(function(D){function B(H){return typeof H=="string"||typeof H=="number"}D.is=B})(d||(e.ProgressToken=d={}));var l;(function(D){D.type=new i.NotificationType("$/progress")})(l||(l={}));class c{constructor(){}}e.ProgressType=c;var u;(function(D){function B(H){return t.func(H)}D.is=B})(u||(u={})),e.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var f;(function(D){D[D.Off=0]="Off",D[D.Messages=1]="Messages",D[D.Compact=2]="Compact",D[D.Verbose=3]="Verbose"})(f||(e.Trace=f={}));var h;(function(D){D.Off="off",D.Messages="messages",D.Compact="compact",D.Verbose="verbose"})(h||(e.TraceValues=h={})),function(D){function B(F){if(!t.string(F))return D.Off;switch(F=F.toLowerCase(),F){case"off":return D.Off;case"messages":return D.Messages;case"compact":return D.Compact;case"verbose":return D.Verbose;default:return D.Off}}D.fromString=B;function H(F){switch(F){case D.Off:return"off";case D.Messages:return"messages";case D.Compact:return"compact";case D.Verbose:return"verbose";default:return"off"}}D.toString=H}(f||(e.Trace=f={}));var p;(function(D){D.Text="text",D.JSON="json"})(p||(e.TraceFormat=p={})),function(D){function B(H){return t.string(H)?(H=H.toLowerCase(),H==="json"?D.JSON:D.Text):D.Text}D.fromString=B}(p||(e.TraceFormat=p={}));var g;(function(D){D.type=new i.NotificationType("$/setTrace")})(g||(e.SetTraceNotification=g={}));var m;(function(D){D.type=new i.NotificationType("$/logTrace")})(m||(e.LogTraceNotification=m={}));var v;(function(D){D[D.Closed=1]="Closed",D[D.Disposed=2]="Disposed",D[D.AlreadyListening=3]="AlreadyListening"})(v||(e.ConnectionErrors=v={}));class _ extends Error{constructor(B,H){super(H),this.code=B,Object.setPrototypeOf(this,_.prototype)}}e.ConnectionError=_;var S;(function(D){function B(H){const F=H;return F&&t.func(F.cancelUndispatched)}D.is=B})(S||(e.ConnectionStrategy=S={}));var E;(function(D){function B(H){const F=H;return F&&(F.kind===void 0||F.kind==="id")&&t.func(F.createCancellationTokenSource)&&(F.dispose===void 0||t.func(F.dispose))}D.is=B})(E||(e.IdCancellationReceiverStrategy=E={}));var C;(function(D){function B(H){const F=H;return F&&F.kind==="request"&&t.func(F.createCancellationTokenSource)&&(F.dispose===void 0||t.func(F.dispose))}D.is=B})(C||(e.RequestCancellationReceiverStrategy=C={}));var M;(function(D){D.Message=Object.freeze({createCancellationTokenSource(H){return new s.CancellationTokenSource}});function B(H){return E.is(H)||C.is(H)}D.is=B})(M||(e.CancellationReceiverStrategy=M={}));var L;(function(D){D.Message=Object.freeze({sendCancellation(H,F){return H.sendNotification(r.type,{id:F})},cleanup(H){}});function B(H){const F=H;return F&&t.func(F.sendCancellation)&&t.func(F.cleanup)}D.is=B})(L||(e.CancellationSenderStrategy=L={}));var I;(function(D){D.Message=Object.freeze({receiver:M.Message,sender:L.Message});function B(H){const F=H;return F&&M.is(F.receiver)&&L.is(F.sender)}D.is=B})(I||(e.CancellationStrategy=I={}));var R;(function(D){function B(H){const F=H;return F&&t.func(F.handleMessage)}D.is=B})(R||(e.MessageStrategy=R={}));var w;(function(D){function B(H){const F=H;return F&&(I.is(F.cancellationStrategy)||S.is(F.connectionStrategy)||R.is(F.messageStrategy))}D.is=B})(w||(e.ConnectionOptions=w={}));var T;(function(D){D[D.New=1]="New",D[D.Listening=2]="Listening",D[D.Closed=3]="Closed",D[D.Disposed=4]="Disposed"})(T||(T={}));function j(D,B,H,F){const K=H!==void 0?H:e.NullLogger;let U=0,Z=0,ce=0;const de="2.0";let ke;const pe=new Map;let et;const ot=new Map,Be=new Map;let ee,ge=new a.LinkedMap,fe=new Map,Ae=new Set,Le=new Map,Ge=f.Off,pn=p.Text,he,Ke=T.New;const Kt=new o.Emitter,At=new o.Emitter,cn=new o.Emitter,gn=new o.Emitter,Kn=new o.Emitter,dt=F&&F.cancellationStrategy?F.cancellationStrategy:I.Message;function Lt($){if($===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+$.toString()}function Gi($){return $===null?"res-unknown-"+(++ce).toString():"res-"+$.toString()}function vh(){return"not-"+(++Z).toString()}function Qa($,se){i.Message.isRequest(se)?$.set(Lt(se.id),se):i.Message.isResponse(se)?$.set(Gi(se.id),se):$.set(vh(),se)}function yh($){}function zi(){return Ke===T.Listening}function Zo(){return Ke===T.Closed}function Qr(){return Ke===T.Disposed}function eu(){(Ke===T.New||Ke===T.Listening)&&(Ke=T.Closed,At.fire(void 0))}function Ja($){Kt.fire([$,void 0,void 0])}function X($){Kt.fire($)}D.onClose(eu),D.onError(Ja),B.onClose(eu),B.onError(X);function te(){ee||ge.size===0||(ee=(0,n.default)().timer.setImmediate(()=>{ee=void 0,me()}))}function re($){i.Message.isRequest($)?jt($):i.Message.isNotification($)?Ze($):i.Message.isResponse($)?Jt($):Ee($)}function me(){if(ge.size===0)return;const $=ge.shift();try{const se=F==null?void 0:F.messageStrategy;R.is(se)?se.handleMessage($,re):re($)}finally{te()}}const Ne=$=>{try{if(i.Message.isNotification($)&&$.method===r.type.method){const se=$.params.id,ye=Lt(se),De=ge.get(ye);if(i.Message.isRequest(De)){const Et=F==null?void 0:F.connectionStrategy,It=Et&&Et.cancelUndispatched?Et.cancelUndispatched(De,yh):void 0;if(It&&(It.error!==void 0||It.result!==void 0)){ge.delete(ye),Le.delete(se),It.id=De.id,Ye(It,$.method,Date.now()),B.write(It).catch(()=>K.error("Sending response for canceled message failed."));return}}const wt=Le.get(se);if(wt!==void 0){wt.cancel(),Nt($);return}else Ae.add(se)}Qa(ge,$)}finally{te()}};function jt($){if(Qr())return;function se(ct,$t,pt){const Zt={jsonrpc:de,id:$.id};ct instanceof i.ResponseError?Zt.error=ct.toJson():Zt.result=ct===void 0?null:ct,Ye(Zt,$t,pt),B.write(Zt).catch(()=>K.error("Sending response failed."))}function ye(ct,$t,pt){const Zt={jsonrpc:de,id:$.id,error:ct.toJson()};Ye(Zt,$t,pt),B.write(Zt).catch(()=>K.error("Sending response failed."))}function De(ct,$t,pt){ct===void 0&&(ct=null);const Zt={jsonrpc:de,id:$.id,result:ct};Ye(Zt,$t,pt),B.write(Zt).catch(()=>K.error("Sending response failed."))}St($);const wt=pe.get($.method);let Et,It;wt&&(Et=wt.type,It=wt.handler);const Xt=Date.now();if(It||ke){const ct=$.id??String(Date.now()),$t=E.is(dt.receiver)?dt.receiver.createCancellationTokenSource(ct):dt.receiver.createCancellationTokenSource($);$.id!==null&&Ae.has($.id)&&$t.cancel(),$.id!==null&&Le.set(ct,$t);try{let pt;if(It)if($.params===void 0){if(Et!==void 0&&Et.numberOfParams!==0){ye(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${$.method} defines ${Et.numberOfParams} params but received none.`),$.method,Xt);return}pt=It($t.token)}else if(Array.isArray($.params)){if(Et!==void 0&&Et.parameterStructures===i.ParameterStructures.byName){ye(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${$.method} defines parameters by name but received parameters by position`),$.method,Xt);return}pt=It(...$.params,$t.token)}else{if(Et!==void 0&&Et.parameterStructures===i.ParameterStructures.byPosition){ye(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${$.method} defines parameters by position but received parameters by name`),$.method,Xt);return}pt=It($.params,$t.token)}else ke&&(pt=ke($.method,$.params,$t.token));const Zt=pt;pt?Zt.then?Zt.then($n=>{Le.delete(ct),se($n,$.method,Xt)},$n=>{Le.delete(ct),$n instanceof i.ResponseError?ye($n,$.method,Xt):$n&&t.string($n.message)?ye(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${$.method} failed with message: ${$n.message}`),$.method,Xt):ye(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${$.method} failed unexpectedly without providing any details.`),$.method,Xt)}):(Le.delete(ct),se(pt,$.method,Xt)):(Le.delete(ct),De(pt,$.method,Xt))}catch(pt){Le.delete(ct),pt instanceof i.ResponseError?se(pt,$.method,Xt):pt&&t.string(pt.message)?ye(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${$.method} failed with message: ${pt.message}`),$.method,Xt):ye(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${$.method} failed unexpectedly without providing any details.`),$.method,Xt)}}else ye(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${$.method}`),$.method,Xt)}function Jt($){if(!Qr())if($.id===null)$.error?K.error(`Received response message without id: Error is: 
${JSON.stringify($.error,void 0,4)}`):K.error("Received response message without id. No further error information provided.");else{const se=$.id,ye=fe.get(se);if(mi($,ye),ye!==void 0){fe.delete(se);try{if($.error){const De=$.error;ye.reject(new i.ResponseError(De.code,De.message,De.data))}else if($.result!==void 0)ye.resolve($.result);else throw new Error("Should never happen.")}catch(De){De.message?K.error(`Response handler '${ye.method}' failed with message: ${De.message}`):K.error(`Response handler '${ye.method}' failed unexpectedly.`)}}}}function Ze($){if(Qr())return;let se,ye;if($.method===r.type.method){const De=$.params.id;Ae.delete(De),Nt($);return}else{const De=ot.get($.method);De&&(ye=De.handler,se=De.type)}if(ye||et)try{if(Nt($),ye)if($.params===void 0)se!==void 0&&se.numberOfParams!==0&&se.parameterStructures!==i.ParameterStructures.byName&&K.error(`Notification ${$.method} defines ${se.numberOfParams} params but received none.`),ye();else if(Array.isArray($.params)){const De=$.params;$.method===l.type.method&&De.length===2&&d.is(De[0])?ye({token:De[0],value:De[1]}):(se!==void 0&&(se.parameterStructures===i.ParameterStructures.byName&&K.error(`Notification ${$.method} defines parameters by name but received parameters by position`),se.numberOfParams!==$.params.length&&K.error(`Notification ${$.method} defines ${se.numberOfParams} params but received ${De.length} arguments`)),ye(...De))}else se!==void 0&&se.parameterStructures===i.ParameterStructures.byPosition&&K.error(`Notification ${$.method} defines parameters by position but received parameters by name`),ye($.params);else et&&et($.method,$.params)}catch(De){De.message?K.error(`Notification handler '${$.method}' failed with message: ${De.message}`):K.error(`Notification handler '${$.method}' failed unexpectedly.`)}else cn.fire($)}function Ee($){if(!$){K.error("Received empty message.");return}K.error(`Received message which is neither a response nor a notification message:
${JSON.stringify($,null,4)}`);const se=$;if(t.string(se.id)||t.number(se.id)){const ye=se.id,De=fe.get(ye);De&&De.reject(new Error("The received response has neither a result nor an error property."))}}function be($){if($!=null)switch(Ge){case f.Verbose:return JSON.stringify($,null,4);case f.Compact:return JSON.stringify($);default:return}}function Re($){if(!(Ge===f.Off||!he))if(pn===p.Text){let se;(Ge===f.Verbose||Ge===f.Compact)&&$.params&&(se=`Params: ${be($.params)}

`),he.log(`Sending request '${$.method} - (${$.id})'.`,se)}else Qo("send-request",$)}function we($){if(!(Ge===f.Off||!he))if(pn===p.Text){let se;(Ge===f.Verbose||Ge===f.Compact)&&($.params?se=`Params: ${be($.params)}

`:se=`No parameters provided.

`),he.log(`Sending notification '${$.method}'.`,se)}else Qo("send-notification",$)}function Ye($,se,ye){if(!(Ge===f.Off||!he))if(pn===p.Text){let De;(Ge===f.Verbose||Ge===f.Compact)&&($.error&&$.error.data?De=`Error data: ${be($.error.data)}

`:$.result?De=`Result: ${be($.result)}

`:$.error===void 0&&(De=`No result returned.

`)),he.log(`Sending response '${se} - (${$.id})'. Processing request took ${Date.now()-ye}ms`,De)}else Qo("send-response",$)}function St($){if(!(Ge===f.Off||!he))if(pn===p.Text){let se;(Ge===f.Verbose||Ge===f.Compact)&&$.params&&(se=`Params: ${be($.params)}

`),he.log(`Received request '${$.method} - (${$.id})'.`,se)}else Qo("receive-request",$)}function Nt($){if(!(Ge===f.Off||!he||$.method===m.type.method))if(pn===p.Text){let se;(Ge===f.Verbose||Ge===f.Compact)&&($.params?se=`Params: ${be($.params)}

`:se=`No parameters provided.

`),he.log(`Received notification '${$.method}'.`,se)}else Qo("receive-notification",$)}function mi($,se){if(!(Ge===f.Off||!he))if(pn===p.Text){let ye;if((Ge===f.Verbose||Ge===f.Compact)&&($.error&&$.error.data?ye=`Error data: ${be($.error.data)}

`:$.result?ye=`Result: ${be($.result)}

`:$.error===void 0&&(ye=`No result returned.

`)),se){const De=$.error?` Request failed: ${$.error.message} (${$.error.code}).`:"";he.log(`Received response '${se.method} - (${$.id})' in ${Date.now()-se.timerStart}ms.${De}`,ye)}else he.log(`Received response ${$.id} without active response promise.`,ye)}else Qo("receive-response",$)}function Qo($,se){if(!he||Ge===f.Off)return;const ye={isLSPMessage:!0,type:$,message:se,timestamp:Date.now()};he.log(ye)}function Xa(){if(Zo())throw new _(v.Closed,"Connection is closed.");if(Qr())throw new _(v.Disposed,"Connection is disposed.")}function _h(){if(zi())throw new _(v.AlreadyListening,"Connection is already listening")}function bh(){if(!zi())throw new Error("Call listen() first.")}function hl($){return $===void 0?null:$}function pf($){if($!==null)return $}function dv($){return $!=null&&!Array.isArray($)&&typeof $=="object"}function Sh($,se){switch($){case i.ParameterStructures.auto:return dv(se)?pf(se):[hl(se)];case i.ParameterStructures.byName:if(!dv(se))throw new Error("Received parameters by name but param is not an object literal.");return pf(se);case i.ParameterStructures.byPosition:return[hl(se)];default:throw new Error(`Unknown parameter structure ${$.toString()}`)}}function fv($,se){let ye;const De=$.numberOfParams;switch(De){case 0:ye=void 0;break;case 1:ye=Sh($.parameterStructures,se[0]);break;default:ye=[];for(let wt=0;wt<se.length&&wt<De;wt++)ye.push(hl(se[wt]));if(se.length<De)for(let wt=se.length;wt<De;wt++)ye.push(null);break}return ye}const tu={sendNotification:($,...se)=>{Xa();let ye,De;if(t.string($)){ye=$;const Et=se[0];let It=0,Xt=i.ParameterStructures.auto;i.ParameterStructures.is(Et)&&(It=1,Xt=Et);let ct=se.length;const $t=ct-It;switch($t){case 0:De=void 0;break;case 1:De=Sh(Xt,se[It]);break;default:if(Xt===i.ParameterStructures.byName)throw new Error(`Received ${$t} parameters for 'by Name' notification parameter structure.`);De=se.slice(It,ct).map(pt=>hl(pt));break}}else{const Et=se;ye=$.method,De=fv($,Et)}const wt={jsonrpc:de,method:ye,params:De};return we(wt),B.write(wt).catch(Et=>{throw K.error("Sending notification failed."),Et})},onNotification:($,se)=>{Xa();let ye;return t.func($)?et=$:se&&(t.string($)?(ye=$,ot.set($,{type:void 0,handler:se})):(ye=$.method,ot.set($.method,{type:$,handler:se}))),{dispose:()=>{ye!==void 0?ot.delete(ye):et=void 0}}},onProgress:($,se,ye)=>{if(Be.has(se))throw new Error(`Progress handler for token ${se} already registered`);return Be.set(se,ye),{dispose:()=>{Be.delete(se)}}},sendProgress:($,se,ye)=>tu.sendNotification(l.type,{token:se,value:ye}),onUnhandledProgress:gn.event,sendRequest:($,...se)=>{Xa(),bh();let ye,De,wt;if(t.string($)){ye=$;const ct=se[0],$t=se[se.length-1];let pt=0,Zt=i.ParameterStructures.auto;i.ParameterStructures.is(ct)&&(pt=1,Zt=ct);let $n=se.length;s.CancellationToken.is($t)&&($n=$n-1,wt=$t);const Pi=$n-pt;switch(Pi){case 0:De=void 0;break;case 1:De=Sh(Zt,se[pt]);break;default:if(Zt===i.ParameterStructures.byName)throw new Error(`Received ${Pi} parameters for 'by Name' request parameter structure.`);De=se.slice(pt,$n).map(e0=>hl(e0));break}}else{const ct=se;ye=$.method,De=fv($,ct);const $t=$.numberOfParams;wt=s.CancellationToken.is(ct[$t])?ct[$t]:void 0}const Et=U++;let It;wt&&(It=wt.onCancellationRequested(()=>{const ct=dt.sender.sendCancellation(tu,Et);return ct===void 0?(K.log(`Received no promise from cancellation strategy when cancelling id ${Et}`),Promise.resolve()):ct.catch(()=>{K.log(`Sending cancellation messages for id ${Et} failed`)})}));const Xt={jsonrpc:de,id:Et,method:ye,params:De};return Re(Xt),typeof dt.sender.enableCancellation=="function"&&dt.sender.enableCancellation(Xt),new Promise(async(ct,$t)=>{const pt=Pi=>{ct(Pi),dt.sender.cleanup(Et),It==null||It.dispose()},Zt=Pi=>{$t(Pi),dt.sender.cleanup(Et),It==null||It.dispose()},$n={method:ye,timerStart:Date.now(),resolve:pt,reject:Zt};try{await B.write(Xt),fe.set(Et,$n)}catch(Pi){throw K.error("Sending request failed."),$n.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,Pi.message?Pi.message:"Unknown reason")),Pi}})},onRequest:($,se)=>{Xa();let ye=null;return u.is($)?(ye=void 0,ke=$):t.string($)?(ye=null,se!==void 0&&(ye=$,pe.set($,{handler:se,type:void 0}))):se!==void 0&&(ye=$.method,pe.set($.method,{type:$,handler:se})),{dispose:()=>{ye!==null&&(ye!==void 0?pe.delete(ye):ke=void 0)}}},hasPendingResponse:()=>fe.size>0,trace:async($,se,ye)=>{let De=!1,wt=p.Text;ye!==void 0&&(t.boolean(ye)?De=ye:(De=ye.sendNotification||!1,wt=ye.traceFormat||p.Text)),Ge=$,pn=wt,Ge===f.Off?he=void 0:he=se,De&&!Zo()&&!Qr()&&await tu.sendNotification(g.type,{value:f.toString($)})},onError:Kt.event,onClose:At.event,onUnhandledNotification:cn.event,onDispose:Kn.event,end:()=>{B.end()},dispose:()=>{if(Qr())return;Ke=T.Disposed,Kn.fire(void 0);const $=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const se of fe.values())se.reject($);fe=new Map,Le=new Map,Ae=new Set,ge=new a.LinkedMap,t.func(B.dispose)&&B.dispose(),t.func(D.dispose)&&D.dispose()},listen:()=>{Xa(),_h(),Ke=T.Listening,D.listen(Ne)},inspect:()=>{(0,n.default)().console.log("inspect")}};return tu.onNotification(m.type,$=>{if(Ge===f.Off||!he)return;const se=Ge===f.Verbose||Ge===f.Compact;he.log($.message,se?$.verbose:void 0)}),tu.onNotification(l.type,$=>{const se=Be.get($.token);se?se($.value):gn.fire($)}),tu}e.createMessageConnection=j}(Ub)),Ub}var T3;function BS(){return T3||(T3=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ProgressType=e.ProgressToken=e.createMessageConnection=e.NullLogger=e.ConnectionOptions=e.ConnectionStrategy=e.AbstractMessageBuffer=e.WriteableStreamMessageWriter=e.AbstractMessageWriter=e.MessageWriter=e.ReadableStreamMessageReader=e.AbstractMessageReader=e.MessageReader=e.SharedArrayReceiverStrategy=e.SharedArraySenderStrategy=e.CancellationToken=e.CancellationTokenSource=e.Emitter=e.Event=e.Disposable=e.LRUCache=e.Touch=e.LinkedMap=e.ParameterStructures=e.NotificationType9=e.NotificationType8=e.NotificationType7=e.NotificationType6=e.NotificationType5=e.NotificationType4=e.NotificationType3=e.NotificationType2=e.NotificationType1=e.NotificationType0=e.NotificationType=e.ErrorCodes=e.ResponseError=e.RequestType9=e.RequestType8=e.RequestType7=e.RequestType6=e.RequestType5=e.RequestType4=e.RequestType3=e.RequestType2=e.RequestType1=e.RequestType0=e.RequestType=e.Message=e.RAL=void 0,e.MessageStrategy=e.CancellationStrategy=e.CancellationSenderStrategy=e.CancellationReceiverStrategy=e.ConnectionError=e.ConnectionErrors=e.LogTraceNotification=e.SetTraceNotification=e.TraceFormat=e.TraceValues=e.Trace=void 0;const n=Y7();Object.defineProperty(e,"Message",{enumerable:!0,get:function(){return n.Message}}),Object.defineProperty(e,"RequestType",{enumerable:!0,get:function(){return n.RequestType}}),Object.defineProperty(e,"RequestType0",{enumerable:!0,get:function(){return n.RequestType0}}),Object.defineProperty(e,"RequestType1",{enumerable:!0,get:function(){return n.RequestType1}}),Object.defineProperty(e,"RequestType2",{enumerable:!0,get:function(){return n.RequestType2}}),Object.defineProperty(e,"RequestType3",{enumerable:!0,get:function(){return n.RequestType3}}),Object.defineProperty(e,"RequestType4",{enumerable:!0,get:function(){return n.RequestType4}}),Object.defineProperty(e,"RequestType5",{enumerable:!0,get:function(){return n.RequestType5}}),Object.defineProperty(e,"RequestType6",{enumerable:!0,get:function(){return n.RequestType6}}),Object.defineProperty(e,"RequestType7",{enumerable:!0,get:function(){return n.RequestType7}}),Object.defineProperty(e,"RequestType8",{enumerable:!0,get:function(){return n.RequestType8}}),Object.defineProperty(e,"RequestType9",{enumerable:!0,get:function(){return n.RequestType9}}),Object.defineProperty(e,"ResponseError",{enumerable:!0,get:function(){return n.ResponseError}}),Object.defineProperty(e,"ErrorCodes",{enumerable:!0,get:function(){return n.ErrorCodes}}),Object.defineProperty(e,"NotificationType",{enumerable:!0,get:function(){return n.NotificationType}}),Object.defineProperty(e,"NotificationType0",{enumerable:!0,get:function(){return n.NotificationType0}}),Object.defineProperty(e,"NotificationType1",{enumerable:!0,get:function(){return n.NotificationType1}}),Object.defineProperty(e,"NotificationType2",{enumerable:!0,get:function(){return n.NotificationType2}}),Object.defineProperty(e,"NotificationType3",{enumerable:!0,get:function(){return n.NotificationType3}}),Object.defineProperty(e,"NotificationType4",{enumerable:!0,get:function(){return n.NotificationType4}}),Object.defineProperty(e,"NotificationType5",{enumerable:!0,get:function(){return n.NotificationType5}}),Object.defineProperty(e,"NotificationType6",{enumerable:!0,get:function(){return n.NotificationType6}}),Object.defineProperty(e,"NotificationType7",{enumerable:!0,get:function(){return n.NotificationType7}}),Object.defineProperty(e,"NotificationType8",{enumerable:!0,get:function(){return n.NotificationType8}}),Object.defineProperty(e,"NotificationType9",{enumerable:!0,get:function(){return n.NotificationType9}}),Object.defineProperty(e,"ParameterStructures",{enumerable:!0,get:function(){return n.ParameterStructures}});const t=W7();Object.defineProperty(e,"LinkedMap",{enumerable:!0,get:function(){return t.LinkedMap}}),Object.defineProperty(e,"LRUCache",{enumerable:!0,get:function(){return t.LRUCache}}),Object.defineProperty(e,"Touch",{enumerable:!0,get:function(){return t.Touch}});const i=CU();Object.defineProperty(e,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const a=Km();Object.defineProperty(e,"Event",{enumerable:!0,get:function(){return a.Event}}),Object.defineProperty(e,"Emitter",{enumerable:!0,get:function(){return a.Emitter}});const o=bP();Object.defineProperty(e,"CancellationTokenSource",{enumerable:!0,get:function(){return o.CancellationTokenSource}}),Object.defineProperty(e,"CancellationToken",{enumerable:!0,get:function(){return o.CancellationToken}});const s=PU();Object.defineProperty(e,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(e,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const r=RU();Object.defineProperty(e,"MessageReader",{enumerable:!0,get:function(){return r.MessageReader}}),Object.defineProperty(e,"AbstractMessageReader",{enumerable:!0,get:function(){return r.AbstractMessageReader}}),Object.defineProperty(e,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return r.ReadableStreamMessageReader}});const d=MU();Object.defineProperty(e,"MessageWriter",{enumerable:!0,get:function(){return d.MessageWriter}}),Object.defineProperty(e,"AbstractMessageWriter",{enumerable:!0,get:function(){return d.AbstractMessageWriter}}),Object.defineProperty(e,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return d.WriteableStreamMessageWriter}});const l=AU();Object.defineProperty(e,"AbstractMessageBuffer",{enumerable:!0,get:function(){return l.AbstractMessageBuffer}});const c=wU();Object.defineProperty(e,"ConnectionStrategy",{enumerable:!0,get:function(){return c.ConnectionStrategy}}),Object.defineProperty(e,"ConnectionOptions",{enumerable:!0,get:function(){return c.ConnectionOptions}}),Object.defineProperty(e,"NullLogger",{enumerable:!0,get:function(){return c.NullLogger}}),Object.defineProperty(e,"createMessageConnection",{enumerable:!0,get:function(){return c.createMessageConnection}}),Object.defineProperty(e,"ProgressToken",{enumerable:!0,get:function(){return c.ProgressToken}}),Object.defineProperty(e,"ProgressType",{enumerable:!0,get:function(){return c.ProgressType}}),Object.defineProperty(e,"Trace",{enumerable:!0,get:function(){return c.Trace}}),Object.defineProperty(e,"TraceValues",{enumerable:!0,get:function(){return c.TraceValues}}),Object.defineProperty(e,"TraceFormat",{enumerable:!0,get:function(){return c.TraceFormat}}),Object.defineProperty(e,"SetTraceNotification",{enumerable:!0,get:function(){return c.SetTraceNotification}}),Object.defineProperty(e,"LogTraceNotification",{enumerable:!0,get:function(){return c.LogTraceNotification}}),Object.defineProperty(e,"ConnectionErrors",{enumerable:!0,get:function(){return c.ConnectionErrors}}),Object.defineProperty(e,"ConnectionError",{enumerable:!0,get:function(){return c.ConnectionError}}),Object.defineProperty(e,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return c.CancellationReceiverStrategy}}),Object.defineProperty(e,"CancellationSenderStrategy",{enumerable:!0,get:function(){return c.CancellationSenderStrategy}}),Object.defineProperty(e,"CancellationStrategy",{enumerable:!0,get:function(){return c.CancellationStrategy}}),Object.defineProperty(e,"MessageStrategy",{enumerable:!0,get:function(){return c.MessageStrategy}});const u=rf();e.RAL=u.default}(zb)),zb}var D3;function IU(){if(D3)return Y1;D3=1,Object.defineProperty(Y1,"__esModule",{value:!0});const e=BS();class n extends e.AbstractMessageBuffer{constructor(d="utf-8"){super(d),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return n.emptyBuffer}fromString(d,l){return new TextEncoder().encode(d)}toString(d,l){return l==="ascii"?this.asciiDecoder.decode(d):new TextDecoder(l).decode(d)}asNative(d,l){return l===void 0?d:d.slice(0,l)}allocNative(d){return new Uint8Array(d)}}n.emptyBuffer=new Uint8Array(0);class t{constructor(d){this.socket=d,this._onData=new e.Emitter,this._messageListener=l=>{l.data.arrayBuffer().then(u=>{this._onData.fire(new Uint8Array(u))},()=>{(0,e.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(d){return this.socket.addEventListener("close",d),e.Disposable.create(()=>this.socket.removeEventListener("close",d))}onError(d){return this.socket.addEventListener("error",d),e.Disposable.create(()=>this.socket.removeEventListener("error",d))}onEnd(d){return this.socket.addEventListener("end",d),e.Disposable.create(()=>this.socket.removeEventListener("end",d))}onData(d){return this._onData.event(d)}}class i{constructor(d){this.socket=d}onClose(d){return this.socket.addEventListener("close",d),e.Disposable.create(()=>this.socket.removeEventListener("close",d))}onError(d){return this.socket.addEventListener("error",d),e.Disposable.create(()=>this.socket.removeEventListener("error",d))}onEnd(d){return this.socket.addEventListener("end",d),e.Disposable.create(()=>this.socket.removeEventListener("end",d))}write(d,l){if(typeof d=="string"){if(l!==void 0&&l!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${l}`);this.socket.send(d)}else this.socket.send(d);return Promise.resolve()}end(){this.socket.close()}}const a=new TextEncoder,o=Object.freeze({messageBuffer:Object.freeze({create:r=>new n(r)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(r,d)=>{if(d.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${d.charset}`);return Promise.resolve(a.encode(JSON.stringify(r,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(r,d)=>{if(!(r instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(d.charset).decode(r)))}})}),stream:Object.freeze({asReadableStream:r=>new t(r),asWritableStream:r=>new i(r)}),console,timer:Object.freeze({setTimeout(r,d,...l){const c=setTimeout(r,d,...l);return{dispose:()=>clearTimeout(c)}},setImmediate(r,...d){const l=setTimeout(r,0,...d);return{dispose:()=>clearTimeout(l)}},setInterval(r,d,...l){const c=setInterval(r,d,...l);return{dispose:()=>clearInterval(c)}}})});function s(){return o}return function(r){function d(){e.RAL.install(o)}r.install=d}(s||(s={})),Y1.default=s,Y1}var O3;function qm(){return O3||(O3=1,function(e){var n=Fl&&Fl.__createBinding||(Object.create?function(d,l,c,u){u===void 0&&(u=c);var f=Object.getOwnPropertyDescriptor(l,c);(!f||("get"in f?!l.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return l[c]}}),Object.defineProperty(d,u,f)}:function(d,l,c,u){u===void 0&&(u=c),d[u]=l[c]}),t=Fl&&Fl.__exportStar||function(d,l){for(var c in d)c!=="default"&&!Object.prototype.hasOwnProperty.call(l,c)&&n(l,d,c)};Object.defineProperty(e,"__esModule",{value:!0}),e.createMessageConnection=e.BrowserMessageWriter=e.BrowserMessageReader=void 0,IU().default.install();const a=BS();t(BS(),e);class o extends a.AbstractMessageReader{constructor(l){super(),this._onData=new a.Emitter,this._messageListener=c=>{this._onData.fire(c.data)},l.addEventListener("error",c=>this.fireError(c)),l.onmessage=this._messageListener}listen(l){return this._onData.event(l)}}e.BrowserMessageReader=o;class s extends a.AbstractMessageWriter{constructor(l){super(),this.port=l,this.errorCount=0,l.addEventListener("error",c=>this.fireError(c))}write(l){try{return this.port.postMessage(l),Promise.resolve()}catch(c){return this.handleError(c,l),Promise.reject(c)}}handleError(l,c){this.errorCount++,this.fireError(l,c,this.errorCount)}end(){}}e.BrowserMessageWriter=s;function r(d,l,c,u){return c===void 0&&(c=a.NullLogger),a.ConnectionStrategy.is(u)&&(u={connectionStrategy:u}),(0,a.createMessageConnection)(d,l,c,u)}e.createMessageConnection=r}(Fl)),Fl}var L3;function SP(){if(L3)return xl;L3=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.Emitter=xl.Event=void 0;const e=qm();var n;(function(i){function a(s,r,d,l){const c=s(u=>{r(u),c.dispose()},d,l);return c}i.once=a;function o(s,r){return new Promise(d=>{const l=s(c=>{(!r||r(c))&&(d(c),l.dispose())})})}i.waitUntil=o})(n||(xl.Event=n={}));class t extends e.Emitter{constructor(a={}){super(a)}get event(){return super.event}fire(a){super.fire(a)}}return xl.Emitter=t,xl}var Pc={},$b={},bp={},j3;function TU(){return j3||(j3=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.default=void 0,bp.default="ffffffff-ffff-ffff-ffff-ffffffffffff"),bp}var Sp={},N3;function DU(){return N3||(N3=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.default=void 0,Sp.default="00000000-0000-0000-0000-000000000000"),Sp}var Ep={},Cp={},Pp={},B3;function OU(){return B3||(B3=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.default=void 0,Pp.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i),Pp}var x3;function R_(){if(x3)return Cp;x3=1,Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.default=void 0;var e=n(OU());function n(i){return i&&i.__esModule?i:{default:i}}function t(i){return typeof i=="string"&&e.default.test(i)}return Cp.default=t,Cp}var F3;function M_(){if(F3)return Ep;F3=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.default=void 0;var e=n(R_());function n(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,e.default)(i))throw TypeError("Invalid UUID");var a,o=new Uint8Array(16);return o[0]=(a=parseInt(i.slice(0,8),16))>>>24,o[1]=a>>>16&255,o[2]=a>>>8&255,o[3]=a&255,o[4]=(a=parseInt(i.slice(9,13),16))>>>8,o[5]=a&255,o[6]=(a=parseInt(i.slice(14,18),16))>>>8,o[7]=a&255,o[8]=(a=parseInt(i.slice(19,23),16))>>>8,o[9]=a&255,o[10]=(a=parseInt(i.slice(24,36),16))/1099511627776&255,o[11]=a/4294967296&255,o[12]=a>>>24&255,o[13]=a>>>16&255,o[14]=a>>>8&255,o[15]=a&255,o}return Ep.default=t,Ep}var If={},k3;function al(){if(k3)return If;k3=1,Object.defineProperty(If,"__esModule",{value:!0}),If.default=void 0,If.unsafeStringify=a;var e=n(R_());function n(s){return s&&s.__esModule?s:{default:s}}for(var t=[],i=0;i<256;++i)t.push((i+256).toString(16).slice(1));function a(s,r=0){return(t[s[r+0]]+t[s[r+1]]+t[s[r+2]]+t[s[r+3]]+"-"+t[s[r+4]]+t[s[r+5]]+"-"+t[s[r+6]]+t[s[r+7]]+"-"+t[s[r+8]]+t[s[r+9]]+"-"+t[s[r+10]]+t[s[r+11]]+t[s[r+12]]+t[s[r+13]]+t[s[r+14]]+t[s[r+15]]).toLowerCase()}function o(s,r=0){var d=a(s,r);if(!(0,e.default)(d))throw TypeError("Stringified UUID is invalid");return d}return If.default=o,If}var Rp={},Z1={},K3;function EP(){if(K3)return Z1;K3=1,Object.defineProperty(Z1,"__esModule",{value:!0}),Z1.default=t;var e,n=new Uint8Array(16);function t(){if(!e&&(e=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!e))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}return Z1}var q3;function Q7(){if(q3)return Rp;q3=1,Object.defineProperty(Rp,"__esModule",{value:!0}),Rp.default=void 0;var e=t(EP()),n=al();function t(d){return d&&d.__esModule?d:{default:d}}var i,a,o=0,s=0;function r(d,l,c){var u=l&&c||0,f=l||new Array(16);d=d||{};var h=d.node,p=d.clockseq;if(d._v6||(h||(h=i),p==null&&(p=a)),h==null||p==null){var g=d.random||(d.rng||e.default)();h==null&&(h=[g[0],g[1],g[2],g[3],g[4],g[5]],!i&&!d._v6&&(h[0]|=1,i=h)),p==null&&(p=(g[6]<<8|g[7])&16383,a===void 0&&!d._v6&&(a=p))}var m=d.msecs!==void 0?d.msecs:Date.now(),v=d.nsecs!==void 0?d.nsecs:s+1,_=m-o+(v-s)/1e4;if(_<0&&d.clockseq===void 0&&(p=p+1&16383),(_<0||m>o)&&d.nsecs===void 0&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=m,s=v,a=p,m+=122192928e5;var S=((m&268435455)*1e4+v)%4294967296;f[u++]=S>>>24&255,f[u++]=S>>>16&255,f[u++]=S>>>8&255,f[u++]=S&255;var E=m/4294967296*1e4&268435455;f[u++]=E>>>8&255,f[u++]=E&255,f[u++]=E>>>24&15|16,f[u++]=E>>>16&255,f[u++]=p>>>8|128,f[u++]=p&255;for(var C=0;C<6;++C)f[u+C]=h[C];return l||(0,n.unsafeStringify)(f)}return Rp.default=r,Rp}var Q1={},H3;function J7(){if(H3)return Q1;H3=1,Object.defineProperty(Q1,"__esModule",{value:!0}),Q1.default=i;var e=t(M_()),n=al();function t(o){return o&&o.__esModule?o:{default:o}}function i(o){var s=typeof o=="string"?(0,e.default)(o):o,r=a(s);return typeof o=="string"?(0,n.unsafeStringify)(r):r}function a(o,s=!1){return Uint8Array.of((o[6]&15)<<4|o[7]>>4&15,(o[7]&15)<<4|(o[4]&240)>>4,(o[4]&15)<<4|(o[5]&240)>>4,(o[5]&15)<<4|(o[0]&240)>>4,(o[0]&15)<<4|(o[1]&240)>>4,(o[1]&15)<<4|(o[2]&240)>>4,96|o[2]&15,o[3],o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])}return Q1}var Mp={},Iu={},V3;function X7(){if(V3)return Iu;V3=1,Object.defineProperty(Iu,"__esModule",{value:!0}),Iu.URL=Iu.DNS=void 0,Iu.default=s;var e=al(),n=t(M_());function t(r){return r&&r.__esModule?r:{default:r}}function i(r){r=unescape(encodeURIComponent(r));for(var d=[],l=0;l<r.length;++l)d.push(r.charCodeAt(l));return d}var a=Iu.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",o=Iu.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function s(r,d,l){function c(u,f,h,p){var g;if(typeof u=="string"&&(u=i(u)),typeof f=="string"&&(f=(0,n.default)(f)),((g=f)===null||g===void 0?void 0:g.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var m=new Uint8Array(16+u.length);if(m.set(f),m.set(u,f.length),m=l(m),m[6]=m[6]&15|d,m[8]=m[8]&63|128,h){p=p||0;for(var v=0;v<16;++v)h[p+v]=m[v];return h}return(0,e.unsafeStringify)(m)}try{c.name=r}catch{}return c.DNS=a,c.URL=o,c}return Iu}var Ap={},G3;function LU(){if(G3)return Ap;G3=1,Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.default=void 0;function e(f){if(typeof f=="string"){var h=unescape(encodeURIComponent(f));f=new Uint8Array(h.length);for(var p=0;p<h.length;++p)f[p]=h.charCodeAt(p)}return n(i(a(f),f.length*8))}function n(f){for(var h=[],p=f.length*32,g="0123456789abcdef",m=0;m<p;m+=8){var v=f[m>>5]>>>m%32&255,_=parseInt(g.charAt(v>>>4&15)+g.charAt(v&15),16);h.push(_)}return h}function t(f){return(f+64>>>9<<4)+14+1}function i(f,h){f[h>>5]|=128<<h%32,f[t(h)-1]=h;for(var p=1732584193,g=-271733879,m=-1732584194,v=271733878,_=0;_<f.length;_+=16){var S=p,E=g,C=m,M=v;p=d(p,g,m,v,f[_],7,-680876936),v=d(v,p,g,m,f[_+1],12,-389564586),m=d(m,v,p,g,f[_+2],17,606105819),g=d(g,m,v,p,f[_+3],22,-1044525330),p=d(p,g,m,v,f[_+4],7,-176418897),v=d(v,p,g,m,f[_+5],12,1200080426),m=d(m,v,p,g,f[_+6],17,-1473231341),g=d(g,m,v,p,f[_+7],22,-45705983),p=d(p,g,m,v,f[_+8],7,1770035416),v=d(v,p,g,m,f[_+9],12,-1958414417),m=d(m,v,p,g,f[_+10],17,-42063),g=d(g,m,v,p,f[_+11],22,-1990404162),p=d(p,g,m,v,f[_+12],7,1804603682),v=d(v,p,g,m,f[_+13],12,-40341101),m=d(m,v,p,g,f[_+14],17,-1502002290),g=d(g,m,v,p,f[_+15],22,1236535329),p=l(p,g,m,v,f[_+1],5,-165796510),v=l(v,p,g,m,f[_+6],9,-1069501632),m=l(m,v,p,g,f[_+11],14,643717713),g=l(g,m,v,p,f[_],20,-373897302),p=l(p,g,m,v,f[_+5],5,-701558691),v=l(v,p,g,m,f[_+10],9,38016083),m=l(m,v,p,g,f[_+15],14,-660478335),g=l(g,m,v,p,f[_+4],20,-405537848),p=l(p,g,m,v,f[_+9],5,568446438),v=l(v,p,g,m,f[_+14],9,-1019803690),m=l(m,v,p,g,f[_+3],14,-187363961),g=l(g,m,v,p,f[_+8],20,1163531501),p=l(p,g,m,v,f[_+13],5,-1444681467),v=l(v,p,g,m,f[_+2],9,-51403784),m=l(m,v,p,g,f[_+7],14,1735328473),g=l(g,m,v,p,f[_+12],20,-1926607734),p=c(p,g,m,v,f[_+5],4,-378558),v=c(v,p,g,m,f[_+8],11,-2022574463),m=c(m,v,p,g,f[_+11],16,1839030562),g=c(g,m,v,p,f[_+14],23,-35309556),p=c(p,g,m,v,f[_+1],4,-1530992060),v=c(v,p,g,m,f[_+4],11,1272893353),m=c(m,v,p,g,f[_+7],16,-155497632),g=c(g,m,v,p,f[_+10],23,-1094730640),p=c(p,g,m,v,f[_+13],4,681279174),v=c(v,p,g,m,f[_],11,-358537222),m=c(m,v,p,g,f[_+3],16,-722521979),g=c(g,m,v,p,f[_+6],23,76029189),p=c(p,g,m,v,f[_+9],4,-640364487),v=c(v,p,g,m,f[_+12],11,-421815835),m=c(m,v,p,g,f[_+15],16,530742520),g=c(g,m,v,p,f[_+2],23,-995338651),p=u(p,g,m,v,f[_],6,-198630844),v=u(v,p,g,m,f[_+7],10,1126891415),m=u(m,v,p,g,f[_+14],15,-1416354905),g=u(g,m,v,p,f[_+5],21,-57434055),p=u(p,g,m,v,f[_+12],6,1700485571),v=u(v,p,g,m,f[_+3],10,-1894986606),m=u(m,v,p,g,f[_+10],15,-1051523),g=u(g,m,v,p,f[_+1],21,-2054922799),p=u(p,g,m,v,f[_+8],6,1873313359),v=u(v,p,g,m,f[_+15],10,-30611744),m=u(m,v,p,g,f[_+6],15,-1560198380),g=u(g,m,v,p,f[_+13],21,1309151649),p=u(p,g,m,v,f[_+4],6,-145523070),v=u(v,p,g,m,f[_+11],10,-1120210379),m=u(m,v,p,g,f[_+2],15,718787259),g=u(g,m,v,p,f[_+9],21,-343485551),p=o(p,S),g=o(g,E),m=o(m,C),v=o(v,M)}return[p,g,m,v]}function a(f){if(f.length===0)return[];for(var h=f.length*8,p=new Uint32Array(t(h)),g=0;g<h;g+=8)p[g>>5]|=(f[g/8]&255)<<g%32;return p}function o(f,h){var p=(f&65535)+(h&65535),g=(f>>16)+(h>>16)+(p>>16);return g<<16|p&65535}function s(f,h){return f<<h|f>>>32-h}function r(f,h,p,g,m,v){return o(s(o(o(h,f),o(g,v)),m),p)}function d(f,h,p,g,m,v,_){return r(h&p|~h&g,f,h,m,v,_)}function l(f,h,p,g,m,v,_){return r(h&g|p&~g,f,h,m,v,_)}function c(f,h,p,g,m,v,_){return r(h^p^g,f,h,m,v,_)}function u(f,h,p,g,m,v,_){return r(p^(h|~g),f,h,m,v,_)}return Ap.default=e,Ap}var z3;function jU(){if(z3)return Mp;z3=1,Object.defineProperty(Mp,"__esModule",{value:!0}),Mp.default=void 0;var e=t(X7()),n=t(LU());function t(a){return a&&a.__esModule?a:{default:a}}var i=(0,e.default)("v3",48,n.default);return Mp.default=i,Mp}var wp={},Ip={},U3;function NU(){if(U3)return Ip;U3=1,Object.defineProperty(Ip,"__esModule",{value:!0}),Ip.default=void 0;var e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);return Ip.default={randomUUID:e},Ip}var $3;function BU(){if($3)return wp;$3=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.default=void 0;var e=i(NU()),n=i(EP()),t=al();function i(o){return o&&o.__esModule?o:{default:o}}function a(o,s,r){if(e.default.randomUUID&&!s&&!o)return e.default.randomUUID();o=o||{};var d=o.random||(o.rng||n.default)();if(d[6]=d[6]&15|64,d[8]=d[8]&63|128,s){r=r||0;for(var l=0;l<16;++l)s[r+l]=d[l];return s}return(0,t.unsafeStringify)(d)}return wp.default=a,wp}var Tp={},Dp={},Y3;function xU(){if(Y3)return Dp;Y3=1,Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.default=void 0;function e(i,a,o,s){switch(i){case 0:return a&o^~a&s;case 1:return a^o^s;case 2:return a&o^a&s^o&s;case 3:return a^o^s}}function n(i,a){return i<<a|i>>>32-a}function t(i){var a=[1518500249,1859775393,2400959708,3395469782],o=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof i=="string"){var s=unescape(encodeURIComponent(i));i=[];for(var r=0;r<s.length;++r)i.push(s.charCodeAt(r))}else Array.isArray(i)||(i=Array.prototype.slice.call(i));i.push(128);for(var d=i.length/4+2,l=Math.ceil(d/16),c=new Array(l),u=0;u<l;++u){for(var f=new Uint32Array(16),h=0;h<16;++h)f[h]=i[u*64+h*4]<<24|i[u*64+h*4+1]<<16|i[u*64+h*4+2]<<8|i[u*64+h*4+3];c[u]=f}c[l-1][14]=(i.length-1)*8/Math.pow(2,32),c[l-1][14]=Math.floor(c[l-1][14]),c[l-1][15]=(i.length-1)*8&4294967295;for(var p=0;p<l;++p){for(var g=new Uint32Array(80),m=0;m<16;++m)g[m]=c[p][m];for(var v=16;v<80;++v)g[v]=n(g[v-3]^g[v-8]^g[v-14]^g[v-16],1);for(var _=o[0],S=o[1],E=o[2],C=o[3],M=o[4],L=0;L<80;++L){var I=Math.floor(L/20),R=n(_,5)+e(I,S,E,C)+M+a[I]+g[L]>>>0;M=C,C=E,E=n(S,30)>>>0,S=_,_=R}o[0]=o[0]+_>>>0,o[1]=o[1]+S>>>0,o[2]=o[2]+E>>>0,o[3]=o[3]+C>>>0,o[4]=o[4]+M>>>0}return[o[0]>>24&255,o[0]>>16&255,o[0]>>8&255,o[0]&255,o[1]>>24&255,o[1]>>16&255,o[1]>>8&255,o[1]&255,o[2]>>24&255,o[2]>>16&255,o[2]>>8&255,o[2]&255,o[3]>>24&255,o[3]>>16&255,o[3]>>8&255,o[3]&255,o[4]>>24&255,o[4]>>16&255,o[4]>>8&255,o[4]&255]}return Dp.default=t,Dp}var W3;function FU(){if(W3)return Tp;W3=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.default=void 0;var e=t(X7()),n=t(xU());function t(a){return a&&a.__esModule?a:{default:a}}var i=(0,e.default)("v5",80,n.default);return Tp.default=i,Tp}var J1={},Z3;function kU(){if(Z3)return J1;Z3=1,Object.defineProperty(J1,"__esModule",{value:!0}),J1.default=l;var e=al(),n=i(Q7()),t=i(J7());function i(c){return c&&c.__esModule?c:{default:c}}function a(c,u){var f=Object.keys(c);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(c);u&&(h=h.filter(function(p){return Object.getOwnPropertyDescriptor(c,p).enumerable})),f.push.apply(f,h)}return f}function o(c){for(var u=1;u<arguments.length;u++){var f=arguments[u]!=null?arguments[u]:{};u%2?a(Object(f),!0).forEach(function(h){s(c,h,f[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(c,Object.getOwnPropertyDescriptors(f)):a(Object(f)).forEach(function(h){Object.defineProperty(c,h,Object.getOwnPropertyDescriptor(f,h))})}return c}function s(c,u,f){return(u=r(u))in c?Object.defineProperty(c,u,{value:f,enumerable:!0,configurable:!0,writable:!0}):c[u]=f,c}function r(c){var u=d(c,"string");return typeof u=="symbol"?u:u+""}function d(c,u){if(typeof c!="object"||!c)return c;var f=c[Symbol.toPrimitive];if(f!==void 0){var h=f.call(c,u);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(u==="string"?String:Number)(c)}function l(c={},u,f=0){var h=(0,n.default)(o(o({},c),{},{_v6:!0}),new Uint8Array(16));if(h=(0,t.default)(h),u){for(var p=0;p<16;p++)u[f+p]=h[p];return u}return(0,e.unsafeStringify)(h)}return J1}var X1={},Q3;function KU(){if(Q3)return X1;Q3=1,Object.defineProperty(X1,"__esModule",{value:!0}),X1.default=i;var e=t(M_()),n=al();function t(o){return o&&o.__esModule?o:{default:o}}function i(o){var s=typeof o=="string"?(0,e.default)(o):o,r=a(s);return typeof o=="string"?(0,n.unsafeStringify)(r):r}function a(o){return Uint8Array.of((o[3]&15)<<4|o[4]>>4&15,(o[4]&15)<<4|(o[5]&240)>>4,(o[5]&15)<<4|o[6]&15,o[7],(o[1]&15)<<4|(o[2]&240)>>4,(o[2]&15)<<4|(o[3]&240)>>4,16|(o[0]&240)>>4,(o[0]&15)<<4|(o[1]&240)>>4,o[8],o[9],o[10],o[11],o[12],o[13],o[14],o[15])}return X1}var Op={},J3;function qU(){if(J3)return Op;J3=1,Object.defineProperty(Op,"__esModule",{value:!0}),Op.default=void 0;var e=t(EP()),n=al();function t(r){return r&&r.__esModule?r:{default:r}}var i=null,a=null,o=0;function s(r,d,l){r=r||{};var c=d&&l||0,u=d||new Uint8Array(16),f=r.random||(r.rng||e.default)(),h=r.msecs!==void 0?r.msecs:Date.now(),p=r.seq!==void 0?r.seq:null,g=a,m=i;return h>o&&r.msecs===void 0&&(o=h,p!==null&&(g=null,m=null)),p!==null&&(p>2147483647&&(p=2147483647),g=p>>>19&4095,m=p&524287),(g===null||m===null)&&(g=f[6]&127,g=g<<8|f[7],m=f[8]&63,m=m<<8|f[9],m=m<<5|f[10]>>>3),h+1e4>o&&p===null?++m>524287&&(m=0,++g>4095&&(g=0,o++)):o=h,a=g,i=m,u[c++]=o/1099511627776&255,u[c++]=o/4294967296&255,u[c++]=o/16777216&255,u[c++]=o/65536&255,u[c++]=o/256&255,u[c++]=o&255,u[c++]=g>>>4&15|112,u[c++]=g&255,u[c++]=m>>>13&63|128,u[c++]=m>>>5&255,u[c++]=m<<3&255|f[10]&7,u[c++]=f[11],u[c++]=f[12],u[c++]=f[13],u[c++]=f[14],u[c++]=f[15],d||(0,n.unsafeStringify)(u)}return Op.default=s,Op}var Lp={},X3;function HU(){if(X3)return Lp;X3=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.default=void 0;var e=n(R_());function n(i){return i&&i.__esModule?i:{default:i}}function t(i){if(!(0,e.default)(i))throw TypeError("Invalid UUID");return parseInt(i.slice(14,15),16)}return Lp.default=t,Lp}var eL;function Hm(){return eL||(eL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"MAX",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"NIL",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"parse",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"v1ToV6",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"v6",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"v6ToV1",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(e,"v7",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return p.default}});var n=g(TU()),t=g(DU()),i=g(M_()),a=g(al()),o=g(Q7()),s=g(J7()),r=g(jU()),d=g(BU()),l=g(FU()),c=g(kU()),u=g(KU()),f=g(qU()),h=g(R_()),p=g(HU());function g(m){return m&&m.__esModule?m:{default:m}}}($b)),$b}var tL;function A_(){if(tL)return Pc;tL=1,Object.defineProperty(Pc,"__esModule",{value:!0}),Pc.GLSPClient=Pc.ClientState=Pc.ApplicationIdProvider=void 0;const e=Hm(),n=vt();class t{static get(){return t._applicationId||(t._applicationId=e.v4()),t._applicationId}}Pc.ApplicationIdProvider=t;var i;(function(o){o[o.Initial=0]="Initial",o[o.Starting=1]="Starting",o[o.StartFailed=2]="StartFailed",o[o.Running=3]="Running",o[o.Stopping=4]="Stopping",o[o.Stopped=5]="Stopped",o[o.ServerError=6]="ServerError"})(i||(Pc.ClientState=i={}));var a;return function(o){function s(r){return n.AnyObject.is(r)&&(0,n.hasStringProp)(r,"id")}o.isOptions=s,o.protocolVersion="1.0.0"}(a||(Pc.GLSPClient=a={})),Pc}var jp={},nL;function CP(){if(nL)return jp;nL=1,Object.defineProperty(jp,"__esModule",{value:!0}),jp.JsonrpcGLSPClient=void 0;const e=qm(),n=A_();var t;return function(i){function a(s){return n.GLSPClient.isOptions(s)&&"connectionProvider"in s}i.isOptions=a,i.ActionMessageNotification=new e.NotificationType("process"),i.InitializeRequest=new e.RequestType("initialize"),i.InitializeClientSessionRequest=new e.RequestType("initializeClientSession"),i.DisposeClientSessionRequest=new e.RequestType("disposeClientSession"),i.ShutdownNotification=new e.NotificationType0("shutdown"),i.ClientNotReadyMsg="JsonrpcGLSPClient is not ready yet";function o(s,...r){console.error(`[JsonrpcGLSPClient] ${s}`,r)}i.error=o}(t||(jp.JsonrpcGLSPClient=t={})),jp}var iL;function e9(){if(iL)return Bl;iL=1,Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.JsonrpcClientProxy=Bl.BaseJsonrpcGLSPClient=void 0;const e=Yr(),n=SP(),t=A_(),i=CP();class a{get onServerInitialized(){return this.onServerInitializedEmitter.event}get onActionMessageNotification(){return this.onActionMessageNotificationEmitter.event}get onCurrentStateChanged(){return this.onCurrentStateChangedEmitter.event}set state(r){this._state!==r&&(this._state=r,this.onCurrentStateChangedEmitter.fire(r))}get state(){return this._state}get initializeResult(){return this._initializeResult}constructor(r){this.onServerInitializedEmitter=new n.Emitter,this.onActionMessageNotificationEmitter=new n.Emitter,this.onCurrentStateChangedEmitter=new n.Emitter,this.connectionProvider=r.connectionProvider,this.state=t.ClientState.Initial}async start(){if(!(this.state===t.ClientState.Running||this.state===t.ClientState.StartFailed)){if(this.state===t.ClientState.Starting){await n.Event.waitUntil(this.onCurrentStateChanged,r=>r===t.ClientState.Running||r===t.ClientState.StartFailed);return}try{this.state=t.ClientState.Starting;const r=await this.resolveConnection();r.listen(),this.resolvedConnection=r,this.state=t.ClientState.Running}catch(r){i.JsonrpcGLSPClient.error("Failed to start connection to server",r),this.state=t.ClientState.StartFailed}}}async initializeServer(r){if(this.initializeResult)return this.initializeResult;if(this.pendingServerInitialize)return this.pendingServerInitialize;const d=new e.Deferred;try{this.pendingServerInitialize=d.promise,this._initializeResult=await this.checkedConnection.sendRequest(i.JsonrpcGLSPClient.InitializeRequest,r),this.onServerInitializedEmitter.fire(this._initializeResult),d.resolve(this._initializeResult),this.pendingServerInitialize=void 0}catch(l){d.reject(l),this._initializeResult=void 0,this.pendingServerInitialize=void 0}return d.promise}initializeClientSession(r){return this.checkedConnection.sendRequest(i.JsonrpcGLSPClient.InitializeClientSessionRequest,r)}disposeClientSession(r){return this.checkedConnection.sendRequest(i.JsonrpcGLSPClient.DisposeClientSessionRequest,r)}onActionMessage(r,d){return this.onActionMessageNotification(l=>{(!d||l.clientId===d)&&r(l)})}sendActionMessage(r){this.checkedConnection.sendNotification(i.JsonrpcGLSPClient.ActionMessageNotification,r)}shutdownServer(){this.checkedConnection.sendNotification(i.JsonrpcGLSPClient.ShutdownNotification)}stop(){return this.connectionPromise?this.state===t.ClientState.Stopping&&this.onStop?this.onStop:(this.state=t.ClientState.Stopping,this.onStop=this.resolveConnection().then(r=>{r.dispose(),this.state=t.ClientState.Stopped,this.onStop=void 0,this.onActionMessageNotificationEmitter.dispose(),this.onCurrentStateChangedEmitter.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0})):(this.state=t.ClientState.Stopped,Promise.resolve())}get checkedConnection(){if(!this.isConnectionActive())throw new Error(i.JsonrpcGLSPClient.ClientNotReadyMsg);return this.resolvedConnection}resolveConnection(){return this.connectionPromise||(this.connectionPromise=this.doCreateConnection()),this.connectionPromise}async doCreateConnection(){const r=typeof this.connectionProvider=="function"?await this.connectionProvider():this.connectionProvider;return r.onError(d=>this.handleConnectionError(d[0],d[1],d[2])),r.onClose(()=>this.handleConnectionClosed()),r.onNotification(i.JsonrpcGLSPClient.ActionMessageNotification,d=>this.onActionMessageNotificationEmitter.fire(d)),r}handleConnectionError(r,d,l){i.JsonrpcGLSPClient.error("Connection to server is erroring. Shutting down server.",r),this.stop(),this.state=t.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===t.ClientState.Stopping||this.state===t.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}i.JsonrpcGLSPClient.error("Connection to server got closed. Server will not be restarted."),this.state=t.ClientState.ServerError}}isConnectionActive(){return this.state===t.ClientState.Running&&!!this.resolvedConnection}get currentState(){return this.state}}Bl.BaseJsonrpcGLSPClient=a;class o{initialize(r,d=!1){this.clientConnection=r,this.enableLogging=d}process(r){var d;this.enableLogging&&console.log(`Send action '${r.action.kind}' to client '${r.clientId}'`),(d=this.clientConnection)===null||d===void 0||d.sendNotification(i.JsonrpcGLSPClient.ActionMessageNotification,r)}}return Bl.JsonrpcClientProxy=o,Bl}var rL;function VU(){if(rL)return Gb;rL=1,Object.defineProperty(Gb,"__esModule",{value:!0});const e=G(),n=e9();return(0,e.decorate)((0,e.injectable)(),n.JsonrpcClientProxy),Gb}var oL;function t9(){return oL||(oL=1,function(e){var n=jl&&jl.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=jl&&jl.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(bU(),e),t($7(),e),t(SU(),e),t(EU(),e),t(VU(),e)}(jl)),jl}var sL;function GU(){if(sL)return Rt;sL=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.sprottyDefaultModule=Rt.edgeJunctionModule=Rt.zorderModule=Rt.updateModule=Rt.openModule=Rt.moveModule=Rt.modelSourceModule=Rt.fadeModule=Rt.expandModule=Rt.edgeLayoutModule=Rt.edgeIntersectionModule=Rt.edgeEditModule=Rt.buttonModule=void 0;const e=t9(),n=BC();Rt.sprottyDefaultModule=n.default;const t=lP(),i=T7(),a=D7(),o=im(),s=WC(),r=dP(),d=fP(),l=hP(),c=pP(),u=gP(),f=mP(),h=vP();return Rt.buttonModule=new e.FeatureModule(t.default.registry,{featureId:Symbol("button")}),Rt.edgeEditModule=new e.FeatureModule(s.edgeEditModule.registry,{featureId:Symbol("edgeEdit")}),Rt.edgeIntersectionModule=new e.FeatureModule(i.default.registry,{featureId:Symbol("edgeIntersection")}),Rt.edgeLayoutModule=new e.FeatureModule(o.default.registry,{featureId:Symbol("edgeLayout")}),Rt.expandModule=new e.FeatureModule(r.default.registry,{featureId:Symbol("expand")}),Rt.fadeModule=new e.FeatureModule(d.default.registry,{featureId:Symbol("fade")}),Rt.modelSourceModule=new e.FeatureModule(h.default.registry,{featureId:Symbol("modelSource")}),Rt.moveModule=new e.FeatureModule(l.default.registry,{featureId:Symbol("move")}),Rt.openModule=new e.FeatureModule(c.default.registry,{featureId:Symbol("open")}),Rt.updateModule=new e.FeatureModule(u.default.registry,{featureId:Symbol("update")}),Rt.zorderModule=new e.FeatureModule(f.default.registry,{featureId:Symbol("zorder")}),Rt.edgeJunctionModule=new e.FeatureModule(a.default.registry,{featureId:Symbol("edgeJunction")}),Rt}var Hl={},Vl={},si={},aL;function Pn(){if(aL)return si;aL=1,Object.defineProperty(si,"__esModule",{value:!0}),si.CompoundOperation=si.Operation=si.RejectAction=si.ResponseAction=si.RequestAction=si.ActionMessage=si.Action=void 0;const e=lt(),n=vt();var t;(function(l){function c(f){return n.AnyObject.is(f)&&(0,n.hasStringProp)(f,"kind")}l.is=c;function u(f,h){return l.is(f)&&f.kind===h}l.hasKind=u})(t||(si.Action=t={}));var i;(function(l){function c(u,f){const h=f??t.is;return n.AnyObject.is(u)&&(0,n.hasStringProp)(u,"clientId")&&"action"in u&&h(u.action)}l.is=c})(i||(si.ActionMessage=i={}));var a;(function(l){function c(h){return t.is(h)&&(0,n.hasStringProp)(h,"requestId")}l.is=c;function u(h,p){return l.is(h)&&h.kind===p}l.hasKind=u;function f(){return e.generateRequestId()}l.generateRequestId=f})(a||(si.RequestAction=a={}));var o;(function(l){function c(f){return t.is(f)&&(0,n.hasStringProp)(f,"responseId")}l.is=c;function u(f){return l.is(f)&&f.responseId!==""}l.hasValidResponseId=u})(o||(si.ResponseAction=o={}));var s;(function(l){l.KIND="rejectRequest";function c(f){return t.hasKind(f,l.KIND)&&(0,n.hasStringProp)(f,"message")}l.is=c;function u(f,h={}){return{kind:l.KIND,responseId:"",message:f,...h}}l.create=u})(s||(si.RejectAction=s={}));var r;(function(l){function c(f){return t.is(f)&&"isOperation"in f&&f.isOperation===!0}l.is=c;function u(f,h){return l.is(f)&&f.kind===h}l.hasKind=u})(r||(si.Operation=r={}));var d;return function(l){l.KIND="compound";function c(f){return r.hasKind(f,l.KIND)&&(0,n.hasArrayProp)(f,"operationList")}l.is=c;function u(f,h={}){return{kind:l.KIND,isOperation:!0,operationList:f,...h}}l.create=u}(d||(si.CompoundOperation=d={})),si}var Nr={},cL;function zU(){if(cL)return Nr;cL=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.EndProgressAction=Nr.UpdateProgressAction=Nr.StartProgressAction=Nr.MessageAction=Nr.StatusAction=void 0;const e=vt(),n=Pn();var t;(function(r){r.KIND="status";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"severity")&&(0,e.hasStringProp)(c,"message")}r.is=d;function l(c,u={}){return{kind:r.KIND,severity:"INFO",message:c,...u}}r.create=l})(t||(Nr.StatusAction=t={}));var i;(function(r){r.KIND="message";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"message")&&(0,e.hasStringProp)(c,"severity")}r.is=d;function l(c,u={}){return{kind:r.KIND,message:c,severity:"INFO",...u}}r.create=l})(i||(Nr.MessageAction=i={}));var a;(function(r){r.KIND="startProgress";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"progressId")&&(0,e.hasStringProp)(c,"title")}r.is=d;function l(c){return{kind:r.KIND,...c}}r.create=l})(a||(Nr.StartProgressAction=a={}));var o;(function(r){r.KIND="updateProgress";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"progressId")}r.is=d;function l(c,u={}){return{kind:r.KIND,progressId:c,...u}}r.create=l})(o||(Nr.UpdateProgressAction=o={}));var s;return function(r){r.KIND="endProgress";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"progressId")}r.is=d;function l(c,u){return{kind:r.KIND,progressId:c,message:u}}r.create=l}(s||(Nr.EndProgressAction=s={})),Nr}var ms={},uL;function UU(){if(uL)return ms;uL=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.PasteOperation=ms.CutOperation=ms.SetClipboardDataAction=ms.RequestClipboardDataAction=void 0;const e=vt(),n=Pn();var t;(function(s){s.KIND="requestClipboardData";function r(l){return n.RequestAction.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"editorContext")}s.is=r;function d(l,c={}){return{kind:s.KIND,requestId:"",editorContext:l,...c}}s.create=d})(t||(ms.RequestClipboardDataAction=t={}));var i;(function(s){s.KIND="setClipboardData";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"clipboardData")}s.is=r;function d(l,c={}){return{kind:s.KIND,responseId:"",clipboardData:l,...c}}s.create=d})(i||(ms.SetClipboardDataAction=i={}));var a;(function(s){s.KIND="cut";function r(l){return n.Operation.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"editorContext")}s.is=r;function d(l,c={}){return{kind:s.KIND,isOperation:!0,editorContext:l,...c}}s.create=d})(a||(ms.CutOperation=a={}));var o;return function(s){s.KIND="paste";function r(l){return n.Operation.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"clipboardData")&&(0,e.hasObjectProp)(l,"editorContext")}s.is=r;function d(l){return{kind:s.KIND,isOperation:!0,...l}}s.create=d}(o||(ms.PasteOperation=o={})),ms}var Gl={},lL;function $U(){if(lL)return Gl;lL=1,Object.defineProperty(Gl,"__esModule",{value:!0}),Gl.SetContextActions=Gl.RequestContextActions=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="requestContextActions";function o(r){return n.RequestAction.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"contextId")&&(0,e.hasObjectProp)(r,"editorContext")}a.is=o;function s(r){return{kind:a.KIND,requestId:"",...r}}a.create=s})(t||(Gl.RequestContextActions=t={}));var i;return function(a){a.KIND="setContextActions";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasArrayProp)(r,"actions")}a.is=o;function s(r,d={}){return{kind:a.KIND,responseId:"",actions:r,...d}}a.create=s}(i||(Gl.SetContextActions=i={})),Gl}var zl={},dL;function YU(){if(dL)return zl;dL=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.ChangeRoutingPointsOperation=zl.ReconnectEdgeOperation=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="reconnectEdge";function o(r){return n.Operation.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"edgeElementId")&&(0,e.hasStringProp)(r,"sourceElementId")&&(0,e.hasStringProp)(r,"targetElementId")}a.is=o;function s(r){return{kind:a.KIND,isOperation:!0,...r}}a.create=s})(t||(zl.ReconnectEdgeOperation=t={}));var i;return function(a){a.KIND="changeRoutingPoints";function o(r){return n.Operation.hasKind(r,a.KIND)&&(0,e.hasArrayProp)(r,"newRoutingPoints")}a.is=o;function s(r,d={}){return{kind:a.KIND,isOperation:!0,newRoutingPoints:r,...d}}a.create=s}(i||(zl.ChangeRoutingPointsOperation=i={})),zl}var vs={},fL;function WU(){if(fL)return vs;fL=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.DeleteElementOperation=vs.CreateEdgeOperation=vs.CreateNodeOperation=vs.CreateOperation=void 0;const e=vt(),n=Pn();var t;(function(s){function r(l){return n.Operation.is(l)&&(0,e.hasStringProp)(l,"elementTypeId")}s.is=r;function d(l,c){return s.is(l)&&l.kind===c}s.hasKind=d})(t||(vs.CreateOperation=t={}));var i;(function(s){s.KIND="createNode";function r(l){return t.hasKind(l,s.KIND)}s.is=r;function d(l,c={}){return{kind:s.KIND,isOperation:!0,elementTypeId:l,...c}}s.create=d})(i||(vs.CreateNodeOperation=i={}));var a;(function(s){s.KIND="createEdge";function r(l){return t.hasKind(l,s.KIND)&&(0,e.hasStringProp)(l,"sourceElementId")&&(0,e.hasStringProp)(l,"targetElementId")}s.is=r;function d(l){return{kind:s.KIND,isOperation:!0,...l}}s.create=d})(a||(vs.CreateEdgeOperation=a={}));var o;return function(s){s.KIND="deleteElement";function r(l){return n.Operation.hasKind(l,s.KIND)&&(0,e.hasArrayProp)(l,"elementIds")}s.is=r;function d(l,c={}){return{kind:s.KIND,isOperation:!0,elementIds:l,...c}}s.create=d}(o||(vs.DeleteElementOperation=o={})),vs}var Ul={},hL;function ZU(){if(hL)return Ul;hL=1,Object.defineProperty(Ul,"__esModule",{value:!0}),Ul.SetPopupModelAction=Ul.RequestPopupModelAction=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="requestPopupModel";function o(r){return n.RequestAction.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"elementId")&&(0,e.hasObjectProp)(r,"bounds")}a.is=o;function s(r){return{kind:a.KIND,requestId:"",...r}}a.create=s})(t||(Ul.RequestPopupModelAction=t={}));var i;return function(a){a.KIND="setPopupModel";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasObjectProp)(r,"newRoot")}a.is=o;function s(r,d={}){return{kind:a.KIND,responseId:"",newRoot:r,...d}}a.create=s}(i||(Ul.SetPopupModelAction=i={})),Ul}var ai={},pL;function QU(){if(pL)return ai;pL=1,Object.defineProperty(ai,"__esModule",{value:!0}),ai.NavigateToExternalTargetAction=ai.SetResolvedNavigationTargetAction=ai.ResolveNavigationTargetAction=ai.NavigateToTargetAction=ai.SetNavigationTargetsAction=ai.RequestNavigationTargetsAction=ai.NavigationTarget=void 0;const e=vt(),n=Pn();var t;(function(l){function c(v){return e.AnyObject.is(v)&&(0,e.hasStringProp)(v,"uri")}l.is=c,l.ELEMENT_IDS="elementIds",l.ELEMENT_IDS_SEPARATOR="&",l.TEXT_LINE="line",l.TEXT_COLUMN="column";function u(v){return v.args!==void 0&&Object.keys(v.args).length>0}l.hasArguments=u;function f(v,_,S){v.args||(v.args={}),v.args[_]=S}l.addArgument=f;function h(v){var _;return!((_=v==null?void 0:v.args)===null||_===void 0)&&_[l.ELEMENT_IDS]?v.args[l.ELEMENT_IDS].toString().split(l.ELEMENT_IDS_SEPARATOR):[]}l.getElementIds=h;function p(v,..._){return v.args===void 0&&(v.args={}),v.args[l.ELEMENT_IDS]=_.join(l.ELEMENT_IDS_SEPARATOR)}l.setElementIds=p;function g(v,_){_&&(v.args===void 0&&(v.args={}),v.args[l.TEXT_LINE]=_.line,v.args[l.TEXT_COLUMN]=_.character)}l.setTextPosition=g;function m(v){if(!(!v.args||!v.args[l.TEXT_LINE]||!v.args[l.TEXT_COLUMN]))return{line:Number(v.args[l.TEXT_LINE]),character:Number(v.args[l.TEXT_COLUMN])}}l.getTextPosition=m})(t||(ai.NavigationTarget=t={}));var i;(function(l){l.KIND="requestNavigationTargets";function c(f){return n.RequestAction.hasKind(f,l.KIND)&&(0,e.hasStringProp)(f,"targetTypeId")&&(0,e.hasObjectProp)(f,"editorContext")}l.is=c;function u(f){return{kind:l.KIND,requestId:"",...f}}l.create=u})(i||(ai.RequestNavigationTargetsAction=i={}));var a;(function(l){l.KIND="setNavigationTargets";function c(f){return n.Action.hasKind(f,l.KIND)&&(0,e.hasArrayProp)(f,"targets")}l.is=c;function u(f,h={}){return{kind:l.KIND,responseId:"",targets:f,...h}}l.create=u})(a||(ai.SetNavigationTargetsAction=a={}));var o;(function(l){l.KIND="navigateToTarget";function c(f){return n.Action.hasKind(f,l.KIND)&&(0,e.hasObjectProp)(f,"target")}l.is=c;function u(f){return{kind:l.KIND,target:f}}l.create=u})(o||(ai.NavigateToTargetAction=o={}));var s;(function(l){l.KIND="resolveNavigationTarget";function c(f){return n.RequestAction.hasKind(f,l.KIND)&&(0,e.hasObjectProp)(f,"navigationTarget")}l.is=c;function u(f,h={}){return{kind:l.KIND,requestId:"",navigationTarget:f,...h}}l.create=u})(s||(ai.ResolveNavigationTargetAction=s={}));var r;(function(l){l.KIND="setResolvedNavigationTarget";function c(f){return n.Action.hasKind(f,l.KIND)&&(0,e.hasArrayProp)(f,"elementIds")}l.is=c;function u(f,h={}){return{kind:l.KIND,responseId:"",elementIds:f,...h}}l.create=u})(r||(ai.SetResolvedNavigationTargetAction=r={}));var d;return function(l){l.KIND="navigateToExternalTarget";function c(f){return n.Action.hasKind(f,l.KIND)&&(0,e.hasObjectProp)(f,"target")}l.is=c;function u(f){return{kind:l.KIND,target:f}}l.create=u}(d||(ai.NavigateToExternalTargetAction=d={})),ai}var $l={},gL;function JU(){if(gL)return $l;gL=1,Object.defineProperty($l,"__esModule",{value:!0}),$l.SelectAllAction=$l.SelectAction=void 0;const e=nf(),n=vt(),t=Pn();var i;(function(o){o.KIND="elementSelected";function s(u){return t.Action.hasKind(u,o.KIND)&&(0,n.hasArrayProp)(u,"selectedElementsIDs")&&(0,n.hasArrayProp)(u,"deselectedElementsIDs")}o.is=s;function r(u={}){var f,h;const p=(f=u.deselectedElementsIDs)!==null&&f!==void 0?f:[];return{kind:o.KIND,selectedElementsIDs:(h=u.selectedElementsIDs)!==null&&h!==void 0?h:[],deselectedElementsIDs:(0,e.isStringArray)(p,!0)?p:[],deselectAll:typeof p=="boolean"?p:!1}}o.create=r;function d(u){return r({selectedElementsIDs:u})}o.addSelection=d;function l(u){return r({deselectedElementsIDs:u})}o.removeSelection=l;function c(u){return r({selectedElementsIDs:u,deselectedElementsIDs:!0})}o.setSelection=c})(i||($l.SelectAction=i={}));var a;return function(o){o.KIND="allSelected";function s(d){return t.Action.hasKind(d,o.KIND)&&(0,n.hasBooleanProp)(d,"select")}o.is=s;function r(d=!0){return{kind:o.KIND,select:d}}o.create=r}(a||($l.SelectAllAction=a={})),$l}var ys={},mL;function XU(){if(mL)return ys;mL=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.ValidationStatus=ys.ApplyLabelEditOperation=ys.SetEditValidationResultAction=ys.RequestEditValidationAction=void 0;const e=vt(),n=Pn();var t;(function(s){s.KIND="requestEditValidation";function r(l){return n.RequestAction.hasKind(l,s.KIND)&&(0,e.hasStringProp)(l,"contextId")&&(0,e.hasStringProp)(l,"modelElementId")&&(0,e.hasStringProp)(l,"text")}s.is=r;function d(l){return{kind:s.KIND,requestId:"",...l}}s.create=d})(t||(ys.RequestEditValidationAction=t={}));var i;(function(s){s.KIND="setEditValidationResult";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"status")}s.is=r;function d(l,c={}){return{kind:s.KIND,responseId:"",status:l,...c}}s.create=d})(i||(ys.SetEditValidationResultAction=i={}));var a;(function(s){s.KIND="applyLabelEdit";function r(l){return n.Operation.hasKind(l,s.KIND)&&(0,e.hasStringProp)(l,"labelId")&&(0,e.hasStringProp)(l,"text")}s.is=r;function d(l){return{kind:s.KIND,isOperation:!0,...l}}s.create=d})(a||(ys.ApplyLabelEditOperation=a={}));var o;return function(s){let r;(function(u){u[u.FATAL=0]="FATAL",u[u.ERROR=1]="ERROR",u[u.WARNING=2]="WARNING",u[u.INFO=3]="INFO",u[u.OK=4]="OK",u[u.NONE=5]="NONE"})(r=s.Severity||(s.Severity={})),s.NONE={severity:r.NONE,message:"",error:{code:-1,message:"",data:{}}};function d(u){return u.severity===r.OK||u.severity===r.INFO||u.severity===r.NONE}s.isOk=d;function l(u){return u.severity===r.WARNING}s.isWarning=l;function c(u){return u.severity===r.ERROR||u.severity===r.FATAL}s.isError=c}(o||(ys.ValidationStatus=o={})),ys}var _s={},vL;function e$(){if(vL)return _s;vL=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.CheckEdgeResultAction=_s.RequestCheckEdgeAction=_s.SetTypeHintsAction=_s.RequestTypeHintsAction=void 0;const e=vt(),n=Pn();var t;(function(r){r.KIND="requestTypeHints";function d(c){return n.RequestAction.hasKind(c,r.KIND)}r.is=d;function l(c={}){return{kind:r.KIND,requestId:"",...c}}r.create=l})(t||(_s.RequestTypeHintsAction=t={}));var i;(function(r){r.KIND="setTypeHints";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasArrayProp)(c,"shapeHints")&&(0,e.hasArrayProp)(c,"edgeHints")}r.is=d;function l(c){return{kind:r.KIND,responseId:"",...c}}r.create=l})(i||(_s.SetTypeHintsAction=i={}));var a;(function(r){r.KIND="requestCheckEdge";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasStringProp)(c,"edgeType")&&(0,e.hasStringProp)(c,"sourceElementId")&&(0,e.hasStringProp)(c,"targetElementId",!0)}r.is=d;function l(c){var u;return{kind:r.KIND,edgeType:c.edgeType,sourceElementId:o(c.sourceElement),targetElementId:c.targetElement?o(c.targetElement):void 0,requestId:(u=c.requestId)!==null&&u!==void 0?u:""}}r.create=l})(a||(_s.RequestCheckEdgeAction=a={}));function o(r){return typeof r=="string"?r:r.id}var s;return function(r){r.KIND="checkEdgeTargetResult";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasBooleanProp)(c,"isValid")&&(0,e.hasStringProp)(c,"edgeType")&&(0,e.hasStringProp)(c,"sourceElementId")&&(0,e.hasStringProp)(c,"targetElementId",!0)}r.is=d;function l(c){return{kind:r.KIND,responseId:"",...c}}r.create=l}(s||(_s.CheckEdgeResultAction=s={})),_s}var Br={},yL;function t$(){if(yL)return Br;yL=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.DeleteMarkersAction=Br.SetMarkersAction=Br.RequestMarkersAction=Br.MarkersReason=Br.MarkerKind=void 0;const e=vt(),n=Pn();var t;(function(r){r.INFO="info",r.WARNING="warning",r.ERROR="error"})(t||(Br.MarkerKind=t={}));var i;(function(r){r.BATCH="batch",r.LIVE="live"})(i||(Br.MarkersReason=i={}));var a;(function(r){r.KIND="requestMarkers";function d(c){return n.RequestAction.hasKind(c,r.KIND)&&(0,e.hasArrayProp)(c,"elementsIDs")}r.is=d;function l(c,u={}){return{kind:r.KIND,requestId:"",elementsIDs:c,reason:i.BATCH,...u}}r.create=l})(a||(Br.RequestMarkersAction=a={}));var o;(function(r){r.KIND="setMarkers";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasArrayProp)(c,"markers")}r.is=d;function l(c,u={}){return{kind:r.KIND,responseId:"",markers:c,reason:i.BATCH,...u}}r.create=l})(o||(Br.SetMarkersAction=o={}));var s;return function(r){r.KIND="deleteMarkers";function d(c){return n.Action.hasKind(c,r.KIND)&&(0,e.hasArrayProp)(c,"markers")}r.is=d;function l(c){return{kind:r.KIND,markers:c}}r.create=l}(s||(Br.DeleteMarkersAction=s={})),Br}var bs={},_L;function n$(){if(_L)return bs;_L=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.SourceModelChangedAction=bs.UpdateModelAction=bs.SetModelAction=bs.RequestModelAction=void 0;const e=vt(),n=Pn();var t;(function(s){s.KIND="requestModel";function r(l){return n.RequestAction.hasKind(l,s.KIND)}s.is=r;function d(l={}){return{kind:s.KIND,requestId:"",...l}}s.create=d})(t||(bs.RequestModelAction=t={}));var i;(function(s){s.KIND="setModel";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"newRoot")}s.is=r;function d(l,c={}){return{kind:s.KIND,responseId:"",newRoot:l,...c}}s.create=d})(i||(bs.SetModelAction=i={}));var a;(function(s){s.KIND="updateModel";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasObjectProp)(l,"newRoot")}s.is=r;function d(l,c={}){return{kind:s.KIND,newRoot:l,animate:!0,...c}}s.create=d})(a||(bs.UpdateModelAction=a={}));var o;return function(s){s.KIND="sourceModelChanged";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasStringProp)(l,"sourceModelName")}s.is=r;function d(l){return{kind:s.KIND,sourceModelName:l}}s.create=d}(o||(bs.SourceModelChangedAction=o={})),bs}var Yl={},bL;function i$(){if(bL)return Yl;bL=1,Object.defineProperty(Yl,"__esModule",{value:!0}),Yl.EditMode=Yl.SetEditModeAction=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="setEditMode";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"editMode")}a.is=o;function s(r){return{kind:a.KIND,editMode:r}}a.create=s})(t||(Yl.SetEditModeAction=t={}));var i;return function(a){a.READONLY="readonly",a.EDITABLE="editable"}(i||(Yl.EditMode=i={})),Yl}var Rc={},SL;function r$(){if(SL)return Rc;SL=1,Object.defineProperty(Rc,"__esModule",{value:!0}),Rc.LayoutOperation=Rc.ComputedBoundsAction=Rc.RequestBoundsAction=void 0;const e=vt(),n=Pn();var t;(function(o){o.KIND="requestBounds";function s(d){return n.RequestAction.hasKind(d,o.KIND)&&(0,e.hasObjectProp)(d,"newRoot")}o.is=s;function r(d,l={}){return{kind:o.KIND,requestId:"",newRoot:d,...l}}o.create=r})(t||(Rc.RequestBoundsAction=t={}));var i;(function(o){o.KIND="computedBounds";function s(d){return n.Action.hasKind(d,o.KIND)&&(0,e.hasArrayProp)(d,"bounds")}o.is=s;function r(d,l={}){return{kind:o.KIND,responseId:"",bounds:d,...l}}o.create=r})(i||(Rc.ComputedBoundsAction=i={}));var a;return function(o){o.KIND="layout";function s(d){return n.Action.hasKind(d,o.KIND)&&(0,e.hasArrayProp)(d,"elementIds")}o.is=s;function r(d,l={}){return{kind:o.KIND,isOperation:!0,elementIds:d,...l}}o.create=r}(a||(Rc.LayoutOperation=a={})),Rc}var Ss={},EL;function o$(){if(EL)return Ss;EL=1,Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.ExportSvgAction=Ss.RequestExportSvgAction=Ss.SetDirtyStateAction=Ss.SaveModelAction=void 0;const e=vt(),n=Pn();var t;(function(s){s.KIND="saveModel";function r(l){return n.Action.hasKind(l,s.KIND)}s.is=r;function d(l={}){return{kind:s.KIND,...l}}s.create=d})(t||(Ss.SaveModelAction=t={}));var i;(function(s){s.KIND="setDirtyState";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasBooleanProp)(l,"isDirty")}s.is=r;function d(l,c={}){return{kind:s.KIND,isDirty:l,...c}}s.create=d})(i||(Ss.SetDirtyStateAction=i={}));var a;(function(s){s.KIND="requestExportSvg";function r(l){return n.RequestAction.hasKind(l,s.KIND)}s.is=r;function d(l={}){return{kind:s.KIND,requestId:"",...l}}s.create=d})(a||(Ss.RequestExportSvgAction=a={}));var o;return function(s){s.KIND="exportSvg";function r(l){return n.Action.hasKind(l,s.KIND)&&(0,e.hasStringProp)(l,"svg")}s.is=r;function d(l,c={}){return{kind:s.KIND,svg:l,responseId:"",...c}}s.create=d}(o||(Ss.ExportSvgAction=o={})),Ss}var Wl={},CL;function s$(){if(CL)return Wl;CL=1,Object.defineProperty(Wl,"__esModule",{value:!0}),Wl.ChangeContainerOperation=Wl.ChangeBoundsOperation=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="changeBounds";function o(r){return n.Operation.hasKind(r,a.KIND)&&(0,e.hasArrayProp)(r,"newBounds")}a.is=o;function s(r){return{kind:a.KIND,isOperation:!0,newBounds:r}}a.create=s})(t||(Wl.ChangeBoundsOperation=t={}));var i;return function(a){a.KIND="changeContainer";function o(r){return n.Operation.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"elementId")&&(0,e.hasStringProp)(r,"targetContainerId")}a.is=o;function s(r){return{kind:a.KIND,isOperation:!0,...r}}a.create=s}(i||(Wl.ChangeContainerOperation=i={})),Wl}var Zl={},PL;function n9(){if(PL)return Zl;PL=1,Object.defineProperty(Zl,"__esModule",{value:!0}),Zl.TriggerEdgeCreationAction=Zl.TriggerNodeCreationAction=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="triggerNodeCreation";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"elementTypeId")}a.is=o;function s(r,d){return{kind:a.KIND,elementTypeId:r,...d}}a.create=s})(t||(Zl.TriggerNodeCreationAction=t={}));var i;return function(a){a.KIND="triggerEdgeCreation";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasStringProp)(r,"elementTypeId")}a.is=o;function s(r,d={}){return{kind:a.KIND,elementTypeId:r,...d}}a.create=s}(i||(Zl.TriggerEdgeCreationAction=i={})),Zl}var Es={},RL;function a$(){if(RL)return Es;RL=1,Object.defineProperty(Es,"__esModule",{value:!0}),Es.MenuItem=Es.PaletteItem=Es.LabeledAction=Es.EditorContext=void 0;const e=vt(),n=n9();var t;(function(s){function r(d){return e.AnyObject.is(d)&&(0,e.hasArrayProp)(d,"selectedElementIds")}s.is=r})(t||(Es.EditorContext=t={}));var i;(function(s){function r(l){return e.AnyObject.is(l)&&(0,e.hasStringProp)(l,"label")&&(0,e.hasArrayProp)(l,"actions")}s.is=r;function d(l){return Array.isArray(l)?l:s.is(l)?l.actions:[l]}s.toActionArray=d})(i||(Es.LabeledAction=i={}));var a;(function(s){function r(c){return i.is(c)&&(0,e.hasStringProp)(c,"id")&&(0,e.hasStringProp)(c,"sortString")}s.is=r;function d(c){if(c){const u=c.actions.filter(f=>l(f)).map(f=>f);return u.length>0?u[0]:void 0}}s.getTriggerAction=d;function l(c){return n.TriggerNodeCreationAction.is(c)||n.TriggerEdgeCreationAction.is(c)}s.isTriggerElementCreationAction=l})(a||(Es.PaletteItem=a={}));var o;return function(s){function r(d){return i.is(d)&&(0,e.hasStringProp)(d,"id")}s.is=r}(o||(Es.MenuItem=o={})),Es}var Ql={},ML;function c$(){if(ML)return Ql;ML=1,Object.defineProperty(Ql,"__esModule",{value:!0}),Ql.RedoAction=Ql.UndoAction=void 0;const e=Pn();var n;(function(i){i.KIND="glspUndo";function a(s){return e.Action.hasKind(s,i.KIND)}i.is=a;function o(){return{kind:i.KIND}}i.create=o})(n||(Ql.UndoAction=n={}));var t;return function(i){i.KIND="glspRedo";function a(s){return e.Action.hasKind(s,i.KIND)}i.is=a;function o(){return{kind:i.KIND}}i.create=o}(t||(Ql.RedoAction=t={})),Ql}var Jl={},AL;function u$(){if(AL)return Jl;AL=1,Object.defineProperty(Jl,"__esModule",{value:!0}),Jl.FitToScreenAction=Jl.CenterAction=void 0;const e=vt(),n=Pn();var t;(function(a){a.KIND="center";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasBooleanProp)(r,"animate")&&(0,e.hasBooleanProp)(r,"retainZoom")}a.is=o;function s(r,d={}){return{kind:a.KIND,animate:!0,retainZoom:!1,elementIds:r,...d}}a.create=s})(t||(Jl.CenterAction=t={}));var i;return function(a){a.KIND="fit";function o(r){return n.Action.hasKind(r,a.KIND)&&(0,e.hasArrayProp)(r,"elementIds")&&(0,e.hasBooleanProp)(r,"animate")}a.is=o;function s(r,d={}){return{kind:a.KIND,animate:!0,elementIds:r,...d}}a.create=s}(i||(Jl.FitToScreenAction=i={})),Jl}var Yb={},wL;function l$(){return wL||(wL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BaseGLSPClient=e.GLOBAL_HANDLER_ID=void 0;const n=Yr(),t=qm(),i=nf(),a=SP(),o=A_();e.GLOBAL_HANDLER_ID="*";class s{get onServerInitialized(){return this.onServerInitializedEmitter.event}get onCurrentStateChanged(){return this.onCurrentStateChangedEmitter.event}set state(d){this._state!==d&&(this._state=d,this.onCurrentStateChangedEmitter.fire(d))}get state(){return this._state}get checkedServer(){if(this.checkState(),!this._server)throw new Error(`No server is configured for GLSPClient with id '${this.id}'`);return this._server}get initializeResult(){return this._initializeResult}constructor(d){this.options=d,this.serverDeferred=new n.Deferred,this.onStartDeferred=new n.Deferred,this.onStopDeferred=new n.Deferred,this.startupTimeout=1500,this.actionMessageHandlers=new Map([[e.GLOBAL_HANDLER_ID,[]]]),this.onServerInitializedEmitter=new a.Emitter,this.onCurrentStateChangedEmitter=new a.Emitter,this.state=o.ClientState.Initial,this.proxy=this.createProxy()}createProxy(){return{process:d=>{var l;const c=(l=this.actionMessageHandlers.get(d.clientId))!==null&&l!==void 0?l:this.actionMessageHandlers.get(e.GLOBAL_HANDLER_ID);if(!c){console.warn("No ActionMessageHandler is configured- Cannot process server message",d);return}c.forEach(u=>u(d))}}}configureServer(d){if(this.state===o.ClientState.Running)throw new Error("Could not configure new server. The GLSPClient is already running");this.serverDeferred.resolve(d)}start(){if(this.state===o.ClientState.Running||this.state===o.ClientState.Starting)return this.onStartDeferred.promise;this.state=o.ClientState.Starting;const d=new Promise((l,c)=>setTimeout(()=>{c(new Error("Could not start client. No server is configured"))},this.startupTimeout));return Promise.race([this.serverDeferred.promise,d]).then(l=>{this._server=l,this.state=o.ClientState.Running,this.onStartDeferred.resolve()}).catch(l=>{this.state=o.ClientState.StartFailed,this.onStartDeferred.reject(l)}),this.onStartDeferred.promise}async initializeServer(d){if(this.initializeResult)return this.initializeResult;if(this.pendingServerInitialize)return this.pendingServerInitialize;const l=new n.Deferred;try{this.pendingServerInitialize=l.promise,this._initializeResult=await this.checkedServer.initialize(d),this.onServerInitializedEmitter.fire(this._initializeResult),l.resolve(this._initializeResult),this.pendingServerInitialize=void 0}catch(c){l.reject(c),this._initializeResult=void 0,this.pendingServerInitialize=void 0}return l.promise}initializeClientSession(d){return this.checkedServer.initializeClientSession(d)}disposeClientSession(d){return this.checkedServer.disposeClientSession(d)}shutdownServer(){this.checkedServer.shutdown()}async stop(){if(this.state===o.ClientState.Stopped||this.state===o.ClientState.Stopping)return this.onStop();this.state=o.ClientState.Stopping;try{this._server&&this._server.shutdown()}finally{this.state=o.ClientState.Stopped,this.onStopDeferred.resolve()}}sendActionMessage(d){this.checkedServer.process(d)}onActionMessage(d,l){return l?(this.actionMessageHandlers.has(l)?(0,i.distinctAdd)(this.actionMessageHandlers.get(l),d):this.actionMessageHandlers.set(l,[d]),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(l),d))):((0,i.distinctAdd)(this.actionMessageHandlers.get(e.GLOBAL_HANDLER_ID),d),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(e.GLOBAL_HANDLER_ID),d)))}get currentState(){return this.state}onStart(){return this.onStartDeferred.promise}onStop(){return this.onStopDeferred.promise}get id(){return this.options.id}checkState(){if(this.state!==o.ClientState.Running)throw new Error(`Client with id '${this.id}' is not in 'Running' state`)}setStartupTimeout(d){this.startupTimeout=d}}e.BaseGLSPClient=s}(Yb)),Yb}var Mc={},IL;function d$(){return IL||(IL=1,Object.defineProperty(Mc,"__esModule",{value:!0}),Mc.GLSPClientProxy=Mc.GLSPServerListener=Mc.GLSPServer=void 0,Mc.GLSPServer=Symbol("GLSPServer"),Mc.GLSPServerListener=Symbol("GLSPServerListener"),Mc.GLSPClientProxy=Symbol("GLSPClientProxy")),Mc}var Np={},TL;function f$(){if(TL)return Np;TL=1,Object.defineProperty(Np,"__esModule",{value:!0}),Np.configureClientConnection=void 0;const e=CP();function n(t,i){t.onRequest(e.JsonrpcGLSPClient.InitializeRequest.method,a=>i.initialize(a)),t.onRequest(e.JsonrpcGLSPClient.InitializeClientSessionRequest,a=>i.initializeClientSession(a)),t.onRequest(e.JsonrpcGLSPClient.DisposeClientSessionRequest,a=>i.disposeClientSession(a)),t.onNotification(e.JsonrpcGLSPClient.ActionMessageNotification,a=>i.process(a)),t.listen()}return Np.configureClientConnection=n,Np}var xr={},DL;function i9(){if(DL)return xr;DL=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.listen=xr.createWebSocketConnection=xr.WebSocketMessageWriter=xr.WebSocketMessageReader=xr.wrap=void 0;const e=qm();function n(s){return{send:r=>s.send(r),onMessage:r=>s.onmessage=d=>r(d.data),onClose:r=>s.onclose=d=>r(d.code,d.reason),onError:r=>s.onerror=d=>{"error"in d&&r(d.error)},dispose:()=>s.close()}}xr.wrap=n;class t extends e.AbstractMessageReader{constructor(r){super(),this.socket=r,this.state="initial",this.eventQueue=[],this.socket.onMessage(d=>this.handleMessage(d)),this.socket.onError(d=>this.fireError(d)),this.socket.onClose(()=>this.fireClose())}listen(r){return this.state==="initial"&&(this.state="listening",this.callback=r,this.eventQueue.forEach(d=>{d.message?this.handleMessage(d.message):d.error?this.fireError(d.error):this.fireClose()}),this.eventQueue=[]),e.Disposable.create(()=>{this.callback=void 0,this.eventQueue=[]})}handleMessage(r){if(this.state==="initial")this.eventQueue.push({message:r});else if(this.state==="listening"){const d=JSON.parse(r);this.callback(d)}}fireError(r){this.state==="initial"?this.eventQueue.push({error:r}):this.state==="listening"&&super.fireError(r)}fireClose(){this.state==="initial"?this.eventQueue.push({}):this.state==="listening"&&super.fireClose(),this.state="closed"}}xr.WebSocketMessageReader=t;class i extends e.AbstractMessageWriter{constructor(r){super(),this.socket=r,this.errorCount=0}end(){}async write(r){try{const d=JSON.stringify(r);this.socket.send(d)}catch(d){this.errorCount++,this.fireError(d,r,this.errorCount)}}}xr.WebSocketMessageWriter=i;function a(s,r){const d=new t(s),l=new i(s);return(0,e.createMessageConnection)(d,l,r)}xr.createWebSocketConnection=a;function o(s,r,d){return new Promise(l=>{s.onopen=()=>{const c=n(s),u=a(c,d);r==null||r(u),l(u)}})}return xr.listen=o,xr}var Bp={},Wb,OL;function h$(){return OL||(OL=1,Wb=qm()),Wb}var LL;function p$(){if(LL)return Bp;LL=1,Object.defineProperty(Bp,"__esModule",{value:!0}),Bp.GLSPWebWorkerProvider=void 0;const e=h$();class n{constructor(i){this.url=i}createWebWorker(i){return new Worker(i)}listen(i){var a,o;this.worker=this.createWebWorker(this.url);const s=(0,e.createMessageConnection)(new e.BrowserMessageReader(this.worker),new e.BrowserMessageWriter(this.worker));return(a=i.logger)===null||a===void 0||a.warn("GLSPWebWorkerProvider Initializing!"),(o=i.onConnection)===null||o===void 0||o.call(i,s),s}}return Bp.GLSPWebWorkerProvider=n,Bp}var Xl={},jL;function g$(){if(jL)return Xl;jL=1,Object.defineProperty(Xl,"__esModule",{value:!0}),Xl.GLSPWebSocketProvider=Xl.GLSPConnectionHandler=void 0;const e=i9();Xl.GLSPConnectionHandler=Symbol("GLSPConnectionHandler");class n{constructor(i,a){this.url=i,this.reconnectAttempts=0,this.options={reconnecting:!0,reconnectAttempts:1/0,reconnectDelay:1e3},this.options=Object.assign(this.options,a)}createWebSocket(i){return new WebSocket(i)}listen(i,a=!1){return this.webSocket=this.createWebSocket(this.url),this.webSocket.onerror=()=>{var o;(o=i.logger)===null||o===void 0||o.error("GLSPWebSocketProvider Connection to server errored. Please make sure that the server is running!"),clearInterval(this.reconnectTimer),this.webSocket.close()},new Promise(o=>{this.webSocket.onopen=()=>{var s,r,d,l;clearInterval(this.reconnectTimer);const c=(0,e.wrap)(this.webSocket),u=(0,e.createWebSocketConnection)(c,i.logger);this.webSocket.onclose=()=>{var f,h;const{reconnecting:p,reconnectAttempts:g,reconnectDelay:m}=this.options;p?this.reconnectAttempts>=g?(f=i.logger)===null||f===void 0||f.error(`GLSPWebSocketProvider WebSocket reconnect failed - maximum number reconnect attempts (${g}) was exceeded!`):this.reconnectTimer=setInterval(()=>{var v;(v=i.logger)===null||v===void 0||v.warn("GLSPWebSocketProvider reconnecting..."),this.listen(i,!0),this.reconnectAttempts++},m):(h=i.logger)===null||h===void 0||h.error("GLSPWebSocketProvider WebSocket will not reconnect - closing the connection now!")},a?((s=i.logger)===null||s===void 0||s.warn("GLSPWebSocketProvider Reconnecting!"),(r=i.onReconnect)===null||r===void 0||r.call(i,u)):((d=i.logger)===null||d===void 0||d.warn("GLSPWebSocketProvider Initializing!"),(l=i.onConnection)===null||l===void 0||l.call(i,u)),o(u)}})}}return Xl.GLSPWebSocketProvider=n,Xl}var Zb={},NL;function m$(){return NL||(NL=1,Object.defineProperty(Zb,"__esModule",{value:!0})),Zb}var xp={},BL;function v$(){if(BL)return xp;BL=1,Object.defineProperty(xp,"__esModule",{value:!0}),xp.DefaultTypes=void 0;var e;return function(n){n.HTML="html",n.FOREIGN_OBJECT="foreign-object",n.PRE_RENDERED="pre-rendered",n.SHAPE_PRE_RENDERED="shape-pre-rendered",n.SVG="svg",n.GRAPH="graph",n.NODE="node",n.COMPARTMENT="comp",n.COMPARTMENT_HEADER="comp:header",n.EDGE="edge",n.PORT="port",n.ROUTING_POINT="routing-point",n.VOLATILE_ROUTING_POINT=`volatile-${n.ROUTING_POINT}`,n.LABEL="label",n.BUTTON="button",n.BUTTON_EXPAND="button:expand",n.ISSUE_MARKER="marker",n.NODE_CIRCLE="node:circle",n.NODE_RECTANGLE="node:rectangle",n.NODE_DIAMOND="node:diamond"}(e||(xp.DefaultTypes=e={})),xp}var Fp={},xL;function y$(){if(xL)return Fp;xL=1,Object.defineProperty(Fp,"__esModule",{value:!0}),Fp.isGModelElementSchema=void 0;const e=vt();function n(t){return typeof t=="object"&&(0,e.hasStringProp)(t,"type")&&(0,e.hasStringProp)(t,"id")}return Fp.isGModelElementSchema=n,Fp}var ed={},FL;function _$(){return FL||(FL=1,function(e){var n=ed&&ed.__createBinding||(Object.create?function(o,s,r,d){d===void 0&&(d=r);var l=Object.getOwnPropertyDescriptor(s,r);(!l||("get"in l?!s.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return s[r]}}),Object.defineProperty(o,d,l)}:function(o,s,r,d){d===void 0&&(d=r),o[d]=s[r]}),t=ed&&ed.__exportStar||function(o,s){for(var r in o)r!=="default"&&!Object.prototype.hasOwnProperty.call(s,r)&&n(s,o,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.getSubType=e.getBasicType=e.findElement=e.cloneModel=e.applyBounds=e.isZoomable=e.isScrollable=void 0;var i=d7();Object.defineProperty(e,"isScrollable",{enumerable:!0,get:function(){return i.isScrollable}}),Object.defineProperty(e,"isZoomable",{enumerable:!0,get:function(){return i.isZoomable}}),t(Zy(),e),t(at(),e),t(f7(),e);var a=Jd();Object.defineProperty(e,"applyBounds",{enumerable:!0,get:function(){return a.applyBounds}}),Object.defineProperty(e,"cloneModel",{enumerable:!0,get:function(){return a.cloneModel}}),Object.defineProperty(e,"findElement",{enumerable:!0,get:function(){return a.findElement}}),Object.defineProperty(e,"getBasicType",{enumerable:!0,get:function(){return a.getBasicType}}),Object.defineProperty(e,"getSubType",{enumerable:!0,get:function(){return a.getSubType}})}(ed)),ed}var Qb={},kL;function b$(){return kL||(kL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportResult=e.SetViewportAction=e.SetBoundsAction=e.SelectionResult=e.OpenAction=e.MoveAction=e.HoverFeedbackAction=e.GetViewportAction=e.GetSelectionAction=e.CollapseExpandAllAction=e.CollapseExpandAction=e.BringToFrontAction=void 0;const n=lt();Object.defineProperty(e,"BringToFrontAction",{enumerable:!0,get:function(){return n.BringToFrontAction}}),Object.defineProperty(e,"CollapseExpandAction",{enumerable:!0,get:function(){return n.CollapseExpandAction}}),Object.defineProperty(e,"CollapseExpandAllAction",{enumerable:!0,get:function(){return n.CollapseExpandAllAction}}),Object.defineProperty(e,"GetSelectionAction",{enumerable:!0,get:function(){return n.GetSelectionAction}}),Object.defineProperty(e,"GetViewportAction",{enumerable:!0,get:function(){return n.GetViewportAction}}),Object.defineProperty(e,"HoverFeedbackAction",{enumerable:!0,get:function(){return n.HoverFeedbackAction}}),Object.defineProperty(e,"MoveAction",{enumerable:!0,get:function(){return n.MoveAction}}),Object.defineProperty(e,"OpenAction",{enumerable:!0,get:function(){return n.OpenAction}}),Object.defineProperty(e,"SelectionResult",{enumerable:!0,get:function(){return n.SelectionResult}}),Object.defineProperty(e,"SetBoundsAction",{enumerable:!0,get:function(){return n.SetBoundsAction}}),Object.defineProperty(e,"SetViewportAction",{enumerable:!0,get:function(){return n.SetViewportAction}}),Object.defineProperty(e,"ViewportResult",{enumerable:!0,get:function(){return n.ViewportResult}});const t=Pn(),i=vt();n.CollapseExpandAction.is=a=>t.Action.hasKind(a,n.CollapseExpandAction.KIND)&&(0,i.hasArrayProp)(a,"expandIds")&&(0,i.hasArrayProp)(a,"collapseIds"),n.CollapseExpandAllAction.is=a=>t.Action.hasKind(a,n.CollapseExpandAllAction.KIND)&&(0,i.hasBooleanProp)(a,"expand"),n.GetSelectionAction.is=a=>t.RequestAction.hasKind(a,n.GetSelectionAction.KIND),n.GetViewportAction.is=a=>t.RequestAction.hasKind(a,n.GetViewportAction.KIND),n.HoverFeedbackAction.is=a=>t.Action.hasKind(a,n.HoverFeedbackAction.KIND)&&(0,i.hasStringProp)(a,"mouseoverElement")&&(0,i.hasBooleanProp)(a,"mouseIsOver"),n.MoveAction.is=a=>t.Action.hasKind(a,n.MoveAction.KIND)&&(0,i.hasArrayProp)(a,"moves")&&(0,i.hasBooleanProp)(a,"animate")&&(0,i.hasBooleanProp)(a,"finished"),n.OpenAction.is=a=>t.Action.hasKind(a,n.OpenAction.KIND)&&(0,i.hasStringProp)(a,"elementId"),n.SelectionResult.is=a=>t.Action.hasKind(a,n.SelectionResult.KIND)&&(0,i.hasArrayProp)(a,"selectedElementsIDs"),n.SetBoundsAction.is=a=>t.Action.hasKind(a,n.SetBoundsAction.KIND)&&(0,i.hasObjectProp)(a,"bounds"),n.SetViewportAction.is=a=>t.Action.hasKind(a,n.SetViewportAction.KIND)&&(0,i.hasStringProp)(a,"elementId")&&(0,i.hasObjectProp)(a,"newViewport")&&(0,i.hasBooleanProp)(a,"animate"),n.ViewportResult.is=a=>t.Action.hasKind(a,n.ViewportResult.KIND)&&(0,i.hasObjectProp)(a,"viewport")&&(0,i.hasObjectProp)(a,"canvasBounds")}(Qb)),Qb}var Jb={},Xb={},kp={},KL;function PP(){if(KL)return kp;KL=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.equalUpTo=void 0;function e(n,t,i=Number.EPSILON){return Math.abs(n-t)<=i}return kp.equalUpTo=e,kp}var qL;function r9(){return qL||(qL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Dimension=void 0;const n=at();Object.defineProperty(e,"Dimension",{enumerable:!0,get:function(){return n.Dimension}});const t=PP(),i=vt();n.Dimension.ZERO=Object.freeze({width:0,height:0}),n.Dimension.is=a=>i.AnyObject.is(a)&&(0,i.hasNumberProp)(a,"width")&&(0,i.hasNumberProp)(a,"height"),n.Dimension.center=a=>({x:a.width*.5,y:a.height*.5}),n.Dimension.add=(a,o)=>({width:a.width+o.width,height:a.height+o.height}),n.Dimension.subtract=(a,o)=>({width:a.width-o.width,height:a.height-o.height}),n.Dimension.multiplyMeasure=(a,o)=>({width:a.width*o,height:a.height*o}),n.Dimension.divideMeasure=(a,o)=>({width:a.width/o,height:a.height/o}),n.Dimension.map=(a,o)=>({...a,width:o(a.width,"width"),height:o(a.height,"height")}),n.Dimension.equals=(a,o,s)=>(0,t.equalUpTo)(a.width,o.width,s)&&(0,t.equalUpTo)(a.height,o.height,s),n.Dimension.fromPoint=a=>({width:a.x,height:a.y}),n.Dimension.area=a=>a.width*a.height}(Xb)),Xb}var eS={},Kp={},qp={},HL;function o9(){return HL||(HL=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.Direction=void 0,qp.Direction={Left:"left",Right:"right",Up:"up",Down:"down"}),qp}var VL;function RP(){if(VL)return Kp;VL=1,Object.defineProperty(Kp,"__esModule",{value:!0}),Kp.Vector=void 0;const e=o9(),n=vt();var t;return function(i){i.ZERO=Object.freeze({x:0,y:0});function a(C){return{x:Math.abs(C.x),y:Math.abs(C.y)}}i.abs=a;function o(C,M){return{x:C.x+M.x,y:C.y+M.y}}i.add=o;function s(C,M){return C.x===M.x&&C.y===M.y}i.equals=s;function r(C){return C!==void 0&&!isNaN(C.x)&&!isNaN(C.y)}i.isValid=r;function d(C){return Math.sqrt(Math.pow(C.x,2)+Math.pow(C.y,2))}i.magnitude=d;function l(C,M){return{...C,x:M(C.x,"x"),y:M(C.y,"y")}}i.map=l;function c(C){const M=d(C);return M===0||M===1?i.ZERO:{x:C.x/M,y:C.y/M}}i.normalize=c;function u(C){return i.equals(C,i.ZERO)}i.isZero=u;function f(C){return n.AnyObject.is(C)&&(0,n.hasNumberProp)(C,"x")&&(0,n.hasNumberProp)(C,"y")}i.is=f;function h(C,M){return i.map(C,L=>L/M)}i.divide=h;function p(C,M){return i.map(C,L=>L*M)}i.multiply=p;function g(C,M){return{x:C.x-M.x,y:C.y-M.y}}i.subtract=g;function m(C){return{x:-C.x,y:-C.y}}i.reverse=m;function v(C){const M=[];return C.x<0?M.push(e.Direction.Left):C.x>0&&M.push(e.Direction.Right),C.y<0?M.push(e.Direction.Up):C.y>0&&M.push(e.Direction.Down),M}i.direction=v;function _(...C){return{x:Math.min(...C.map(M=>M.x)),y:Math.min(...C.map(M=>M.y))}}i.min=_;function S(...C){return{x:Math.max(...C.map(M=>M.x)),y:Math.max(...C.map(M=>M.y))}}i.max=S;function E(...C){return C.length===0?i.ZERO:{x:C.reduce((M,L)=>M+L.x,0)/C.length,y:C.reduce((M,L)=>M+L.y,0)/C.length}}i.avg=E}(t||(Kp.Vector=t={})),Kp}var GL;function MP(){return GL||(GL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Point=void 0;const n=at();Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return n.Point}});const t=RP(),i=PP(),a=vt();n.Point.is=o=>a.AnyObject.is(o)&&(0,a.hasNumberProp)(o,"x")&&(0,a.hasNumberProp)(o,"y"),n.Point.isOrigin=o=>n.Point.equals(o,n.Point.ORIGIN),n.Point.isValid=o=>o!==void 0&&!isNaN(o.x)&&!isNaN(o.y),n.Point.abs=o=>n.Point.map(o,Math.abs),n.Point.divideScalar=(o,s)=>n.Point.map(o,r=>r/s),n.Point.multiplyScalar=(o,s)=>n.Point.map(o,r=>r*s),n.Point.map=(o,s)=>({...o,x:s(o.x,"x"),y:s(o.y,"y")}),n.Point.snapToGrid=(o,s,r)=>{if(r){const d=n.Point.subtract(o,r),l=n.Point.snapToGrid(d,s);return n.Point.add(r,l)}else return{x:Math.round(o.x/s.x)*s.x,y:Math.round(o.y/s.y)*s.y}},n.Point.vector=(o,s)=>n.Point.subtract(s,o),n.Point.move=(o,s)=>{const r=n.Point.vector(o,s),d=t.Vector.direction(r);return{from:o,to:s,vector:r,direction:d}},n.Point.moveTowards=(o,s)=>{const r=n.Point.add(o,s),d=t.Vector.direction(s);return{from:o,to:r,vector:s,direction:d}},n.Point.equals=(o,s,r)=>(0,i.equalUpTo)(o.x,s.x,r)&&(0,i.equalUpTo)(o.y,s.y,r)}(eS)),eS}var zL;function S$(){return zL||(zL=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Bounds=void 0;const n=at();Object.defineProperty(e,"Bounds",{enumerable:!0,get:function(){return n.Bounds}});const t=r9(),i=MP(),a=vt();n.Bounds.ZERO=Object.freeze({x:0,y:0,width:0,height:0}),n.Bounds.is=o=>a.AnyObject.is(o)&&(0,a.hasNumberProp)(o,"x")&&(0,a.hasNumberProp)(o,"y")&&(0,a.hasNumberProp)(o,"width")&&(0,a.hasNumberProp)(o,"height"),n.Bounds.isValid=o=>o!==void 0&&t.Dimension.isValid(o)&&i.Point.isValid(o),n.Bounds.encompasses=(o,s)=>n.Bounds.includes(o,n.Bounds.topLeft(s))&&n.Bounds.includes(o,n.Bounds.bottomRight(s)),n.Bounds.overlap=(o,s,r)=>{const d=n.Bounds.topLeft(o),l=n.Bounds.bottomRight(o),c=n.Bounds.topLeft(s),u=n.Bounds.bottomRight(s);return r?d.x<=u.x&&c.x<=l.x&&l.y>=c.y&&u.y>=d.y:d.x<u.x&&c.x<l.x&&l.y>c.y&&u.y>d.y},n.Bounds.equals=(o,s,r)=>i.Point.equals(o,s,r)&&t.Dimension.equals(o,s,r),n.Bounds.left=o=>o.x,n.Bounds.centerX=o=>o.x+(o.width>=0?o.width*.5:0),n.Bounds.right=o=>o.x+o.width,n.Bounds.top=o=>o.y,n.Bounds.middle=o=>o.y+(o.height>=0?o.height*.5:0),n.Bounds.centerY=n.Bounds.middle,n.Bounds.bottom=o=>o.y+o.height,n.Bounds.topLeft=o=>({x:n.Bounds.left(o),y:n.Bounds.top(o)}),n.Bounds.topCenter=o=>({x:n.Bounds.centerX(o),y:n.Bounds.top(o)}),n.Bounds.topRight=o=>({x:n.Bounds.right(o),y:n.Bounds.top(o)}),n.Bounds.middleLeft=o=>({x:n.Bounds.left(o),y:n.Bounds.middle(o)}),n.Bounds.middleCenter=o=>({x:n.Bounds.centerX(o),y:n.Bounds.middle(o)}),n.Bounds.middleRight=o=>({x:n.Bounds.right(o),y:n.Bounds.middle(o)}),n.Bounds.bottomLeft=o=>({x:n.Bounds.left(o),y:n.Bounds.bottom(o)}),n.Bounds.bottomCenter=o=>({x:n.Bounds.centerX(o),y:n.Bounds.bottom(o)}),n.Bounds.bottomRight=o=>({x:n.Bounds.right(o),y:n.Bounds.bottom(o)}),n.Bounds.isAbove=(o,s)=>n.Bounds.top(o)<=n.Bounds.top(s),n.Bounds.isBelow=(o,s)=>n.Bounds.top(o)>=n.Bounds.top(s),n.Bounds.isBefore=(o,s)=>n.Bounds.left(o)<n.Bounds.left(s),n.Bounds.isAfter=(o,s)=>n.Bounds.left(o)>=n.Bounds.left(s),n.Bounds.sortBy=(o,...s)=>s.sort((r,d)=>o(r)-o(d)),n.Bounds.from=(o,s)=>({...o,width:s.x-o.x,height:s.y-o.y}),n.Bounds.position=n.Bounds.topLeft,n.Bounds.dimension=o=>({width:o.width,height:o.height}),n.Bounds.move=n.Bounds.translate,n.Bounds.resize=(o,s)=>({...o,width:o.width+s.width,height:o.height+s.height})}(Jb)),Jb}var td={},UL;function E$(){if(UL)return td;UL=1,Object.defineProperty(td,"__esModule",{value:!0}),td.DisposableCollection=td.Disposable=void 0;const e=nf(),n=vt();var t;(function(a){function o(d){return n.AnyObject.is(d)&&(0,n.hasFunctionProp)(d,"dispose")}a.is=o;function s(){return{dispose:()=>{}}}a.empty=s;function r(d){return{dispose:d}}a.create=r})(t||(td.Disposable=t={}));class i{constructor(...o){this.disposables=[],o.forEach(s=>this.push(s)),this.errorHandler=s=>console.error(s)}dispose(){var o,s;if(!this.disposed)try{for(;!this.disposed;)(o=this.disposables.pop())===null||o===void 0||o.dispose()}catch(r){(s=this.errorHandler)===null||s===void 0||s.call(this,r)}}get disposed(){return this.disposables.length===0}push(...o){const s=(0,e.isArrayOfType)(o,t.is)?o:o.map(t.create);return this.disposables.push(...s),t.create(()=>(0,e.remove)(this.disposables,...s))}get isDisposed(){return this.disposed}clear(){this.disposables.length=0}}return td.DisposableCollection=i,td}var Hp={},$L;function C$(){if($L)return Hp;$L=1,Object.defineProperty(Hp,"__esModule",{value:!0}),Hp.Movement=void 0;const e=MP(),n=RP(),t=vt();var i;return function(a){a.ZERO=Object.freeze({from:e.Point.ORIGIN,to:e.Point.ORIGIN,vector:n.Vector.ZERO,direction:[]});function o(l){return t.AnyObject.is(l)&&(0,t.hasObjectProp)(l,"from")&&e.Point.is(l.from)&&(0,t.hasObjectProp)(l,"to")&&e.Point.is(l.to)&&(0,t.hasObjectProp)(l,"vector")&&n.Vector.is(l.to)&&(0,t.hasObjectProp)(l,"direction")}a.is=o;function s(l){return n.Vector.isZero(l.vector)}a.isStationary=s;function r(l){return a.equals(l,a.ZERO)}a.isZero=r;function d(l,c){return e.Point.equals(l.from,c.from)&&e.Point.equals(l.to,c.to)&&n.Vector.equals(l.vector,c.vector)}a.equals=d}(i||(Hp.Movement=i={})),Hp}var YL;function AP(){return YL||(YL=1,function(e){var n=Vl&&Vl.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=Vl&&Vl.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(Pn(),e),t(zU(),e),t(UU(),e),t($U(),e),t(YU(),e),t(WU(),e),t(ZU(),e),t(QU(),e),t(JU(),e),t(XU(),e),t(e$(),e),t(t$(),e),t(n$(),e),t(i$(),e),t(r$(),e),t(o$(),e),t(s$(),e),t(n9(),e),t(a$(),e),t(c$(),e),t(u$(),e),t(l$(),e),t(A_(),e),t(d$(),e),t(e9(),e),t(CP(),e),t(f$(),e),t(i9(),e),t(p$(),e),t(g$(),e),t(m$(),e),t(v$(),e),t(y$(),e),t(_$(),e),t(b$(),e),t(S$(),e),t(r9(),e),t(MP(),e),t(nf(),e),t(E$(),e),t(SP(),e),t(C$(),e),t(o9(),e),t(RP(),e),t(PP(),e),t(vt(),e)}(Vl)),Vl}var WL;function P$(){return WL||(WL=1,function(e){var n=Hl&&Hl.__createBinding||(Object.create?function(F,K,U,Z){Z===void 0&&(Z=U);var ce=Object.getOwnPropertyDescriptor(K,U);(!ce||("get"in ce?!K.__esModule:ce.writable||ce.configurable))&&(ce={enumerable:!0,get:function(){return K[U]}}),Object.defineProperty(F,Z,ce)}:function(F,K,U,Z){Z===void 0&&(Z=U),F[Z]=K[U]}),t=Hl&&Hl.__exportStar||function(F,K){for(var U in F)U!=="default"&&!Object.prototype.hasOwnProperty.call(K,U)&&n(K,F,U)};Object.defineProperty(e,"__esModule",{value:!0}),e.SvgExporter=e.ExportSvgPostprocessor=e.ExportSvgKeyListener=e.ExportSvgCommand=e.isExpandable=e.expandFeature=e.isEdgeLayoutable=e.edgeLayoutFeature=e.checkEdgePlacement=e.DEFAULT_EDGE_PLACEMENT=e.DeleteContextMenuItemProvider=e.ContextMenuProviderRegistry=e.RevealNamedElementActionProvider=e.CommandPaletteActionProviderRegistry=e.GButton=e.configureButtonHandler=e.ButtonHandlerRegistry=e.layoutableChildFeature=e.layoutContainerFeature=e.isSizeable=e.isLayoutableChild=e.isLayoutContainer=e.isBoundsAware=e.isAlignable=e.getAbsoluteClientBounds=e.getAbsoluteBounds=e.findChildrenAtPosition=e.boundsFeature=e.alignFeature=e.GShapeElement=e.FocusFixPostprocessor=e.PopupMouseTool=e.MouseTool=e.MousePositionTracker=e.KeyTool=e.createFeatureSet=e.SModelRegistry=e.GModelFactory=e.EMPTY_ROOT=e.isParent=e.createRandomId=e.ModelIndexImpl=e.GParentElement=e.GModelRoot=e.GModelElement=e.GChildElement=e.onAction=e.configureActionHandler=e.ActionHandlerRegistry=e.ActionDispatcher=void 0,e.JumpingPolylineEdgeView=e.GRoutingHandleView=e.GLabelView=e.GCompartmentView=e.GBezierCreateHandleView=e.GBezierControlHandleView=e.BezierCurveEdgeView=e.SGraphImpl=e.SEdgeImpl=e.GPort=e.GNode=e.GLabel=e.GGraphIndex=e.GCompartment=e.GViewportRootElement=e.SprottySelectCommand=e.SprottySelectAllCommand=e.SelectMouseListener=e.SelectKeyboardListener=e.GetSelectionCommand=e.selectFeature=e.isSelected=e.isSelectable=e.isConnectable=e.getRouteBounds=e.getAbsoluteRouteBounds=e.edgeInProgressTargetHandleID=e.edgeInProgressID=e.connectableFeature=e.GRoutingHandle=e.GRoutableElement=e.GDanglingAnchor=e.GConnectableElement=e.isProjectable=e.getProjections=e.getProjectedBounds=e.getModelBounds=e.moveFeature=e.isMoveable=e.isLocateable=e.isDecoration=e.decorationFeature=e.SIssueMarkerImpl=e.GDecoration=e.popupFeature=e.isHoverable=e.hoverFeedbackFeature=e.hasPopupFeature=e.isFadeable=e.fadeFeature=void 0,e.SvgViewportView=e.RectangularNodeView=e.EmptyGroupView=e.RectangularPort=e.RectangularNode=e.GShapedPreRenderedElement=e.GPreRenderedElement=e.GHtmlRoot=e.GForeignObjectElement=e.DiamondNode=e.CircularPort=e.CircularNode=e.SGraphView=e.PolylineEdgeViewWithGapsOnIntersections=e.PolylineEdgeView=void 0,t(AP(),e),t(t9(),e);var i=Qy();Object.defineProperty(e,"ActionDispatcher",{enumerable:!0,get:function(){return i.ActionDispatcher}});var a=wm();Object.defineProperty(e,"ActionHandlerRegistry",{enumerable:!0,get:function(){return a.ActionHandlerRegistry}}),Object.defineProperty(e,"configureActionHandler",{enumerable:!0,get:function(){return a.configureActionHandler}}),Object.defineProperty(e,"onAction",{enumerable:!0,get:function(){return a.onAction}}),t(RC(),e),t(Qd(),e),t(eh(),e),t(MC(),e),t(sn(),e),t(br(),e),t(wC(),e),t(AC(),e),t(Im(),e),t(Jy(),e);var o=ft();Object.defineProperty(e,"GChildElement",{enumerable:!0,get:function(){return o.SChildElementImpl}}),Object.defineProperty(e,"GModelElement",{enumerable:!0,get:function(){return o.SModelElementImpl}}),Object.defineProperty(e,"GModelRoot",{enumerable:!0,get:function(){return o.SModelRootImpl}}),Object.defineProperty(e,"GParentElement",{enumerable:!0,get:function(){return o.SParentElementImpl}}),Object.defineProperty(e,"ModelIndexImpl",{enumerable:!0,get:function(){return o.ModelIndexImpl}}),Object.defineProperty(e,"createRandomId",{enumerable:!0,get:function(){return o.createRandomId}}),Object.defineProperty(e,"isParent",{enumerable:!0,get:function(){return o.isParent}});var s=Yc();Object.defineProperty(e,"EMPTY_ROOT",{enumerable:!0,get:function(){return s.EMPTY_ROOT}}),Object.defineProperty(e,"GModelFactory",{enumerable:!0,get:function(){return s.SModelFactory}}),Object.defineProperty(e,"SModelRegistry",{enumerable:!0,get:function(){return s.SModelRegistry}}),Object.defineProperty(e,"createFeatureSet",{enumerable:!0,get:function(){return s.createFeatureSet}}),t(gi(),e),t(Xy(),e),t(Tm(),e),t(th(),e);var r=za();Object.defineProperty(e,"KeyTool",{enumerable:!0,get:function(){return r.KeyTool}});var d=Wr();Object.defineProperty(e,"MousePositionTracker",{enumerable:!0,get:function(){return d.MousePositionTracker}}),Object.defineProperty(e,"MouseTool",{enumerable:!0,get:function(){return d.MouseTool}}),Object.defineProperty(e,"PopupMouseTool",{enumerable:!0,get:function(){return d.PopupMouseTool}}),t(DC(),e),t(ih(),e),t(jC(),e),t(OC(),e),t(LC(),e);var l=NC();Object.defineProperty(e,"FocusFixPostprocessor",{enumerable:!0,get:function(){return l.FocusFixPostprocessor}}),t(zn(),e),t(r_(),e),t(n_(),e),t(kC(),e),t(xC(),e),t(i_(),e);var c=Ft();Object.defineProperty(e,"GShapeElement",{enumerable:!0,get:function(){return c.SShapeElementImpl}}),Object.defineProperty(e,"alignFeature",{enumerable:!0,get:function(){return c.alignFeature}}),Object.defineProperty(e,"boundsFeature",{enumerable:!0,get:function(){return c.boundsFeature}}),Object.defineProperty(e,"findChildrenAtPosition",{enumerable:!0,get:function(){return c.findChildrenAtPosition}}),Object.defineProperty(e,"getAbsoluteBounds",{enumerable:!0,get:function(){return c.getAbsoluteBounds}}),Object.defineProperty(e,"getAbsoluteClientBounds",{enumerable:!0,get:function(){return c.getAbsoluteClientBounds}}),Object.defineProperty(e,"isAlignable",{enumerable:!0,get:function(){return c.isAlignable}}),Object.defineProperty(e,"isBoundsAware",{enumerable:!0,get:function(){return c.isBoundsAware}}),Object.defineProperty(e,"isLayoutContainer",{enumerable:!0,get:function(){return c.isLayoutContainer}}),Object.defineProperty(e,"isLayoutableChild",{enumerable:!0,get:function(){return c.isLayoutableChild}}),Object.defineProperty(e,"isSizeable",{enumerable:!0,get:function(){return c.isSizeable}}),Object.defineProperty(e,"layoutContainerFeature",{enumerable:!0,get:function(){return c.layoutContainerFeature}}),Object.defineProperty(e,"layoutableChildFeature",{enumerable:!0,get:function(){return c.layoutableChildFeature}}),t(FC(),e),t(Dm(),e);var u=Om();Object.defineProperty(e,"ButtonHandlerRegistry",{enumerable:!0,get:function(){return u.ButtonHandlerRegistry}}),Object.defineProperty(e,"configureButtonHandler",{enumerable:!0,get:function(){return u.configureButtonHandler}});var f=KC();Object.defineProperty(e,"GButton",{enumerable:!0,get:function(){return f.SButtonImpl}});var h=o_();Object.defineProperty(e,"CommandPaletteActionProviderRegistry",{enumerable:!0,get:function(){return h.CommandPaletteActionProviderRegistry}}),Object.defineProperty(e,"RevealNamedElementActionProvider",{enumerable:!0,get:function(){return h.RevealNamedElementActionProvider}}),t(VC(),e);var p=s_();Object.defineProperty(e,"ContextMenuProviderRegistry",{enumerable:!0,get:function(){return p.ContextMenuProviderRegistry}}),Object.defineProperty(e,"DeleteContextMenuItemProvider",{enumerable:!0,get:function(){return p.DeleteContextMenuItemProvider}}),t(GC(),e),t(im(),e),t(zC(),e);var g=sh();Object.defineProperty(e,"DEFAULT_EDGE_PLACEMENT",{enumerable:!0,get:function(){return g.DEFAULT_EDGE_PLACEMENT}}),Object.defineProperty(e,"checkEdgePlacement",{enumerable:!0,get:function(){return g.checkEdgePlacement}}),Object.defineProperty(e,"edgeLayoutFeature",{enumerable:!0,get:function(){return g.edgeLayoutFeature}}),Object.defineProperty(e,"isEdgeLayoutable",{enumerable:!0,get:function(){return g.isEdgeLayoutable}}),t(oh(),e),t(u_(),e),t($C(),e),t(Bm(),e),t(ah(),e),t(ZC(),e);var m=d_();Object.defineProperty(e,"expandFeature",{enumerable:!0,get:function(){return m.expandFeature}}),Object.defineProperty(e,"isExpandable",{enumerable:!0,get:function(){return m.isExpandable}}),t(_7(),e);var v=QC();Object.defineProperty(e,"ExportSvgCommand",{enumerable:!0,get:function(){return v.ExportSvgCommand}}),Object.defineProperty(e,"ExportSvgKeyListener",{enumerable:!0,get:function(){return v.ExportSvgKeyListener}}),Object.defineProperty(e,"ExportSvgPostprocessor",{enumerable:!0,get:function(){return v.ExportSvgPostprocessor}}),t(a_(),e);var _=f_();Object.defineProperty(e,"SvgExporter",{enumerable:!0,get:function(){return _.SvgExporter}}),t(h_(),e);var S=rh();Object.defineProperty(e,"fadeFeature",{enumerable:!0,get:function(){return S.fadeFeature}}),Object.defineProperty(e,"isFadeable",{enumerable:!0,get:function(){return S.isFadeable}}),t(JC(),e);var E=Xd();Object.defineProperty(e,"hasPopupFeature",{enumerable:!0,get:function(){return E.hasPopupFeature}}),Object.defineProperty(e,"hoverFeedbackFeature",{enumerable:!0,get:function(){return E.hoverFeedbackFeature}}),Object.defineProperty(e,"isHoverable",{enumerable:!0,get:function(){return E.isHoverable}}),Object.defineProperty(e,"popupFeature",{enumerable:!0,get:function(){return E.popupFeature}}),t(L7(),e),t(eP(),e);var C=p_();Object.defineProperty(e,"GDecoration",{enumerable:!0,get:function(){return C.SDecoration}}),Object.defineProperty(e,"SIssueMarkerImpl",{enumerable:!0,get:function(){return C.SIssueMarkerImpl}}),Object.defineProperty(e,"decorationFeature",{enumerable:!0,get:function(){return C.decorationFeature}}),Object.defineProperty(e,"isDecoration",{enumerable:!0,get:function(){return C.isDecoration}}),t(XC(),e),t(g_(),e),t(tP(),e),t(nP(),e);var M=Wc();Object.defineProperty(e,"isLocateable",{enumerable:!0,get:function(){return M.isLocateable}}),Object.defineProperty(e,"isMoveable",{enumerable:!0,get:function(){return M.isMoveable}}),Object.defineProperty(e,"moveFeature",{enumerable:!0,get:function(){return M.moveFeature}}),t(xm(),e),t(E7(),e),t(qC(),e),t(iP(),e),t(rP(),e);var L=m_();Object.defineProperty(e,"getModelBounds",{enumerable:!0,get:function(){return L.getModelBounds}}),Object.defineProperty(e,"getProjectedBounds",{enumerable:!0,get:function(){return L.getProjectedBounds}}),Object.defineProperty(e,"getProjections",{enumerable:!0,get:function(){return L.getProjections}}),Object.defineProperty(e,"isProjectable",{enumerable:!0,get:function(){return L.isProjectable}}),t(C7(),e),t(Lm(),e),t(Qc(),e),t(oP(),e),t(y_(),e),t(sP(),e),t(__(),e);var I=on();Object.defineProperty(e,"GConnectableElement",{enumerable:!0,get:function(){return I.SConnectableElementImpl}}),Object.defineProperty(e,"GDanglingAnchor",{enumerable:!0,get:function(){return I.SDanglingAnchorImpl}}),Object.defineProperty(e,"GRoutableElement",{enumerable:!0,get:function(){return I.SRoutableElementImpl}}),Object.defineProperty(e,"GRoutingHandle",{enumerable:!0,get:function(){return I.SRoutingHandleImpl}}),Object.defineProperty(e,"connectableFeature",{enumerable:!0,get:function(){return I.connectableFeature}}),Object.defineProperty(e,"edgeInProgressID",{enumerable:!0,get:function(){return I.edgeInProgressID}}),Object.defineProperty(e,"edgeInProgressTargetHandleID",{enumerable:!0,get:function(){return I.edgeInProgressTargetHandleID}}),Object.defineProperty(e,"getAbsoluteRouteBounds",{enumerable:!0,get:function(){return I.getAbsoluteRouteBounds}}),Object.defineProperty(e,"getRouteBounds",{enumerable:!0,get:function(){return I.getRouteBounds}}),Object.defineProperty(e,"isConnectable",{enumerable:!0,get:function(){return I.isConnectable}}),t(v_(),e),t(jm(),e),t(Os(),e),t(aP(),e);var R=Sr();Object.defineProperty(e,"isSelectable",{enumerable:!0,get:function(){return R.isSelectable}}),Object.defineProperty(e,"isSelected",{enumerable:!0,get:function(){return R.isSelected}}),Object.defineProperty(e,"selectFeature",{enumerable:!0,get:function(){return R.selectFeature}});var w=cP();Object.defineProperty(e,"GetSelectionCommand",{enumerable:!0,get:function(){return w.GetSelectionCommand}}),Object.defineProperty(e,"SelectKeyboardListener",{enumerable:!0,get:function(){return w.SelectKeyboardListener}}),Object.defineProperty(e,"SelectMouseListener",{enumerable:!0,get:function(){return w.SelectMouseListener}}),Object.defineProperty(e,"SprottySelectAllCommand",{enumerable:!0,get:function(){return w.SelectAllCommand}}),Object.defineProperty(e,"SprottySelectCommand",{enumerable:!0,get:function(){return w.SelectCommand}}),t(S_(),e),t(E_(),e),t(C_(),e),t($a(),e),t(b_(),e),t(Fm(),e);var T=c_();Object.defineProperty(e,"GViewportRootElement",{enumerable:!0,get:function(){return T.ViewportRootElementImpl}}),t(l_(),e),t(uP(),e);var j=ef();Object.defineProperty(e,"GCompartment",{enumerable:!0,get:function(){return j.SCompartmentImpl}}),Object.defineProperty(e,"GGraphIndex",{enumerable:!0,get:function(){return j.SGraphIndex}}),Object.defineProperty(e,"GLabel",{enumerable:!0,get:function(){return j.SLabelImpl}}),Object.defineProperty(e,"GNode",{enumerable:!0,get:function(){return j.SNodeImpl}}),Object.defineProperty(e,"GPort",{enumerable:!0,get:function(){return j.SPortImpl}}),Object.defineProperty(e,"SEdgeImpl",{enumerable:!0,get:function(){return j.SEdgeImpl}}),Object.defineProperty(e,"SGraphImpl",{enumerable:!0,get:function(){return j.SGraphImpl}});var D=k7();Object.defineProperty(e,"BezierCurveEdgeView",{enumerable:!0,get:function(){return D.BezierCurveEdgeView}}),Object.defineProperty(e,"GBezierControlHandleView",{enumerable:!0,get:function(){return D.SBezierControlHandleView}}),Object.defineProperty(e,"GBezierCreateHandleView",{enumerable:!0,get:function(){return D.SBezierCreateHandleView}}),Object.defineProperty(e,"GCompartmentView",{enumerable:!0,get:function(){return D.SCompartmentView}}),Object.defineProperty(e,"GLabelView",{enumerable:!0,get:function(){return D.SLabelView}}),Object.defineProperty(e,"GRoutingHandleView",{enumerable:!0,get:function(){return D.SRoutingHandleView}}),Object.defineProperty(e,"JumpingPolylineEdgeView",{enumerable:!0,get:function(){return D.JumpingPolylineEdgeView}}),Object.defineProperty(e,"PolylineEdgeView",{enumerable:!0,get:function(){return D.PolylineEdgeView}}),Object.defineProperty(e,"PolylineEdgeViewWithGapsOnIntersections",{enumerable:!0,get:function(){return D.PolylineEdgeViewWithGapsOnIntersections}}),Object.defineProperty(e,"SGraphView",{enumerable:!0,get:function(){return D.SGraphView}}),t(H7(),e),t(V7(),e),t(Ds(),e);var B=yP();Object.defineProperty(e,"CircularNode",{enumerable:!0,get:function(){return B.CircularNode}}),Object.defineProperty(e,"CircularPort",{enumerable:!0,get:function(){return B.CircularPort}}),Object.defineProperty(e,"DiamondNode",{enumerable:!0,get:function(){return B.DiamondNode}}),Object.defineProperty(e,"GForeignObjectElement",{enumerable:!0,get:function(){return B.ForeignObjectElementImpl}}),Object.defineProperty(e,"GHtmlRoot",{enumerable:!0,get:function(){return B.HtmlRootImpl}}),Object.defineProperty(e,"GPreRenderedElement",{enumerable:!0,get:function(){return B.PreRenderedElementImpl}}),Object.defineProperty(e,"GShapedPreRenderedElement",{enumerable:!0,get:function(){return B.ShapedPreRenderedElementImpl}}),Object.defineProperty(e,"RectangularNode",{enumerable:!0,get:function(){return B.RectangularNode}}),Object.defineProperty(e,"RectangularPort",{enumerable:!0,get:function(){return B.RectangularPort}}),t(K7(),e);var H=UC();Object.defineProperty(e,"EmptyGroupView",{enumerable:!0,get:function(){return H.EmptyGroupView}}),Object.defineProperty(e,"RectangularNodeView",{enumerable:!0,get:function(){return H.RectangularNodeView}}),Object.defineProperty(e,"SvgViewportView",{enumerable:!0,get:function(){return H.SvgViewportView}}),t(Nm(),e),t(z7(),e),t(tf(),e),t(Ts(),e),t(HC(),e),t(U7(),e),t(Zc(),e),t(Zd(),e),t(Wd(),e),t(Ua(),e),t(t_(),e),t(Ga(),e)}(Hl)),Hl}var xi={},ZL;function R$(){if(ZL)return xi;ZL=1;var e=xi&&xi.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h};Object.defineProperty(xi,"__esModule",{value:!0}),xi.applyHiddenBoundingRect=xi.hiddenBoundingRect=xi.CircularNodeView=xi.DiamondNodeView=void 0;const n=AP(),t=G(),i=P_();let a=class extends i.DiamondNodeView{render(l,c,u){return r(l,c,super.render(l,c,u))}};xi.DiamondNodeView=a,xi.DiamondNodeView=a=e([(0,t.injectable)()],a);let o=class extends i.CircularNodeView{render(l,c,u){return r(l,c,super.render(l,c,u))}};xi.CircularNodeView=o,xi.CircularNodeView=o=e([(0,t.injectable)()],o);function s(d,l){return!l||l.targetKind==="hidden"?(0,i.svg)("rect",{attrs:{[i.ATTR_BBOX_ELEMENT]:!0},...n.Bounds.dimension(d.bounds),style:{fill:"transparent"}}):void 0}xi.hiddenBoundingRect=s;function r(d,l,c){var u;if(c&&l.targetKind==="hidden"){const f=c.sel==="g"?c:(0,i.svg)("g",null,c);return(u=f.children)===null||u===void 0||u.unshift(s(d)),f}return c}return xi.applyHiddenBoundingRect=r,xi}var Vp={},QL;function M$(){if(QL)return Vp;QL=1,Object.defineProperty(Vp,"__esModule",{value:!0}),Vp.TYPES=void 0;const e=P_(),n=Symbol("IGModelRootListener");return Vp.TYPES={...e.TYPES,EmptyArray:Symbol("EmptyArray"),ActionHandlerRegistryProvider:e.TYPES.ActionHandlerRegistryProvider,IAsyncClipboardService:Symbol("IAsyncClipboardService"),IEditorContextServiceProvider:Symbol("IEditorContextProvider"),IFeedbackActionDispatcher:Symbol("IFeedbackActionDispatcher"),IToolFactory:Symbol("Factory<Tool>"),ITypeHintProvider:Symbol("ITypeHintProvider"),IMovementRestrictor:Symbol("IMovementRestrictor"),IMovementOptions:Symbol("IMovementOptions"),ISelectionListener:Symbol("ISelectionListener"),ISModelRootListener:n,IGModelRootListener:n,IContextMenuProvider:Symbol("IContextMenuProvider"),ICopyPasteHandler:Symbol("ICopyPasteHandler"),ITool:Symbol("ITool"),IDefaultTool:Symbol("IDefaultTool"),IEditModeListener:Symbol("IEditModeListener"),IMarqueeBehavior:Symbol("IMarqueeBehavior"),IHelperLineManager:Symbol("IHelperLineManager"),IHelperLineOptions:Symbol("IHelperLineOptions"),IElementNavigator:Symbol("IElementNavigator"),ILocalElementNavigator:Symbol("ILocalElementNavigator"),IDiagramOptions:Symbol("IDiagramOptions"),IDiagramStartup:Symbol("IDiagramStartup"),IToolManager:Symbol("IToolManager"),IContainerManager:Symbol("IContainerManager"),IChangeBoundsManager:Symbol("IChangeBoundsManager"),IGridManager:Symbol("IGridManager"),IDebugManager:Symbol("IDebugManager"),Grid:Symbol("Grid")},Vp}var JL;function Y(){return JL||(JL=1,function(e){var n=Pl&&Pl.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=Pl&&Pl.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(_U(),e),t(GU(),e),t(P$(),e),t(R$(),e),t(M$(),e)}(Pl)),Pl}var yo={},XL;function wP(){if(XL)return yo;XL=1;var e=yo&&yo.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=yo&&yo.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t=yo&&yo.__param||function(s,r){return function(d,l){r(d,l,s)}};Object.defineProperty(yo,"__esModule",{value:!0}),yo.GLSPActionHandlerRegistry=void 0;const i=Y(),a=G();let o=class extends i.ActionHandlerRegistry{constructor(r,d){super(r,d),this.initialized=!1}getHandledActionKinds(){return Array.from(this.elements.keys())}initialize(){this.initialized||(this.lazyInjector.getAll(i.TYPES.ActionHandlerRegistration).forEach(r=>this.register(r.actionKind,r.factory())),this.lazyInjector.getAll(i.TYPES.IActionHandlerInitializer).forEach(r=>this.initializeActionHandler(r)))}};return yo.GLSPActionHandlerRegistry=o,e([(0,a.inject)(i.LazyInjector),n("design:type",Object)],o.prototype,"lazyInjector",void 0),yo.GLSPActionHandlerRegistry=o=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.EmptyArray)),t(1,(0,a.inject)(i.TYPES.EmptyArray)),n("design:paramtypes",[Array,Array])],o),yo}var sr={},e5;function ch(){if(e5)return sr;e5=1;var e=sr&&sr.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=sr&&sr.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(sr,"__esModule",{value:!0}),sr.GLSPModelSource=sr.OptionalAction=sr.ServerAction=void 0;const t=Y(),i=G();var a;(function(r){function d(c){return t.Action.is(c)&&"__receivedFromServer"in c&&c.__receivedFromServer===!0}r.is=d;function l(c){c.__receivedFromServer=!0}r.mark=l})(a||(sr.ServerAction=a={}));var o;(function(r){function d(c){return t.Action.is(c)&&"__skipErrorIfNoHandler"in c&&c.__skipErrorIfNoHandler===!0}r.is=d;function l(c){return c.__skipErrorIfNoHandler=!0,c}r.mark=l})(o||(sr.OptionalAction=o={}));let s=class extends t.ModelSource{constructor(){super(...arguments),this.toDispose=new t.DisposableCollection}get diagramType(){return this.options.diagramType}get sourceUri(){return this.options.sourceUri}configure(d){if(this.glspClient=d,!d.initializeResult)throw new Error("Could not configure model source. The GLSP client is not initialized yet!");const l=this.createInitializeClientSessionParameters(d.initializeResult);return this.configureServeActions(d.initializeResult),this.toDispose.push(d.onActionMessage(c=>this.messageReceived(c),this.clientId),t.Disposable.create(()=>d.disposeClientSession(this.createDisposeClientSessionParameters()))),d.initializeClientSession(l)}createInitializeClientSessionParameters(d){const l=this.registry.getHandledActionKinds();return{clientSessionId:this.clientId,clientActionKinds:l,diagramType:this.diagramType}}createDisposeClientSessionParameters(){return{clientSessionId:this.clientId}}configureServeActions(d){const l=d.serverActions[this.diagramType];if((l==null?void 0:l.length)===0)throw new Error(`No server-handled actions could be derived from the initialize result for diagramType: ${this.diagramType}!`);l.forEach(c=>this.registry.register(c,this))}messageReceived(d){if(this.clientId!==d.clientId)return;const l=d.action;a.mark(l),this.logger.log(this,"receiving",l),this.actionDispatcher.dispatch(l)}initialize(d){var l;this.clientId||(this.clientId=(l=this.options.clientId)!==null&&l!==void 0?l:this.viewerOptions.baseDiv),this.registry=d}handle(d){this.shouldForwardToServer(d)&&this.forwardToServer(d)}forwardToServer(d){const l={clientId:this.clientId,action:d};if(this.logger.log(this,"sending",l),this.glspClient)this.glspClient.sendActionMessage(l);else throw new Error("GLSPClient is not connected")}shouldForwardToServer(d){return!a.is(d)}commitModel(d){return this._currentRoot=d,d}get model(){return this._currentRoot}dispose(){this.toDispose.dispose()}};return sr.GLSPModelSource=s,e([(0,i.inject)(t.TYPES.ILogger),n("design:type",Object)],s.prototype,"logger",void 0),e([(0,i.inject)(t.TYPES.IDiagramOptions),n("design:type",Object)],s.prototype,"options",void 0),e([(0,i.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],s.prototype,"dispose",null),sr.GLSPModelSource=s=e([(0,i.injectable)()],s),sr}var Cs={},t5;function w_(){if(t5)return Cs;t5=1;var e=Cs&&Cs.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Cs,"__esModule",{value:!0}),Cs.DefaultModelInitializationConstraint=Cs.ModelInitializationConstraint=void 0;const n=G(),t=Y();let i=class{constructor(){this.completion=new t.Deferred,this._isCompleted=!1,this.onInitializedEmitter=new t.Emitter}get isCompleted(){return this._isCompleted}onInitialized(s){return s?this.isCompleted?(s(),t.Disposable.empty()):this.onInitializedEmitter.event(s):this.completion.promise}setCompleted(){this.isCompleted||(this._isCompleted=!0,this.completion.resolve(),this.onInitializedEmitter.fire(),this.onInitializedEmitter.dispose())}notifyDispatched(s){this.isCompleted||this.isInitializedAfter(s)&&this.setCompleted()}};Cs.ModelInitializationConstraint=i,Cs.ModelInitializationConstraint=i=e([(0,n.injectable)()],i);let a=class extends i{constructor(){super(...arguments),this.seenNonEmptyModelAction=!1}isInitializedAfter(s){if(this.isNonEmptyModelAction(s))this.seenNonEmptyModelAction=!0;else if(this.seenNonEmptyModelAction&&s.kind===t.InitializeCanvasBoundsAction.KIND)return!0;return!1}isNonEmptyModelAction(s){return t.SetModelAction.is(s)||t.UpdateModelAction.is(s)?s.newRoot.type!=="NONE":!1}};return Cs.DefaultModelInitializationConstraint=a,Cs.DefaultModelInitializationConstraint=a=e([(0,n.injectable)()],a),Cs}var n5;function s9(){if(n5)return Bs;n5=1;var e=Bs&&Bs.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=Bs&&Bs.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)};Object.defineProperty(Bs,"__esModule",{value:!0}),Bs.GLSPActionDispatcher=void 0;const t=Y(),i=G(),a=wP(),o=ch(),s=w_();let r=class extends t.ActionDispatcher{constructor(){super(...arguments),this.timeouts=new Map,this.initializedConstraint=!1,this.postUpdateQueue=[],this.initializeDeferred=new t.Deferred}initialize(){return this.initialized||(this.initialized=this.initializeDeferred.promise,this.doInitialize()),this.initialized}async doInitialize(){try{this.actionHandlerRegistry instanceof a.GLSPActionHandlerRegistry&&this.actionHandlerRegistry.initialize(),this.handleAction(t.SetModelAction.create(t.EMPTY_ROOT)).catch(()=>{}),this.startModelInitialization(),this.initializeDeferred.resolve()}catch(l){this.initializeDeferred.reject(l)}}startModelInitialization(){this.initializedConstraint||(this.logger.log(this,"Starting model initialization mode"),this.initializationConstraint.onInitialized(()=>this.logger.log(this,"Model initialization completed")),this.initializedConstraint=!0)}onceModelInitialized(){return this.initializationConstraint.onInitialized()}hasHandler(l){return this.actionHandlerRegistry.get(l.kind).length>0}dispatchOnceModelInitialized(...l){this.initializationConstraint.onInitialized(()=>this.dispatchAll(l))}dispatchAfterNextUpdate(...l){this.postUpdateQueue.push(...l)}modelRootChanged(l){if(this.postUpdateQueue.length===0)return;const c=[...this.postUpdateQueue];this.postUpdateQueue=[],this.dispatchAll(c)}async dispatch(l){const c=await super.dispatch(l);return this.initializationConstraint.notifyDispatched(l),c}handleAction(l){if(t.ResponseAction.hasValidResponseId(l)){const c=this.timeouts.get(l.responseId);c!==void 0&&(clearTimeout(c),this.timeouts.delete(l.responseId)),this.requests.get(l.responseId)===void 0&&(l.responseId="")}return!this.hasHandler(l)&&o.OptionalAction.is(l)?Promise.resolve():super.handleAction(l)}request(l){return!l.requestId&&l.requestId===""&&(l.requestId=t.RequestAction.generateRequestId()),super.request(l)}requestUntil(l,c=2e3,u=!1){!l.requestId&&l.requestId===""&&(l.requestId=t.RequestAction.generateRequestId());const f=l.requestId,h=setTimeout(()=>{const p=this.requests.get(f);if(p!==void 0){clearTimeout(h),this.requests.delete(f);const g="Request "+f+" ("+l+") time out after "+c+"ms.";u?p.reject(g):(this.logger.info(this,g),p.resolve())}},c);return this.timeouts.set(f,h),super.request(l)}};return Bs.GLSPActionDispatcher=r,e([(0,i.inject)(s.ModelInitializationConstraint),n("design:type",s.ModelInitializationConstraint)],r.prototype,"initializationConstraint",void 0),e([(0,i.inject)(t.ActionHandlerRegistry),n("design:type",t.ActionHandlerRegistry)],r.prototype,"actionHandlerRegistry",void 0),e([(0,i.inject)(t.TYPES.ActionHandlerRegistryProvider),n("design:type",Function)],r.prototype,"actionHandlerRegistryProvider",void 0),Bs.GLSPActionDispatcher=r=e([(0,i.injectable)()],r),Bs}var tS={},i5;function Vm(){return i5||(i5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ensureArgs=e.hasArgs=e.isArgsAware=e.argsFeature=void 0,e.argsFeature=Symbol("argsFeature");function n(a){return a!==void 0&&a.hasFeature(e.argsFeature)}e.isArgsAware=n;function t(a){return a!==void 0&&n(a)&&a.args!==void 0}e.hasArgs=t;function i(a){return n(a)?(a.args===void 0&&(a.args={}),!0):!1}e.ensureArgs=i}(tS)),tS}var Gp={},r5;function a9(){if(r5)return Gp;r5=1,Object.defineProperty(Gp,"__esModule",{value:!0}),Gp.AutoCompleteValue=void 0;const e=Y();var n;return function(t){function i(a){return e.LabeledAction.is(a)&&(0,e.hasStringProp)(a,"text")}t.is=i}(n||(Gp.AutoCompleteValue=n={})),Gp}var nd={},id={},o5;function c9(){if(o5)return id;o5=1,Object.defineProperty(id,"__esModule",{value:!0}),id.ValidationDecorator=id.IValidationDecorator=void 0;const e=Y();var n;(function(i){i.NO_DECORATION={decorateValidationResult(a){},isValidatedOk(){return!1},invalidate(){},dispose(){}}})(n||(id.IValidationDecorator=n={}));class t{constructor(a){this.containerElement=a,this.warningClasses=["warning"],this.warningIconClasses=(0,e.codiconCSSString)("warning"),this.errorClasses=["error"],this.errorIconClasses=(0,e.codiconCSSString)("error"),this.isValidated=!1,this.hasValidationError=!1}decorateValidationResult(a){e.ValidationStatus.isError(a)?(this.hasValidationError=!0,this.decorateError(a.message?a.message:"Error")):e.ValidationStatus.isWarning(a)?(this.hasValidationError=!1,this.decorateWarning(a.message?a.message:"Warning")):(this.hasValidationError=!1,this.dispose()),this.isValidated=!0}decorateError(a){this.switchCssClasses(this.containerElement,this.errorClasses);const o=this.createDecorationDiv();this.switchCssClasses(o,this.errorClasses),o.innerHTML=`<span class="${this.errorIconClasses}"></span> ${a}`,this.adjustPosition()}decorateWarning(a){this.switchCssClasses(this.containerElement,this.warningClasses);const o=this.createDecorationDiv();this.switchCssClasses(o,this.warningClasses),o.innerHTML=`<span class="${this.warningIconClasses}"></span> ${a}`,this.adjustPosition()}switchCssClasses(a,o){a.classList.remove(...this.errorClasses,...this.warningClasses),a.classList.add(...o)}createDecorationDiv(){return this.decorationDiv||(this.containerElement.classList.add("validation"),this.decorationDiv=document.createElement("div"),this.decorationDiv.style.width=`${this.decorationContainerWidth()}px`,this.decorationDiv.classList.add("validation-decorator"),this.containerElement.appendChild(this.decorationDiv)),this.decorationDiv}decorationContainerWidth(){return this.containerElement.clientWidth-5}adjustPosition(){if(this.decorationDiv){const a=this.decorationDiv.clientHeight+2;this.decorationDiv.style.top=`-${a}px`}}isValidatedOk(){return this.isValidated&&!this.hasValidationError}invalidate(){this.isValidated=!1}dispose(){this.hasValidationError=!1,this.isValidated=!1,this.decorationDiv&&this.containerElement&&this.containerElement.contains(this.decorationDiv)&&(this.containerElement.removeChild(this.decorationDiv),this.switchCssClasses(this.containerElement,[]),this.decorationDiv=void 0)}}return id.ValidationDecorator=t,id}var s5;function IP(){if(s5)return nd;s5=1,Object.defineProperty(nd,"__esModule",{value:!0}),nd.toActionArray=nd.AutoCompleteWidget=void 0;const e=Y(),n=a9(),t=c9(),i=v7();class a{constructor(r,d,l,c=()=>{},u,f){this.autoSuggestionSettings=r,this.suggestionProvider=d,this.suggestionSubmitHandler=l,this.notifyClose=c,this.logger=u,this.options=f,this.loadingIndicatorClasses=(0,e.codiconCSSClasses)("loading",!1,!0,["loading"]),this.validationDecorator=t.IValidationDecorator.NO_DECORATION}configureValidation(r,d=t.IValidationDecorator.NO_DECORATION){this.inputValidator=r,this.validationDecorator=d}configureTextSubmitHandler(r){this.textSubmitHandler=r}initialize(r){this.containerElement=r,this.inputElement=this.createInputElement(),this.containerElement.appendChild(this.inputElement),this.containerElement.style.position="absolute"}createInputElement(){const r=document.createElement("input");return r.style.position="absolute",r.spellcheck=!1,r.autocapitalize="false",r.autocomplete="off",r.style.width="100%",r.addEventListener("keydown",d=>this.handleKeyDown(d)),r.addEventListener("blur",()=>{this.containerElement.style.visibility!=="hidden"&&window.setTimeout(()=>this.notifyClose("blur"),200)}),r}handleKeyDown(r){if((0,e.matchesKeystroke)(r,"Escape")){this.notifyClose("escape");return}if(!((0,e.matchesKeystroke)(r,"Enter")&&!this.isInputElementChanged()&&this.isSuggestionAvailable())&&(this.isInputElementChanged()&&this.invalidateValidationResultAndContextActions(),!(!(0,e.matchesKeystroke)(r,"Enter")||this.isSuggestionAvailable()))){if(!this.validationDecorator.isValidatedOk()){r.stopImmediatePropagation();return}this.textSubmitHandler&&(this.executeFromTextOnlyInput(),this.notifyClose("submission"))}}isInputElementChanged(){return this.inputElement.value!==this.previousContent}invalidateValidationResultAndContextActions(){this.contextActions=void 0,this.validationDecorator.invalidate()}open(r,...d){this.contextActions=void 0,this.autoCompleteResult=i(this.autocompleteSettings(r)),this.previousContent=this.inputElement.value,this.inputElement.setSelectionRange(0,this.inputElement.value.length),this.inputElement.focus()}autocompleteSettings(r){return{input:this.inputElement,emptyMsg:this.autoSuggestionSettings.noSuggestionsMessage,className:this.autoSuggestionSettings.suggestionsClass,showOnFocus:this.autoSuggestionSettings.showOnFocus,debounceWaitMs:this.autoSuggestionSettings.debounceWaitMs,minLength:-1,fetch:(d,l)=>this.updateSuggestions(l,d,r),onSelect:d=>this.onSelect(d),render:(d,l)=>this.renderSuggestions(d,l),customize:(d,l,c,u)=>{this.customizeInputElement(d,l,c,u)}}}customizeInputElement(r,d,l,c){var u;if(l.style.position="fixed",this.containerElement&&(this.containerElement.appendChild(l),this.options&&this.options.selectedSuggestionChanged)){const f=l.querySelector(".selected");if(f!=null){const h=Array.from(l.children).indexOf(f);this.options.selectedSuggestionChanged((u=this.contextActions)===null||u===void 0?void 0:u[h])}else this.options.selectedSuggestionChanged(void 0)}}updateSuggestions(r,d,l,...c){this.onLoading(),this.doUpdateSuggestions(d,l).then(u=>{var f,h;this.contextActions=this.filterActions(d,u),r(this.contextActions),(h=(f=this.options)===null||f===void 0?void 0:f.visibleSuggestionsChanged)===null||h===void 0||h.call(f,this.contextActions),this.onLoaded("success")}).catch(u=>{this.logger&&this.logger.error(this,"Failed to obtain suggestions",u),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}doUpdateSuggestions(r,d,...l){return this.suggestionProvider.provideSuggestions(r)}onLoaded(r){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator),this.validationDecorator.invalidate(),this.validateInputIfNoContextActions(),this.previousContent=this.inputElement.value}renderSuggestions(r,d){const l=document.createElement("div"),c=this.escapeForRegExp(d).split(" ").join("|"),u=new RegExp(c,"gi");return r.icon&&this.renderIcon(l,r.icon),l.innerHTML+=r.label.replace(u,f=>"<em>"+f+"</em>").replace(/ /g,"&nbsp;"),l}escapeForRegExp(r){return r.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}renderIcon(r,d){r.innerHTML+=`<span class="icon ${d}"></span>`}filterActions(r,d){return(0,e.toArray)(d.filter(l=>{const c=l.label.toLowerCase();return r.split(" ").every(f=>c.indexOf(f.toLowerCase())!==-1)}))}onSelect(r){n.AutoCompleteValue.is(r)?(this.inputElement.value=r.text,window.setTimeout(()=>this.inputElement.dispatchEvent(new Event("input")))):(this.executeFromSuggestion(r),this.notifyClose("submission"))}validateInputIfNoContextActions(){this.isNoOrExactlyOneMatchingContextAction()?this.validateInput():this.validationDecorator.dispose()}isNoOrExactlyOneMatchingContextAction(){return!this.isSuggestionAvailable()||this.contextActions&&this.contextActions.length===1&&this.inputElement.value.endsWith(this.contextActions[0].label)}isSuggestionAvailable(){return this.contextActions&&this.contextActions.length>0}validateInput(){this.inputValidator&&this.inputValidator.validate(this.inputElement.value).then(r=>this.validationDecorator.decorateValidationResult(r)).catch(r=>this.handleErrorDuringValidation(r))}handleErrorDuringValidation(r){this.logger&&this.logger.error(this,"Failed to validate input",r),this.validationDecorator.dispose()}executeFromSuggestion(r){this.suggestionSubmitHandler.executeFromSuggestion(r)}executeFromTextOnlyInput(){this.textSubmitHandler&&this.textSubmitHandler.executeFromTextOnlyInput(this.inputElement.value)}get inputField(){return this.inputElement}dispose(){this.validationDecorator.dispose(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}}nd.AutoCompleteWidget=a;function o(s){return e.LabeledAction.is(s)?s.actions:e.Action.is(s)?[s]:[]}return nd.toActionArray=o,nd}var nS={},a5;function A$(){return a5||(a5=1,Object.defineProperty(nS,"__esModule",{value:!0})),nS}var Ac={},zp={},c5;function Ya(){return c5||(c5=1,function(e){var n=zp&&zp.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(e,"__esModule",{value:!0}),e.GLSPAbstractUIExtension=e.CSS_HIDDEN_EXTENSION_CLASS=e.CSS_UI_EXTENSION_CLASS=void 0;const t=Y(),i=G();e.CSS_UI_EXTENSION_CLASS="ui-extension",e.CSS_HIDDEN_EXTENSION_CLASS="hidden";let a=class extends t.AbstractUIExtension{get diagramContainerId(){return this.options.baseDiv}get parentContainerSelector(){return"#"+this.diagramContainerId}get containerSelector(){return"#"+this.id()}get initialized(){return!!this.containerElement}initialize(){if(this.initialized)return!0;try{this.containerElement=this.getOrCreateContainer(),this.initializeContainer(this.containerElement),this.initializeContents(this.containerElement)}catch(s){const r=s instanceof Error?s.message:`Could not retrieve container element for UI extension ${this.id}`;return this.logger.error(this,r),!1}return!0}getOrCreateContainer(){if(this.containerElement)return this.containerElement;const s=this.getContainer();if(s)return s;const r=this.getParentContainer();if(!(r!=null&&r.isConnected))throw new Error(`Could not obtain attached parent for initializing UI extension ${this.id}`);const d=this.createContainer(r);return this.insertContainerIntoParent(d,r),d}getContainer(){return document.querySelector(this.containerSelector)}createContainer(s){const r=document.createElement("div");return r.id=s.id+"_"+this.id(),r}initializeContainer(s){s.classList.add(e.CSS_UI_EXTENSION_CLASS,this.containerClass())}getParentContainer(){return document.querySelector(this.parentContainerSelector)}insertContainerIntoParent(s,r){r.insertBefore(s,r.firstChild)}setContainerVisible(s){var r,d;s?(r=this.containerElement)===null||r===void 0||r.classList.remove(e.CSS_HIDDEN_EXTENSION_CLASS):(d=this.containerElement)===null||d===void 0||d.classList.add(e.CSS_HIDDEN_EXTENSION_CLASS)}isContainerVisible(){var s;return!(!((s=this.containerElement)===null||s===void 0)&&s.classList.contains(e.CSS_HIDDEN_EXTENSION_CLASS))}toggleContainerVisible(){this.setContainerVisible(!this.isContainerVisible())}};e.GLSPAbstractUIExtension=a,e.GLSPAbstractUIExtension=a=n([(0,i.injectable)()],a)}(zp)),zp}var u5;function u9(){if(u5)return Ac;u5=1;var e=Ac&&Ac.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Ac&&Ac.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Ac,"__esModule",{value:!0}),Ac.BaseAutocompletePalette=void 0;const t=Y(),i=G(),a=Ya(),o=IP();class s extends a.GLSPAbstractUIExtension{constructor(){super(...arguments),this.autoSuggestionSettings={noSuggestionsMessage:"No suggestions available",suggestionsClass:"command-palette-suggestions",debounceWaitMs:50,showOnFocus:!0}}containerClass(){return"autocomplete-palette"}show(d,...l){super.show(d,...l),this.root=d,this.autocompleteWidget.open(d)}hide(){var d;(d=this.autocompleteWidget)===null||d===void 0||d.dispose(),this.root=void 0,super.hide()}initializeContents(d){d.classList.add("command-palette"),this.autocompleteWidget=new o.AutoCompleteWidget(this.autoSuggestionSettings,{provideSuggestions:l=>this.retrieveSuggestions(this.root,l)},{executeFromSuggestion:l=>this.executeSuggestion(l)},l=>this.autocompleteHide(l),this.logger,{visibleSuggestionsChanged:l=>this.visibleSuggestionsChanged(this.root,l),selectedSuggestionChanged:l=>this.selectedSuggestionChanged(this.root,l)}),this.autocompleteWidget.initialize(d)}async visibleSuggestionsChanged(d,l){}async selectedSuggestionChanged(d,l){}autocompleteHide(d){this.hide()}executeSuggestion(d){this.actionDispatcher.dispatchAll((0,o.toActionArray)(d))}}return Ac.BaseAutocompletePalette=s,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),Ac}var oa={},sa={},aa={},Up={},l5;function of(){if(l5)return Up;l5=1,Object.defineProperty(Up,"__esModule",{value:!0}),Up.FocusStateChangedAction=void 0;const e=Y();var n;return function(t){t.KIND="focusStateChanged";function i(o){return e.Action.hasKind(o,t.KIND)&&(0,e.hasBooleanProp)(o,"hasFocus")}t.is=i;function a(o=!0){return{kind:t.KIND,hasFocus:o}}t.create=a}(n||(Up.FocusStateChangedAction=n={})),Up}var d5;function Gm(){if(d5)return aa;d5=1;var e=aa&&aa.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=aa&&aa.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(aa,"__esModule",{value:!0}),aa.FocusTracker=void 0;const t=Y(),i=G(),a=of();let o=class{constructor(){this.inActiveCssClass="inactive",this._hasFocus=!0,this.onFocusChangedEmitter=new t.Emitter}get onFocusChanged(){return this.onFocusChangedEmitter.event}get hasFocus(){return this._hasFocus}get focusElement(){return this._focusElement}get diagramElement(){return this._diagramElement}handle(r){a.FocusStateChangedAction.is(r)&&(this._hasFocus=r.hasFocus,this._focusElement=document.activeElement,this._diagramElement=document.getElementById(this.options.baseDiv),this._diagramElement&&(this.hasFocus?this._diagramElement.classList.contains(this.inActiveCssClass)&&this._diagramElement.classList.remove(this.inActiveCssClass):this._diagramElement.classList.add(this.inActiveCssClass),this.onFocusChangedEmitter.fire({hasFocus:this.hasFocus,focusElement:this.focusElement,diagramElement:this.diagramElement})))}};return aa.FocusTracker=o,e([(0,i.inject)(t.TYPES.ViewerOptions),n("design:type",Object)],o.prototype,"options",void 0),aa.FocusTracker=o=e([(0,i.injectable)()],o),aa}var dn={},iS={},f5;function kt(){return f5||(f5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.removeDescendants=e.isNotDescendantOfAnyElement=e.getDescendantIds=e.isVisibleOnCanvas=e.calculateDeltaBetweenPoints=e.findTopLevelElementByFeature=e.getElementTypeId=e.calcRoute=e.calcElementAndRoute=e.calcElementAndRoutingPoints=e.ROUTE_KINDS=e.ROUTING_POINT_KINDS=e.ALL_ROUTING_POINTS=e.toElementAndRoutingPoints=e.toElementAndBounds=e.isSelectableAndBoundsAware=e.isRoutingHandle=e.isRoutable=e.isNonRoutableBoundsAware=e.isNonRoutableSelectedBoundsAware=e.isNonRoutableMovableBoundsAware=e.isNonRoutableSelectedMovableBoundsAware=e.toggleCssClass=e.removeCssClassOfElements=e.addCssClassToElements=e.removeCssClasses=e.addCssClasses=e.isNotUndefined=e.hasSelectedElements=e.getSelectedElementCount=e.getElements=e.getMatchingElements=e.forEachElement=e.filter=void 0;const n=Y();function t(K,U){return K.all().filter(U)}e.filter=t;function i(K,U,Z){t(K,U).forEach(Z)}e.forEachElement=i;function a(K,U){return Array.from(t(K,U))}e.getMatchingElements=a;function o(K,U,Z){const ce=de=>de!==void 0?Z?Z(de):!0:!1;return U.map(de=>K.getById(de)).filter(ce)}e.getElements=o;function s(K){let U=0;return i(K,n.isSelected,Z=>U++),U}e.getSelectedElementCount=s;function r(K){return s(K)>0}e.hasSelectedElements=r;function d(K){return K!==void 0}e.isNotUndefined=d;function l(K,...U){var Z;const ce=Array.isArray(U[0])?U[0]:U,de=(Z=K.cssClasses)!==null&&Z!==void 0?Z:[];(0,n.distinctAdd)(de,...ce),K.cssClasses=de}e.addCssClasses=l;function c(K,...U){if(!K.cssClasses||K.cssClasses.length===0)return;const Z=Array.isArray(U[0])?U[0]:U;(0,n.remove)(K.cssClasses,...Z)}e.removeCssClasses=c;function u(K,...U){for(const Z of K)l(Z,U)}e.addCssClassToElements=u;function f(K,...U){for(const Z of K)c(Z,U)}e.removeCssClassOfElements=f;function h(K,U,Z){return Z?l(K,U):c(K,U)}e.toggleCssClass=h;function p(K){return m(K)&&(0,n.isMoveable)(K)}e.isNonRoutableSelectedMovableBoundsAware=p;function g(K){return v(K)&&(0,n.isMoveable)(K)}e.isNonRoutableMovableBoundsAware=g;function m(K){return v(K)&&(0,n.isSelected)(K)}e.isNonRoutableSelectedBoundsAware=m;function v(K){return(0,n.isBoundsAware)(K)&&!_(K)}e.isNonRoutableBoundsAware=v;function _(K){return K instanceof n.GRoutableElement&&K.routingPoints!==void 0}e.isRoutable=_;function S(K){return K!==void 0&&K instanceof n.GRoutingHandle}e.isRoutingHandle=S;function E(K){return(0,n.isSelectable)(K)&&(0,n.isBoundsAware)(K)}e.isSelectableAndBoundsAware=E;function C(K){return{elementId:K.id,newPosition:{x:K.bounds.x,y:K.bounds.y},newSize:{width:K.bounds.width,height:K.bounds.height}}}e.toElementAndBounds=C;function M(K){return{elementId:K.id,newRoutingPoints:K.routingPoints}}e.toElementAndRoutingPoints=M,e.ALL_ROUTING_POINTS=void 0,e.ROUTING_POINT_KINDS=["linear","bezier-junction"],e.ROUTE_KINDS=[...e.ROUTING_POINT_KINDS,"source","target"];function L(K,U){const Z=U?R(K,U,e.ROUTING_POINT_KINDS):K.routingPoints;return{elementId:K.id,newRoutingPoints:Z}}e.calcElementAndRoutingPoints=L;function I(K,U){var Z,ce;let de=U?R(K,U,e.ROUTE_KINDS):void 0;return de||(de=[...K.routingPoints],de.splice(0,0,((Z=K.source)===null||Z===void 0?void 0:Z.position)||n.Point.ORIGIN),de.push(((ce=K.target)===null||ce===void 0?void 0:ce.position)||n.Point.ORIGIN)),{elementId:K.id,newRoutingPoints:de}}e.calcElementAndRoute=I;function R(K,U,Z=e.ALL_ROUTING_POINTS,ce=Number.EPSILON){const de=U.get(K.routerKind).route(K),ke=[];for(const pe of de)Z&&!Z.includes(pe.kind)||e.ROUTING_POINT_KINDS.includes(pe.kind)&&ke.find(et=>n.Point.maxDistance(pe,et)<ce)||ke.push(pe);return ke}e.calcRoute=R;function w(K){return typeof K=="string"?K:K.type}e.getElementTypeId=w;function T(K,U,Z=ce=>!1){let ce,de=K;for(;de!==void 0;)!Z(de)&&U(de)&&(ce=de),de instanceof n.GChildElement?de=de.parent:de=void 0;return ce}e.findTopLevelElementByFeature=T;function j(K,U,Z){const ce=n.Point.subtract(K,U),de=(0,n.getZoom)(Z);return n.Point.divideScalar(ce,de)}e.calculateDeltaBetweenPoints=j;function D(K){const U=(0,n.getAbsoluteBounds)(K),Z=K.root.canvasBounds;return U.x<=Z.width&&U.x+U.width>=0&&U.y<=Z.height&&U.y+U.height>=0}e.isVisibleOnCanvas=D;function B(K,U){if(!K||U!=null&&U(K))return[];const Z=K,ce=[Z.id];return Z instanceof n.GParentElement&&ce.push(...Z.children.flatMap(de=>B(de,U))),ce}e.getDescendantIds=B;function H(K){const U=new Set(K);return Z=>{let ce=Z;for(;ce instanceof n.GChildElement;)if(ce=ce.parent,U.has(ce))return!1;return!0}}e.isNotDescendantOfAnyElement=H;function F(K){return K.filter(H(K))}e.removeDescendants=F}(iS)),iS}var h5;function Er(){if(h5)return dn;h5=1;var e=dn&&dn.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=dn&&dn.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},t=dn&&dn.__param||function(u,f){return function(h,p){f(h,p,u)}};Object.defineProperty(dn,"__esModule",{value:!0}),dn.SelectFeedbackAction=dn.SelectAllCommand=dn.SelectCommand=dn.SelectionService=dn.ISelectionListener=void 0;const i=Y(),a=G(),o=kt();var s;(function(u){function f(h){return i.AnyObject.is(h)&&(0,i.hasFunctionProp)(h,"selectionChanged")}u.is=f})(s||(dn.ISelectionListener=s={}));let r=class{constructor(){this.selectedElementIDs=new Set,this.toDispose=new i.DisposableCollection,this.onSelectionChangedEmitter=new i.Emitter}initialize(){this.toDispose.push(this.onSelectionChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(i.TYPES.ISelectionListener).forEach(f=>this.addListener(f))}dispose(){this.toDispose.dispose()}get onSelectionChanged(){return this.onSelectionChangedEmitter.event}addListener(f){return this.onSelectionChanged(h=>f.selectionChanged(h.root,h.selectedElements,h.deselectedElements))}modelRootChanged(f){this.updateSelection(f,[],[])}updateSelection(f,h,p){if(f===void 0&&h.length===0&&p.length===0)return;const g=this.root,m=new Set(this.selectedElementIDs);this.root=f;const v=[...h].filter(C=>p.indexOf(C)===-1),_=[...p].filter(C=>h.indexOf(C)===-1&&this.selectedElementIDs.has(C));_.forEach(C=>this.selectedElementIDs.delete(C)),v.forEach(C=>this.selectedElementIDs.add(C));const S=new Set(_);for(const C of this.selectedElementIDs)f.index.getById(C)===void 0&&(this.selectedElementIDs.delete(C),g!=null&&g.index.getById(C)&&S.add(C));(m.size!==this.selectedElementIDs.size||![...m].every(C=>this.selectedElementIDs.has(C)))&&(this.dispatchFeedback([c.create({selectedElementsIDs:[...this.selectedElementIDs],deselectedElementsIDs:[...S]})]),this.notifyListeners(this.root,this.selectedElementIDs,S))}dispatchFeedback(f){this.feedbackDispatcher.registerFeedback(this,f)}notifyListeners(f,h,p){this.onSelectionChangedEmitter.fire({root:f,selectedElements:Array.from(h),deselectedElements:Array.from(p)})}getModelRoot(){return this.root}getSelectedElements(){return this.root?(0,o.getElements)(this.root.index,Array.from(this.selectedElementIDs),i.isSelectable):[]}getSelectedElementIDs(){return[...this.selectedElementIDs]}hasSelectedElements(){return this.selectedElementIDs.size>0}isSingleSelection(){return this.selectedElementIDs.size===1}isMultiSelection(){return this.selectedElementIDs.size>1}};dn.SelectionService=r,e([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],r.prototype,"feedbackDispatcher",void 0),e([(0,a.inject)(i.LazyInjector),n("design:type",Object)],r.prototype,"lazyInjector",void 0),e([(0,a.inject)(i.TYPES.ILogger),n("design:type",Object)],r.prototype,"logger",void 0),e([(0,a.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],r.prototype,"initialize",null),e([(0,a.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],r.prototype,"dispose",null),dn.SelectionService=r=e([(0,a.injectable)()],r);let d=class extends i.Command{constructor(f,h){super(),this.action=f,this.selectionService=h,this.selected=[],this.deselected=[]}execute(f){const h=f.root,p=v=>v instanceof i.GChildElement&&(0,i.isSelectable)(v),g=(0,o.getElements)(h.index,this.action.selectedElementsIDs,p),m=this.action.deselectAll?this.selectionService.getSelectedElements():(0,o.getElements)(h.index,this.action.deselectedElementsIDs,p);return this.selectionService.updateSelection(h,(0,i.pluck)(g,"id"),(0,i.pluck)(m,"id")),h}undo(f){return f.root}redo(f){return f.root}};dn.SelectCommand=d,d.KIND=i.SprottySelectCommand.KIND,dn.SelectCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),t(1,(0,a.inject)(r)),n("design:paramtypes",[Object,r])],d);let l=class extends i.Command{constructor(f,h){super(),this.action=f,this.selectionService=h,this.previousSelection=new Map}execute(f){const h=f.root,p=v=>v instanceof i.GChildElement&&(0,i.isSelectable)(v),g=(0,o.getMatchingElements)(h.index,p),m=(0,i.pluck)(g,"id");return this.action.select?this.selectionService.updateSelection(h,m,[]):this.selectionService.updateSelection(h,[],m),h}undo(f){return f.root}redo(f){return f.root}};dn.SelectAllCommand=l,l.KIND=i.SprottySelectAllCommand.KIND,dn.SelectAllCommand=l=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),t(1,(0,a.inject)(r)),n("design:paramtypes",[Object,r])],l);var c;return function(u){u.KIND="selectFeedback";function f(v){return i.Action.hasKind(v,u.KIND)&&(0,i.hasArrayProp)(v,"selectedElementsIDs")&&(0,i.hasArrayProp)(v,"deselectedElementsIDs")}u.is=f;function h(v){return{...i.SelectAction.create(v),kind:u.KIND}}u.create=h;function p(v){return{...i.SelectAction.addSelection(v),kind:u.KIND}}u.addSelection=p;function g(v){return{...i.SelectAction.removeSelection(v),kind:u.KIND}}u.removeSelection=g;function m(v){return{...i.SelectAction.setSelection(v),kind:u.KIND}}u.setSelection=m}(c||(dn.SelectFeedbackAction=c={})),dn}var p5;function kn(){if(p5)return sa;p5=1;var e=sa&&sa.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=sa&&sa.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(sa,"__esModule",{value:!0}),sa.EditorContextService=void 0;const t=Y(),i=G(),a=Gm(),o=Er();let s=class{constructor(){this.onEditModeChangedEmitter=new t.Emitter,this.onDirtyStateChangedEmitter=new t.Emitter,this.onModelRootChangedEmitter=new t.Emitter,this.toDispose=new t.DisposableCollection}get onEditModeChanged(){return this.onEditModeChangedEmitter.event}get onDirtyStateChanged(){return this.onDirtyStateChangedEmitter.event}get onModelRootChanged(){return this.onModelRootChangedEmitter.event}get onFocusChanged(){return this.focusTracker.onFocusChanged}get onSelectionChanged(){return this.selectionService.onSelectionChanged}initialize(){var d;this._editMode=(d=this.diagramOptions.editMode)!==null&&d!==void 0?d:t.EditMode.EDITABLE,this.toDispose.push(this.onEditModeChangedEmitter,this.onDirtyStateChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(t.TYPES.IGModelRootListener).forEach(d=>{this.onModelRootChanged(l=>d.modelRootChanged(l))}),this.lazyInjector.getAll(t.TYPES.IEditModeListener).forEach(d=>{this.onEditModeChanged(l=>d.editModeChanged(l.newValue,l.oldValue))})}dispose(){this.toDispose.dispose()}get(d){return{selectedElementIds:Array.from(this.selectionService.getSelectedElementIDs()),lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:d}}getWithSelection(d,l){return{selectedElementIds:d,lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:l}}notifyModelRootChanged(d,l){if(!(l instanceof t.CommandStack))throw new Error("Invalid model root change notification. Notifier is not an instance of `CommandStack`.");this._modelRoot=d,this.onModelRootChangedEmitter.fire(d)}handle(d){t.SetEditModeAction.is(d)?this.handleSetEditModeAction(d):t.SetDirtyStateAction.is(d)&&this.handleSetDirtyStateAction(d)}handleSetEditModeAction(d){const l=this._editMode;this._editMode=d.editMode,this.onEditModeChangedEmitter.fire({newValue:this.editMode,oldValue:l})}handleSetDirtyStateAction(d){d.isDirty!==this._isDirty&&(this._isDirty=d.isDirty,this.onDirtyStateChangedEmitter.fire(d))}get sourceUri(){return this.diagramOptions.sourceUri}get editMode(){return this._editMode}get diagramType(){return this.diagramOptions.diagramType}get clientId(){return this.diagramOptions.clientId}get modelRoot(){if(!this._modelRoot)throw new Error("Model root not available yet");return this._modelRoot}get selectedElements(){return this.selectionService.getSelectedElements()}get isReadonly(){return this.editMode===t.EditMode.READONLY}get isDirty(){return this._isDirty}};return sa.EditorContextService=s,e([(0,i.inject)(o.SelectionService),n("design:type",o.SelectionService)],s.prototype,"selectionService",void 0),e([(0,i.inject)(t.MousePositionTracker),n("design:type",t.MousePositionTracker)],s.prototype,"mousePositionTracker",void 0),e([(0,i.inject)(t.LazyInjector),n("design:type",Object)],s.prototype,"lazyInjector",void 0),e([(0,i.inject)(t.TYPES.IDiagramOptions),n("design:type",Object)],s.prototype,"diagramOptions",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),e([(0,i.inject)(a.FocusTracker),n("design:type",a.FocusTracker)],s.prototype,"focusTracker",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],s.prototype,"initialize",null),e([(0,i.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],s.prototype,"dispose",null),sa.EditorContextService=s=e([(0,i.injectable)()],s),sa}var g5;function l9(){if(g5)return oa;g5=1;var e=oa&&oa.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=oa&&oa.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(oa,"__esModule",{value:!0}),oa.GLSPCommandStack=void 0;const t=Y(),i=G(),a=kn();let o=class extends t.CommandStack{constructor(){super(...arguments),this.toDispose=new t.DisposableCollection}dispose(){this.toDispose.dispose()}get editorContext(){return this.lazyInjector.get(a.EditorContextService)}get onModelRootChanged(){return this.editorContext.onModelRootChanged}undo(){return this.logger.warn(this,"GLSPCommandStack.undo() was called. This should never happen as the GLSP server is responsible for handling undo requests"),this.currentModel}redo(){return this.logger.warn(this,"GLSPCommandStack.redo() was called. This should never happen as the GLSP server is responsible for handling redo requests"),this.currentModel}pushToUndoStack(r){}mergeOrPush(r,d){}async execute(r){const d=await super.execute(r);return(r instanceof t.SetModelCommand||r instanceof t.UpdateModelCommand)&&this.notifyListeners(d),d}notifyListeners(r){this.editorContext.notifyModelRootChanged(r,this)}};return oa.GLSPCommandStack=o,e([(0,i.inject)(t.LazyInjector),n("design:type",Object)],o.prototype,"lazyInjector",void 0),e([(0,i.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],o.prototype,"dispose",null),oa.GLSPCommandStack=o=e([(0,i.injectable)()],o),oa}var $p={},Dt={},rd={},Yp={},m5;function cl(){if(m5)return Yp;m5=1,Object.defineProperty(Yp,"__esModule",{value:!0}),Yp.Ranked=void 0;const e=Y();var n;return function(t){t.DEFAULT_RANK=0;function i(o){return e.AnyObject.is(o)&&(0,e.hasNumberProp)(o,"rank")}t.is=i;function a(o){return i(o)?o.rank:t.DEFAULT_RANK}t.getRank=a,t.sortAsc=(o,s)=>a(o)-a(s),t.sortDesc=(o,s)=>a(s)-a(o),t.sort=t.sortAsc}(n||(Yp.Ranked=n={})),Yp}var v5;function Cr(){if(v5)return rd;v5=1,Object.defineProperty(rd,"__esModule",{value:!0}),rd.getFeedbackRank=rd.FeedbackCommand=void 0;const e=Y(),n=cl();class t extends e.Command{constructor(){super(...arguments),this.priority=0,this.rank=this.priority?-this.priority:n.Ranked.DEFAULT_RANK}undo(o){return o.root}redo(o){return o.root}}rd.FeedbackCommand=t;function i(a){var o;const s=a;return s!=null&&s.priority?-s.priority:(o=s.rank)!==null&&o!==void 0?o:n.Ranked.DEFAULT_RANK}return rd.getFeedbackRank=i,rd}var y5;function Un(){if(y5)return Dt;y5=1;var e=Dt&&Dt.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=Dt&&Dt.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)},t=Dt&&Dt.__param||function(p,g){return function(m,v){g(m,v,p)}};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.toggleCssClasses=Dt.deleteCssClasses=Dt.applyCssClasses=Dt.cursorFeedbackAction=Dt.CursorCSS=Dt.CSS_HIDDEN=Dt.CSS_GHOST_ELEMENT=Dt.ModifyCssFeedbackCommand=Dt.ModifyCSSFeedbackAction=void 0;const i=Y(),a=G(),o=kt(),s=Cr();var r;(function(p){p.KIND="modifyCSSFeedback";function g(v){return i.Action.hasKind(v,p.KIND)&&(0,i.hasArrayProp)(v,"elementIds")}p.is=g;function m(v){const{elements:_,...S}=v,E=_?_.map(C=>typeof C=="string"?C:C.id):void 0;return{kind:p.KIND,elementIds:E,...S}}p.create=m})(r||(Dt.ModifyCSSFeedbackAction=r={}));let d=class extends s.FeedbackCommand{constructor(g){super(),this.action=g}execute(g){return(this.action.elementIds?(0,o.getElements)(g.root.index,this.action.elementIds):[g.root]).forEach(v=>{this.action.remove&&(0,o.removeCssClasses)(v,this.action.remove),this.action.add&&(0,o.addCssClasses)(v,this.action.add)}),g.root}};Dt.ModifyCssFeedbackCommand=d,d.KIND=r.KIND,Dt.ModifyCssFeedbackCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],d),Dt.CSS_GHOST_ELEMENT="ghost-element",Dt.CSS_HIDDEN="hidden";var l;(function(p){p.DEFAULT="default-mode",p.OVERLAP_FORBIDDEN="overlap-forbidden-mode",p.NODE_CREATION="node-creation-mode",p.EDGE_CREATION_SOURCE="edge-creation-select-source-mode",p.EDGE_CREATION_TARGET="edge-creation-select-target-mode",p.EDGE_RECONNECT="edge-reconnect-select-target-mode",p.EDGE_CHECK_PENDING="edge-check-pending-mode",p.OPERATION_NOT_ALLOWED="edge-modification-not-allowed-mode",p.ELEMENT_DELETION="element-deletion-mode",p.RESIZE_NESW="resize-nesw-mode",p.RESIZE_NWSE="resize-nwse-mode",p.RESIZE_NW="resize-nw-mode",p.RESIZE_N="resize-n-mode",p.RESIZE_NE="resize-ne-mode",p.RESIZE_E="resize-e-mode",p.RESIZE_SE="resize-se-mode",p.RESIZE_S="resize-s-mode",p.RESIZE_SW="resize-sw-mode",p.RESIZE_W="resize-w-mode",p.MOVE="move-mode",p.MARQUEE="marquee-mode"})(l||(Dt.CursorCSS=l={}));function c(p){const g=[];return p&&g.push(p),r.create({add:g,remove:Object.values(l)})}Dt.cursorFeedbackAction=c;function u(p,...g){return r.create({elements:[p],add:g})}Dt.applyCssClasses=u;function f(p,...g){return r.create({elements:[p],remove:g})}Dt.deleteCssClasses=f;function h(p,g,...m){return g?u(p,...m):f(p,...m)}return Dt.toggleCssClasses=h,Dt}var _o={},Wp={},_5;function d9(){if(_5)return Wp;_5=1,Object.defineProperty(Wp,"__esModule",{value:!0}),Wp.FeedbackEmitter=void 0;const e=Y();let n=0;class t{constructor(a){this.feedbackDispatcher=a,this.id=n++,this.feedbackActions=[],this.cleanupActions=[]}add(a,o){if(!a&&!o)return this;const s=this.feedbackActions.length;return this.feedbackActions[s]=a,o&&(this.cleanupActions[s]=o),this}merge(a){return this.feedbackActions.push(...a.feedbackActions),this.cleanupActions.push(...a.cleanupActions),this}remove(a){const o=this.feedbackActions.indexOf(a);return o>=0&&(this.feedbackActions.splice(o,1),this.cleanupActions.splice(o,1)),this}clear(){return this.feedbackActions=[],this.cleanupActions=[],this}submit(){const a=(0,e.arrayOf)(...this.feedbackActions),o=(0,e.arrayOf)(...this.cleanupActions);return(a.length>0||o.length>0)&&(this.deregistration=this.feedbackDispatcher.registerFeedback(this,a,()=>o.flatMap(e.MaybeActions.asArray)),this.clear()),this}discard(){return this.feedbackDispatcher.deregisterFeedback(this),this.deregistration=void 0,this}revert(){var a;return(a=this.deregistration)===null||a===void 0||a.dispose(),this.deregistration=void 0,this}dispose(){return this.revert(),this.clear(),this}}return Wp.FeedbackEmitter=t,Wp}var b5;function TP(){if(b5)return _o;b5=1;var e=_o&&_o.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=_o&&_o.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(_o,"__esModule",{value:!0}),_o.FeedbackActionDispatcher=_o.feedbackFeature=void 0;const t=Y(),i=G(),a=Cr(),o=d9();_o.feedbackFeature=Symbol("feedbackFeature");let s=class{constructor(){this.registeredFeedback=new Map,this.isDisposed=!1}registerFeedback(d,l,c){return d instanceof t.GModelElement&&this.logger.log(this,"GModelElements as feedback emitters are discouraged, as they usually change between model updates and are considered unstable."),l.length>0&&(this.registeredFeedback.set(d,l),this.dispatchFeedback(l,d)),t.Disposable.create(()=>this.deregisterFeedback(d,c))}deregisterFeedback(d,l){this.registeredFeedback.delete(d);const c=t.MaybeActions.asArray(l);c.length>0&&this.dispatchFeedback(c,d)}getRegisteredFeedback(){const d=[];return this.registeredFeedback.forEach(l=>d.push(...l)),d}getRegisteredFeedbackEmitters(d){const l=[];return this.registeredFeedback.forEach((c,u)=>{c.includes(d)&&l.push(u)}),l}getFeedbackCommands(){return this.getRegisteredFeedback().flatMap(d=>this.actionToCommands(d)).sort((d,l)=>(0,a.getFeedbackRank)(d)-(0,a.getFeedbackRank)(l))}async applyFeedbackCommands(d){var l;const c=(l=this.getFeedbackCommands())!==null&&l!==void 0?l:[];if((c==null?void 0:c.length)>0){const u=c.map(f=>f.execute(d));await Promise.all(u)}}actionToCommands(d){var l;return(l=this.actionHandlerRegistry.get(d.kind).filter((0,t.toTypeGuard)(t.CommandActionHandler)).map(c=>c.handle(d)))!==null&&l!==void 0?l:[]}createEmitter(){return new o.FeedbackEmitter(this)}async dispatchFeedback(d,l){try{if(this.isDisposed)return;await this.actionDispatcher.dispatchAll(d),this.logger.info(this,`Dispatched feedback actions for ${l}`)}catch(c){this.logger.error(this,"Failed to dispatch feedback actions",c)}}dispose(){this.registeredFeedback.clear(),this.isDisposed=!0}};return _o.FeedbackActionDispatcher=s,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),e([(0,i.inject)(t.TYPES.ILogger),n("design:type",Object)],s.prototype,"logger",void 0),e([(0,i.inject)(t.ActionHandlerRegistry),n("design:type",t.ActionHandlerRegistry)],s.prototype,"actionHandlerRegistry",void 0),e([(0,i.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],s.prototype,"dispose",null),_o.FeedbackActionDispatcher=s=e([(0,i.injectable)()],s),_o}var bo={},S5;function f9(){if(S5)return bo;S5=1;var e=bo&&bo.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=bo&&bo.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t=bo&&bo.__param||function(s,r){return function(d,l){r(d,l,s)}};Object.defineProperty(bo,"__esModule",{value:!0}),bo.FeedbackAwareSetModelCommand=void 0;const i=Y(),a=G();let o=class extends i.SetModelCommand{constructor(r){super(r)}execute(r){const d=super.execute(r);return this.applyFeedback(d,r),d}applyFeedback(r,d){var l;const c={...d,root:r};(l=this.feedbackActionDispatcher)===null||l===void 0||l.applyFeedbackCommands(c)}};return bo.FeedbackAwareSetModelCommand=o,e([(0,a.inject)(i.TYPES.ILogger),n("design:type",Object)],o.prototype,"logger",void 0),e([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),(0,a.optional)(),n("design:type",Object)],o.prototype,"feedbackActionDispatcher",void 0),bo.FeedbackAwareSetModelCommand=o=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],o),bo}var So={},E5;function h9(){if(E5)return So;E5=1;var e=So&&So.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=So&&So.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t=So&&So.__param||function(s,r){return function(d,l){r(d,l,s)}};Object.defineProperty(So,"__esModule",{value:!0}),So.FeedbackAwareUpdateModelCommand=void 0;const i=Y(),a=G();let o=class extends i.UpdateModelCommand{constructor(r){super({animate:!0,...r})}performUpdate(r,d,l){var c;const u={...l,root:d};return(c=this.feedbackActionDispatcher)===null||c===void 0||c.applyFeedbackCommands(u),super.performUpdate(r,d,l)}createAnimations(r,d,l){return super.createAnimations(r,d,l).filter(u=>!(u instanceof i.MorphEdgesAnimation))}};return So.FeedbackAwareUpdateModelCommand=o,e([(0,a.inject)(i.TYPES.ILogger),n("design:type",Object)],o.prototype,"logger",void 0),e([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),(0,a.optional)(),n("design:type",Object)],o.prototype,"feedbackActionDispatcher",void 0),So.FeedbackAwareUpdateModelCommand=o=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],o),So}var Eo={},C5;function p9(){if(C5)return Eo;C5=1;var e=Eo&&Eo.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Eo&&Eo.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.DiagramLoader=Eo.IDiagramStartup=void 0;const t=Y(),i=G(),a=cl(),o=ch(),s=w_();var r;(function(l){function c(u){return t.AnyObject.is(u)&&(0,t.hasNumberProp)(u,"rank",!0)&&("preLoadDiagram"in u||"preInitialize"in u||"preRequestModel"in u||"postRequestModel"in u||"postModelInitialization"in u)}l.is=c})(r||(Eo.IDiagramStartup=r={}));let d=class{get diagramStartups(){return this.lazyInjector.getAll(t.TYPES.IDiagramStartup)}async load(c={}){var u,f,h,p;this.diagramStartups.sort(a.Ranked.sort),await this.invokeStartupHook("preLoadDiagram");const g={requestModelOptions:{sourceUri:(u=this.options.sourceUri)!==null&&u!==void 0?u:"",diagramType:this.options.diagramType,...c.requestModelOptions},initializeParameters:{applicationId:t.ApplicationIdProvider.get(),protocolVersion:t.GLSPClient.protocolVersion,...c.initializeParameters},enableNotifications:(f=c.enableNotifications)!==null&&f!==void 0?f:!0};await((p=(h=this.actionDispatcher).initialize)===null||p===void 0?void 0:p.call(h)),await this.invokeStartupHook("preInitialize"),await this.initialize(g),await this.invokeStartupHook("preRequestModel"),await this.requestModel(g),await this.invokeStartupHook("postRequestModel"),await this.modelInitializationConstraint.onInitialized(),await this.invokeStartupHook("postModelInitialization")}async invokeStartupHook(c){var u;for(const f of this.diagramStartups)try{await((u=f[c])===null||u===void 0?void 0:u.call(f))}catch(h){console.error(`Error invoking diagram startup hook '${c}':`,`
`,h)}}async requestModel(c){await this.actionDispatcher.dispatch(t.RequestModelAction.create({options:c.requestModelOptions,requestId:t.RequestAction.generateRequestId()}))}async initialize(c){c.enableNotifications&&await this.actionDispatcher.dispatch(t.StatusAction.create("Initializing...",{severity:"INFO"}));const u=await this.options.glspClientProvider();await u.start(),u.initializeResult||await u.initializeServer(c.initializeParameters),this.modelSource.configure(u),c.enableNotifications&&this.actionDispatcher.dispatch(t.StatusAction.create("",{severity:"NONE"}))}};return Eo.DiagramLoader=d,e([(0,i.inject)(t.TYPES.IDiagramOptions),n("design:type",Object)],d.prototype,"options",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],d.prototype,"actionDispatcher",void 0),e([(0,i.inject)(o.GLSPModelSource),n("design:type",o.GLSPModelSource)],d.prototype,"modelSource",void 0),e([(0,i.inject)(s.ModelInitializationConstraint),n("design:type",s.ModelInitializationConstraint)],d.prototype,"modelInitializationConstraint",void 0),e([(0,i.inject)(t.LazyInjector),n("design:type",Object)],d.prototype,"lazyInjector",void 0),Eo.DiagramLoader=d=e([(0,i.injectable)()],d),Eo}var Tu={},P5;function g9(){if(P5)return Tu;P5=1;var e=Tu&&Tu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Tu,"__esModule",{value:!0}),Tu.GModelRegistry=void 0;const n=Y(),t=G(),i=Vm();let a=class extends n.SModelRegistry{register(s,r){if(s===void 0)throw new Error("Key is undefined");this.hasKey(s)&&(console.log(`Key is already registered: ${s}.Factory for model element '${s}' will be overwritten.`),console.warn(`Implicit overwriting by registering the same key twice is deprecated
 Use 'overrideModelElement()' instead of 'configureModelElement()' for explicit overwriting.`)),this.elements.set(s,r)}getDefaultFeatures(s){var r;const d=[...(r=super.getDefaultFeatures(s))!==null&&r!==void 0?r:[]];return d.includes(i.argsFeature)||d.push(i.argsFeature),d}};return Tu.GModelRegistry=a,Tu.GModelRegistry=a=e([(0,t.injectable)()],a),Tu}var Du={},R5;function m9(){if(R5)return Du;R5=1;var e=Du&&Du.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Du,"__esModule",{value:!0}),Du.GLSPMousePositionTracker=void 0;const n=Y(),t=G(),i=cl();let a=class extends n.MousePositionTracker{constructor(){super(...arguments),this.rank=i.Ranked.DEFAULT_RANK-200}mouseMove(s,r){const d=s.root.canvasBounds,l={x:r.clientX,y:r.clientY},c=n.Point.subtract(l,d),u=s.root.parentToLocal(c);return this.lastPosition=u,[]}};return Du.GLSPMousePositionTracker=a,Du.GLSPMousePositionTracker=a=e([(0,t.injectable)()],a),Du}var Ou={},M5;function v9(){if(M5)return Ou;M5=1;var e=Ou&&Ou.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.SelectionClearingMouseListener=void 0;const n=G(),t=Y();let i=class extends t.MouseListener{mouseDown(o,s){const r=document.getSelection();return r===null?[]:(r.removeAllRanges(),r.addRange(document.createRange()),[])}};return Ou.SelectionClearingMouseListener=i,Ou.SelectionClearingMouseListener=i=e([(0,n.injectable)()],i),Ou}var wc={},A5;function an(){if(A5)return wc;A5=1,Object.defineProperty(wc,"__esModule",{value:!0}),wc.Tool=wc.EnableDefaultToolsAction=wc.EnableToolsAction=void 0;const e=Y();var n;(function(a){a.KIND="enable-tools";function o(r){return e.Action.hasKind(r,a.KIND)&&(0,e.hasArrayProp)(r,"toolIds")}a.is=o;function s(r){return{kind:a.KIND,toolIds:r}}a.create=s})(n||(wc.EnableToolsAction=n={}));var t;(function(a){a.KIND="enable-default-tools";function o(r){return e.Action.hasKind(r,a.KIND)}a.is=o;function s(){return{kind:a.KIND}}a.create=s})(t||(wc.EnableDefaultToolsAction=t={}));var i;return function(a){function o(s){return e.AnyObject.is(s)&&(0,e.hasStringProp)(s,"id")&&(0,e.hasFunctionProp)(s,"enable")&&(0,e.hasFunctionProp)(s,"disable")&&(0,e.hasBooleanProp)(s,"isEditTool",!0)}a.is=o}(i||(wc.Tool=i={})),wc}var Si={},w5;function y9(){if(w5)return Si;w5=1;var e=Si&&Si.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Si&&Si.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)};Object.defineProperty(Si,"__esModule",{value:!0}),Si.DefaultToolsEnablingKeyListener=Si.ToolManagerActionHandler=Si.ToolManager=void 0;const t=Y(),i=G(),a=kn(),o=cl(),s=an();let r=class{constructor(){this.actives=[],this.tools=[],this.defaultTools=[],this._defaultToolsEnabled=!1}get defaultToolsEnabled(){return this._defaultToolsEnabled}preLoadDiagram(){const u=this.lazyInjector.getAll(t.TYPES.ITool),f=this.lazyInjector.getAll(t.TYPES.IDefaultTool);this.registerTools(...u),this.registerDefaultTools(...f),this.enableDefaultTools()}get managedTools(){return this.defaultTools.concat(this.tools)}get activeTools(){return this.actives}get rank(){return o.Ranked.DEFAULT_RANK-100}registerDefaultTools(...u){(0,t.distinctAdd)(this.defaultTools,...u)}registerTools(...u){(0,t.distinctAdd)(this.tools,...u)}disableActiveTools(){this._defaultToolsEnabled=!1,this.actives.forEach(u=>u.disable()),this.actives.splice(0,this.actives.length)}enableDefaultTools(){this.defaultToolsEnabled||(this.enable((0,t.pluck)(this.defaultTools,"id")),this._defaultToolsEnabled=!0)}enable(u){this.disableActiveTools();let f=u.map(h=>this.tool(h));this.editorContext&&this.editorContext.isReadonly&&(f=f.filter(h=>!(h!=null&&h.isEditTool))),f.forEach(h=>{h!==void 0&&(h.enable(),this.actives.push(h))})}tool(u){return this.managedTools.find(f=>f.id===u)}disableEditTools(){this.disableActiveTools(),this.enable(this.defaultTools.filter(u=>!u.isEditTool).map(u=>u.id))}editModeChanged(u,f){f!==u&&(u===t.EditMode.READONLY?this.disableEditTools():u===t.EditMode.EDITABLE&&this.enableDefaultTools())}};Si.ToolManager=r,e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],r.prototype,"editorContext",void 0),e([(0,i.inject)(t.LazyInjector),n("design:type",Object)],r.prototype,"lazyInjector",void 0),Si.ToolManager=r=e([(0,i.injectable)()],r);let d=class{handle(u){s.EnableDefaultToolsAction.is(u)?this.toolManager.enableDefaultTools():s.EnableToolsAction.is(u)&&this.toolManager.enable(u.toolIds)}};Si.ToolManagerActionHandler=d,e([(0,i.inject)(t.TYPES.IToolManager),n("design:type",Object)],d.prototype,"toolManager",void 0),Si.ToolManagerActionHandler=d=e([(0,i.injectable)()],d);let l=class extends t.KeyListener{keyDown(u,f){return(0,t.matchesKeystroke)(f,"Escape")?[s.EnableDefaultToolsAction.create()]:[]}};return Si.DefaultToolsEnablingKeyListener=l,Si.DefaultToolsEnablingKeyListener=l=e([(0,i.injectable)()],l),Si}var Co={},I5;function _9(){if(I5)return Co;I5=1;var e=Co&&Co.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Co&&Co.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t=Co&&Co.__param||function(s,r){return function(d,l){r(d,l,s)}};Object.defineProperty(Co,"__esModule",{value:!0}),Co.GLSPUIExtensionRegistry=void 0;const i=Y(),a=G();let o=class extends i.UIExtensionRegistry{constructor(r){super(r)}preLoadDiagram(){this.lazyInjector.getAll(i.TYPES.IUIExtension).forEach(r=>this.register(r.id(),r))}};return Co.GLSPUIExtensionRegistry=o,e([(0,a.inject)(i.LazyInjector),n("design:type",Object)],o.prototype,"lazyInjector",void 0),Co.GLSPUIExtensionRegistry=o=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.EmptyArray)),n("design:paramtypes",[Array])],o),Co}var Po={},T5;function DP(){if(T5)return Po;T5=1;var e=Po&&Po.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Po&&Po.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t=Po&&Po.__param||function(s,r){return function(d,l){r(d,l,s)}};Object.defineProperty(Po,"__esModule",{value:!0}),Po.GLSPKeyTool=void 0;const i=Y(),a=G();let o=class extends i.KeyTool{constructor(r){super(r)}registerListener(r){return super.register(r),i.Disposable.create(()=>this.deregister(r))}preLoadDiagram(){this.lazyInjector.getAll(i.TYPES.KeyListener).forEach(r=>this.register(r))}};return Po.GLSPKeyTool=o,e([(0,a.inject)(i.LazyInjector),n("design:type",Object)],o.prototype,"lazyInjector",void 0),Po.GLSPKeyTool=o=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.EmptyArray)),n("design:paramtypes",[Array])],o),Po}var Ro={},D5;function OP(){if(D5)return Ro;D5=1;var e=Ro&&Ro.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=Ro&&Ro.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)},t=Ro&&Ro.__param||function(d,l){return function(c,u){l(c,u,d)}};Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.GLSPMouseTool=void 0;const i=Y(),a=G(),o=cl();let s=class extends i.MouseTool{constructor(l){super(l)}preLoadDiagram(){this.lazyInjector.getAll(i.TYPES.MouseListener).forEach(l=>this.register(l))}register(l){super.register(l),this.rankedMouseListeners=r(this.mouseListeners,c=>o.Ranked.getRank(c))}registerListener(l){return this.register(l),i.Disposable.create(()=>this.deregister(l))}deregister(l){super.deregister(l),this.rankedMouseListeners=r(this.mouseListeners,c=>o.Ranked.getRank(c))}handleEvent(l,c,u){this.focusOnMouseEvent(l,c);const f=this.getTargetElement(c,u);f&&this.notifyListenersByRank(f,l,u)}async notifyListenersByRank(l,c,u){for(const f of this.rankedMouseListeners)await this.dispatchActions(f[1],c,l,u)}async dispatchActions(l,c,u,f){const h=l.map(p=>p[c](u,f)).reduce((p,g)=>p.concat(g));if(h.length>0){f.preventDefault();for(const p of h)i.Action.is(p)?await this.actionDispatcher.dispatch(p):p.then(g=>{this.actionDispatcher.dispatch(g)})}}};Ro.GLSPMouseTool=s,e([(0,a.inject)(i.LazyInjector),n("design:type",Object)],s.prototype,"lazyInjector",void 0),Ro.GLSPMouseTool=s=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.EmptyArray)),n("design:paramtypes",[Array])],s);function r(d,l){const c=d.reduce((u,f)=>{const h=l(f);if(!u.has(h))u.set(h,[f]);else{const p=u.get(h);p&&p.push(f)}return u},new Map);return new Map([...c.entries()].sort())}return Ro}var Lu={},O5;function b9(){if(O5)return Lu;O5=1;var e=Lu&&Lu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Lu,"__esModule",{value:!0}),Lu.GViewRegistry=void 0;const n=Y(),t=G();let i=class extends n.ViewRegistry{register(o,s){if(o===void 0)throw new Error("Key is undefined");this.hasKey(o)&&console.log(`View instance for type '${o}' will be overwritten.`),this.elements.set(o,s)}};return Lu.GViewRegistry=i,Lu.GViewRegistry=i=e([(0,t.injectable)()],i),Lu}var L5;function S9(){if(L5)return $p;L5=1,Object.defineProperty($p,"__esModule",{value:!0}),$p.defaultModule=void 0;const e=Y(),n=s9(),t=wP(),i=l9(),a=kn(),o=Un(),s=TP(),r=f9(),d=h9(),l=of(),c=Gm(),u=p9(),f=ch(),h=w_(),p=g9(),g=m9(),m=v9(),v=Er(),_=an(),S=y9(),E=_9(),C=DP(),M=OP(),L=b9();return $p.defaultModule=new e.FeatureModule((I,R,w,T,...j)=>{e.sprottyDefaultModule.registry(I,R,w,T,...j);const D={bind:I,unbind:R,isBound:w,rebind:T};(0,e.bindLazyInjector)(D),I(a.EditorContextService).toSelf().inSingletonScope(),I(e.TYPES.IDiagramStartup).toService(a.EditorContextService),I(e.TYPES.IEditorContextServiceProvider).toProvider(B=>async()=>B.container.get(a.EditorContextService)),(0,e.configureActionHandler)(D,e.SetEditModeAction.KIND,a.EditorContextService),(0,e.configureActionHandler)(D,e.SetDirtyStateAction.KIND,a.EditorContextService),I(c.FocusTracker).toSelf().inSingletonScope(),I(e.TYPES.IDiagramStartup).toService(c.FocusTracker),(0,e.configureActionHandler)(D,l.FocusStateChangedAction.KIND,c.FocusTracker),I(e.TYPES.IFeedbackActionDispatcher).to(s.FeedbackActionDispatcher).inSingletonScope(),(0,e.configureCommand)(D,d.FeedbackAwareUpdateModelCommand),T(e.SetModelCommand).to(r.FeedbackAwareSetModelCommand),I(M.GLSPMouseTool).toSelf().inSingletonScope(),(0,e.bindOrRebind)(D,e.MouseTool).toService(M.GLSPMouseTool),I(e.TYPES.IDiagramStartup).toService(M.GLSPMouseTool),I(g.GLSPMousePositionTracker).toSelf().inSingletonScope(),(0,e.bindOrRebind)(D,e.MousePositionTracker).toService(g.GLSPMousePositionTracker),I(C.GLSPKeyTool).toSelf().inSingletonScope(),(0,e.bindOrRebind)(D,e.KeyTool).toService(C.GLSPKeyTool),I(e.TYPES.IDiagramStartup).toService(C.GLSPKeyTool),(0,e.bindAsService)(D,e.TYPES.MouseListener,m.SelectionClearingMouseListener),(0,e.bindOrRebind)(D,e.TYPES.ICommandStack).to(i.GLSPCommandStack).inSingletonScope(),I(n.GLSPActionDispatcher).toSelf().inSingletonScope(),I(e.TYPES.IGModelRootListener).toService(n.GLSPActionDispatcher),(0,e.bindOrRebind)(D,e.TYPES.IActionDispatcher).toService(n.GLSPActionDispatcher),(0,e.bindOrRebind)(D,e.ActionHandlerRegistry).to(t.GLSPActionHandlerRegistry).inSingletonScope(),(0,e.bindAsService)(D,e.TYPES.ModelSource,f.GLSPModelSource),I(u.DiagramLoader).toSelf().inSingletonScope(),I(h.ModelInitializationConstraint).to(h.DefaultModelInitializationConstraint).inSingletonScope(),(0,e.bindOrRebind)(D,e.TYPES.SModelRegistry).to(p.GModelRegistry).inSingletonScope(),(0,e.bindOrRebind)(D,e.TYPES.ViewRegistry).to(L.GViewRegistry).inSingletonScope(),I(v.SelectionService).toSelf().inSingletonScope(),I(e.TYPES.IGModelRootListener).toService(v.SelectionService),I(e.TYPES.IDiagramStartup).toService(v.SelectionService),(0,e.configureCommand)(D,o.ModifyCssFeedbackCommand),(0,e.configureCommand)(D,e.MoveCommand),(0,e.bindAsService)(D,e.TYPES.IVNodePostprocessor,e.LocationPostprocessor),I(e.TYPES.HiddenVNodePostprocessor).toService(e.LocationPostprocessor),I(e.TYPES.IToolManager).to(S.ToolManager).inSingletonScope(),I(e.TYPES.IDiagramStartup).toService(e.TYPES.IToolManager),I(e.TYPES.IEditModeListener).toService(e.TYPES.IToolManager),I(S.DefaultToolsEnablingKeyListener).toSelf().inSingletonScope(),I(e.TYPES.KeyListener).toService(S.DefaultToolsEnablingKeyListener),I(S.ToolManagerActionHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)(D,_.EnableDefaultToolsAction.KIND,S.ToolManagerActionHandler),(0,e.configureActionHandler)(D,_.EnableToolsAction.KIND,S.ToolManagerActionHandler),I(E.GLSPUIExtensionRegistry).toSelf().inSingletonScope(),(0,e.bindOrRebind)(D,e.TYPES.UIExtensionRegistry).toService(E.GLSPUIExtensionRegistry),I(e.TYPES.IDiagramStartup).toService(E.GLSPUIExtensionRegistry),I(e.TYPES.EmptyArray).toDynamicValue(()=>[])},{featureId:Symbol("default")}),$p}var Zp={},j5;function Jc(){if(j5)return Zp;j5=1,Object.defineProperty(Zp,"__esModule",{value:!0}),Zp.DragAwareMouseListener=void 0;const e=Y();class n extends e.MouseListener{constructor(i=0){super(),this._isMouseDown=!1,this._isMouseDrag=!1,this._dragSensitivity=0,this._dragSensitivity=i}mouseDown(i,a){return this._isMouseDown=!0,this._dragStart=this._dragSensitivity>0?{x:a.clientX,y:a.clientY}:void 0,[]}mouseMove(i,a){return this._isMouseDown?this._dragStart&&e.Point.maxDistance(this._dragStart,{x:a.clientX,y:a.clientY})<this._dragSensitivity?this.nonDraggingMouseMove(i,a):(this._isMouseDrag=!0,this.draggingMouseMove(i,a)):this.nonDraggingMouseMove(i,a)}draggingMouseMove(i,a){return[]}nonDraggingMouseMove(i,a){return[]}mouseUp(i,a){return this._isMouseDown=!1,this._dragStart=void 0,this._isMouseDrag?(this._isMouseDrag=!1,this.draggingMouseUp(i,a)):this.nonDraggingMouseUp(i,a)}nonDraggingMouseUp(i,a){return[]}draggingMouseUp(i,a){return[]}get isMouseDrag(){return this._isMouseDrag}get isMouseDown(){return this._isMouseDown}dispose(){this._isMouseDrag=!1,this._isMouseDown=!1}}return Zp.DragAwareMouseListener=n,Zp}var rS={},Qp={},Mo={},oS={},sS={},N5;function Pr(){return N5||(N5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.SResizeHandle=e.removeResizeHandles=e.addResizeHandles=e.GResizeHandle=e.isBoundsAwareMoveable=e.ResizeHandleLocation=e.isResizable=e.resizeFeature=void 0;const n=Y(),t=Un();e.resizeFeature=Symbol("resizeFeature");function i(l){return(0,n.isBoundsAware)(l)&&(0,n.isSelectable)(l)&&l instanceof n.GParentElement&&l.hasFeature(e.resizeFeature)}e.isResizable=i;var a;(function(l){l.TopLeft="top-left",l.Top="top",l.TopRight="top-right",l.Right="right",l.BottomRight="bottom-right",l.Bottom="bottom",l.BottomLeft="bottom-left",l.Left="left"})(a||(e.ResizeHandleLocation=a={})),function(l){l.CORNERS=[l.TopLeft,l.TopRight,l.BottomRight,l.BottomLeft],l.CROSS=[l.Top,l.Right,l.Bottom,l.Left],l.ALL=[...l.CORNERS,...l.CROSS];function c(f){switch(f){case l.TopLeft:return l.BottomRight;case l.Top:return l.Bottom;case l.TopRight:return l.BottomLeft;case l.Right:return l.Left;case l.BottomRight:return l.TopLeft;case l.Bottom:return l.Top;case l.BottomLeft:return l.TopRight;case l.Left:return l.Right}}l.opposite=c;function u(f){switch(f){case l.TopLeft:return[n.Direction.Up,n.Direction.Left];case l.Top:return[n.Direction.Up];case l.TopRight:return[n.Direction.Up,n.Direction.Right];case l.Right:return[n.Direction.Right];case l.BottomRight:return[n.Direction.Down,n.Direction.Right];case l.Bottom:return[n.Direction.Down];case l.BottomLeft:return[n.Direction.Down,n.Direction.Left];case l.Left:return[n.Direction.Left]}}l.direction=u}(a||(e.ResizeHandleLocation=a={}));function o(l){return(0,n.isMoveable)(l)&&(0,n.isBoundsAware)(l)}e.isBoundsAwareMoveable=o;class s extends n.GChildElement{constructor(c,u=s.TYPE,f=!1){super(),this.location=c,this.type=u,this.hoverFeedback=f}hasFeature(c){return c===n.hoverFeedbackFeature}isNwResize(){return this.location===a.TopLeft}isNResize(){return this.location===a.Top}isNeResize(){return this.location===a.TopRight}isEResize(){return this.location===a.Right}isSeResize(){return this.location===a.BottomRight}isSResize(){return this.location===a.Bottom}isSwResize(){return this.location===a.BottomLeft}isWResize(){return this.location===a.Left}isNwSeResize(){return this.isNwResize()||this.isSeResize()}isNeSwResize(){return this.isNeResize()||this.isSwResize()}static getHandlePosition(c,u){const f=s.is(c)?c.parent.bounds:c instanceof n.GModelElement?c.bounds:c;switch(s.is(c)?c.location:u){case a.TopLeft:return n.Bounds.topLeft(f);case a.Top:return n.Bounds.topCenter(f);case a.TopRight:return n.Bounds.topRight(f);case a.Right:return n.Bounds.middleRight(f);case a.BottomRight:return n.Bounds.bottomRight(f);case a.Bottom:return n.Bounds.bottomCenter(f);case a.BottomLeft:return n.Bounds.bottomLeft(f);case a.Left:return n.Bounds.middleLeft(f)}}static getCursorCss(c){switch(c.location){case a.TopLeft:return t.CursorCSS.RESIZE_NW;case a.Top:return t.CursorCSS.RESIZE_N;case a.TopRight:return t.CursorCSS.RESIZE_NE;case a.Right:return t.CursorCSS.RESIZE_E;case a.BottomRight:return t.CursorCSS.RESIZE_SE;case a.Bottom:return t.CursorCSS.RESIZE_S;case a.BottomLeft:return t.CursorCSS.RESIZE_SW;case a.Left:return t.CursorCSS.RESIZE_W}}static is(c){return typeof c=="object"&&!!c&&"type"in c&&c.type===s.TYPE}}e.GResizeHandle=s,e.SResizeHandle=s,s.TYPE="resize-handle";function r(l,c=a.CORNERS){for(const u of a.ALL){const f=l.children.find(h=>h instanceof s&&h.location===u);c.includes(u)&&!f?l.add(new s(u)):!c.includes(u)&&f&&l.remove(f)}}e.addResizeHandles=r;function d(l){l.removeAll(c=>c instanceof s)}e.removeResizeHandles=d}(sS)),sS}var B5;function uh(){return B5||(B5=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Direction=e.getDirectionFrom=e.getDirectionOf=e.isSelectionBounds=e.SelectionBounds=e.SELECTION_BOUNDS=e.isHelperLine=e.HelperLine=e.HELPER_LINE=e.HelperLineType=void 0;const n=Y(),t=Hm(),i=Pr();e.HelperLineType={Left:"left",Right:"right",Center:"center",Top:"top",Bottom:"bottom",Middle:"middle",LeftRight:"left-right",RightLeft:"right-left",BottomTop:"bottom-top",TopBottom:"top-bottom"},e.HELPER_LINE="helper-line";class a extends n.GChildElement{constructor(u=n.Point.ORIGIN,f=n.Point.ORIGIN,h=e.HelperLineType.Left){super(),this.startPoint=u,this.endPoint=f,this.lineType=h,this.id=(0,t.v4)(),this.type=e.HELPER_LINE}get isLeft(){return this.lineType===e.HelperLineType.Left||this.lineType===e.HelperLineType.LeftRight}get isRight(){return this.lineType===e.HelperLineType.Right||this.lineType===e.HelperLineType.RightLeft}get isTop(){return this.lineType===e.HelperLineType.Top||this.lineType===e.HelperLineType.TopBottom}get isBottom(){return this.lineType===e.HelperLineType.Bottom||this.lineType===e.HelperLineType.BottomTop}get isMiddle(){return this.lineType===e.HelperLineType.Middle}get isCenter(){return this.lineType===e.HelperLineType.Center}}e.HelperLine=a;function o(c){return c.type===e.HELPER_LINE}e.isHelperLine=o,e.SELECTION_BOUNDS="selection-bounds";class s extends n.GShapeElement{constructor(u){super(),this.id=(0,t.v4)(),this.type=e.SELECTION_BOUNDS,u&&(this.bounds=u)}}e.SelectionBounds=s;function r(c){return c.type===e.SELECTION_BOUNDS}e.isSelectionBounds=r,e.getDirectionOf=n.Vector.direction;function d(c){return c===i.ResizeHandleLocation.TopLeft?[n.Direction.Up,n.Direction.Left]:c===i.ResizeHandleLocation.TopRight?[n.Direction.Up,n.Direction.Right]:c===i.ResizeHandleLocation.BottomLeft?[n.Direction.Down,n.Direction.Left]:c===i.ResizeHandleLocation.BottomRight?[n.Direction.Down,n.Direction.Right]:[]}e.getDirectionFrom=d;var l=Y();Object.defineProperty(e,"Direction",{enumerable:!0,get:function(){return l.Direction}})}(oS)),oS}var x5;function LP(){if(x5)return Mo;x5=1;var e=Mo&&Mo.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Mo&&Mo.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)},t=Mo&&Mo.__param||function(r,d){return function(l,c){d(l,c,r)}};Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.PositionSnapper=void 0;const i=Y(),a=G(),o=uh();let s=class{constructor(d,l){this.snapper=d,this.helperLineManager=l}snapPosition(d,l,c=!0){return c&&this.snapper?this.snapper.snap(d,l):{x:d.x,y:d.y}}snapDelta(d,l,c,u){const f=this.snapPosition(d,l,c),h=this.getMinimumDelta(l,c,u);return h&&(f.x=Math.abs(f.x)>=h.x?f.x:0,f.y=Math.abs(f.y)>=h.y?f.y:0),f}getMinimumDelta(d,l,c){return this.getHelperLineMinimum(d,l,c)}getHelperLineMinimum(d,l,c){if(!this.helperLineManager)return;const u=d.root.children.filter(h=>(0,o.isHelperLine)(h));if(u.length===0)return;const f={x:0,y:0};return c.includes(o.Direction.Left)&&u.some(h=>h.isLeft||h.isCenter)?f.x=this.helperLineManager.getMinimumMoveDelta(d,l,o.Direction.Left):c.includes(o.Direction.Right)&&u.some(h=>h.isRight||h.isCenter)&&(f.x=this.helperLineManager.getMinimumMoveDelta(d,l,o.Direction.Right)),c.includes(o.Direction.Up)&&u.some(h=>h.isTop||h.isMiddle)?f.y=this.helperLineManager.getMinimumMoveDelta(d,l,o.Direction.Up):c.includes(o.Direction.Down)&&u.some(h=>h.isBottom||h.isMiddle)&&(f.y=this.helperLineManager.getMinimumMoveDelta(d,l,o.Direction.Down)),f}};return Mo.PositionSnapper=s,Mo.PositionSnapper=s=e([(0,a.injectable)(),t(0,(0,a.optional)()),t(0,(0,a.inject)(i.TYPES.ISnapper)),t(1,(0,a.optional)()),t(1,(0,a.inject)(i.TYPES.IHelperLineManager)),n("design:paramtypes",[Object,Object])],s),Mo}var ju={},Jp={},F5;function sf(){if(F5)return Jp;F5=1,Object.defineProperty(Jp,"__esModule",{value:!0}),Jp.LayoutAware=void 0;var e;return function(n){function t(d){return"layoutData"in d}n.is=t;function i(d){return t(d)?d.layoutData:void 0}n.getLayoutData=i;function a(d,l){d.layoutData=l}n.setLayoutData=a;function o(d,l){r(d).layoutData.computedDimensions=l}n.setComputedDimensions=o;function s(d){var l;return(l=i(d))===null||l===void 0?void 0:l.computedDimensions}n.getComputedDimensions=s;function r(d){var l;return d.layoutData=(l=d.layoutData)!==null&&l!==void 0?l:{},d}}(e||(Jp.LayoutAware=e={})),Jp}var k5;function E9(){if(k5)return ju;k5=1;var e=ju&&ju.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(ju,"__esModule",{value:!0}),ju.FreeFormLayouter=void 0;const n=Y(),t=G(),i=sf();let a=class extends n.AbstractLayout{layout(s,r){const d=r.getBoundsData(s),l=this.getLayoutOptions(s),c=this.getChildrenSize(s,l,r),u=c.width>0?c.width+l.paddingLeft+l.paddingRight:0,f=c.height>0?c.height+l.paddingTop+l.paddingBottom:0;if(c.width>0&&c.height>0){const h=this.layoutChildren(s,r,l,u,f),p=this.getComputedContainerDimensions(l,c.width,c.height);i.LayoutAware.setComputedDimensions(d,p),d.bounds=this.getFinalContainerBounds(s,h,l,p.width,p.height),d.boundsChanged=!0}else d.bounds={x:d.bounds.x,y:d.bounds.y,width:0,height:0},d.boundsChanged=!0}getChildrenSize(s,r,d){let l=0,c=0;return s.children.forEach(u=>{const f=d.getBoundsData(u).bounds;if(f!==void 0&&n.Dimension.isValid(f)){const h=f.x+f.width,p=f.y+f.height;l=Math.max(l,h),c=Math.max(c,p)}}),{width:l,height:c}}layoutChild(s,r,d,l,c,u,f,h){return r.bounds={x:s.bounds.x,y:s.bounds.y,width:d.width,height:d.height},r.boundsChanged=!0,u}getComputedContainerDimensions(s,r,d){return{width:r+s.paddingLeft+s.paddingRight,height:d+s.paddingTop+s.paddingBottom}}getFinalContainerBounds(s,r,d,l,c){return{x:s.bounds.x,y:s.bounds.y,width:Math.max(d.minWidth,l),height:Math.max(d.minHeight,c)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingFactor:1,minWidth:0,minHeight:0}}spread(s,r){return{...s,...r}}};return ju.FreeFormLayouter=a,a.KIND="freeform",ju.FreeFormLayouter=a=e([(0,t.injectable)()],a),ju}var Ao={},Ei={},K5;function lh(){if(K5)return Ei;K5=1;var e=Ei&&Ei.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Ei&&Ei.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=Ei&&Ei.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(Ei,"__esModule",{value:!0}),Ei.LocalComputedBoundsCommand=Ei.LocalComputedBoundsAction=Ei.LocalRequestBoundsAction=void 0;const i=Y(),a=G(),o=ch(),s=sf();var r;(function(c){function u(p){return i.RequestBoundsAction.is(p)&&!o.ServerAction.is(p)&&(0,i.hasArrayProp)(p,"elementIDs",!0)}c.is=u;function f(p,g){return{...i.RequestBoundsAction.create(p),elementIDs:g}}c.create=f;function h({root:p},g,m,v){return g.dispatch(c.create(p,v)),{model:p,modelChanged:!1,cause:m}}c.fromCommand=h})(r||(Ei.LocalRequestBoundsAction=r={}));var d;(function(c){function u(h){return i.ComputedBoundsAction.is(h)&&o.ServerAction.is(h)}c.is=u;function f(h){return o.ServerAction.mark(h),h}c.mark=f})(d||(Ei.LocalComputedBoundsAction=d={}));let l=class extends i.Command{constructor(u){super(),this.action=u}execute(u){var f,h;return d.is(this.action)?(this.viewerOptions.needsClientLayout&&(this.computedBoundsApplicator.apply(u.root,this.action),(f=this.action.layoutData)===null||f===void 0||f.forEach(({elementId:p,layoutData:g})=>{const m=u.root.index.getById(p);m!==void 0&&s.LayoutAware.setLayoutData(m,g)})),u.root):((h=this.action.layoutData)===null||h===void 0||h.forEach(({elementId:p,layoutData:g})=>{const m=u.root.index.getById(p);m!==void 0&&s.LayoutAware.setLayoutData(m,g)}),{model:u.root,modelChanged:!1})}undo(u){return u.root}redo(u){return u.root}};return Ei.LocalComputedBoundsCommand=l,l.KIND=i.ComputedBoundsAction.KIND,e([(0,a.inject)(i.ComputedBoundsApplicator),n("design:type",i.ComputedBoundsApplicator)],l.prototype,"computedBoundsApplicator",void 0),e([(0,a.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],l.prototype,"viewerOptions",void 0),Ei.LocalComputedBoundsCommand=l=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],l),Ei}var q5;function C9(){if(q5)return Ao;q5=1;var e=Ao&&Ao.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Ao&&Ao.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.GLSPHiddenBoundsUpdater=Ao.BoundsDataExt=void 0;const t=Y(),i=G(),a=kt(),o=sf(),s=lh();class r extends t.BoundsData{}Ao.BoundsDataExt=r;let d=class extends t.HiddenBoundsUpdater{constructor(){super(...arguments),this.element2route=[]}getElement2BoundsData(){return this.element2boundsData}decorate(c,u){return super.decorate(c,u),(0,a.isRoutable)(u)&&this.element2route.push((0,a.calcElementAndRoute)(u,this.edgeRouterRegistry)),c}postUpdate(c){s.LocalRequestBoundsAction.is(c)&&c.elementIDs&&this.focusOnElements(c.elementIDs),this.getBoundsFromDOM(),this.layouter.layout(this.getElement2BoundsData());const u=[],f=[],h=[];this.getElement2BoundsData().forEach((_,S)=>{if(_.boundsChanged&&_.bounds!==void 0){const E={elementId:S.id,newSize:{width:_.bounds.width,height:_.bounds.height}};S instanceof t.GChildElement&&(0,t.isLayoutContainer)(S.parent)&&(E.newPosition={x:_.bounds.x,y:_.bounds.y}),u.push(E)}_.alignmentChanged&&_.alignment!==void 0&&f.push({elementId:S.id,newAlignment:_.alignment}),o.LayoutAware.is(_)&&h.push({elementId:S.id,layoutData:_.layoutData})});const p=this.element2route.length===0?void 0:this.element2route,g=c.requestId,m=this.root!==void 0?this.root.revision:void 0,v=t.ComputedBoundsAction.create(u,{revision:m,alignments:f,layoutData:h,routes:p,responseId:g});s.LocalRequestBoundsAction.is(c)&&s.LocalComputedBoundsAction.mark(v),this.actionDispatcher.dispatch(v),this.getElement2BoundsData().clear(),this.element2route=[]}focusOnElements(c){const u=this.getElement2BoundsData();if(u.size>0){const f=[...u.keys()][0].index,h=new Set(c.flatMap(p=>this.expandElementId(p,f,c)));u.forEach((p,g)=>!h.has(g.id)&&u.delete(g))}}expandElementId(c,u,f){return(0,a.getDescendantIds)(u.getById(c))}};return Ao.GLSPHiddenBoundsUpdater=d,e([(0,i.inject)(t.EdgeRouterRegistry),(0,i.optional)(),n("design:type",t.EdgeRouterRegistry)],d.prototype,"edgeRouterRegistry",void 0),Ao.GLSPHiddenBoundsUpdater=d=e([(0,i.injectable)()],d),Ao}var Nu={},H5;function P9(){if(H5)return Nu;H5=1;var e=Nu&&Nu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.HBoxLayouterExt=void 0;const n=Y(),t=G(),i=sf();let a=class extends n.HBoxLayouter{layout(s,r){var d,l;const c=r.getBoundsData(s),u=this.getLayoutOptions(s),f=this.getChildrenSize(s,u,r),h=this.getFixedContainerBounds(s,u,r),p=c.bounds?((d=c.bounds)===null||d===void 0?void 0:d.width)-u.paddingLeft-u.paddingRight:0,g=c.bounds?((l=c.bounds)===null||l===void 0?void 0:l.height)-u.paddingTop-u.paddingBottom:0,m=u.paddingFactor*(u.resizeContainer?Math.max(h.width-u.paddingLeft-u.paddingRight,f.width):Math.max(0,h.width-u.paddingLeft-u.paddingRight)),v=u.paddingFactor*(u.resizeContainer?Math.max(h.height-u.paddingTop-u.paddingBottom,f.height):Math.max(0,h.height-u.paddingTop-u.paddingBottom)),_=Math.max(p,m),S=Math.max(g,v),E=_-f.width,C=s.children.map(M=>this.getChildLayoutOptions(M,u)).filter(M=>M.hGrab).length;if(_>0&&S>0){const M=this.layoutChildren(s,r,u,_,S,E,C),L=this.getComputedContainerDimensions(u,f.width,f.height);i.LayoutAware.setComputedDimensions(c,L),c.bounds=this.getFinalContainerBounds(s,M,u,L.width,L.height),c.boundsChanged=!0}}getChildrenSize(s,r,d){let l=0,c=-1,u=!0;return s.children.forEach(h=>{if((0,n.isLayoutableChild)(h)){const p=d.getBoundsData(h).bounds;p!==void 0&&n.Dimension.isValid(p)&&(l+=p.width,u?u=!1:l+=r.hGap,c=Math.max(c,p.height))}}),{width:l,height:c}}layoutChildren(s,r,d,l,c,u,f){let h={x:d.paddingLeft+.5*(l-l/d.paddingFactor),y:d.paddingTop+.5*(c-c/d.paddingFactor)};return s.children.forEach(p=>{if((0,n.isLayoutableChild)(p)){const g=r.getBoundsData(p),m=g.bounds,v=this.getChildLayoutOptions(p,d);m!==void 0&&n.Dimension.isValid(m)&&(h=this.layoutChild(p,g,m,v,d,h,l,c,u,f))}}),h}layoutChild(s,r,d,l,c,u,f,h,p,g){const m=l.vGrab?"top":l.vAlign,v=this.getDy(m,d,h);let _=super.layoutChild(s,r,d,l,c,u,f,h);if(r.bounds={...r.bounds,x:u.x,y:u.y+v},l.vGrab&&(r.bounds={x:r.bounds.x,y:r.bounds.y,width:r.bounds.width,height:h},r.boundsChanged=!0),l.hGrab&&p&&g){const S=r.bounds.width+p/g;r.bounds={x:r.bounds.x,y:r.bounds.y,width:S,height:r.bounds.height},r.boundsChanged=!0,_={x:u.x+S,y:u.y}}return _}getFixedContainerBounds(s,r,d){var l,c;const u=s;if((0,n.isBoundsAware)(u)){const f=u.bounds,h=this.getElementLayoutOptions(u),p=(l=h==null?void 0:h.prefWidth)!==null&&l!==void 0?l:0,g=(c=h==null?void 0:h.prefHeight)!==null&&c!==void 0?c:0;return{...f,width:p,height:g}}return n.Bounds.EMPTY}getChildLayoutOptions(s,r){return super.getChildLayoutOptions(s,this.filterContainerOptions(r))}getLayoutOptions(s){return super.getLayoutOptions(s)}getElementLayoutOptions(s){return s.layoutOptions}getComputedContainerDimensions(s,r,d){return{width:r+s.paddingLeft+s.paddingRight,height:d+s.paddingTop+s.paddingBottom}}getFinalContainerBounds(s,r,d,l,c){var u,f;const h=this.getElementLayoutOptions(s),p=(u=h==null?void 0:h.prefWidth)!==null&&u!==void 0?u:d.minWidth,g=(f=h==null?void 0:h.prefHeight)!==null&&f!==void 0?f:d.minHeight;return{x:s.bounds.x,y:s.bounds.y,width:Math.max(p,l),height:Math.max(g,c)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(s){return{...s,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};return Nu.HBoxLayouterExt=a,a.KIND=n.HBoxLayouter.KIND,Nu.HBoxLayouterExt=a=e([(0,t.injectable)()],a),Nu}var ca={},V5;function R9(){if(V5)return ca;V5=1;var e=ca&&ca.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(ca,"__esModule",{value:!0}),ca.StatefulLayouterExt=ca.LayouterExt=void 0;const n=G(),t=Y();let i=class extends t.Layouter{layout(s){new a(s,this.layoutRegistry,this.logger).layout()}};ca.LayouterExt=i,ca.LayouterExt=i=e([(0,n.injectable)()],i);class a extends t.StatefulLayouter{constructor(s,r,d){super(s,r,d),this.elementToBoundsData=s,this.layoutRegistry2=r,this.toBeLayouted2=[],s.forEach((l,c)=>{(0,t.isLayoutContainer)(c)&&this.toBeLayouted2.push(c)});for(const l of this.toBeLayouted2)s.delete(l)}getBoundsData(s){let r=this.elementToBoundsData.get(s),d=s.bounds;return(0,t.isLayoutContainer)(s)&&this.toBeLayouted2.indexOf(s)>=0?d=this.doLayout(s):(0,t.isLayoutContainer)(s)&&(d={x:0,y:0,width:-1,height:-1}),r||(r={bounds:d,boundsChanged:!1,alignmentChanged:!1},this.elementToBoundsData.set(s,r)),r}layout(){for(;this.toBeLayouted2.length>0;){const s=this.toBeLayouted2[0];this.doLayout(s)}for(this.toBeLayouted2=[],this.elementToBoundsData.forEach((s,r)=>{(0,t.isLayoutContainer)(r)&&this.toBeLayouted2.push(r)});this.toBeLayouted2.length>0;){const s=this.toBeLayouted2[0];this.doLayout(s)}}doLayout(s){const r=this.toBeLayouted2.indexOf(s);r>=0&&this.toBeLayouted2.splice(r,1);const d=this.layoutRegistry2.get(s.layout);d&&d.layout(s,this);const l=this.elementToBoundsData.get(s);return l!==void 0&&l.bounds!==void 0?l.bounds:(this.log.error(s,"Layout failed"),t.Bounds.EMPTY)}}return ca.StatefulLayouterExt=a,ca}var wo={},G5;function zm(){if(G5)return wo;G5=1;var e=wo&&wo.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=wo&&wo.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)};Object.defineProperty(wo,"__esModule",{value:!0}),wo.SetBoundsFeedbackCommand=wo.SetBoundsFeedbackAction=void 0;const t=Y(),i=G(),a=cl(),o=lh();var s;(function(d){d.KIND="setBoundsFeedback";function l(u){return t.Action.hasKind(u,d.KIND)}d.is=l;function c(u){return{kind:d.KIND,bounds:u}}d.create=c})(s||(wo.SetBoundsFeedbackAction=s={}));let r=class extends t.SetBoundsCommand{constructor(){super(...arguments),this.rank=a.Ranked.DEFAULT_RANK}execute(l){super.execute(l),this.action.bounds.forEach(u=>{var f;const h=l.root.index.getById(u.elementId);if(h&&(0,t.isLayoutContainer)(h)){const p=(f=h.layoutOptions)!==null&&f!==void 0?f:{};p.prefHeight=u.newSize.height,p.prefWidth=u.newSize.width,h.layoutOptions=p}});const c=this.action.bounds.map(u=>u.elementId);return o.LocalRequestBoundsAction.fromCommand(l,this.actionDispatcher,this.action,c)}};return wo.SetBoundsFeedbackCommand=r,r.KIND=s.KIND,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],r.prototype,"actionDispatcher",void 0),wo.SetBoundsFeedbackCommand=r=e([(0,i.injectable)()],r),wo}var Bu={},z5;function M9(){if(z5)return Bu;z5=1;var e=Bu&&Bu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Bu,"__esModule",{value:!0}),Bu.VBoxLayouterExt=void 0;const n=Y(),t=G(),i=sf();let a=class extends n.VBoxLayouter{layout(s,r){var d,l;const c=r.getBoundsData(s),u=this.getLayoutOptions(s),f=this.getChildrenSize(s,u,r),h=this.getFixedContainerBounds(s,u,r),p=(((d=c.bounds)===null||d===void 0?void 0:d.width)||0)-u.paddingLeft-u.paddingRight,g=(((l=c.bounds)===null||l===void 0?void 0:l.height)||0)-u.paddingTop-u.paddingBottom,m=u.paddingFactor*(u.resizeContainer?Math.max(h.width-u.paddingLeft-u.paddingRight,f.width):Math.max(0,h.width-u.paddingLeft-u.paddingRight)),v=u.paddingFactor*(u.resizeContainer?Math.max(h.height-u.paddingTop-u.paddingBottom,f.height):Math.max(0,h.height-u.paddingTop-u.paddingBottom)),_=Math.max(p,m),S=Math.max(g,v),E=S-f.height,C=s.children.map(M=>this.getChildLayoutOptions(M,u)).filter(M=>M.vGrab).length;if(m>0&&v>0){const M=this.layoutChildren(s,r,u,_,S,E,C),L=this.getComputedContainerDimensions(u,f.width,f.height);i.LayoutAware.setComputedDimensions(c,L),c.bounds=this.getFinalContainerBounds(s,M,u,L.width,L.height),c.boundsChanged=!0}}getChildrenSize(s,r,d){let l=-1,c=0,u=!0;return s.children.forEach(h=>{if((0,n.isLayoutableChild)(h)){const p=d.getBoundsData(h).bounds;p!==void 0&&n.Dimension.isValid(p)&&(c+=p.height,u?u=!1:c+=r.vGap,l=Math.max(l,p.width))}}),{width:l,height:c}}layoutChildren(s,r,d,l,c,u,f){let h={x:d.paddingLeft+.5*(l-l/d.paddingFactor),y:d.paddingTop+.5*(c-c/d.paddingFactor)};return s.children.forEach(p=>{if((0,n.isLayoutableChild)(p)){const g=r.getBoundsData(p),m=g.bounds,v=this.getChildLayoutOptions(p,d);m!==void 0&&n.Dimension.isValid(m)&&(h=this.layoutChild(p,g,m,v,d,h,l,c,u,f))}}),h}layoutChild(s,r,d,l,c,u,f,h,p,g){const m=l.hGrab?"left":l.hAlign,v=this.getDx(m,d,f);let _=super.layoutChild(s,r,d,l,c,u,f,h);if(r.bounds={...r.bounds,x:u.x+v,y:u.y},l.hGrab&&(r.bounds={x:r.bounds.x,y:r.bounds.y,width:f,height:r.bounds.height},r.boundsChanged=!0),l.vGrab&&p&&g){const S=r.bounds.height+p/g;r.bounds={x:r.bounds.x,y:r.bounds.y,width:r.bounds.width,height:S},r.boundsChanged=!0,_={x:u.x,y:u.y+S}}return _}getFixedContainerBounds(s,r,d){var l,c;const u=s;if((0,n.isBoundsAware)(u)){const f=u.bounds,h=this.getElementLayoutOptions(u),p=(l=h==null?void 0:h.prefWidth)!==null&&l!==void 0?l:0,g=(c=h==null?void 0:h.prefHeight)!==null&&c!==void 0?c:0;return{...f,width:p,height:g}}return n.Bounds.EMPTY}getChildLayoutOptions(s,r){return super.getChildLayoutOptions(s,this.filterContainerOptions(r))}getLayoutOptions(s){return super.getLayoutOptions(s)}getElementLayoutOptions(s){return s.layoutOptions}getComputedContainerDimensions(s,r,d){return{width:r+s.paddingLeft+s.paddingRight,height:d+s.paddingTop+s.paddingBottom}}getFinalContainerBounds(s,r,d,l,c){var u,f;const h=this.getElementLayoutOptions(s),p=(u=h==null?void 0:h.prefWidth)!==null&&u!==void 0?u:d.minWidth,g=(f=h==null?void 0:h.prefHeight)!==null&&f!==void 0?f:d.minHeight;return{x:s.bounds.x,y:s.bounds.y,width:Math.max(p,l),height:Math.max(g,c)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(s){return{...s,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};return Bu.VBoxLayouterExt=a,a.KIND=n.VBoxLayouter.KIND,Bu.VBoxLayouterExt=a=e([(0,t.injectable)()],a),Bu}var U5;function A9(){if(U5)return Qp;U5=1,Object.defineProperty(Qp,"__esModule",{value:!0}),Qp.boundsModule=void 0;const e=Y(),n=LP(),t=E9(),i=C9(),a=P9(),o=R9(),s=lh(),r=zm(),d=M9();return Qp.boundsModule=new e.FeatureModule((l,c,u,f)=>{const h={bind:l,isBound:u};(0,e.configureCommand)(h,e.SetBoundsCommand),(0,e.configureCommand)(h,e.RequestBoundsCommand),l(e.HiddenBoundsUpdater).toSelf().inSingletonScope(),(0,e.bindAsService)(h,e.TYPES.HiddenVNodePostprocessor,i.GLSPHiddenBoundsUpdater),(0,e.configureCommand)(h,s.LocalComputedBoundsCommand),(0,e.configureCommand)(h,r.SetBoundsFeedbackCommand),l(e.TYPES.Layouter).to(o.LayouterExt).inSingletonScope(),l(e.TYPES.LayoutRegistry).to(e.LayoutRegistry).inSingletonScope(),(0,e.configureLayout)(h,e.VBoxLayouter.KIND,d.VBoxLayouterExt),(0,e.configureLayout)(h,e.HBoxLayouter.KIND,a.HBoxLayouterExt),(0,e.configureLayout)(h,t.FreeFormLayouter.KIND,t.FreeFormLayouter),l(n.PositionSnapper).toSelf()},{featureId:Symbol("bounds")}),Qp}var Xp={},xu={},$5;function w9(){if($5)return xu;$5=1;var e=xu&&xu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(xu,"__esModule",{value:!0}),xu.GlspCommandPalette=void 0;const n=Y(),t=G(),i=Ya();let a=class extends n.CommandPalette{initializeContents(s){super.initializeContents(s),s.classList.add(i.CSS_UI_EXTENSION_CLASS)}setContainerVisible(s){var r,d;s?(r=this.containerElement)===null||r===void 0||r.classList.remove(i.CSS_HIDDEN_EXTENSION_CLASS):(d=this.containerElement)===null||d===void 0||d.classList.add(i.CSS_HIDDEN_EXTENSION_CLASS)}};return xu.GlspCommandPalette=a,xu.GlspCommandPalette=a=e([(0,t.injectable)()],a),xu}var ua={},Y5;function I9(){if(Y5)return ua;Y5=1;var e=ua&&ua.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=ua&&ua.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)},t;Object.defineProperty(ua,"__esModule",{value:!0}),ua.CommandPaletteTool=void 0;const i=G(),a=Y();let o=t=class{postConstruct(){this.commandPaletteKeyListener=this.createCommandPaletteKeyListener()}get id(){return t.ID}enable(){this.keyTool.register(this.commandPaletteKeyListener)}disable(){this.keyTool.deregister(this.commandPaletteKeyListener)}createCommandPaletteKeyListener(){return new a.CommandPaletteKeyListener}};return ua.CommandPaletteTool=o,o.ID="glsp.command-palette-tool",e([(0,i.inject)(a.KeyTool),n("design:type",a.KeyTool)],o.prototype,"keyTool",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],o.prototype,"postConstruct",null),ua.CommandPaletteTool=o=t=e([(0,i.injectable)()],o),ua}var Io={},W5;function T9(){if(W5)return Io;W5=1;var e=Io&&Io.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Io&&Io.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Io,"__esModule",{value:!0}),Io.ServerCommandPaletteActionProvider=Io.ServerCommandPalette=void 0;const t=Y(),i=G(),a=kn();var o;(function(r){r.CONTEXT_ID="command-palette",r.TEXT="text",r.INDEX="index"})(o||(Io.ServerCommandPalette=o={}));let s=class{async getActions(d,l,c,u){const f=t.RequestContextActions.create({contextId:o.CONTEXT_ID,editorContext:this.editorContext.get({[o.TEXT]:l,[o.INDEX]:u||0})}),h=await this.actionDispatcher.requestUntil(f);return h?this.getPaletteActionsFromResponse(h):[]}getPaletteActionsFromResponse(d){return t.SetContextActions.is(d)?d.actions:[]}};return Io.ServerCommandPaletteActionProvider=s,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],s.prototype,"editorContext",void 0),Io.ServerCommandPaletteActionProvider=s=e([(0,i.injectable)()],s),Io}var Z5;function D9(){if(Z5)return Xp;Z5=1,Object.defineProperty(Xp,"__esModule",{value:!0}),Xp.commandPaletteModule=void 0;const e=Y(),n=w9(),t=I9(),i=T9();return Xp.commandPaletteModule=new e.FeatureModule(a=>{(0,e.bindAsService)(a,e.TYPES.IUIExtension,n.GlspCommandPalette),a(e.TYPES.ICommandPaletteActionProviderRegistry).to(e.CommandPaletteActionProviderRegistry).inSingletonScope(),(0,e.bindAsService)(a,e.TYPES.ICommandPaletteActionProvider,i.ServerCommandPaletteActionProvider),(0,e.bindAsService)(a,e.TYPES.IDefaultTool,t.CommandPaletteTool)},{featureId:Symbol("commandPalette")}),Xp}var eg={},la={},Q5;function O9(){if(Q5)return la;Q5=1;var e=la&&la.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=la&&la.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(la,"__esModule",{value:!0}),la.GLSPContextMenuMouseListener=void 0;const t=Y(),i=G(),a=of();let o=class extends t.MouseListener{initialize(){var r;(r=this.contextMenuServiceProvider)===null||r===void 0||r.call(this).then(d=>this.menuService=d)}contextMenu(r,d){return this.openContextMenu(r,d)}openContextMenu(r,d){return!this.menuService||!this.menuProvider?[]:[this.showContextMenuItems(r,d)]}async showContextMenuItems(r,d){await this.handleContextElementSelection(r,d);const l={x:d.x,y:d.y},c=await this.menuProvider.getItems(r.root,l);return this.menuService.show(c,l,()=>this.focusEventTarget(d)),a.FocusStateChangedAction.create(!1)}async handleContextElementSelection(r,d){const l=(0,t.findParentByFeature)(r,t.isSelectable);if(!l)return this.actionDispatcher.dispatch(t.SelectAction.setSelection([]));if(!l.selected)return this.actionDispatcher.dispatch(t.SelectAction.setSelection([l.id]))}focusEventTarget(r){const d=r.target instanceof SVGElement?r.target:void 0,l=d==null?void 0:d.closest("svg");l&&l.focus()}};return la.GLSPContextMenuMouseListener=o,e([(0,i.inject)(t.TYPES.IContextMenuServiceProvider),(0,i.optional)(),n("design:type",Function)],o.prototype,"contextMenuServiceProvider",void 0),e([(0,i.inject)(t.TYPES.IContextMenuProviderRegistry),(0,i.optional)(),n("design:type",t.ContextMenuProviderRegistry)],o.prototype,"menuProvider",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],o.prototype,"actionDispatcher",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],o.prototype,"initialize",null),la.GLSPContextMenuMouseListener=o=e([(0,i.injectable)()],o),la}var To={},J5;function L9(){if(J5)return To;J5=1;var e=To&&To.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=To&&To.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(To,"__esModule",{value:!0}),To.ServerContextMenuItemProvider=To.ServerContextMenu=void 0;const t=Y(),i=G(),a=kn();var o;(function(r){r.CONTEXT_ID="context-menu"})(o||(To.ServerContextMenu=o={}));let s=class{async getItems(d,l){const c=Array.from(d.index.all().filter(t.isSelected).map(p=>p.id)),u=this.editorContext.getWithSelection(c),f=t.RequestContextActions.create({contextId:o.CONTEXT_ID,editorContext:u}),h=await this.actionDispatcher.requestUntil(f);return h?this.getContextActionsFromResponse(h):[]}getContextActionsFromResponse(d){return t.SetContextActions.is(d)?d.actions:[]}};return To.ServerContextMenuItemProvider=s,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],s.prototype,"editorContext",void 0),To.ServerContextMenuItemProvider=s=e([(0,i.injectable)()],s),To}var X5;function j9(){if(X5)return eg;X5=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.contextMenuModule=void 0;const e=Y(),n=O9(),t=L9();return eg.contextMenuModule=new e.FeatureModule(i=>{i(e.TYPES.IContextMenuServiceProvider).toProvider(a=>async()=>a.container.isBound(e.TYPES.IContextMenuService)?a.container.get(e.TYPES.IContextMenuService):(console.warn("'TYPES.IContextMenuService' is not bound. Use no-op implementation instead"),{show:()=>{}})),(0,e.bindAsService)(i,e.TYPES.MouseListener,n.GLSPContextMenuMouseListener),i(e.TYPES.IContextMenuProviderRegistry).to(e.ContextMenuProviderRegistry),(0,e.bindAsService)(i,e.TYPES.IContextMenuItemProvider,t.ServerContextMenuItemProvider)},{featureId:Symbol("contextMenu")}),eg}var aS={},Fr={},e2;function N9(){if(e2)return Fr;e2=1;var e=Fr&&Fr.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=Fr&&Fr.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)};Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.ServerCopyPasteHandler=Fr.LocalClipboardService=void 0;const t=Y(),i=G(),a=Hm(),o=kn();let s=class{clear(){this.currentId=void 0,this.data=void 0}put(h,p){this.currentId=p,this.data=h}get(h){if(h===this.currentId)return this.data}};Fr.LocalClipboardService=s,Fr.LocalClipboardService=s=e([(0,i.injectable)()],s);function r(f){return JSON.stringify({clipboardId:f})}function d(f){return f!==void 0&&"clipboardId"in f}function l(f){const h=f.getData(c),p=h?JSON.parse(h):void 0;return d(p)?p.clipboardId:void 0}const c="text/plain";let u=class{handleCopy(h){if(h.clipboardData&&this.shouldCopy(h)){const p=(0,a.v4)();h.clipboardData.setData(c,r(p)),this.actionDispatcher.request(t.RequestClipboardDataAction.create(this.editorContext.get())).then(g=>this.clipboardService.put(g.clipboardData,p)),h.preventDefault()}else h.clipboardData&&h.clipboardData.clearData(),this.clipboardService.clear()}handleCut(h){h.clipboardData&&this.shouldCopy(h)&&(this.handleCopy(h),this.actionDispatcher.dispatch(t.CutOperation.create(this.editorContext.get())),h.preventDefault())}handlePaste(h){if(h.clipboardData&&this.shouldPaste(h)){const p=l(h.clipboardData),g=this.clipboardService.get(p);g&&this.actionDispatcher.dispatch(t.PasteOperation.create({clipboardData:g,editorContext:this.editorContext.get()})),h.preventDefault()}}shouldCopy(h){return this.editorContext.get().selectedElementIds.length>0&&this.isDiagramActive()}shouldPaste(h){return this.isDiagramActive()}isDiagramActive(){var h,p;return((p=(h=document.activeElement)===null||h===void 0?void 0:h.parentElement)===null||p===void 0?void 0:p.id)===this.viewerOptions.baseDiv}};return Fr.ServerCopyPasteHandler=u,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],u.prototype,"actionDispatcher",void 0),e([(0,i.inject)(t.TYPES.ViewerOptions),n("design:type",Object)],u.prototype,"viewerOptions",void 0),e([(0,i.inject)(t.TYPES.IAsyncClipboardService),n("design:type",Object)],u.prototype,"clipboardService",void 0),e([(0,i.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],u.prototype,"editorContext",void 0),Fr.ServerCopyPasteHandler=u=e([(0,i.injectable)()],u),Fr}var da={},t2;function B9(){if(t2)return da;t2=1;var e=da&&da.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n=da&&da.__metadata||function(o,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,s)};Object.defineProperty(da,"__esModule",{value:!0}),da.CopyPasteStartup=void 0;const t=Y(),i=G();let a=class{constructor(){this.toDispose=new t.DisposableCollection}modelRootChanged(s){s.id!==t.EMPTY_ROOT.id&&(this.graphElementId=this.domHelper.createUniqueDOMElementId(s))}postModelInitialization(){if(!this.copyPasteHandler)return;const s=l=>{var c,u;this.graphElementId&&((c=document.activeElement)===null||c===void 0?void 0:c.id)===this.graphElementId&&((u=this.copyPasteHandler)===null||u===void 0||u.handleCopy(l))},r=l=>{var c,u;this.graphElementId&&((c=document.activeElement)===null||c===void 0?void 0:c.id)===this.graphElementId&&((u=this.copyPasteHandler)===null||u===void 0||u.handleCut(l))},d=l=>{var c,u;this.graphElementId&&((c=document.activeElement)===null||c===void 0?void 0:c.id)===this.graphElementId&&((u=this.copyPasteHandler)===null||u===void 0||u.handlePaste(l))};window.addEventListener("copy",s),window.addEventListener("cut",r),window.addEventListener("paste",d),this.toDispose.push(t.Disposable.create(()=>{window.removeEventListener("copy",s),window.removeEventListener("cut",r),window.removeEventListener("paste",d)}))}dispose(){this.toDispose.dispose()}};return da.CopyPasteStartup=a,e([(0,i.inject)(t.TYPES.ICopyPasteHandler),(0,i.optional)(),n("design:type",Object)],a.prototype,"copyPasteHandler",void 0),e([(0,i.inject)(t.TYPES.DOMHelper),n("design:type",t.DOMHelper)],a.prototype,"domHelper",void 0),e([(0,i.preDestroy)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],a.prototype,"dispose",null),da.CopyPasteStartup=a=e([(0,i.injectable)()],a),da}var n2;function jP(){return n2||(n2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.standaloneCopyPasteModule=e.copyPasteModule=void 0;const n=Y(),t=N9(),i=B9();e.copyPasteModule=new n.FeatureModule((a,o,s)=>{a(n.TYPES.ICopyPasteHandler).to(t.ServerCopyPasteHandler),a(n.TYPES.IAsyncClipboardService).to(t.LocalClipboardService).inSingletonScope()},{featureId:Symbol("copyPaste")}),e.standaloneCopyPasteModule=new n.FeatureModule((a,o,s)=>{(0,n.bindAsService)(a,n.TYPES.IDiagramStartup,i.CopyPasteStartup),a(n.TYPES.IGModelRootListener).toService(i.CopyPasteStartup)},{featureId:Symbol("standaloneCopyPaste"),requires:e.copyPasteModule})}(aS)),aS}var tg={},Fu={},i2;function x9(){if(i2)return Fu;i2=1;var e=Fu&&Fu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n;Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.GlspDecorationPlacer=void 0;const t=Y(),i=G();let a=n=class extends t.DecorationPlacer{getPosition(s){return s instanceof t.GChildElement&&s.parent instanceof t.GRoutableElement?super.getPosition(s):(0,t.isSizeable)(s)?{x:-n.DECORATION_OFFSET.x,y:-n.DECORATION_OFFSET.y}:t.Point.ORIGIN}};return Fu.GlspDecorationPlacer=a,a.DECORATION_OFFSET={x:12,y:10},Fu.GlspDecorationPlacer=a=n=e([(0,i.injectable)()],a),Fu}var r2;function F9(){if(r2)return tg;r2=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.decorationModule=void 0;const e=Y(),n=x9();return tg.decorationModule=new e.FeatureModule(t=>{(0,e.bindAsService)(t,e.TYPES.IVNodePostprocessor,n.GlspDecorationPlacer)},{featureId:Symbol("decoration")}),tg}var ng={},Hn={},o2;function I_(){if(o2)return Hn;o2=1;var e=Hn&&Hn.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=Hn&&Hn.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)},t=Hn&&Hn.__param||function(p,g){return function(m,v){g(m,v,p)}};Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.templateToSchema=Hn.AddTemplateElementsFeedbackCommand=Hn.getTemplateElementId=Hn.AddTemplateElementsAction=void 0;const i=Y(),a=G(),o=Cr(),s=kt(),r=lh();var d;(function(p){p.KIND="addTemplateElements";function g(m){return{kind:p.KIND,...m}}p.create=g})(d||(Hn.AddTemplateElementsAction=d={}));function l(p){return typeof p=="string"?`${p}_feedback`:p.id}Hn.getTemplateElementId=l;let c=class extends o.FeedbackCommand{constructor(g){super(),this.action=g}execute(g){const m=this.action.templates.map(_=>u(_,g)).filter(s.isNotUndefined).map(_=>g.modelFactory.createElement(_)).map(_=>this.applyRootCssClasses(_,this.action.addClasses,this.action.removeClasses));m.forEach(_=>g.root.add(_));const v=m.map(_=>_.id);return r.LocalRequestBoundsAction.fromCommand(g,this.actionDispatcher,this.action,v)}applyRootCssClasses(g,m,v){return g.cssClasses=h(g.cssClasses,m,v),g}};Hn.AddTemplateElementsFeedbackCommand=c,c.KIND=d.KIND,e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],c.prototype,"actionDispatcher",void 0),Hn.AddTemplateElementsFeedbackCommand=c=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],c);function u(p,g){if(typeof p=="string"){const m=g.root.index.getById(p),v=m?g.modelFactory.createSchema(m):void 0;return v&&f(v),v}return p}Hn.templateToSchema=u;function f(p){var g;return p.id=l(p.id),(g=p.children)===null||g===void 0||g.forEach(m=>f(m)),p}function h(p,g,m){const v=p??[];return g&&(0,i.distinctAdd)(v,...g),m&&(0,i.remove)(v,...m),v}return Hn}var ar={},s2;function NP(){if(s2)return ar;s2=1;var e=ar&&ar.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=ar&&ar.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=ar&&ar.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(ar,"__esModule",{value:!0}),ar.RemoveTemplateElementsFeedbackCommand=ar.RemoveTemplateElementsAction=void 0;const i=Y(),a=G(),o=Cr(),s=I_();var r;(function(l){l.KIND="removeTemplateElements";function c(u){return{kind:l.KIND,...u}}l.create=c})(r||(ar.RemoveTemplateElementsAction=r={}));let d=class extends o.FeedbackCommand{constructor(c){super(),this.action=c}execute(c){const u=c.root.index;for(const f of this.action.templates){const h=u.getById((0,s.getTemplateElementId)(f));h&&h instanceof i.GChildElement&&h.parent.remove(h)}return c.root}};return ar.RemoveTemplateElementsFeedbackCommand=d,d.KIND=r.KIND,ar.RemoveTemplateElementsFeedbackCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],d),ar}var a2;function BP(){if(a2)return ng;a2=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.elementTemplateModule=void 0;const e=Y(),n=I_(),t=NP();return ng.elementTemplateModule=new e.FeatureModule((i,a,o,s)=>{const r={bind:i,unbind:a,isBound:o,rebind:s};(0,e.configureCommand)(r,n.AddTemplateElementsFeedbackCommand),(0,e.configureCommand)(r,t.RemoveTemplateElementsFeedbackCommand)},{featureId:Symbol("elementTemplate")}),ng}var cS={},ku={},c2;function k9(){if(c2)return ku;c2=1;var e=ku&&ku.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(ku,"__esModule",{value:!0}),ku.ExportSvgActionHandler=void 0;const n=_P(),t=G();let i=class{handle(o){const s=new Blob([o.svg],{type:"text/plain;charset=utf-8"});(0,n.saveAs)(s,"diagram.svg")}};return ku.ExportSvgActionHandler=i,ku.ExportSvgActionHandler=i=e([(0,t.injectable)()],i),ku}var Ku={},u2;function K9(){if(u2)return Ku;u2=1;var e=Ku&&Ku.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.GLSPSvgExporter=void 0;const n=Y(),t=G(),i=Hm();let a=class extends n.SvgExporter{export(s,r){var d;if(typeof document<"u"){let l=this.findSvgElement();if(l){l=this.prepareSvgElement(l,s,r);const c=this.createSvg(l,s,(d=r==null?void 0:r.options)!==null&&d!==void 0?d:{},r),u=this.getSvgExport(c,l,s,r);this.actionDispatcher.dispatch(n.ExportSvgAction.create(u,{responseId:r==null?void 0:r.requestId,options:r==null?void 0:r.options}))}}}createSvg(s,r,d,l){const c=s.id;try{return s.id=c||(0,i.v4)(),super.createSvg(s,r,d,l)}finally{s.id=c}}findSvgElement(){const s=document.getElementById(this.options.hiddenDiv);return s&&s.querySelector("svg")}prepareSvgElement(s,r,d){return s}copyStyles(s,r,d){this.copyStyle(s,r,d);for(let l=0;l<s.childNodes.length;++l){const c=s.childNodes[l],u=r.childNodes[l];c instanceof Element&&this.copyStyles(c,u,[])}}copyStyle(s,r,d){const l=getComputedStyle(s),c=getComputedStyle(r);let u="";for(let f=0;f<l.length;f++){const h=l[f];if(!d.includes(h)){const p=l.getPropertyValue(h),g=l.getPropertyPriority(h);c.getPropertyValue(h)!==p&&(this.shouldUpdateStyle(r)?r.style.setProperty(h,p):u+=`${h}: ${p}${g?" !"+g:""}; `)}}u!==""&&r.setAttribute("style",u.trim())}shouldUpdateStyle(s){return"tagName"in s&&"style"in s}getSvgExport(s,r,d,l){const c=this.getSvgExportStyle(r,d,l);return c?s.replace('style="',`style="${c}`):s}getSvgExportStyle(s,r,d){const l=this.getBounds(r,document);return`width: ${l.width}px !important;height: ${l.height}px !important;border: none !important;cursor: default !important;`}};return Ku.GLSPSvgExporter=a,Ku.GLSPSvgExporter=a=e([(0,t.injectable)()],a),Ku}var l2;function xP(){return l2||(l2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.standaloneExportModule=e.exportModule=void 0;const n=Y(),t=k9(),i=K9();e.exportModule=new n.FeatureModule((a,o,s)=>{const r={bind:a,isBound:s};(0,n.bindAsService)(r,n.TYPES.HiddenVNodePostprocessor,n.ExportSvgPostprocessor),(0,n.configureCommand)(r,n.ExportSvgCommand),a(n.TYPES.SvgExporter).to(i.GLSPSvgExporter).inSingletonScope()},{featureId:Symbol("export")}),e.standaloneExportModule=new n.FeatureModule((a,o,s)=>{const r={bind:a,isBound:s};(0,n.bindAsService)(r,n.TYPES.KeyListener,n.ExportSvgKeyListener),a(t.ExportSvgActionHandler).toSelf().inSingletonScope(),(0,n.configureActionHandler)(r,n.ExportSvgAction.KIND,t.ExportSvgActionHandler)},{featureId:Symbol("standaloneExport"),requires:e.exportModule})}(cS)),cS}var ig={},ci={},od={},uS={},d2;function Um(){return d2||(d2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isReparentable=e.reparentFeature=e.isContainable=e.containerFeature=void 0,e.containerFeature=Symbol("containable");function n(i){return i.hasFeature(e.containerFeature)}e.isContainable=n,e.reparentFeature=Symbol("reparentFeature");function t(i){return i.hasFeature(e.reparentFeature)}e.isReparentable=t}(uS)),uS}var f2;function Zr(){if(f2)return od;f2=1,Object.defineProperty(od,"__esModule",{value:!0}),od.GEdge=od.GGraph=void 0;const e=Y(),n=Vm(),t=Um();class i extends e.SGraphImpl{isContainableElement(s){return!0}}od.GGraph=i,i.DEFAULT_FEATURES=[...e.SGraphImpl.DEFAULT_FEATURES,t.containerFeature,n.argsFeature];class a extends e.SEdgeImpl{localToParent(s){const r=(0,e.getRouteBounds)(this.routingPoints),d={x:s.x+r.x,y:s.y+r.y,width:-1,height:-1};return(0,e.isBounds)(s)&&(d.width=s.width,d.height=s.height),d}parentToLocal(s){const r=(0,e.getRouteBounds)(this.routingPoints),d={x:s.x-r.x,y:s.y-r.y,width:-1,height:-1};return(0,e.isBounds)(s)&&(d.width=s.width,d.height=s.height),d}}return od.GEdge=a,a.DEFAULT_FEATURES=[...e.SEdgeImpl.DEFAULT_FEATURES,n.argsFeature],od}var lS={},h2;function T_(){return h2||(h2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.GReconnectHandle=e.createReconnectHandle=e.isTargetRoutingHandle=e.isSourceRoutingHandle=e.removeReconnectHandles=e.addReconnectHandles=e.isReconnectHandle=e.isReconnectable=e.reconnectFeature=void 0;const n=Y();e.reconnectFeature=Symbol("reconnectFeature");function t(u){return u instanceof n.GRoutableElement&&u.hasFeature(e.reconnectFeature)}e.isReconnectable=t;const i=-2;function a(u){return u!==void 0&&u instanceof c}e.isReconnectHandle=a;function o(u){s(u),l(u,"source",i),l(u,"target",u.routingPoints.length)}e.addReconnectHandles=o;function s(u){u.removeAll(f=>f instanceof c)}e.removeReconnectHandles=s;function r(u,f){return f.pointIndex===i}e.isSourceRoutingHandle=r;function d(u,f){return f.pointIndex===u.routingPoints.length}e.isTargetRoutingHandle=d;function l(u,f,h){const p=new c;return p.kind=f,p.pointIndex=h,p.type="routing-point",f==="target"&&u.id===n.edgeInProgressID&&(p.id=n.edgeInProgressTargetHandleID),u.add(p),p}e.createReconnectHandle=l;class c extends n.GRoutingHandle{hasFeature(f){return f!==n.selectFeature&&super.hasFeature(f)}}e.GReconnectHandle=c}(lS)),lS}var p2;function q9(){if(p2)return ci;p2=1;var e=ci&&ci.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},n=ci&&ci.__metadata||function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},t=ci&&ci.__param||function(g,m){return function(v,_){m(v,_,g)}};Object.defineProperty(ci,"__esModule",{value:!0}),ci.TypeHintProvider=ci.ApplyTypeHintsCommand=ci.ApplyTypeHintsAction=void 0;const i=Y(),a=G(),o=Cr(),s=Zr(),r=kt(),d=Pr(),l=T_(),c=Um();var u;(function(g){g.KIND="applyTypeHints";function m(_){return i.Action.hasKind(_,g.KIND)}g.is=m;function v(){return{kind:g.KIND}}g.create=v})(u||(ci.ApplyTypeHintsAction=u={}));let f=class extends o.FeedbackCommand{constructor(m){super(),this.action=m,this.rank=-10}execute(m){return m.root.index.all().forEach(v=>{if(v instanceof i.GShapeElement||v instanceof i.GModelRoot)return this.applyShapeTypeHint(v);v instanceof s.GEdge&&this.applyEdgeTypeHint(v)}),m.root}applyEdgeTypeHint(m){const v=this.typeHintProvider.getEdgeTypeHint(m);v&&m.features instanceof Set&&(h(m.features,i.deletableFeature,v.deletable),h(m.features,i.editFeature,v.routable),h(m.features,l.reconnectFeature,v.repositionable))}applyShapeTypeHint(m){const v=this.typeHintProvider.getShapeTypeHint(m);if(v&&m.features instanceof Set){h(m.features,i.deletableFeature,v.deletable),h(m.features,i.moveFeature,v.repositionable),h(m.features,d.resizeFeature,v.resizable),h(m.features,c.reparentFeature,v.reparentable),h(m.features,c.containerFeature,!0),(0,c.isContainable)(m)&&(m.isContainableElement=S=>this.isContainableElement(S,v));const _=(0,i.isConnectable)(m)?m.canConnect.bind(m):void 0;h(m.features,i.connectableFeature,!0),(0,i.isConnectable)(m)&&(m.canConnect=(S,E)=>this.canConnect(S,E,m,_))}}canConnect(m,v,_,S){var E;const C=this.typeHintProvider.getEdgeTypeHint(m.type);if(!C)return(E=S==null?void 0:S(m,v))!==null&&E!==void 0?E:!1;const M=v==="source"?C.sourceElementTypeIds:C.targetElementTypeIds;if(!M)return!0;const L=_.type+":";return M.some(I=>L.startsWith(I))}isContainableElement(m,v){var _,S;const E=(0,r.getElementTypeId)(m)+":";return(S=(_=v.containableElementTypeIds)===null||_===void 0?void 0:_.some(C=>E.startsWith(C)))!==null&&S!==void 0?S:!1}};ci.ApplyTypeHintsCommand=f,f.KIND=u.KIND,e([(0,a.inject)(i.TYPES.ITypeHintProvider),n("design:type",Object)],f.prototype,"typeHintProvider",void 0),ci.ApplyTypeHintsCommand=f=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],f);function h(g,m,v){v&&!g.has(m)?g.add(m):!v&&g.has(m)&&g.delete(m)}let p=class{constructor(){this.shapeHints=new Map,this.edgeHints=new Map}init(){this.typeHintsFeedback=this.feedbackActionDispatcher.createEmitter()}handle(m){this.shapeHints.clear(),this.edgeHints.clear(),m.shapeHints.forEach(v=>this.shapeHints.set(v.elementTypeId,v)),m.edgeHints.forEach(v=>this.edgeHints.set(v.elementTypeId,v)),this.typeHintsFeedback.add(u.create()).submit()}getShapeTypeHint(m){return this.getTypeHint(m,this.shapeHints)}getEdgeTypeHint(m){return this.getTypeHint(m,this.edgeHints)}getTypeHint(m,v){const _=(0,r.getElementTypeId)(m);let S=v.get(_);if(S===void 0){const E=_.split(":");for(;S===void 0&&E.length>0;)if(E.pop(),S=v.get(E.join(":")),S){v.set(_,S);break}}return S}async postRequestModel(){const m=await this.actionDispatcher.request(i.RequestTypeHintsAction.create());this.handle(m)}};return ci.TypeHintProvider=p,e([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],p.prototype,"feedbackActionDispatcher",void 0),e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],p.prototype,"actionDispatcher",void 0),e([(0,a.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],p.prototype,"init",null),ci.TypeHintProvider=p=e([(0,a.injectable)()],p),ci}var g2;function H9(){if(g2)return ig;g2=1,Object.defineProperty(ig,"__esModule",{value:!0}),ig.typeHintsModule=void 0;const e=Y(),n=q9();return ig.typeHintsModule=new e.FeatureModule((t,i,a)=>{const o={bind:t,unbind:i,isBound:a};(0,e.bindAsService)(o,e.TYPES.ITypeHintProvider,n.TypeHintProvider),t(e.TYPES.IDiagramStartup).toService(n.TypeHintProvider),(0,e.configureActionHandler)(o,e.SetTypeHintsAction.KIND,n.TypeHintProvider),(0,e.configureCommand)(o,n.ApplyTypeHintsCommand)},{featureId:Symbol("typeHints")}),ig}var rg={},qu={},Do={},kr={},m2;function Wa(){if(m2)return kr;m2=1;var e=kr&&kr.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=kr&&kr.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)};Object.defineProperty(kr,"__esModule",{value:!0}),kr.BaseCreationTool=kr.BaseEditTool=void 0;const t=Y(),i=G(),a=kn(),o=an(),s=DP(),r=OP();let d=class{constructor(){this.toDisposeOnDisable=new t.DisposableCollection}disable(){this.toDisposeOnDisable.dispose()}get isEditTool(){return!0}dispatchActions(u){return this.actionDispatcher.dispatchAll(u)}createFeedbackEmitter(){return this.feedbackDispatcher.createEmitter()}registerFeedback(u,f=this,h){return this.feedbackDispatcher.registerFeedback(f,u,h)}deregisterFeedback(u=this,f){this.feedbackDispatcher.deregisterFeedback(u,f)}};kr.BaseEditTool=d,e([(0,i.inject)(t.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],d.prototype,"feedbackDispatcher",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],d.prototype,"actionDispatcher",void 0),e([(0,i.inject)(r.GLSPMouseTool),n("design:type",r.GLSPMouseTool)],d.prototype,"mouseTool",void 0),e([(0,i.inject)(s.GLSPKeyTool),n("design:type",s.GLSPKeyTool)],d.prototype,"keyTool",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],d.prototype,"editorContext",void 0),kr.BaseEditTool=d=e([(0,i.injectable)()],d);let l=class extends d{handle(u){if(this.isTriggerAction(u))return this.triggerAction=u,o.EnableToolsAction.create([this.id])}enable(){if(this.triggerAction===void 0)throw new TypeError(`Could not enable tool ${this.id}. The triggerAction cannot be undefined.`);this.doEnable()}};return kr.BaseCreationTool=l,kr.BaseCreationTool=l=e([(0,i.injectable)()],l),kr}var Ic={},Sn={},v2;function Wo(){if(v2)return Sn;v2=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.outsideOfViewport=Sn.absoluteToLocal=Sn.absoluteToParent=Sn.toAbsoluteSize=Sn.toAbsolutePosition=Sn.toAbsoluteBounds=Sn.getViewportBounds=Sn.getAbsolutePositionByPoint=Sn.getAbsolutePosition=void 0;const e=Y();function n(c,u){return t(c,{x:u.pageX,y:u.pageY})}Sn.getAbsolutePosition=n;function t(c,u){let f=e.Point.subtract(u,c.root.canvasBounds);const h=(0,e.findParentByFeature)(c,e.isViewport);if(h){const p=h.zoom,g=e.Point.multiplyScalar(h.scroll,p);f=e.Point.add(f,g),f=e.Point.divideScalar(f,p)}return f}Sn.getAbsolutePositionByPoint=t;function i(c,u){const f=t(c,e.Bounds.topLeft(u)),h=t(c,e.Bounds.bottomRight(u));return e.Bounds.from(f,h)}Sn.getViewportBounds=i;function a(c){const u=(0,e.isAlignable)(c)?c.alignment:e.Point.ORIGIN,f=u.x,h=u.y,p=c.bounds.width,g=c.bounds.height;return(0,e.translateBounds)({x:f,y:h,width:p,height:g},c,c.root)}Sn.toAbsoluteBounds=a;function o(c){return a(c)}Sn.toAbsolutePosition=o;function s(c){return a(c)}Sn.toAbsoluteSize=s;function r(c,u){return(0,e.isBoundsAware)(c.parent)?d(c.parent,u):d(c,u)}Sn.absoluteToParent=r;function d(c,u){const f=a(c);return e.Point.subtract(u,f)}Sn.absoluteToLocal=d;function l(c,u){return c.x<u.scroll.x||c.x>u.scroll.x+u.canvasBounds.width||c.y<u.scroll.y||c.y>u.scroll.y+u.canvasBounds.height}return Sn.outsideOfViewport=l,Sn}var Hu={},y2;function V9(){if(y2)return Hu;y2=1;var e=Hu&&Hu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.FeedbackEdgeEndView=void 0;const n=Y(),t=G();let i=class{render(o,s){var r;const d=(r=o.position)!==null&&r!==void 0?r:n.Point.ORIGIN;return(0,n.svg)("g",{x:d.x,y:d.y})}};return Hu.FeedbackEdgeEndView=i,Hu.FeedbackEdgeEndView=i=e([(0,t.injectable)()],i),Hu}var _2;function ul(){return _2||(_2=1,function(e){var n=Ic&&Ic.__decorate||function(C,M,L,I){var R=arguments.length,w=R<3?M:I===null?I=Object.getOwnPropertyDescriptor(M,L):I,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(C,M,L,I);else for(var j=C.length-1;j>=0;j--)(T=C[j])&&(w=(R<3?T(w):R>3?T(M,L,w):T(M,L))||w);return R>3&&w&&Object.defineProperty(M,L,w),w},t=Ic&&Ic.__metadata||function(C,M){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,M)},i=Ic&&Ic.__param||function(C,M){return function(L,I){M(L,I,C)}};Object.defineProperty(e,"__esModule",{value:!0}),e.configureDanglingFeedbackEdge=e.removeDanglingFeedbackEdge=e.drawFeedbackEdge=e.defaultFeedbackEdgeSchema=e.feedbackEdgeEndId=e.feedbackEdgeId=e.FeedbackEdgeEnd=e.RemoveFeedbackEdgeCommand=e.RemoveFeedbackEdgeAction=e.DrawFeedbackEdgeCommand=e.DrawFeedbackEdgeAction=void 0;const a=Y(),o=G(),s=TP(),r=Cr(),d=kt(),l=Wo(),c=V9();var u;(function(C){C.KIND="drawFeedbackEdge";function M(I){return a.Action.hasKind(I,C.KIND)}C.is=M;function L(I){return{kind:C.KIND,...I}}C.create=L})(u||(e.DrawFeedbackEdgeAction=u={}));let f=class extends r.FeedbackCommand{constructor(M){super(),this.action=M}execute(M){return _(M,this.action.sourceId,this.action.elementTypeId,this.action.edgeSchema),M.root}};e.DrawFeedbackEdgeCommand=f,f.KIND=u.KIND,e.DrawFeedbackEdgeCommand=f=n([(0,o.injectable)(),i(0,(0,o.inject)(a.TYPES.Action)),t("design:paramtypes",[Object])],f);var h;(function(C){C.KIND="removeFeedbackEdgeCommand";function M(I){return a.Action.hasKind(I,C.KIND)}C.is=M;function L(){return{kind:C.KIND}}C.create=L})(h||(e.RemoveFeedbackEdgeAction=h={}));let p=class extends r.FeedbackCommand{execute(M){return S(M.root),M.root}};e.RemoveFeedbackEdgeCommand=p,p.KIND=h.KIND,e.RemoveFeedbackEdgeCommand=p=n([(0,o.injectable)()],p);class g extends a.GDanglingAnchor{constructor(M,L,I=void 0,R=g.TYPE){super(),this.sourceId=M,this.elementTypeId=L,this.feedbackEdge=I,this.type=R}}e.FeedbackEdgeEnd=g,g.DEFAULT_FEATURES=[a.deletableFeature,s.feedbackFeature],g.TYPE="feedback-edge-end";function m(C){return C.id+"_feedback_edge"}e.feedbackEdgeId=m;function v(C){return C.id+"_feedback_anchor"}e.feedbackEdgeEndId=v,e.defaultFeedbackEdgeSchema={cssClasses:["feedback-edge"],opacity:.3};function _(C,M,L,I){const R=C.root,w=R.index.getById(M);if(!w)return;const T=(0,a.findParentByFeature)(w,a.isConnectable);if(!T||!(0,a.isBoundsAware)(T))return;const j=new g(T.id,L);j.id=v(R),j.position=(0,l.toAbsolutePosition)(T);const D={id:m(R),type:L,sourceId:T.id,targetId:j.id,...e.defaultFeedbackEdgeSchema,...I},B=C.modelFactory.createElement(D);(0,d.isRoutable)(B)&&(j.feedbackEdge=B,R.add(j),R.add(B))}e.drawFeedbackEdge=_;function S(C){const M=C.index.getById(m(C)),L=C.index.getById(v(C));M instanceof a.GChildElement&&C.remove(M),L instanceof a.GChildElement&&C.remove(L)}e.removeDanglingFeedbackEdge=S;function E(C){!C.isBound(f)&&!C.isBound(p)&&!C.isBound(c.FeedbackEdgeEndView)&&((0,a.configureCommand)(C,f),(0,a.configureCommand)(C,p),(0,a.configureView)(C,g.TYPE,c.FeedbackEdgeEndView))}e.configureDanglingFeedbackEdge=E}(Ic)),Ic}var og={},b2;function FP(){if(b2)return og;b2=1,Object.defineProperty(og,"__esModule",{value:!0}),og.FeedbackEdgeEndMovingMouseListener=void 0;const e=Y(),n=Wo(),t=ul();class i extends e.MouseListener{constructor(o,s){super(),this.anchorRegistry=o,this.feedbackDispatcher=s,this.feedback=s.createEmitter()}mouseMove(o,s){const r=o.root,d=r.index.getById((0,t.feedbackEdgeEndId)(r));if(!(d instanceof t.FeedbackEdgeEnd)||!d.feedbackEdge)return[];const l=d.feedbackEdge,c=(0,n.getAbsolutePosition)(d,s),u=(0,e.findChildrenAtPosition)(o.root,c).reverse().find(f=>(0,e.isConnectable)(f)&&f.canConnect(l,"target"));if(u instanceof e.GConnectableElement&&l.source&&(0,e.isBoundsAware)(l.source)){const f=this.computeAbsoluteAnchor(u,e.Bounds.center((0,n.toAbsoluteBounds)(l.source)));e.Point.euclideanDistance(f,d.position)>1&&this.feedback.add(e.MoveAction.create([{elementId:d.id,toPosition:f}],{animate:!1})).submit()}else this.feedback.add(e.MoveAction.create([{elementId:d.id,toPosition:c}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(o,s,r){const d=(0,n.absoluteToParent)(o,s);let c=this.anchorRegistry.get(e.PolylineEdgeRouter.KIND,o.anchorKind).getAnchor(o,d,r);if(o.parent!==o.root){const u=(0,e.findParentByFeature)(o.parent,e.isBoundsAware);if(u){const f=(0,n.toAbsoluteBounds)(u);c=e.Point.add(f,c)}}return c}dispose(){this.feedback.dispose()}}return og.FeedbackEdgeEndMovingMouseListener=i,og}var S2;function kP(){if(S2)return Do;S2=1;var e=Do&&Do.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=Do&&Do.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)},t;Object.defineProperty(Do,"__esModule",{value:!0}),Do.EdgeCreationToolMouseListener=Do.EdgeCreationTool=void 0;const i=Y(),a=G(),o=Jc(),s=Un(),r=an(),d=Zr(),l=Wa(),c=ul(),u=FP();let f=t=class extends l.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=i.TriggerEdgeCreationAction.is}get id(){return t.ID}doEnable(){this.toolFeedback(),this.creationListener(),this.trackFeedbackEdge()}toolFeedback(){const g=this.createFeedbackEmitter().add((0,s.cursorFeedbackAction)(s.CursorCSS.OPERATION_NOT_ALLOWED),(0,s.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(g)}creationListener(){const g=new h(this.triggerAction,this.actionDispatcher,this.typeHintProvider,this,this.grid?this.grid.x/2:void 0);this.toDisposeOnDisable.push(g,this.mouseTool.registerListener(g))}trackFeedbackEdge(){const g=new u.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher);this.toDisposeOnDisable.push(g,this.mouseTool.registerListener(g))}};Do.EdgeCreationTool=f,f.ID="tool_create_edge",e([(0,a.inject)(i.AnchorComputerRegistry),n("design:type",i.AnchorComputerRegistry)],f.prototype,"anchorRegistry",void 0),e([(0,a.inject)(i.TYPES.ITypeHintProvider),n("design:type",Object)],f.prototype,"typeHintProvider",void 0),e([(0,a.optional)(),(0,a.inject)(i.TYPES.Grid),n("design:type",Object)],f.prototype,"grid",void 0),Do.EdgeCreationTool=f=t=e([(0,a.injectable)()],f);class h extends o.DragAwareMouseListener{constructor(g,m,v,_,S){super(S),this.triggerAction=g,this.actionDispatcher=m,this.typeHintProvider=v,this.tool=_,this.dragSensitivity=S,this.allowedTarget=!1,this.pendingDynamicCheck=!1,this.proxyEdge=new d.GEdge,this.proxyEdge.type=g.elementTypeId,this.cursorFeedback=_.createFeedbackEmitter(),this.feedbackEdgeFeedback=_.createFeedbackEmitter()}nonDraggingMouseUp(g,m){const v=[];return m.button===0?(this.isSourceSelected()?this.currentTarget&&this.allowedTarget&&(this.target=this.currentTarget.id):this.currentTarget&&this.allowedTarget&&(this.source=this.currentTarget.id,this.feedbackEdgeFeedback.add(c.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source}),c.RemoveFeedbackEdgeAction.create()).submit()),this.source&&this.target&&(v.push(this.getCreateOperation(g,m,this.source,this.target)),this.isContinuousMode(g,m)?this.dispose():v.push(r.EnableDefaultToolsAction.create()))):m.button===2&&(this.dispose(),v.push(r.EnableDefaultToolsAction.create())),v}isContinuousMode(g,m){return(0,i.isCtrlOrCmd)(m)}getCreateOperation(g,m,v,_){return i.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:v,targetElementId:_,args:this.getCreateEdgeOperationArgs(g,m)})}getCreateEdgeOperationArgs(g,m){return{...this.triggerAction.args}}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(g,m){const v=(0,i.findParentByFeature)(g,i.isConnectable);if(v!==this.currentTarget){if(this.pendingDynamicCheck=!1,this.currentTarget=v,this.currentTarget){if(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.canConnect(v,"target")):this.allowedTarget=this.canConnect(v,"source"),this.pendingDynamicCheck)return[(0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_CHECK_PENDING)]}else this.allowedTarget=!1;return[this.updateEdgeFeedback()]}return[]}updateEdgeFeedback(){return this.allowedTarget?this.isSourceSelected()?(0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_CREATION_TARGET):(0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_CREATION_SOURCE):(0,s.cursorFeedbackAction)(s.CursorCSS.OPERATION_NOT_ALLOWED)}canConnect(g,m){var v;if(!g||!(0,i.isConnectable)(g)||!g.canConnect(this.proxyEdge,m))return!1;if(!this.isDynamic(this.proxyEdge.type))return!0;const _=(v=this.source)!==null&&v!==void 0?v:g,S=this.source?g:void 0;return this.pendingDynamicCheck=!0,this.actionDispatcher.request(i.RequestCheckEdgeAction.create({sourceElement:_,targetElement:S,edgeType:this.proxyEdge.type})).then(E=>{this.pendingDynamicCheck&&(this.allowedTarget=E.isValid,this.actionDispatcher.dispatch(this.updateEdgeFeedback()),this.pendingDynamicCheck=!1)}).catch(E=>console.error("Dynamic edge check failed with: ",E)),!1}isDynamic(g){var m;const v=this.typeHintProvider.getEdgeTypeHint(g);return(m=v==null?void 0:v.dynamic)!==null&&m!==void 0?m:!1}dispose(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.feedbackEdgeFeedback.dispose(),this.cursorFeedback.dispose(),super.dispose()}}return Do.EdgeCreationToolMouseListener=h,Do}var Kr={},E2;function $m(){if(E2)return Kr;E2=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.getSeverity=Kr.createGIssue=Kr.getGIssueMarker=Kr.getOrCreateGIssueMarker=Kr.GIssueMarker=void 0;const e=Y();class n extends e.SIssueMarkerImpl{constructor(){super(),this.issues=[],this.type="marker",this.features=new Set(e.GDecoration.DEFAULT_FEATURES)}computeProjectionCssClasses(){const r=o(this);this.projectionCssClasses=["sprotty-issue","sprotty-"+r]}}Kr.GIssueMarker=n;function t(s){let r;return r=i(s),r===void 0&&(r=new n,(0,e.isBoundsAware)(s)&&(r.projectedBounds=s.parentToLocal(s.bounds)),s.add(r)),r}Kr.getOrCreateGIssueMarker=t;function i(s){let r;for(const d of s.children)d instanceof n&&(r=d);return r}Kr.getGIssueMarker=i;function a(s,r){const d={message:s.description,severity:"info"};switch(s.kind){case e.MarkerKind.ERROR:{d.severity="error";break}case e.MarkerKind.INFO:{d.severity="info";break}case e.MarkerKind.WARNING:{d.severity="warning";break}}return d}Kr.createGIssue=a;function o(s){let r="info";for(const d of s.issues.map(l=>l.severity)){if(d==="error")return d;d==="warning"&&r==="info"&&(r=d)}return r}return Kr.getSeverity=o,Kr}var C2;function G9(){if(C2)return qu;C2=1;var e=qu&&qu.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h};Object.defineProperty(qu,"__esModule",{value:!0}),qu.GlspHoverMouseListener=void 0;const n=G(),t=Y(),i=of(),a=an(),o=kP(),s=$m();let r=class extends t.HoverMouseListener{constructor(){super(...arguments),this.enableHover=!0}handle(l){if(i.FocusStateChangedAction.is(l)&&!l.hasFocus){if(this.stopMouseOverTimer(),this.lastHoverFeedbackElementId){const c=this.lastHoverFeedbackElementId;return this.lastHoverFeedbackElementId=void 0,t.HoverFeedbackAction.create({mouseoverElement:c,mouseIsOver:!1})}}else a.EnableToolsAction.is(l)?this.enableHover=!l.toolIds.includes(o.EdgeCreationTool.ID):a.EnableDefaultToolsAction.is(l)&&(this.enableHover=!0)}mouseOver(l,c){return this.enableHover?super.mouseOver(l,c):[]}startMouseOverTimer(l,c){return this.stopMouseOverTimer(),new Promise(u=>{this.state.mouseOverTimer=window.setTimeout(()=>{const f=this.computePopupBounds(l,{x:c.pageX,y:c.pageY});l instanceof s.GIssueMarker?u(t.SetPopupModelAction.create(this.createPopupModel(l,f))):u(t.RequestPopupModelAction.create({elementId:l.id,bounds:f})),this.state.popupOpen=!0,this.state.previousPopupElement=l},this.options.popupOpenDelay)})}createPopupModel(l,c){return l.issues!==void 0&&l.issues.length>0?{type:"html",id:"sprotty-popup",children:[this.createMarkerIssuePopup(l)],canvasBounds:this.modifyBounds(c)}:{type:t.EMPTY_ROOT.type,id:t.EMPTY_ROOT.id}}createMarkerIssuePopup(l){const c=this.createIssueMessage(l);return{type:"pre-rendered",id:"popup-title",code:`<div class="${(0,s.getSeverity)(l)}"><div class="sprotty-popup-title">${c}</div></div>`}}createIssueMessage(l){return"<ul>"+l.issues.map(c=>"<li>"+c.severity.toUpperCase()+": "+c.message+"</li>").join("")+"</ul>"}modifyBounds(l){return l}};return qu.GlspHoverMouseListener=r,qu.GlspHoverMouseListener=r=e([(0,n.injectable)()],r),qu}var P2;function z9(){if(P2)return rg;P2=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.hoverModule=void 0;const e=Y(),n=of(),t=an(),i=G9();return rg.hoverModule=new e.FeatureModule((a,o,s)=>{const r={bind:a,isBound:s};(0,e.bindAsService)(r,e.TYPES.PopupVNodePostprocessor,e.PopupPositionUpdater),(0,e.bindAsService)(r,e.TYPES.MouseListener,i.GlspHoverMouseListener),(0,e.bindAsService)(r,e.TYPES.PopupMouseListener,e.PopupHoverMouseListener),(0,e.bindAsService)(r,e.TYPES.KeyListener,e.HoverKeyListener),a(e.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),a(e.ClosePopupActionHandler).toSelf().inSingletonScope(),(0,e.configureCommand)(r,e.HoverFeedbackCommand),(0,e.configureCommand)(r,e.SetPopupModelCommand),(0,e.configureActionHandler)(r,e.SetPopupModelCommand.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,e.FitToScreenCommand.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,e.CenterCommand.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,e.SetViewportCommand.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,e.MoveCommand.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,n.FocusStateChangedAction.KIND,e.ClosePopupActionHandler),(0,e.configureActionHandler)(r,t.EnableToolsAction.KIND,i.GlspHoverMouseListener),(0,e.configureActionHandler)(r,t.EnableDefaultToolsAction.KIND,i.GlspHoverMouseListener),(0,e.configureActionHandler)(r,n.FocusStateChangedAction.KIND,i.GlspHoverMouseListener)},{featureId:Symbol("hover")}),rg}var sg={},Vu={},R2;function U9(){if(R2)return Vu;R2=1;var e=Vu&&Vu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Vu,"__esModule",{value:!0}),Vu.GlspEditLabelUI=void 0;const n=Y(),t=G(),i=Ya();let a=class extends n.EditLabelUI{initializeContents(s){super.initializeContents(s),s.classList.add(i.CSS_UI_EXTENSION_CLASS)}setContainerVisible(s){var r,d;s?((r=this.containerElement)===null||r===void 0||r.classList.remove(i.CSS_HIDDEN_EXTENSION_CLASS),this.editControl.focus()):(d=this.containerElement)===null||d===void 0||d.classList.add(i.CSS_HIDDEN_EXTENSION_CLASS)}};return Vu.GlspEditLabelUI=a,Vu.GlspEditLabelUI=a=e([(0,t.injectable)()],a),Vu}var M2;function $9(){if(M2)return sg;M2=1,Object.defineProperty(sg,"__esModule",{value:!0}),sg.labelEditUiModule=void 0;const e=Y(),n=U9();return sg.labelEditUiModule=new e.FeatureModule((t,i,a,o,...s)=>{const r={bind:t,unbind:i,isBound:a,rebind:o};(0,e.configureActionHandler)(r,e.EditLabelAction.KIND,e.EditLabelActionHandler),t(n.GlspEditLabelUI).toSelf().inSingletonScope(),t(e.TYPES.IUIExtension).toService(n.GlspEditLabelUI)},{featureId:Symbol("labelEditUi")}),sg}var ag={},Gu={},A2;function Y9(){if(A2)return Gu;A2=1;var e=Gu&&Gu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n;Object.defineProperty(Gu,"__esModule",{value:!0}),Gu.DirectLabelEditTool=void 0;const t=G(),i=Y(),a=Wa();let o=n=class extends a.BaseEditTool{get id(){return n.ID}createEditLabelMouseListener(){return new i.EditLabelMouseListener}createEditLabelKeyListener(){return new i.EditLabelKeyListener}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.createEditLabelMouseListener()),this.keyTool.registerListener(this.createEditLabelKeyListener()))}};return Gu.DirectLabelEditTool=o,o.ID="glsp.direct-label-edit-tool",Gu.DirectLabelEditTool=o=n=e([(0,t.injectable)()],o),Gu}var Fi={},w2;function W9(){if(w2)return Fi;w2=1;var e=Fi&&Fi.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Fi&&Fi.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.BalloonLabelValidationDecorator=Fi.ServerEditLabelValidator=Fi.LabelEditValidation=void 0;const t=Y(),i=G();var a;(function(r){r.CONTEXT_ID="label-edit";function d(c){const u=c.message;let f="ok";return t.ValidationStatus.isError(c)?f="error":t.ValidationStatus.isWarning(c)&&(f="warning"),{message:u,severity:f}}r.toEditLabelValidationResult=d;function l(c,u){return t.RequestEditValidationAction.create({contextId:r.CONTEXT_ID,modelElementId:u,text:c})}r.createValidationRequestAction=l})(a||(Fi.LabelEditValidation=a={}));let o=class{async validate(d,l){const c=a.createValidationRequestAction(d,l.id),u=await this.actionDispatcher.requestUntil(c);return u?this.getValidationResultFromResponse(u):{severity:"ok"}}getValidationResultFromResponse(d){return t.SetEditValidationResultAction.is(d)?a.toEditLabelValidationResult(d.status):{severity:"ok"}}};Fi.ServerEditLabelValidator=o,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],o.prototype,"actionDispatcher",void 0),Fi.ServerEditLabelValidator=o=e([(0,i.injectable)()],o);let s=class{decorate(d,l){const c=d.parentElement;if(c)switch(l.message&&(c.setAttribute("data-balloon",l.message),c.setAttribute("data-balloon-pos","up-left"),c.setAttribute("data-balloon-visible","true")),l.severity){case"ok":c.classList.add("validation-ok");break;case"warning":c.classList.add("validation-warning");break;case"error":c.classList.add("validation-error");break}}dispose(d){const l=d.parentElement;l&&(l.removeAttribute("data-balloon"),l.removeAttribute("data-balloon-pos"),l.removeAttribute("data-balloon-visible"),l.classList.remove("validation-ok","validation-warning","validation-error"))}};return Fi.BalloonLabelValidationDecorator=s,Fi.BalloonLabelValidationDecorator=s=e([(0,i.injectable)()],s),Fi}var I2;function Z9(){if(I2)return ag;I2=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.labelEditModule=void 0;const e=Y(),n=Y9(),t=W9();return ag.labelEditModule=new e.FeatureModule((i,a,o,s)=>{i(e.TYPES.IEditLabelValidator).to(t.ServerEditLabelValidator),i(e.TYPES.IEditLabelValidationDecorator).to(t.BalloonLabelValidationDecorator),(0,e.bindAsService)(i,e.TYPES.IDefaultTool,n.DirectLabelEditTool),(0,e.configureCommand)({bind:i,isBound:o},e.ApplyLabelEditCommand)},{featureId:Symbol("labelEdit")}),ag}var cg={},Ot={},Bn={},T2;function Ym(){if(T2)return Bn;T2=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.toValidElementAndBounds=Bn.toValidElementMove=Bn.isValidMove=Bn.isValidSize=Bn.getLayoutOptions=Bn.minDimensions=Bn.minHeight=Bn.minWidth=void 0;function e(d){const l=i(d);return l!==void 0&&typeof l.minWidth=="number"?l.minWidth:1}Bn.minWidth=e;function n(d){const l=i(d);return l!==void 0&&typeof l.minHeight=="number"?l.minHeight:1}Bn.minHeight=n;function t(d){return{width:e(d),height:n(d)}}Bn.minDimensions=t;function i(d){const l=d.layoutOptions;if(l!==void 0)return l}Bn.getLayoutOptions=i;function a(d,l){return l.width>=e(d)&&l.height>=n(d)}Bn.isValidSize=a;function o(d,l,c){var u;return(u=c==null?void 0:c.validate(d,l))!==null&&u!==void 0?u:!0}Bn.isValidMove=o;function s(d,l,c){if(o(d,l.toPosition,c))return l}Bn.toValidElementMove=s;function r(d,l,c){if(!o(d,l.newPosition,c))return;const u=e(d);l.newSize.width<u&&(l.newSize.width=u);const f=n(d);return l.newSize.height<f&&(l.newSize.height=f),l}return Bn.toValidElementAndBounds=r,Bn}var D2;function Q9(){if(D2)return Ot;D2=1;var e=Ot&&Ot.__decorate||function(v,_,S,E){var C=arguments.length,M=C<3?_:E===null?E=Object.getOwnPropertyDescriptor(_,S):E,L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(v,_,S,E);else for(var I=v.length-1;I>=0;I--)(L=v[I])&&(M=(C<3?L(M):C>3?L(_,S,M):L(_,S))||M);return C>3&&M&&Object.defineProperty(_,S,M),M},n=Ot&&Ot.__metadata||function(v,_){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,_)};Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.AlignElementsActionHandler=Ot.AlignElementsAction=Ot.SelectFunction=Ot.Alignment=Ot.ResizeElementsActionHandler=Ot.LayoutElementsActionHandler=Ot.ResizeElementsAction=Ot.ReduceFunction=Ot.ResizeDimension=void 0;const t=Y(),i=G(),a=Er(),o=kt(),s=Ym(),r=Pr();var d;(function(v){v[v.Width=0]="Width",v[v.Height=1]="Height",v[v.Width_And_Height=2]="Width_And_Height"})(d||(Ot.ResizeDimension=d={}));var l;(function(v){function _(...I){return Math.min(...I)}v.min=_;function S(...I){return Math.max(...I)}v.max=S;function E(...I){return I.reduce((R,w)=>R+w,0)/I.length}v.avg=E;function C(...I){return I[0]}v.first=C;function M(...I){return I[I.length-1]}v.last=M;function L(I){return v[I]}v.get=L})(l||(Ot.ReduceFunction=l={}));var c;(function(v){v.KIND="resizeElementAction";function _(E){return t.Action.hasKind(E,v.KIND)&&(0,t.hasArrayProp)(E,"elementIds")&&(0,t.hasNumberProp)(E,"dimension")&&(0,t.hasStringProp)(E,"reduceFunction")}v.is=_;function S(E){return{kind:v.KIND,dimension:d.Width,elementIds:[],...E}}v.create=S})(c||(Ot.ResizeElementsAction=c={}));let u=class{getSelectedElements(_){const S=this.selectionService.getModelRoot().index,E=_.elementIds.length>0?_.elementIds:this.selectionService.getSelectedElementIDs();return(0,o.getElements)(S,E,this.isActionElement)}dispatchAction(_){this.actionDispatcher.dispatch(_)}dispatchActions(_){this.actionDispatcher.dispatchAll(_)}};Ot.LayoutElementsActionHandler=u,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],u.prototype,"actionDispatcher",void 0),e([(0,i.inject)(a.SelectionService),n("design:type",a.SelectionService)],u.prototype,"selectionService",void 0),e([(0,i.inject)(t.TYPES.IMovementRestrictor),(0,i.optional)(),n("design:type",Object)],u.prototype,"movementRestrictor",void 0),Ot.LayoutElementsActionHandler=u=e([(0,i.injectable)()],u);let f=class extends u{handle(_){const S=this.getSelectedElements(_);if(S.length>1){const E=l.get(_.reduceFunction);switch(_.dimension){case d.Width:return this.resizeWidth(S,E);case d.Height:return this.resizeHeight(S,E);case d.Width_And_Height:return this.resizeWidthAndHeight(S,E)}}}resizeWidth(_,S){const E=S(..._.map(C=>C.bounds.width));this.dispatchResizeActions(_,(C,M)=>{const L=.5*(E-C.bounds.width);M.newPosition.x=C.bounds.x-L,M.newSize.width=E})}resizeHeight(_,S){const E=S(..._.map(C=>C.bounds.height));this.dispatchResizeActions(_,(C,M)=>{const L=.5*(E-C.bounds.height);M.newPosition.y=C.bounds.y-L,M.newSize.height=E})}resizeWidthAndHeight(_,S){const E=S(..._.map(L=>L.bounds.width)),C=S(..._.map(L=>L.bounds.height)),M={width:E,height:C};this.dispatchResizeActions(_,(L,I)=>{const R=t.Dimension.subtract(M,L.bounds),w=t.Dimension.center(R);I.newPosition=t.Point.subtract(L.bounds,w),I.newSize=M})}dispatchResizeActions(_,S){const E=[];_.forEach(C=>{const M=this.createElementAndBounds(C,S);M&&E.push(M)}),this.dispatchActions([t.SetBoundsAction.create(E),t.ChangeBoundsOperation.create(E)])}createElementAndBounds(_,S){const E={elementId:_.id,newPosition:{x:_.bounds.x,y:_.bounds.y},newSize:{width:_.bounds.width,height:_.bounds.height}};return S(_,E),(0,s.toValidElementAndBounds)(_,E,this.movementRestrictor)}isActionElement(_){return(0,r.isResizable)(_)}};Ot.ResizeElementsActionHandler=f,Ot.ResizeElementsActionHandler=f=e([(0,i.injectable)()],f);var h;(function(v){v[v.Left=0]="Left",v[v.Center=1]="Center",v[v.Right=2]="Right",v[v.Top=3]="Top",v[v.Middle=4]="Middle",v[v.Bottom=5]="Bottom"})(h||(Ot.Alignment=h={}));var p;(function(v){function _(M){return M}v.all=_;function S(M){return[M[0]]}v.first=S;function E(M){return[M[M.length-1]]}v.last=E;function C(M){return v[M]}v.get=C})(p||(Ot.SelectFunction=p={}));var g;(function(v){v.KIND="alignElements";function _(E){return t.Action.hasKind(E,v.KIND)&&(0,t.hasArrayProp)(E,"elementIds")&&(0,t.hasNumberProp)(E,"alignment")&&(0,t.hasStringProp)(E,"selectFunction")}v.is=_;function S(E={}){return{kind:v.KIND,elementIds:[],alignment:h.Left,selectFunction:"all",...E}}v.create=S})(g||(Ot.AlignElementsAction=g={}));let m=class extends u{handle(_){const S=this.getSelectedElements(_),C=p.get(_.selectFunction)(S);if(S.length>1)switch(_.alignment){case h.Left:return this.alignLeft(C);case h.Center:return this.alignCenter(C);case h.Right:return this.alignRight(C);case h.Top:return this.alignTop(C);case h.Middle:return this.alignMiddle(C);case h.Bottom:return this.alignBottom(C)}}alignLeft(_){const S=_.map(E=>E.bounds.x).reduce((E,C)=>Math.min(E,C));this.dispatchAlignActions(_,(E,C)=>C.toPosition.x=S)}alignCenter(_){const S=_.map(L=>L.bounds.x).reduce((L,I)=>Math.min(L,I)),C=_.map(L=>L.bounds.x+L.bounds.width).reduce((L,I)=>Math.max(L,I))-S,M=S+.5*C;this.dispatchAlignActions(_,(L,I)=>I.toPosition.x=M-.5*L.bounds.width)}alignRight(_){const S=_.map(E=>E.bounds.x+E.bounds.width).reduce((E,C)=>Math.max(E,C));this.dispatchAlignActions(_,(E,C)=>C.toPosition.x=S-E.bounds.width)}alignTop(_){const S=_.map(E=>E.bounds.y).reduce((E,C)=>Math.min(E,C));this.dispatchAlignActions(_,(E,C)=>C.toPosition.y=S)}alignMiddle(_){const S=_.map(L=>L.bounds.y).reduce((L,I)=>Math.min(L,I)),C=_.map(L=>L.bounds.y+L.bounds.height).reduce((L,I)=>Math.max(L,I))-S,M=S+.5*C;this.dispatchAlignActions(_,(L,I)=>I.toPosition.y=M-.5*L.bounds.height)}alignBottom(_){const S=_.map(E=>E.bounds.y+E.bounds.height).reduce((E,C)=>Math.max(E,C));this.dispatchAlignActions(_,(E,C)=>C.toPosition.y=S-E.bounds.height)}dispatchAlignActions(_,S){const E=[],C=[];_.forEach(M=>{const L=this.createElementMove(M,S);if(L){E.push(L);const I=this.createElementAndBounds(M,L);C.push(I)}}),this.dispatchActions([t.MoveAction.create(E),t.ChangeBoundsOperation.create(C)])}createElementMove(_,S){const E={elementId:_.id,fromPosition:{x:_.bounds.x,y:_.bounds.y},toPosition:{x:_.bounds.x,y:_.bounds.y}};return S(_,E),(0,s.toValidElementMove)(_,E,this.movementRestrictor)}createElementAndBounds(_,S){return{elementId:_.id,newPosition:{x:S.toPosition.x,y:S.toPosition.y},newSize:{width:_.bounds.width,height:_.bounds.height}}}isActionElement(_){return(0,r.isBoundsAwareMoveable)(_)}};return Ot.AlignElementsActionHandler=m,Ot.AlignElementsActionHandler=m=e([(0,i.injectable)()],m),Ot}var O2;function J9(){if(O2)return cg;O2=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.layoutModule=void 0;const e=Y(),n=Q9();return cg.layoutModule=new e.FeatureModule((t,i,a)=>{const o={bind:t,isBound:a};(0,e.configureActionHandler)(o,n.ResizeElementsAction.KIND,n.ResizeElementsActionHandler),(0,e.configureActionHandler)(o,n.AlignElementsAction.KIND,n.AlignElementsActionHandler)},{featureId:Symbol("layout")}),cg}var ug={},cr={},fa={},L2;function KP(){if(L2)return fa;L2=1;var e=fa&&fa.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n=fa&&fa.__metadata||function(o,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,s)};Object.defineProperty(fa,"__esModule",{value:!0}),fa.NavigationTargetResolver=void 0;const t=Y(),i=G();let a=class{async resolve(s){return this.resolveWithSourceUri(this.diagramOptions.sourceUri,s)}async resolveWithSourceUri(s,r){const d=decodeURIComponent(r.uri),l=s==null?void 0:s.replace(/^file:\/\//,""),c=d.replace(/^file:\/\//,"");if(l&&l!==c){this.logger.info("Source and Target URI are different. Can't resolve locally.",l,c);return}if(t.NavigationTarget.getElementIds(r).length>0)return t.SetResolvedNavigationTargetAction.create(t.NavigationTarget.getElementIds(r));const u=await this.requestResolution(r);if(t.SetResolvedNavigationTargetAction.is(u))return u}requestResolution(s){return this.dispatcher.request(t.ResolveNavigationTargetAction.create(s))}};return fa.NavigationTargetResolver=a,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],a.prototype,"dispatcher",void 0),e([(0,i.inject)(t.TYPES.ILogger),n("design:type",Object)],a.prototype,"logger",void 0),e([(0,i.inject)(t.TYPES.IDiagramOptions),n("design:type",Object)],a.prototype,"diagramOptions",void 0),fa.NavigationTargetResolver=a=e([(0,i.injectable)()],a),fa}var j2;function X9(){if(j2)return cr;j2=1;var e=cr&&cr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=cr&&cr.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(cr,"__esModule",{value:!0}),cr.NavigationActionHandler=cr.ProcessNavigationArgumentsAction=cr.NavigateAction=void 0;const t=Y(),i=G(),a=kn(),o=KP();var s;(function(l){l.KIND="navigate";function c(f){return t.Action.hasKind(f,l.KIND)&&(0,t.hasStringProp)(f,"targetTypeId")}l.is=c;function u(f,h={}){return{kind:l.KIND,targetTypeId:f,...h}}l.create=u})(s||(cr.NavigateAction=s={}));var r;(function(l){l.KIND="processNavigationArguments";function c(f){return t.Action.hasKind(f,l.KIND)&&(0,t.hasObjectProp)(f,"args")}l.is=c;function u(f){return{kind:l.KIND,args:f}}l.create=u})(r||(cr.ProcessNavigationArgumentsAction=r={}));let d=class{constructor(){this.notificationTimeout=5e3}handle(c){s.is(c)?this.handleNavigateAction(c):t.NavigateToTargetAction.is(c)?this.handleNavigateToTarget(c):r.is(c)?this.processNavigationArguments(c.args):t.NavigateToExternalTargetAction.is(c)&&this.handleNavigateToExternalTarget(c)}async handleNavigateAction(c){try{const u=this.editorContext.get(c.args),f=await this.dispatcher.request(t.RequestNavigationTargetsAction.create({targetTypeId:c.targetTypeId,editorContext:u}));if(t.SetNavigationTargetsAction.is(f)&&f.targets&&f.targets.length===1)return f.targets.length>1&&this.logger.warn(this,"Processing of multiple targets is not supported yet. Only the first is being processed.",f.targets),this.dispatcher.dispatch(t.NavigateToTargetAction.create(f.targets[0]));this.warnAboutFailedNavigation("No valid navigation target found")}catch(u){this.logger.error(this,"Failed to obtain navigation target",u,c)}}async handleNavigateToTarget(c){try{const u=await this.resolveElements(c);if(this.containsElementIdsOrArguments(u)){this.navigateTo(u),this.handleResolutionArguments(u);return}else{this.navigateToExternal(c.target);return}}catch(u){this.logger.error(this,"Failed to navigate",u,c)}}resolveElements(c){return this.resolver.resolve(c.target)}containsElementIdsOrArguments(c){return c!==void 0&&(this.containsElementIds(c.elementIds)||this.containsArguments(c.args))}containsElementIds(c){return c!==void 0&&c.length>0}containsArguments(c){return c!==void 0&&c!==void 0&&Object.keys(c).length>0}navigateTo(c){const u=c.elementIds;this.containsElementIds(u)&&this.dispatcher.dispatchAll([t.SelectAllAction.create(!1),t.SelectAction.create({selectedElementsIDs:u}),t.CenterAction.create(u)])}handleResolutionArguments(c){const u=c.args;this.containsArguments(u)&&this.dispatcher.dispatch(r.create(u))}navigateToExternal(c){return this.dispatcher.dispatch(t.NavigateToExternalTargetAction.create(c))}processNavigationArguments(c){c.info&&c.info.toString().length>0&&this.notify("INFO",c.info.toString()),c.warning&&c.warning.toString().length>0&&this.notify("WARNING",c.warning.toString()),c.error&&c.error.toString().length>0&&this.notify("ERROR",c.error.toString())}async handleNavigateToExternalTarget(c){this.actionHandlerRegistry.get(t.NavigateToExternalTargetAction.KIND).length===1&&this.warnAboutFailedNavigation("Could not resolve or navigate to target",c.target)}warnAboutFailedNavigation(c,u){const f=`${c}`+(u?`: '${u.uri}' (arguments: ${JSON.stringify(u.args)})`:"");this.logger.warn(this,c,u),this.notify("WARNING",f)}notify(c,u){const f=this.notificationTimeout;this.dispatcher.dispatchAll([t.StatusAction.create(u,{severity:c,timeout:f}),t.MessageAction.create(u,{severity:c})])}};return cr.NavigationActionHandler=d,e([(0,i.inject)(t.TYPES.ILogger),n("design:type",Object)],d.prototype,"logger",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],d.prototype,"dispatcher",void 0),e([(0,i.inject)(t.TYPES.ActionHandlerRegistryProvider),n("design:type",Function)],d.prototype,"actionHandlerRegistryProvider",void 0),e([(0,i.inject)(t.TYPES.IEditorContextServiceProvider),n("design:type",Function)],d.prototype,"editorContextService",void 0),e([(0,i.inject)(t.ActionHandlerRegistry),n("design:type",t.ActionHandlerRegistry)],d.prototype,"actionHandlerRegistry",void 0),e([(0,i.inject)(o.NavigationTargetResolver),n("design:type",o.NavigationTargetResolver)],d.prototype,"resolver",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],d.prototype,"editorContext",void 0),cr.NavigationActionHandler=d=e([(0,i.injectable)()],d),cr}var N2;function e6(){if(N2)return ug;N2=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.navigationModule=void 0;const e=Y(),n=X9(),t=KP();return ug.navigationModule=new e.FeatureModule((i,a,o)=>{i(t.NavigationTargetResolver).toSelf().inSingletonScope(),i(n.NavigationActionHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)({bind:i,isBound:o},n.NavigateAction.KIND,n.NavigationActionHandler),(0,e.configureActionHandler)({bind:i,isBound:o},e.NavigateToTargetAction.KIND,n.NavigationActionHandler),(0,e.configureActionHandler)({bind:i,isBound:o},n.ProcessNavigationArgumentsAction.KIND,n.NavigationActionHandler),(0,e.configureActionHandler)({bind:i,isBound:o},e.NavigateToExternalTargetAction.KIND,n.NavigationActionHandler)},{featureId:Symbol("navigation")}),ug}var lg={},ui={},B2;function t6(){if(B2)return ui;B2=1;var e=ui&&ui.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h};Object.defineProperty(ui,"__esModule",{value:!0}),ui.GLSPBezierEdgeRouter=ui.GLSPManhattanEdgeRouter=ui.GLSPPolylineEdgeRouter=ui.GLSPAbstractEdgeRouter=void 0;const n=Y(),t=G();let i=class extends n.AbstractEdgeRouter{getTranslatedAnchor(l,c,u,f,h){const p=super.getTranslatedAnchor(l,c,u,f,h);return n.Point.isValid(p)?p:c}cleanupRoutingPoints(l,c,u,f){r(l.source)&&r(l.target)&&super.cleanupRoutingPoints(l,c,u,f)}};ui.GLSPAbstractEdgeRouter=i,ui.GLSPAbstractEdgeRouter=i=e([(0,t.injectable)()],i);let a=class extends n.PolylineEdgeRouter{getTranslatedAnchor(l,c,u,f,h){const p=super.getTranslatedAnchor(l,c,u,f,h);return n.Point.isValid(p)?p:c}cleanupRoutingPoints(l,c,u,f){r(l.source)&&r(l.target)&&super.cleanupRoutingPoints(l,c,u,f)}};ui.GLSPPolylineEdgeRouter=a,ui.GLSPPolylineEdgeRouter=a=e([(0,t.injectable)()],a);let o=class extends n.ManhattanEdgeRouter{getTranslatedAnchor(l,c,u,f,h){const p=super.getTranslatedAnchor(l,c,u,f,h);return n.Point.isValid(p)?p:c}cleanupRoutingPoints(l,c,u,f){r(l.source)&&r(l.target)&&super.cleanupRoutingPoints(l,c,u,f)}};ui.GLSPManhattanEdgeRouter=o,ui.GLSPManhattanEdgeRouter=o=e([(0,t.injectable)()],o);let s=class extends n.BezierEdgeRouter{getTranslatedAnchor(l,c,u,f,h){const p=super.getTranslatedAnchor(l,c,u,f,h);return n.Point.isValid(p)?p:c}cleanupRoutingPoints(l,c,u,f){r(l.source)&&r(l.target)&&super.cleanupRoutingPoints(l,c,u,f)}};ui.GLSPBezierEdgeRouter=s,ui.GLSPBezierEdgeRouter=s=e([(0,t.injectable)()],s);function r(d){return d?d.bounds?!0:d.position&&d.size?(d.bounds={...d.position,...d.size},!0):!1:!1}return ui}var x2;function n6(){if(x2)return lg;x2=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.routingModule=void 0;const e=Y(),n=t6();return lg.routingModule=new e.FeatureModule((t,i,a,o)=>{const s={bind:t,unbind:i,isBound:a,rebind:o};t(e.EdgeRouterRegistry).toSelf().inSingletonScope(),t(e.AnchorComputerRegistry).toSelf().inSingletonScope(),(0,e.bindAsService)(s,e.TYPES.IEdgeRouter,n.GLSPManhattanEdgeRouter),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.ManhattanEllipticAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.ManhattanRectangularAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.ManhattanDiamondAnchor),(0,e.bindAsService)(s,e.TYPES.IEdgeRouter,n.GLSPPolylineEdgeRouter),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.EllipseAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.RectangleAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.DiamondAnchor),(0,e.bindAsService)(s,e.TYPES.IEdgeRouter,n.GLSPBezierEdgeRouter),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.BezierEllipseAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.BezierRectangleAnchor),(0,e.bindAsService)(s,e.TYPES.IAnchorComputer,e.BezierDiamondAnchor),(0,e.configureCommand)({bind:t,isBound:a},e.AddRemoveBezierSegmentCommand)},{featureId:Symbol("routing")}),lg}var dS={},Oo={},F2;function i6(){if(F2)return Oo;F2=1;var e=Oo&&Oo.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Oo&&Oo.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)},t=Oo&&Oo.__param||function(r,d){return function(l,c){d(l,c,r)}};Object.defineProperty(Oo,"__esModule",{value:!0}),Oo.SelectFeedbackCommand=void 0;const i=G(),a=Y(),o=Er();let s=class extends a.Command{constructor(d){super(),this.action=d,this.sprottySelectCommand=new a.SprottySelectCommand({...d,kind:a.SelectAction.KIND})}execute(d){return this.sprottySelectCommand.execute(d)}undo(d){return this.sprottySelectCommand.undo(d)}redo(d){return this.sprottySelectCommand.redo(d)}};return Oo.SelectFeedbackCommand=s,s.KIND=o.SelectFeedbackAction.KIND,Oo.SelectFeedbackCommand=s=e([(0,i.injectable)(),t(0,(0,i.inject)(a.TYPES.Action)),n("design:paramtypes",[Object])],s),Oo}var ha={},k2;function r6(){if(k2)return ha;k2=1;var e=ha&&ha.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ha&&ha.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(ha,"__esModule",{value:!0}),ha.RankedSelectMouseListener=void 0;const t=Y(),i=G(),a=cl(),o=Pr();let s=class extends t.SelectMouseListener{constructor(){super(...arguments),this.rank=a.Ranked.DEFAULT_RANK-100}handleSelectTarget(d,l,c){const u=[];return u.push(t.SelectAction.create({selectedElementsIDs:[d.id],deselectedElementsIDs:l.map(f=>f.id)})),u.push(t.BringToFrontAction.create([d.id])),u}handleDeselectTarget(d,l){const c=[];return c.push(t.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[d.id]})),c}handleDeselectAll(d,l){const c=[];return c.push(t.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:d.map(u=>u.id)})),c}handleButton(d,l){var c;return d instanceof o.GResizeHandle&&(!((c=this.changeBoundsManager)===null||c===void 0)&&c.useSymmetricResize(l))?[]:super.handleButton(d,l)}};return ha.RankedSelectMouseListener=s,e([(0,i.inject)(t.TYPES.IChangeBoundsManager),(0,i.optional)(),n("design:type",Object)],s.prototype,"changeBoundsManager",void 0),ha.RankedSelectMouseListener=s=e([(0,i.injectable)()],s),ha}var K2;function qP(){return K2||(K2=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.standaloneSelectModule=e.selectModule=void 0;const n=Y(),t=Er(),i=i6(),a=r6();e.selectModule=new n.FeatureModule((o,s,r)=>{const d={bind:o,isBound:r};(0,n.configureCommand)(d,t.SelectCommand),(0,n.configureCommand)(d,t.SelectAllCommand),(0,n.configureCommand)(d,i.SelectFeedbackCommand),(0,n.bindAsService)(d,n.TYPES.MouseListener,a.RankedSelectMouseListener)},{featureId:Symbol("select")}),e.standaloneSelectModule=new n.FeatureModule(o=>{(0,n.bindAsService)(o,n.TYPES.KeyListener,n.SelectKeyboardListener)},{featureId:Symbol("standaloneSelect"),requires:e.selectModule})}(dS)),dS}var dg={},qr={},q2;function o6(){if(q2)return qr;q2=1;var e=qr&&qr.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=qr&&qr.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(qr,"__esModule",{value:!0}),qr.SourceModelChangedActionHandler=qr.ExternalSourceModelChangedHandler=void 0;const t=G(),i=Y();let a=class{};qr.ExternalSourceModelChangedHandler=a,qr.ExternalSourceModelChangedHandler=a=e([(0,t.injectable)()],a);let o=class{handle(r){if(i.SourceModelChangedAction.is(r)){if(this.externalModelSourceChangedHandler){this.externalModelSourceChangedHandler.notifySourceModelChange(r.sourceModelName,this.options).then(d=>this.dispatcher.dispatchAll(d));return}this.showSimpleNotification(r)}}showSimpleNotification(r){const d=`The source model ${r.sourceModelName} has changed. You might want to consider reloading.`,l=0,c="WARNING";this.dispatcher.dispatchAll([i.StatusAction.create(d,{severity:c,timeout:l}),i.MessageAction.create(d,{severity:c})])}};return qr.SourceModelChangedActionHandler=o,e([(0,t.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],o.prototype,"dispatcher",void 0),e([(0,t.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],o.prototype,"options",void 0),e([(0,t.inject)(a),(0,t.optional)(),n("design:type",a)],o.prototype,"externalModelSourceChangedHandler",void 0),qr.SourceModelChangedActionHandler=o=e([(0,t.injectable)()],o),qr}var H2;function s6(){if(H2)return dg;H2=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.sourceModelWatcherModule=void 0;const e=Y(),n=o6();return dg.sourceModelWatcherModule=new e.FeatureModule((t,i,a)=>{(0,e.configureActionHandler)({bind:t,isBound:a},e.SourceModelChangedAction.KIND,n.SourceModelChangedActionHandler)},{featureId:Symbol("sourceModelWatcher")}),dg}var fg={},pa={},V2;function a6(){if(V2)return pa;V2=1;var e=pa&&pa.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=pa&&pa.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)},t;Object.defineProperty(pa,"__esModule",{value:!0}),pa.StatusOverlay=void 0;const i=Y(),a=G(),o=Ya();let s=t=class extends o.GLSPAbstractUIExtension{id(){return t.ID}containerClass(){return"sprotty-status"}initializeContents(d){this.statusIconDiv=document.createElement("div"),d.appendChild(this.statusIconDiv),this.statusMessageDiv=document.createElement("div"),this.statusMessageDiv.classList.add("sprotty-status-message"),d.appendChild(this.statusMessageDiv)}setStatus(d){if(this.statusMessageDiv&&(this.statusMessageDiv.textContent=d.message,this.removeClasses(this.statusMessageDiv,1),this.statusMessageDiv.classList.add(d.severity.toLowerCase())),this.statusIconDiv){this.removeClasses(this.statusIconDiv,0);const l=this.statusIconDiv.classList;switch(l.add(d.severity.toLowerCase()),d.severity){case"FATAL":l.add(...(0,i.codiconCSSClasses)("error"));break;case"ERROR":l.add(...(0,i.codiconCSSClasses)("warning"));break;case"WARNING":l.add(...(0,i.codiconCSSClasses)("warning"));break;case"INFO":l.add(...(0,i.codiconCSSClasses)("info"));break}}}clearStatus(){this.setStatus(i.StatusAction.create("",{severity:"NONE"}))}clearTimeout(){this.pendingTimeout&&(window.clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0)}removeClasses(d,l){const c=d.classList;for(;c.length>l;){const u=c.item(c.length-1);u&&c.remove(u)}}handle(d){var l;if(this.clearTimeout(),d.severity==="NONE"){this.clearStatus();return}this.setStatus(d);const c=(l=d.timeout)!==null&&l!==void 0?l:-1;c>0&&(this.pendingTimeout=window.setTimeout(()=>this.clearStatus(),c))}preInitialize(){return this.actionDispatcher.dispatch(i.SetUIExtensionVisibilityAction.create({extensionId:this.id(),visible:!0}))}};return pa.StatusOverlay=s,s.ID="glsp.server.status.overlay",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),pa.StatusOverlay=s=t=e([(0,a.injectable)()],s),pa}var G2;function c6(){if(G2)return fg;G2=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.statusModule=void 0;const e=Y(),n=a6();return fg.statusModule=new e.FeatureModule((t,i,a,o)=>{const s={bind:t,unbind:i,isBound:a,rebind:o};(0,e.bindAsService)(s,e.TYPES.IUIExtension,n.StatusOverlay),t(e.TYPES.IDiagramStartup).toService(n.StatusOverlay),(0,e.configureActionHandler)(s,e.StatusAction.KIND,n.StatusOverlay)},{featureId:Symbol("status")}),fg}var hg={},ga={},z2;function u6(){if(z2)return ga;z2=1;var e=ga&&ga.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=ga&&ga.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(ga,"__esModule",{value:!0}),ga.MetadataPlacer=void 0;const t=Y(),i=G(),a=Zr();let o=class{decorate(r,d){return d instanceof t.GModelRoot&&(0,t.setAttr)(r,"data-svg-metadata-api",!0),(0,t.setAttr)(r,"data-svg-metadata-type",d.type),d instanceof t.GChildElement&&(0,t.setAttr)(r,"data-svg-metadata-parent-id",this.domHelper.createUniqueDOMElementId(d.parent)),d instanceof a.GEdge&&(d.source!==void 0&&(0,t.setAttr)(r,"data-svg-metadata-edge-source-id",this.domHelper.createUniqueDOMElementId(d.source)),d.target!==void 0&&(0,t.setAttr)(r,"data-svg-metadata-edge-target-id",this.domHelper.createUniqueDOMElementId(d.target))),r}postUpdate(){}};return ga.MetadataPlacer=o,e([(0,i.inject)(t.TYPES.DOMHelper),n("design:type",t.DOMHelper)],o.prototype,"domHelper",void 0),ga.MetadataPlacer=o=e([(0,i.injectable)()],o),ga}var U2;function l6(){if(U2)return hg;U2=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.svgMetadataModule=void 0;const e=Y(),n=u6();return hg.svgMetadataModule=new e.FeatureModule(t=>{t(n.MetadataPlacer).toSelf().inSingletonScope(),t(e.TYPES.IVNodePostprocessor).toService(n.MetadataPlacer)},{featureId:Symbol("svgMetadata")}),hg}var pg={},fn={},xn={},$2;function D_(){if($2)return xn;$2=1;var e=xn&&xn.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=xn&&xn.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)},t,i;Object.defineProperty(xn,"__esModule",{value:!0}),xn.DeleteToolMouseListener=xn.MouseDeleteTool=xn.DeleteKeyListener=xn.DelKeyDeleteTool=void 0;const a=Y(),o=G(),s=Un(),r=an(),d=Wa();let l=t=class{constructor(){this.isEditTool=!0,this.deleteKeyListener=new c}get id(){return t.ID}enable(){this.keytool.register(this.deleteKeyListener)}disable(){this.keytool.deregister(this.deleteKeyListener)}};xn.DelKeyDeleteTool=l,l.ID="glsp.delete-keyboard",e([(0,o.inject)(a.KeyTool),n("design:type",a.KeyTool)],l.prototype,"keytool",void 0),xn.DelKeyDeleteTool=l=t=e([(0,o.injectable)()],l);let c=class extends a.KeyListener{keyDown(p,g){if((0,a.matchesKeystroke)(g,"Delete")){const m=Array.from(p.root.index.all().filter(v=>(0,a.isDeletable)(v)&&(0,a.isSelectable)(v)&&v.selected).filter(v=>v.id!==v.root.id).map(v=>v.id));if(m.length>0)return[a.DeleteElementOperation.create(m)]}return[]}};xn.DeleteKeyListener=c,xn.DeleteKeyListener=c=e([(0,o.injectable)()],c);let u=i=class extends d.BaseEditTool{constructor(){super(...arguments),this.deleteToolMouseListener=new f}get id(){return i.ID}enable(){const p=this.createFeedbackEmitter().add((0,s.cursorFeedbackAction)(s.CursorCSS.ELEMENT_DELETION),(0,s.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.deleteToolMouseListener),p)}};xn.MouseDeleteTool=u,u.ID="glsp.delete-mouse",xn.MouseDeleteTool=u=i=e([(0,o.injectable)()],u);let f=class extends a.MouseListener{mouseUp(p,g){const m=(0,a.findParentByFeature)(p,a.isDeletable);if(m===void 0)return[];const v=[];return v.push(a.DeleteElementOperation.create([m.id])),(0,a.isCtrlOrCmd)(g)||v.push(r.EnableDefaultToolsAction.create()),v}};return xn.DeleteToolMouseListener=f,xn.DeleteToolMouseListener=f=e([(0,o.injectable)()],f),xn}var ki={},Lo={},Tc={},Y2;function O_(){return Y2||(Y2=1,function(e){var n=Tc&&Tc.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},t=Tc&&Tc.__metadata||function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},i=Tc&&Tc.__param||function(g,m){return function(v,_){m(v,_,g)}};Object.defineProperty(e,"__esModule",{value:!0}),e.removeMarquee=e.drawMarquee=e.MARQUEE=e.marqueeId=e.MarqueeEndMovingMouseListener=e.RemoveMarqueeCommand=e.RemoveMarqueeAction=e.DrawMarqueeCommand=e.DrawMarqueeAction=void 0;const a=G(),o=Y(),s=Cr();var r;(function(g){g.KIND="drawMarquee";function m(_){return o.Action.hasKind(_,g.KIND)&&(0,o.hasObjectProp)(_,"startPoint")&&(0,o.hasObjectProp)(_,"endPoint")}g.is=m;function v(_){return{kind:g.KIND,..._}}g.create=v})(r||(e.DrawMarqueeAction=r={}));let d=class extends s.FeedbackCommand{constructor(m){super(),this.action=m}execute(m){return h(m,this.action.startPoint,this.action.endPoint),m.root}};e.DrawMarqueeCommand=d,d.KIND=r.KIND,e.DrawMarqueeCommand=d=n([(0,a.injectable)(),i(0,(0,a.inject)(o.TYPES.Action)),t("design:paramtypes",[Object])],d);var l;(function(g){g.KIND="removeMarquee";function m(_){return o.Action.hasKind(_,g.KIND)}g.is=m;function v(){return{kind:g.KIND}}g.create=v})(l||(e.RemoveMarqueeAction=l={}));let c=class extends s.FeedbackCommand{execute(m){return p(m.root),m.root}};e.RemoveMarqueeCommand=c,c.KIND=l.KIND,e.RemoveMarqueeCommand=c=n([(0,a.injectable)()],c);class u extends o.MouseListener{constructor(m){super(),this.anchorRegistry=m}mouseMove(m,v){return[]}}e.MarqueeEndMovingMouseListener=u;function f(g){return g.id+"_"+e.MARQUEE}e.marqueeId=f,e.MARQUEE="marquee";function h(g,m,v){const _=g.root;p(_);const S={type:e.MARQUEE,id:f(_),startPoint:m,endPoint:v},E=g.modelFactory.createElement(S);_.add(E)}e.drawMarquee=h;function p(g){const m=g.index.getById(f(g));m instanceof o.GChildElement&&g.remove(m)}e.removeMarquee=p}(Tc)),Tc}var W2;function HP(){if(W2)return Lo;W2=1;var e=Lo&&Lo.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Lo&&Lo.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t=Lo&&Lo.__param||function(c,u){return function(f,h){u(f,h,c)}};Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.MarqueeUtil=void 0;const i=Y(),a=G(),o=Zr(),s=kt(),r=Wo(),d=O_();let l=class{constructor(u={entireElement:!1,entireEdge:!1},f){this.marqueeBehavior=u,this.domHelper=f}isContinuousMode(u,f){return f.shiftKey}getMarkableNodes(u){return(0,s.getMatchingElements)(u.index,this.isMarkableNode())}isMarkableNode(){return(0,i.typeGuard)((0,i.toTypeGuard)(i.GNode),s.isSelectableAndBoundsAware)}getMarkableEdges(u){return(0,s.getMatchingElements)(u.index,this.isMarkableEdge())}isMarkableEdge(){return(0,i.typeGuard)((0,i.toTypeGuard)(o.GEdge),i.isSelectable)}updateStartPoint(u){this.startPoint=u}updateCurrentPoint(u){this.currentPoint=u}isMarked(u){return u instanceof o.GEdge?this.isMarkedEdge(u):this.isMarkedNode(u)}drawMarqueeAction(){return d.DrawMarqueeAction.create({startPoint:this.startPoint,endPoint:this.currentPoint})}isMarkedEdge(u){const f=this.domHelper.createUniqueDOMElementId(u),h=document.getElementById(f);if(!h||h.getAttribute("transform")||!h.children[0])return!1;const p=h.children[0].getAttribute("d");return this.isEdgePathMarked(p)}isMarkedNode(u){return this.isNodeMarked(this.getNodeBounds(u))}getNodeBounds(u){return(0,r.toAbsoluteBounds)(u)}isEdgePathMarked(u){if(!u)return!1;const f=u.split(/M|L/).filter(h=>h).map(h=>{const p=h.split(",");return{x:parseInt(p[0],10),y:parseInt(p[1],10)}});return this.isEdgeMarked(f)}isEdgeMarked(u){return this.marqueeBehavior.entireEdge?this.isEntireEdgeMarked(u):this.isPartOfEdgeMarked(u)}isNodeMarked(u){const f=this.startPoint.x<this.currentPoint.x?this.isElementBetweenXAxis(u,this.startPoint.x,this.currentPoint.x):this.isElementBetweenXAxis(u,this.currentPoint.x,this.startPoint.x),h=this.startPoint.y<this.currentPoint.y?this.isElementBetweenYAxis(u,this.startPoint.y,this.currentPoint.y):this.isElementBetweenYAxis(u,this.currentPoint.y,this.startPoint.y);return f&&h}isEntireEdgeMarked(u){for(let f=0;f<u.length;f++)if(!this.pointInRect(u[f]))return!1;return!0}isPartOfEdgeMarked(u){for(let f=0;f<u.length-1;f++)if(this.isLineMarked(u[f],u[f+1]))return!0;return!1}isLineMarked(u,f){const h=new i.PointToPointLine(u,f);return this.pointInRect(u)||this.pointInRect(f)||this.lineIntersect(h,this.startPoint,{x:this.startPoint.x,y:this.currentPoint.y})||this.lineIntersect(h,this.startPoint,{x:this.currentPoint.x,y:this.startPoint.y})||this.lineIntersect(h,{x:this.currentPoint.x,y:this.startPoint.y},this.currentPoint)||this.lineIntersect(h,{x:this.startPoint.x,y:this.currentPoint.y},this.currentPoint)}lineIntersect(u,f,h){return u.intersection(new i.PointToPointLine(f,h))!==void 0}pointInRect(u){const f=this.startPoint.x<=this.currentPoint.x?this.isBetween(u.x,this.startPoint.x,this.currentPoint.x):this.isBetween(u.x,this.currentPoint.x,this.startPoint.x),h=this.startPoint.y<=this.currentPoint.y?this.isBetween(u.y,this.startPoint.y,this.currentPoint.y):this.isBetween(u.y,this.currentPoint.y,this.startPoint.y);return f&&h}isElementBetweenXAxis(u,f,h){const p=this.isBetween(u.x,f,h),g=this.isBetween(u.x+u.width,f,h);return this.marqueeBehavior.entireElement?p&&g:p||g||this.isBetween(f,u.x,u.x+u.width)||this.isBetween(h,u.x,u.x+u.width)}isElementBetweenYAxis(u,f,h){const p=this.isBetween(u.y,f,h),g=this.isBetween(u.y+u.height,f,h);return this.marqueeBehavior.entireElement?p&&g:p||g||this.isBetween(f,u.y,u.y+u.height)||this.isBetween(h,u.y,u.y+u.height)}isBetween(u,f,h){return f<=u&&u<=h}};return Lo.MarqueeUtil=l,Lo.MarqueeUtil=l=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.IMarqueeBehavior)),t(0,(0,a.optional)()),t(1,(0,a.inject)(i.TYPES.DOMHelper)),n("design:paramtypes",[Object,i.DOMHelper])],l),Lo}var Z2;function dh(){if(Z2)return ki;Z2=1;var e=ki&&ki.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=ki&&ki.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)},t;Object.defineProperty(ki,"__esModule",{value:!0}),ki.ShiftKeyListener=ki.MarqueeMouseListener=ki.MarqueeMouseTool=void 0;const i=Y(),a=G(),o=Jc(),s=Un(),r=an(),d=kt(),l=Wo(),c=Wa(),u=HP(),f=O_();let h=t=class extends c.BaseEditTool{constructor(){super(...arguments),this.shiftKeyListener=new g}get id(){return t.ID}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(new p(this.editorContext.modelRoot,this.marqueeUtil)),this.keyTool.registerListener(this.shiftKeyListener),this.createFeedbackEmitter().add((0,s.cursorFeedbackAction)(s.CursorCSS.MARQUEE),(0,s.cursorFeedbackAction)()).submit())}get isEditTool(){return!1}};ki.MarqueeMouseTool=h,h.ID="glsp.marquee-mouse-tool",e([(0,a.inject)(u.MarqueeUtil),n("design:type",u.MarqueeUtil)],h.prototype,"marqueeUtil",void 0),ki.MarqueeMouseTool=h=t=e([(0,a.injectable)()],h);class p extends o.DragAwareMouseListener{constructor(v,_){super(),this.marqueeUtil=_,this.isActive=!1,this.nodes=this.marqueeUtil.getMarkableNodes(v),this.edges=this.marqueeUtil.getMarkableEdges(v)}mouseDown(v,_){return this.isActive=!0,this.marqueeUtil.updateStartPoint((0,l.getAbsolutePosition)(v,_)),_.ctrlKey&&(this.previouslySelected=(0,d.getMatchingElements)(v.index,(0,i.typeGuard)(d.isSelectableAndBoundsAware,i.isSelected)).map(S=>S.id)),[]}mouseMove(v,_){if(this.marqueeUtil.updateCurrentPoint((0,l.getAbsolutePosition)(v,_)),this.isActive){const S=this.nodes.filter(L=>this.marqueeUtil.isMarked(L)).map(L=>L.id),E=this.edges.filter(L=>this.marqueeUtil.isMarked(L)).map(L=>L.id),M=S.concat(E).concat(this.previouslySelected);return[i.SelectAction.setSelection(M),this.marqueeUtil.drawMarqueeAction()]}return[]}mouseUp(v,_){return this.isActive=!1,this.marqueeUtil.isContinuousMode(v,_)?[f.RemoveMarqueeAction.create()]:[f.RemoveMarqueeAction.create(),r.EnableDefaultToolsAction.create()]}}ki.MarqueeMouseListener=p;let g=class extends i.KeyListener{keyUp(v,_){return _.shiftKey?[]:[f.RemoveMarqueeAction.create(),r.EnableDefaultToolsAction.create()]}};return ki.ShiftKeyListener=g,ki.ShiftKeyListener=g=e([(0,a.injectable)()],g),ki}var ur={},Q2;function VP(){if(Q2)return ur;Q2=1;var e=ur&&ur.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ur&&ur.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)},t=ur&&ur.__param||function(r,d){return function(l,c){d(l,c,r)}};Object.defineProperty(ur,"__esModule",{value:!0}),ur.OriginViewportCommand=ur.OriginViewportAction=void 0;const i=Y(),a=G();var o;(function(r){r.KIND="originViewport";function d(c){return i.Action.hasKind(c,r.KIND)}r.is=d;function l(c={}){return{kind:r.KIND,animate:!0,...c}}r.create=l})(o||(ur.OriginViewportAction=o={}));let s=class extends i.BoundsAwareViewportCommand{constructor(d){super(d.animate),this.action=d}getElementIds(){return[]}initialize(d){if(!(0,i.isViewport)(d))return;this.oldViewport={scroll:d.scroll,zoom:d.zoom};const l=this.getNewViewport(i.Bounds.EMPTY,d);if(l){const{zoomLimits:c,horizontalScrollLimits:u,verticalScrollLimits:f}=this.viewerOptions;this.newViewport=(0,i.limitViewport)(l,d.canvasBounds,u,f,c)}}getNewViewport(d,l){return{zoom:1,scroll:{x:0,y:0}}}};return ur.OriginViewportCommand=s,s.KIND=o.KIND,ur.OriginViewportCommand=s=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],s),ur}var J2;function Wm(){if(J2)return fn;J2=1;var e=fn&&fn.__decorate||function(I,R,w,T){var j=arguments.length,D=j<3?R:T===null?T=Object.getOwnPropertyDescriptor(R,w):T,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(I,R,w,T);else for(var H=I.length-1;H>=0;H--)(B=I[H])&&(D=(j<3?B(D):j>3?B(R,w,D):B(R,w))||D);return j>3&&D&&Object.defineProperty(R,w,D),D},n=fn&&fn.__metadata||function(I,R){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(I,R)},t;Object.defineProperty(fn,"__esModule",{value:!0}),fn.changeCodiconClass=fn.changeCSSClass=fn.createToolGroup=fn.createIcon=fn.compare=fn.ToolPalette=fn.EnableToolPaletteAction=void 0;const i=Y(),a=G(),o=kn(),s=Gm(),r=an(),d=Ya(),l=D_(),c=dh(),u=VP(),f="clicked",h="search",p="tools",g="chevron-right",m="500px";var v;(function(I){I.KIND="enableToolPalette";function R(T){return i.Action.hasKind(T,I.KIND)}I.is=R;function w(){return{kind:I.KIND}}I.create=w})(v||(fn.EnableToolPaletteAction=v={}));let _=t=class extends d.GLSPAbstractUIExtension{constructor(){super(...arguments),this.paletteItemsCopy=[],this.dynamic=!1}id(){return t.ID}containerClass(){return t.ID}postConstruct(){this.editorContext.onEditModeChanged(R=>this.editModeChanged(R.newValue,R.oldValue))}initialize(){return this.paletteItems?super.initialize():!1}initializeContents(R){this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,R.setAttribute("aria-label","Tool-Palette")}onBeforeShow(R,w){this.modelRootId=w.id,this.containerElement.style.maxHeight=m}addMinimizePaletteButton(){const R=document.getElementById(this.options.baseDiv),w=document.createElement("div");if(w.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),R){const T=R.insertBefore(w,R.firstChild),j=E(g);this.updateMinimizePaletteButtonTooltip(w),j.onclick=D=>{this.isPaletteMaximized()?this.containerElement.style.maxHeight="0px":this.containerElement.style.maxHeight=m,this.updateMinimizePaletteButtonTooltip(w),L(j,p),L(j,g)},T.appendChild(j)}}updateMinimizePaletteButtonTooltip(R){this.isPaletteMaximized()?R.title="Minimize palette":R.title="Maximize palette"}isPaletteMaximized(){return this.containerElement&&this.containerElement.style.maxHeight!=="0px"}createBody(){const R=document.createElement("div");R.classList.add("palette-body");let w=0;if(this.paletteItems.sort(S).forEach(T=>{if(T.children){const j=C(T);T.children.sort(S).forEach(D=>j.appendChild(this.createToolButton(D,w++))),R.appendChild(j)}else R.appendChild(this.createToolButton(T,w++))}),this.paletteItems.length===0){const T=document.createElement("div");T.innerText="No results found.",T.classList.add("tool-button"),R.appendChild(T)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(R),this.bodyDiv=R}createHeader(){this.addMinimizePaletteButton();const R=document.createElement("div");R.classList.add("palette-header"),R.append(this.createHeaderTitle()),R.appendChild(this.createHeaderTools()),R.appendChild(this.searchField=this.createHeaderSearchField()),this.containerElement.appendChild(R)}createHeaderTools(){const R=document.createElement("div");R.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),R.appendChild(this.defaultToolsButton);const w=this.createMouseDeleteToolButton();R.appendChild(w);const T=this.createMarqueeToolButton();R.appendChild(T);const j=this.createValidateButton();R.appendChild(j);const D=this.createResetViewportButton();if(R.appendChild(D),this.gridManager){const H=this.createToggleGridButton();R.appendChild(H)}if(this.debugManager){const H=this.createToggleDebugButton();R.appendChild(H)}const B=this.createSearchButton();return R.appendChild(B),R}createDefaultToolButton(){const R=E("inspect");return R.id="btn_default_tools",R.title="Enable selection tool",R.onclick=this.onClickStaticToolButton(R),R.ariaLabel=R.title,R.tabIndex=1,R}createMouseDeleteToolButton(){const R=E("chrome-close");return R.title="Enable deletion tool",R.onclick=this.onClickStaticToolButton(R,l.MouseDeleteTool.ID),R.ariaLabel=R.title,R.tabIndex=1,R}createMarqueeToolButton(){const R=E("screen-full");return R.title="Enable marquee tool",R.onclick=this.onClickStaticToolButton(R,c.MarqueeMouseTool.ID),R.ariaLabel=R.title,R.tabIndex=1,R}createValidateButton(){const R=E("pass");return R.title="Validate model",R.onclick=w=>{const T=[this.modelRootId];this.actionDispatcher.dispatch(i.RequestMarkersAction.create(T,{reason:i.MarkersReason.BATCH})),R.focus()},R.ariaLabel=R.title,R.tabIndex=1,R}createResetViewportButton(){const R=E("screen-normal");return R.title="Reset Viewport",R.onclick=w=>{this.actionDispatcher.dispatch(u.OriginViewportAction.create()),R.focus()},R.ariaLabel=R.title,R.tabIndex=1,R}createToggleGridButton(){var R;const w=E("symbol-numeric");return w.title="Toggle Grid",w.onclick=()=>{var T,j,D;!((T=this.gridManager)===null||T===void 0)&&T.isGridVisible?(w.classList.remove(f),(j=this.gridManager)===null||j===void 0||j.setGridVisible(!1)):(w.classList.add(f),(D=this.gridManager)===null||D===void 0||D.setGridVisible(!0))},!((R=this.gridManager)===null||R===void 0)&&R.isGridVisible&&w.classList.add(f),w.ariaLabel=w.title,w.tabIndex=1,w}createToggleDebugButton(){var R;const w=E("debug");return w.title="Debug Mode",w.onclick=()=>{var T,j,D;!((T=this.debugManager)===null||T===void 0)&&T.isDebugEnabled?(w.classList.remove(f),(j=this.debugManager)===null||j===void 0||j.setDebugEnabled(!1)):(w.classList.add(f),(D=this.debugManager)===null||D===void 0||D.setDebugEnabled(!0))},!((R=this.debugManager)===null||R===void 0)&&R.isDebugEnabled&&w.classList.add(f),w.ariaLabel=w.title,w.tabIndex=1,w}createSearchButton(){const R=E(h);return R.onclick=w=>{const T=document.getElementById(this.containerElement.id+"_search_field");T&&(T.style.display==="none"?(T.style.display="",T.focus()):T.style.display="none")},R.classList.add("search-icon"),R.title="Filter palette entries",R.ariaLabel=R.title,R.tabIndex=1,R}createHeaderSearchField(){const R=document.createElement("input");return R.classList.add("search-input"),R.id=this.containerElement.id+"_search_field",R.type="text",R.placeholder="Search...",R.style.display="none",R.onkeyup=()=>this.requestFilterUpdate(this.searchField.value),R.onkeydown=w=>this.clearOnEscape(w),R}createHeaderTitle(){const R=document.createElement("div");return R.classList.add("header-icon"),R.appendChild(E(p)),R.insertAdjacentText("beforeend","Palette"),R}createToolButton(R,w){const T=document.createElement("div");return T.tabIndex=w,T.classList.add("tool-button"),R.icon&&T.appendChild(E(R.icon)),T.insertAdjacentText("beforeend",R.label),T.onclick=this.onClickCreateToolButton(T,R),T.onkeydown=j=>this.clearToolOnEscape(j),T}onClickCreateToolButton(R,w){return T=>{this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(w.actions),this.changeActiveButton(R),R.focus())}}onClickStaticToolButton(R,w){return T=>{if(!this.editorContext.isReadonly){const j=w?r.EnableToolsAction.create([w]):r.EnableDefaultToolsAction.create();this.actionDispatcher.dispatch(j),this.changeActiveButton(R),R.focus()}}}changeActiveButton(R){this.lastActiveButton&&this.lastActiveButton.classList.remove(f),R?(R.classList.add(f),this.lastActiveButton=R):this.defaultToolsButton&&(this.defaultToolsButton.classList.add(f),this.lastActiveButton=this.defaultToolsButton)}handle(R){var w;this.changeActiveButton(),i.UpdateModelAction.is(R)||i.SetModelAction.is(R)?this.reloadPaletteBody():r.EnableDefaultToolsAction.is(R)&&this.focusTracker.hasFocus&&((w=this.focusTracker.diagramElement)===null||w===void 0||w.focus())}editModeChanged(R,w){this.actionDispatcher.dispatch(i.SetUIExtensionVisibilityAction.create({extensionId:t.ID,visible:!this.editorContext.isReadonly}))}clearOnEscape(R){(0,i.matchesKeystroke)(R,"Escape")&&(this.searchField.value="",this.requestFilterUpdate(""))}clearToolOnEscape(R){(0,i.matchesKeystroke)(R,"Escape")&&this.actionDispatcher.dispatch(r.EnableDefaultToolsAction.create())}requestFilterUpdate(R){this.paletteItemsCopy.length===0&&(this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))),this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const w=[];for(const T of this.paletteItems)if(T.children){const j=T.children.filter(D=>D.label.toLowerCase().includes(R.toLowerCase()));j.length>0&&(T.children.splice(0,T.children.length),j.forEach(D=>T.children.push(D)),w.push(T))}this.paletteItems=w,this.createBody()}async preRequestModel(){}async postRequestModel(){await this.setPaletteItems(),this.editorContext.isReadonly||this.show(this.editorContext.modelRoot)}async setPaletteItems(){const R=i.RequestContextActions.create({contextId:t.ID,editorContext:{selectedElementIds:[]}}),w=await this.actionDispatcher.request(R);this.paletteItems=w.actions.map(T=>T),this.dynamic=this.paletteItems.some(T=>this.hasDynamicAction(T))}hasDynamicAction(R){var w;const T=!!R.actions.find(j=>{var D;return i.TriggerNodeCreationAction.is(j)&&((D=j.ghostElement)===null||D===void 0?void 0:D.dynamic)});return T||((w=R.children)===null||w===void 0?void 0:w.some(j=>this.hasDynamicAction(j)))||!1}async reloadPaletteBody(){!this.editorContext.isReadonly&&this.dynamic&&(await this.setPaletteItems(),this.paletteItemsCopy=[],this.requestFilterUpdate(this.searchField.value))}};fn.ToolPalette=_,_.ID="tool-palette",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],_.prototype,"actionDispatcher",void 0),e([(0,a.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],_.prototype,"editorContext",void 0),e([(0,a.inject)(s.FocusTracker),n("design:type",s.FocusTracker)],_.prototype,"focusTracker",void 0),e([(0,a.inject)(i.TYPES.IGridManager),(0,a.optional)(),n("design:type",Object)],_.prototype,"gridManager",void 0),e([(0,a.inject)(i.TYPES.IDebugManager),(0,a.optional)(),n("design:type",Object)],_.prototype,"debugManager",void 0),e([(0,a.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],_.prototype,"postConstruct",null),fn.ToolPalette=_=t=e([(0,a.injectable)()],_);function S(I,R){const w=I.sortString.localeCompare(R.sortString);return w!==0?w:I.label.localeCompare(R.label)}fn.compare=S;function E(I){const R=document.createElement("i");return R.classList.add(...(0,i.codiconCSSClasses)(I)),R}fn.createIcon=E;function C(I){const R=document.createElement("div");R.classList.add("tool-group"),R.id=I.id;const w=document.createElement("div");return w.classList.add("group-header"),I.icon&&w.appendChild(E(I.icon)),w.insertAdjacentText("beforeend",I.label),w.ondblclick=T=>{const j="collapsed";M(R,j),Array.from(R.children).forEach(D=>M(D,j)),window.getSelection().removeAllRanges()},R.appendChild(w),R}fn.createToolGroup=C;function M(I,R){I.classList.contains(R)?I.classList.remove(R):I.classList.add(R)}fn.changeCSSClass=M;function L(I,R){I.classList.contains((0,i.codiconCSSClasses)(R)[1])?I.classList.remove((0,i.codiconCSSClasses)(R)[1]):I.classList.add((0,i.codiconCSSClasses)(R)[1])}return fn.changeCodiconClass=L,fn}var X2;function d6(){if(X2)return pg;X2=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.toolPaletteModule=void 0;const e=Y(),n=an(),t=Wm();return pg.toolPaletteModule=new e.FeatureModule((i,a,o,s)=>{(0,e.bindAsService)(i,e.TYPES.IUIExtension,t.ToolPalette),i(e.TYPES.IDiagramStartup).toService(t.ToolPalette),(0,e.configureActionHandler)({bind:i,isBound:o},n.EnableDefaultToolsAction.KIND,t.ToolPalette),(0,e.configureActionHandler)({bind:i,isBound:o},e.UpdateModelAction.KIND,t.ToolPalette),(0,e.configureActionHandler)({bind:i,isBound:o},e.SetModelAction.KIND,t.ToolPalette)},{featureId:Symbol("toolPalette")}),pg}var gg={},Dc={},lr={},ej;function f6(){if(ej)return lr;ej=1;var e=lr&&lr.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g};Object.defineProperty(lr,"__esModule",{value:!0}),lr.movementRestrictionFeedback=lr.removeMovementRestrictionFeedback=lr.createMovementRestrictionFeedback=lr.NoOverlapMovementRestrictor=void 0;const n=Y(),t=G(),i=Un(),a=Wo(),o=Pr();let s=class{constructor(){this.cssClasses=["movement-not-allowed"]}validate(u,f){if(!(0,n.isMoveable)(u)||!f)return!1;const h=(0,n.isBoundsAware)(u)?u.bounds:{width:1,height:1},p=Object.create(u);return p.bounds={...h,...f},p.type="Ghost",p.id=u.id,!Array.from(u.root.index.all().filter(g=>g.id!==p.id&&g!==p.root&&g instanceof n.GNode).map(g=>g)).some(g=>this.areOverlapping(g,p))}isBoundsRelevant(u,f){return u.id!==f.id&&u!==f.root&&u instanceof n.GNode&&(0,n.isBoundsAware)(u)}areOverlapping(u,f){return n.Bounds.overlap((0,a.toAbsoluteBounds)(u),(0,a.toAbsoluteBounds)(f))}};lr.NoOverlapMovementRestrictor=s,lr.NoOverlapMovementRestrictor=s=e([(0,t.injectable)()],s);function r(c,u){const f=[c];return c instanceof n.GParentElement&&c.children.filter(h=>h instanceof o.GResizeHandle).forEach(h=>f.push(h)),i.ModifyCSSFeedbackAction.create({elements:f,add:u.cssClasses})}lr.createMovementRestrictionFeedback=r;function d(c,u){const f=[c];return c instanceof n.GParentElement&&c.children.filter(h=>h instanceof o.GResizeHandle).forEach(h=>f.push(h)),i.ModifyCSSFeedbackAction.create({elements:f,remove:u.cssClasses})}lr.removeMovementRestrictionFeedback=d;function l(c,u,f){return f?d(c,u):r(c,u)}return lr.movementRestrictionFeedback=l,lr}var fS={},tj;function Zm(){return tj||(tj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.InsertIndicator=e.ARG_LENGTH=void 0;const n=Y(),t=Hm(),i=Vm();e.ARG_LENGTH="length";class a extends n.GNode{constructor(s){super(),this.id=(0,t.v4)(),this.type=a.TYPE,this.features=(0,n.createFeatureSet)(a.DEFAULT_FEATURES),this.cssClasses=["insert-indicator","sprotty-node"],this.size=n.Dimension.ZERO,this.args={},s&&(this.args={[e.ARG_LENGTH]:s})}}e.InsertIndicator=a,a.DEFAULT_FEATURES=[n.boundsFeature,n.moveFeature,i.argsFeature],a.TYPE="node:insert-indicator"}(fS)),fS}var hS={},sd={},nj;function h6(){if(nj)return sd;nj=1,Object.defineProperty(sd,"__esModule",{value:!0}),sd.DiagramMovementCalculator=sd.MovementCalculator=void 0;const e=Y();class n{setPosition(a){this.position={...a}}updatePosition(a){var o;const s=e.Vector.is(a)?a:a.vector;this.setPosition(e.Point.add((o=this.position)!==null&&o!==void 0?o:e.Point.ORIGIN,s))}get hasPosition(){return this.position!==void 0}calculateMoveTo(a){return this.position?e.Point.move(this.position,a):e.Movement.ZERO}dispose(){this.position=void 0}}sd.MovementCalculator=n;class t extends n{constructor(a){super(),this.positionTracker=a}init(){const a=this.positionTracker.lastPositionOnDiagram;a&&this.setPosition(a)}calculateMoveToCurrent(){const a=this.positionTracker.lastPositionOnDiagram;return a?this.calculateMoveTo(a):e.Movement.ZERO}reset(){this.dispose()}}return sd.DiagramMovementCalculator=t,sd}var ij;function GP(){return ij||(ij=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.MoveableRoutingHandle=e.MoveableResizeHandle=e.ChangeBoundsTracker=e.TrackedElementResize=e.DEFAULT_RESIZE_OPTIONS=e.TrackedMove=e.TrackedElementMove=e.DEFAULT_MOVE_OPTIONS=void 0;const n=Y(),t=kt(),i=Pr(),a=h6();e.DEFAULT_MOVE_OPTIONS={snap:!0,restrict:!0,validate:!0,skipStatic:!0,skipInvalid:!1};var o;(function(u){function f(h){return(0,n.hasObjectProp)(h,"element")&&(0,n.hasObjectProp)(h,"fromPosition")&&(0,n.hasObjectProp)(h,"toPosition")&&(0,n.hasBooleanProp)(h,"valid")}u.is=f})(o||(e.TrackedElementMove=o={}));var s;(function(u){function f(h){return n.Movement.is(h)&&(0,n.hasBooleanProp)(h,"valid")}u.is=f})(s||(e.TrackedMove=s={})),e.DEFAULT_RESIZE_OPTIONS={snap:!0,restrict:!0,validate:!0,symmetric:!0,constrainResize:!0,skipStatic:!0,skipInvalidSize:!1,skipInvalidMove:!1};var r;(function(u){function f(h){return(0,n.isBoundsAware)(h.element)&&(0,n.hasObjectProp)(h,"fromBounds")&&(0,n.hasObjectProp)(h,"toBounds")&&(0,n.hasObjectProp)(h,"valid")}u.is=f})(r||(e.TrackedElementResize=r={}));class d{constructor(f){this.manager=f,this.diagramMovement=new a.DiagramMovementCalculator(f.positionTracker)}startTracking(){return this.diagramMovement.init(),this}updateTrackingPosition(f){const h=s.is(f)?n.Vector.max(...f.elementMoves.map(p=>p.moveVector)):f;this.diagramMovement.updatePosition(h)}isTracking(){return this.diagramMovement.hasPosition}stopTracking(){return this.diagramMovement.dispose(),this}moveElements(f,h){const p=this.resolveMoveOptions(h),g=this.calculateDiagramMovement(),m={...g,elementMoves:[],valid:!0,options:p};if(n.Vector.isZero(g.vector)&&p.skipStatic)return m;const v=this.getMoveableElements(f,p);for(const _ of v){const S=this.calculateElementMove(_,g.vector,p);this.skipElementMove(S,p)||(m.elementMoves.push(S),m.valid&&(m.valid=S.valid))}return m}resolveMoveOptions(f){var h,p;return{...e.DEFAULT_MOVE_OPTIONS,...f,snap:this.manager.usePositionSnap((h=f==null?void 0:f.snap)!==null&&h!==void 0?h:e.DEFAULT_MOVE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((p=f==null?void 0:f.restrict)!==null&&p!==void 0?p:e.DEFAULT_MOVE_OPTIONS.restrict)}}calculateDiagramMovement(){return this.diagramMovement.calculateMoveToCurrent()}getMoveableElements(f,h){var p;return Array.isArray(f)?f:(0,t.getElements)(f.ctx.index,f.elementIDs,(p=f.guard)!==null&&p!==void 0?p:n.isMoveable)}skipElementMove(f,h){return h.skipInvalid&&!f.valid||h.skipStatic&&n.Vector.isZero(f.moveVector)}calculateElementMove(f,h,p){const g=f.position,m=n.Point.add(g,h),v={element:f,fromPosition:g,toPosition:m,valid:!0,moveVector:h,sourceVector:h};return p.snap&&(v.toPosition=this.snapPosition(v,p)),p.restrict&&(v.toPosition=this.restrictMovement(v,p)),p.validate&&(v.valid=this.validateElementMove(v,p)),v.moveVector=n.Point.vector(v.fromPosition,v.toPosition),v}snapPosition(f,h){return this.manager.snapPosition(f.element,f.toPosition)}restrictMovement(f,h){const p=n.Point.move(f.fromPosition,f.toPosition);return this.manager.restrictMovement(f.element,p).to}validateElementMove(f,h){return this.manager.hasValidPosition(f.element,f.toPosition)}resizeElements(f,h){const p=this.resolveResizeOptions(h),g=this.calculateDiagramMovement(),m=this.calculateHandleMove(new l(f),g.vector,p),v={...g,valid:{move:!0,size:!0},options:p,handleMove:m,elementResizes:[]};if(n.Vector.isZero(m.moveVector)&&p.skipStatic)return v;const _=this.getResizableElements(f,p);for(const S of _){const E=this.calculateElementResize(S,m,p);this.skipElementResize(E,p)||(v.elementResizes.push(E),v.valid.move=v.valid.move&&E.valid.move,v.valid.size=v.valid.size&&E.valid.size)}return v}resolveResizeOptions(f){var h,p,g;return{...e.DEFAULT_RESIZE_OPTIONS,...f,snap:this.manager.usePositionSnap((h=f==null?void 0:f.snap)!==null&&h!==void 0?h:e.DEFAULT_RESIZE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((p=f==null?void 0:f.restrict)!==null&&p!==void 0?p:e.DEFAULT_RESIZE_OPTIONS.restrict),symmetric:this.manager.useSymmetricResize((g=f==null?void 0:f.symmetric)!==null&&g!==void 0?g:e.DEFAULT_RESIZE_OPTIONS.symmetric)}}calculateHandleMove(f,h,p){const g=this.resolveMoveOptions({...p,validate:!1});return this.calculateElementMove(f,h,g)}getResizableElements(f,h){return[f.parent]}skipElementResize(f,h){return h.skipInvalidMove&&!f.valid.move||h.skipInvalidSize&&!f.valid.size||h.skipStatic&&n.Dimension.equals(f.fromBounds,f.toBounds)}calculateElementResize(f,h,p){const g=f.bounds,m=this.calculateElementBounds(f,h,p),v={element:f,fromBounds:g,toBounds:m,valid:{size:!0,move:!0}};return p.validate&&(v.valid.size=this.manager.hasValidSize(v.element,v.toBounds),v.valid.move=h.valid&&this.manager.hasValidPosition(v.element,v.toBounds)),v}calculateElementBounds(f,h,p){let g=this.calculateBounds(f.bounds,h);if(p.symmetric){const v=this.calculateSymmetricHandleMove(h,p);g=this.calculateBounds(g,v)}if(!p.constrainResize||this.manager.hasValidSize(f,g))return g;const m=this.manager.getMinimumSize(f);if(h.moveVector=this.constrainResizeVector(f.bounds,h,m),p.symmetric&&(h.moveVector.x=f.bounds.width>m.width?h.moveVector.x/2:h.moveVector.x,h.moveVector.y=f.bounds.height>m.height?h.moveVector.y/2:h.moveVector.y),g=this.calculateBounds(f.bounds,h),p.symmetric){const v=this.calculateSymmetricHandleMove(h,{...p,snap:!1});g=this.calculateBounds(g,v)}return g}calculateSymmetricHandleMove(f,h){const p=this.resolveMoveOptions({...h,validate:!1,restrict:!1});return this.calculateElementMove(f.element.opposite(),n.Vector.reverse(f.moveVector),p)}calculateBounds(f,h){return!h||n.Vector.isZero(h.moveVector)?f:this.doCalculateBounds(f,h.moveVector,h.element.location)}doCalculateBounds(f,h,p){switch(p){case i.ResizeHandleLocation.TopLeft:return{x:f.x+h.x,y:f.y+h.y,width:f.width-h.x,height:f.height-h.y};case i.ResizeHandleLocation.Top:return{...f,y:f.y+h.y,height:f.height-h.y};case i.ResizeHandleLocation.TopRight:return{...f,y:f.y+h.y,width:f.width+h.x,height:f.height-h.y};case i.ResizeHandleLocation.Right:return{...f,width:f.width+h.x};case i.ResizeHandleLocation.BottomRight:return{...f,width:f.width+h.x,height:f.height+h.y};case i.ResizeHandleLocation.Bottom:return{...f,height:f.height+h.y};case i.ResizeHandleLocation.BottomLeft:return{...f,x:f.x+h.x,width:f.width-h.x,height:f.height+h.y};case i.ResizeHandleLocation.Left:return{...f,x:f.x+h.x,width:f.width-h.x}}}constrainResizeVector(f,h,p){const g=h.moveVector;switch(h.element.location){case i.ResizeHandleLocation.TopLeft:g.x=f.width-g.x<p.width?f.width-p.width:g.x,g.y=f.height-g.y<p.height?f.height-p.height:g.y;break;case i.ResizeHandleLocation.Top:g.y=f.height-g.y<p.height?f.height-p.height:g.y;break;case i.ResizeHandleLocation.TopRight:g.x=f.width+g.x<p.width?p.width-f.width:g.x,g.y=f.height-g.y<p.height?f.height-p.height:g.y;break;case i.ResizeHandleLocation.Right:g.x=f.width+g.x<p.width?p.width-f.width:g.x;break;case i.ResizeHandleLocation.BottomRight:g.x=f.width+g.x<p.width?p.width-f.width:g.x,g.y=f.height+g.y<p.height?p.height-f.height:g.y;break;case i.ResizeHandleLocation.Bottom:g.y=f.height+g.y<p.height?p.height-f.height:g.y;break;case i.ResizeHandleLocation.BottomLeft:g.x=f.width-g.x<p.width?f.width-p.width:g.x,g.y=f.height+g.y<p.height?p.height-f.height:g.y;break;case i.ResizeHandleLocation.Left:g.x=f.width-g.x<p.width?f.width-p.width:g.x;break}return g}dispose(){this.stopTracking()}}e.ChangeBoundsTracker=d;class l extends i.GResizeHandle{constructor(f,h=f.location,p=i.GResizeHandle.getHandlePosition(f.parent,h)){super(h,f.type,f.hoverFeedback),this.handle=f,this.location=h,this.position=p,this.id=f.id,this.parent=f.parent}opposite(){return new l(this.handle,i.ResizeHandleLocation.opposite(this.location))}}e.MoveableResizeHandle=l;class c extends n.GRoutingHandle{constructor(f,h){super(),this.handle=f,this.position=h,this.id=f.id,this.parent=f.parent}}e.MoveableRoutingHandle=c}(hS)),hS}var rj;function zP(){return rj||(rj=1,function(e){var n=Dc&&Dc.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},t=Dc&&Dc.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)},i=Dc&&Dc.__param||function(p,g){return function(m,v){g(m,v,p)}};Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeBoundsManager=e.CSS_ACTIVE_HANDLE=e.CSS_RESTRICTED_RESIZE=e.CSS_RESIZE_MODE=void 0;const a=Y(),o=G(),s=Un(),r=Ym(),d=sf(),l=Pr(),c=f6(),u=Zm(),f=GP();e.CSS_RESIZE_MODE="resize-mode",e.CSS_RESTRICTED_RESIZE="resize-not-allowed",e.CSS_ACTIVE_HANDLE="active";let h=class{constructor(g,m,v,_,S){this.positionTracker=g,this.movementRestrictor=m,this.snapper=v,this.helperLineManager=_,this.gridManager=S}unsnapModifier(){return"shift"}usePositionSnap(g){return typeof g=="boolean"?g:!g.shiftKey}snapPosition(g,m){var v,_;return(_=(v=this.snapper)===null||v===void 0?void 0:v.snap(m,g))!==null&&_!==void 0?_:m}isValid(g){return this.hasValidPosition(g)&&this.hasValidSize(g)}hasValidPosition(g,m){return!(0,a.isLocateable)(g)||(0,r.isValidMove)(g,m??g.position,this.movementRestrictor)}hasValidSize(g,m){if(!(0,a.isBoundsAware)(g))return!0;const v=m??g.bounds,_=this.getMinimumSize(g);return!(v.width<_.width||v.height<_.height)}getMinimumSize(g){if(!(0,a.isBoundsAware)(g))return a.Dimension.EMPTY;const m=(0,r.minDimensions)(g),v=d.LayoutAware.getComputedDimensions(g);return v?{width:Math.max(m.width,v.width),height:Math.max(m.height,v.height)}:m}useMovementRestriction(g){return this.usePositionSnap(g)}restrictMovement(g,m){const v=this.getMinimumMovement(g,m);if(!v)return m;const _=a.Vector.abs(m.vector),S={x:_.x<v.x?m.from.x:m.to.x,y:_.y<v.y?m.from.y:m.to.y};return a.Point.move(m.from,S)}getMinimumMovement(g,m){var v;return g instanceof u.InsertIndicator&&this.gridManager?this.gridManager.grid:(v=this.helperLineManager)===null||v===void 0?void 0:v.getMinimumMoveVector(g,!0,m.direction)}addMoveFeedback(g,m,v,_){return g.add((0,s.cursorFeedbackAction)(s.CursorCSS.MOVE),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT)),m.elementMoves.forEach(S=>this.addMoveRestrictionFeedback(g,S,v,_)),g}addResizeFeedback(g,m,v,_){g.add(s.ModifyCSSFeedbackAction.create({add:[e.CSS_RESIZE_MODE]}),s.ModifyCSSFeedbackAction.create({remove:[e.CSS_RESIZE_MODE]}));const S=l.GResizeHandle.getCursorCss(m.handleMove.element);g.add((0,s.cursorFeedbackAction)(S),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT));const E=m.handleMove.element;return g.add((0,s.applyCssClasses)(E,e.CSS_ACTIVE_HANDLE),(0,s.deleteCssClasses)(E,e.CSS_ACTIVE_HANDLE)),g.add((0,s.toggleCssClasses)(E,!m.valid.size,e.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(E,e.CSS_RESTRICTED_RESIZE)),m.elementResizes.forEach(C=>{this.addMoveRestrictionFeedback(g,C,v,_),g.add((0,s.toggleCssClasses)(C.element,!C.valid.size,e.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(C.element,e.CSS_RESTRICTED_RESIZE))}),g}addMoveRestrictionFeedback(g,m,v,_){if(this.movementRestrictor){const S=f.TrackedElementMove.is(m)?m.valid:m.valid.move;g.add((0,c.movementRestrictionFeedback)(m.element,this.movementRestrictor,S),(0,c.removeMovementRestrictionFeedback)(m.element,this.movementRestrictor))}return g}defaultResizeLocations(){return l.ResizeHandleLocation.CORNERS}useSymmetricResize(g){return typeof g=="boolean"?g:g.ctrlKey}createTracker(){return new f.ChangeBoundsTracker(this)}};e.ChangeBoundsManager=h,e.ChangeBoundsManager=h=n([(0,o.injectable)(),i(0,(0,o.inject)(a.MousePositionTracker)),i(1,(0,o.optional)()),i(1,(0,o.inject)(a.TYPES.IMovementRestrictor)),i(2,(0,o.optional)()),i(2,(0,o.inject)(a.TYPES.ISnapper)),i(3,(0,o.optional)()),i(3,(0,o.inject)(a.TYPES.IHelperLineManager)),i(4,(0,o.optional)()),i(4,(0,o.inject)(a.TYPES.IGridManager)),t("design:paramtypes",[a.MousePositionTracker,Object,Object,Object,Object])],h)}(Dc)),Dc}var jo={},En={},oj;function af(){if(oj)return En;oj=1;var e=En&&En.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=En&&En.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)};Object.defineProperty(En,"__esModule",{value:!0}),En.MoveFinishedEventAction=En.MoveInitializedEventAction=En.HideChangeBoundsToolResizeFeedbackCommand=En.ShowChangeBoundsToolResizeFeedbackCommand=En.HideChangeBoundsToolResizeFeedbackAction=En.ShowChangeBoundsToolResizeFeedbackAction=void 0;const t=Y(),i=G(),a=Cr(),o=ch(),s=kt(),r=Pr();var d;(function(p){p.KIND="showChangeBoundsToolResizeFeedback";function g(v){return t.Action.hasKind(v,p.KIND)&&(0,t.hasStringProp)(v,"elementId")}p.is=g;function m(v){const _=typeof v=="string"?{elementId:v}:v;return{kind:p.KIND,..._}}p.create=m})(d||(En.ShowChangeBoundsToolResizeFeedbackAction=d={}));var l;(function(p){p.KIND="hideChangeBoundsToolResizeFeedback";function g(v){return t.Action.hasKind(v,p.KIND)}p.is=g;function m(){return{kind:p.KIND}}p.create=m})(l||(En.HideChangeBoundsToolResizeFeedbackAction=l={}));let c=class extends a.FeedbackCommand{execute(g){var m,v;const _=g.root.index;if((0,s.forEachElement)(_,r.isResizable,S=>S.id!==this.action.elementId&&(0,r.removeResizeHandles)(S)),this.action.elementId){const S=_.getById(this.action.elementId);S&&(0,r.isResizable)(S)&&(0,r.addResizeHandles)(S,(v=(m=this.action.resizeLocations)!==null&&m!==void 0?m:S.resizeLocations)!==null&&v!==void 0?v:this.changeBoundsManager.defaultResizeLocations())}return g.root}};En.ShowChangeBoundsToolResizeFeedbackCommand=c,c.KIND=d.KIND,e([(0,i.inject)(t.TYPES.Action),n("design:type",Object)],c.prototype,"action",void 0),e([(0,i.inject)(t.TYPES.IChangeBoundsManager),n("design:type",Object)],c.prototype,"changeBoundsManager",void 0),En.ShowChangeBoundsToolResizeFeedbackCommand=c=e([(0,i.injectable)()],c);let u=class extends a.FeedbackCommand{execute(g){const m=g.root.index;return(0,s.forEachElement)(m,r.isResizable,r.removeResizeHandles),g.root}};En.HideChangeBoundsToolResizeFeedbackCommand=u,u.KIND=l.KIND,e([(0,i.inject)(t.TYPES.Action),n("design:type",Object)],u.prototype,"action",void 0),En.HideChangeBoundsToolResizeFeedbackCommand=u=e([(0,i.injectable)()],u);var f;(function(p){p.KIND="move-initialized-event";function g(v){return t.Action.hasKind(v,p.KIND)}p.is=g;function m(){return o.OptionalAction.mark({kind:p.KIND})}p.create=m})(f||(En.MoveInitializedEventAction=f={}));var h;return function(p){p.KIND="move-finished-event";function g(v){return t.Action.hasKind(v,p.KIND)}p.is=g;function m(){return o.OptionalAction.mark({kind:p.KIND})}p.create=m}(h||(En.MoveFinishedEventAction=h={})),En}var mg={},Vg={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var w$=Vg.exports,sj;function cf(){return sj||(sj=1,function(e,n){(function(){var t,i="4.17.21",a=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",r="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",l=500,c="__lodash_placeholder__",u=1,f=2,h=4,p=1,g=2,m=1,v=2,_=4,S=8,E=16,C=32,M=64,L=128,I=256,R=512,w=30,T="...",j=800,D=16,B=1,H=2,F=3,K=1/0,U=9007199254740991,Z=17976931348623157e292,ce=NaN,de=4294967295,ke=de-1,pe=de>>>1,et=[["ary",L],["bind",m],["bindKey",v],["curry",S],["curryRight",E],["flip",R],["partial",C],["partialRight",M],["rearg",I]],ot="[object Arguments]",Be="[object Array]",ee="[object AsyncFunction]",ge="[object Boolean]",fe="[object Date]",Ae="[object DOMException]",Le="[object Error]",Ge="[object Function]",pn="[object GeneratorFunction]",he="[object Map]",Ke="[object Number]",Kt="[object Null]",At="[object Object]",cn="[object Promise]",gn="[object Proxy]",Kn="[object RegExp]",dt="[object Set]",Lt="[object String]",Gi="[object Symbol]",vh="[object Undefined]",Qa="[object WeakMap]",yh="[object WeakSet]",zi="[object ArrayBuffer]",Zo="[object DataView]",Qr="[object Float32Array]",eu="[object Float64Array]",Ja="[object Int8Array]",X="[object Int16Array]",te="[object Int32Array]",re="[object Uint8Array]",me="[object Uint8ClampedArray]",Ne="[object Uint16Array]",jt="[object Uint32Array]",Jt=/\b__p \+= '';/g,Ze=/\b(__p \+=) '' \+/g,Ee=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,Re=/[&<>"']/g,we=RegExp(be.source),Ye=RegExp(Re.source),St=/<%-([\s\S]+?)%>/g,Nt=/<%([\s\S]+?)%>/g,mi=/<%=([\s\S]+?)%>/g,Qo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Xa=/^\w*$/,_h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bh=/[\\^$.*+?()[\]{}|]/g,hl=RegExp(bh.source),pf=/^\s+/,dv=/\s/,Sh=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,fv=/\{\n\/\* \[wrapped with (.+)\] \*/,tu=/,? & /,$=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,se=/[()=,{}\[\]\/\s]/,ye=/\\(\\)?/g,De=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,wt=/\w*$/,Et=/^[-+]0x[0-9a-f]+$/i,It=/^0b[01]+$/i,Xt=/^\[object .+?Constructor\]$/,ct=/^0o[0-7]+$/i,$t=/^(?:0|[1-9]\d*)$/,pt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,$n=/['\n\r\u2028\u2029\\]/g,Pi="\\ud800-\\udfff",e0="\\u0300-\\u036f",hx="\\ufe20-\\ufe2f",px="\\u20d0-\\u20ff",$R=e0+hx+px,YR="\\u2700-\\u27bf",WR="a-z\\xdf-\\xf6\\xf8-\\xff",gx="\\xac\\xb1\\xd7\\xf7",mx="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vx="\\u2000-\\u206f",yx=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ZR="A-Z\\xc0-\\xd6\\xd8-\\xde",QR="\\ufe0e\\ufe0f",JR=gx+mx+vx+yx,t0="[']",_x="["+Pi+"]",XR="["+JR+"]",hv="["+$R+"]",eM="\\d+",bx="["+YR+"]",tM="["+WR+"]",nM="[^"+Pi+JR+eM+YR+WR+ZR+"]",n0="\\ud83c[\\udffb-\\udfff]",Sx="(?:"+hv+"|"+n0+")",iM="[^"+Pi+"]",i0="(?:\\ud83c[\\udde6-\\uddff]){2}",r0="[\\ud800-\\udbff][\\udc00-\\udfff]",gf="["+ZR+"]",rM="\\u200d",oM="(?:"+tM+"|"+nM+")",Ex="(?:"+gf+"|"+nM+")",sM="(?:"+t0+"(?:d|ll|m|re|s|t|ve))?",aM="(?:"+t0+"(?:D|LL|M|RE|S|T|VE))?",cM=Sx+"?",uM="["+QR+"]?",Cx="(?:"+rM+"(?:"+[iM,i0,r0].join("|")+")"+uM+cM+")*",Px="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rx="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",lM=uM+cM+Cx,Mx="(?:"+[bx,i0,r0].join("|")+")"+lM,Ax="(?:"+[iM+hv+"?",hv,i0,r0,_x].join("|")+")",wx=RegExp(t0,"g"),Ix=RegExp(hv,"g"),o0=RegExp(n0+"(?="+n0+")|"+Ax+lM,"g"),Tx=RegExp([gf+"?"+tM+"+"+sM+"(?="+[XR,gf,"$"].join("|")+")",Ex+"+"+aM+"(?="+[XR,gf+oM,"$"].join("|")+")",gf+"?"+oM+"+"+sM,gf+"+"+aM,Rx,Px,eM,Mx].join("|"),"g"),Dx=RegExp("["+rM+Pi+$R+QR+"]"),Ox=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Lx=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],jx=-1,Yt={};Yt[Qr]=Yt[eu]=Yt[Ja]=Yt[X]=Yt[te]=Yt[re]=Yt[me]=Yt[Ne]=Yt[jt]=!0,Yt[ot]=Yt[Be]=Yt[zi]=Yt[ge]=Yt[Zo]=Yt[fe]=Yt[Le]=Yt[Ge]=Yt[he]=Yt[Ke]=Yt[At]=Yt[Kn]=Yt[dt]=Yt[Lt]=Yt[Qa]=!1;var qt={};qt[ot]=qt[Be]=qt[zi]=qt[Zo]=qt[ge]=qt[fe]=qt[Qr]=qt[eu]=qt[Ja]=qt[X]=qt[te]=qt[he]=qt[Ke]=qt[At]=qt[Kn]=qt[dt]=qt[Lt]=qt[Gi]=qt[re]=qt[me]=qt[Ne]=qt[jt]=!0,qt[Le]=qt[Ge]=qt[Qa]=!1;var Nx={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Bx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},xx={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},kx=parseFloat,Kx=parseInt,dM=typeof ka=="object"&&ka&&ka.Object===Object&&ka,qx=typeof self=="object"&&self&&self.Object===Object&&self,Yn=dM||qx||Function("return this")(),s0=n&&!n.nodeType&&n,pl=s0&&!0&&e&&!e.nodeType&&e,fM=pl&&pl.exports===s0,a0=fM&&dM.process,Jr=function(){try{var Q=pl&&pl.require&&pl.require("util").types;return Q||a0&&a0.binding&&a0.binding("util")}catch{}}(),hM=Jr&&Jr.isArrayBuffer,pM=Jr&&Jr.isDate,gM=Jr&&Jr.isMap,mM=Jr&&Jr.isRegExp,vM=Jr&&Jr.isSet,yM=Jr&&Jr.isTypedArray;function Rr(Q,ie,ne){switch(ne.length){case 0:return Q.call(ie);case 1:return Q.call(ie,ne[0]);case 2:return Q.call(ie,ne[0],ne[1]);case 3:return Q.call(ie,ne[0],ne[1],ne[2])}return Q.apply(ie,ne)}function Hx(Q,ie,ne,Me){for(var Ue=-1,gt=Q==null?0:Q.length;++Ue<gt;){var In=Q[Ue];ie(Me,In,ne(In),Q)}return Me}function Xr(Q,ie){for(var ne=-1,Me=Q==null?0:Q.length;++ne<Me&&ie(Q[ne],ne,Q)!==!1;);return Q}function Vx(Q,ie){for(var ne=Q==null?0:Q.length;ne--&&ie(Q[ne],ne,Q)!==!1;);return Q}function _M(Q,ie){for(var ne=-1,Me=Q==null?0:Q.length;++ne<Me;)if(!ie(Q[ne],ne,Q))return!1;return!0}function nu(Q,ie){for(var ne=-1,Me=Q==null?0:Q.length,Ue=0,gt=[];++ne<Me;){var In=Q[ne];ie(In,ne,Q)&&(gt[Ue++]=In)}return gt}function pv(Q,ie){var ne=Q==null?0:Q.length;return!!ne&&mf(Q,ie,0)>-1}function c0(Q,ie,ne){for(var Me=-1,Ue=Q==null?0:Q.length;++Me<Ue;)if(ne(ie,Q[Me]))return!0;return!1}function Qt(Q,ie){for(var ne=-1,Me=Q==null?0:Q.length,Ue=Array(Me);++ne<Me;)Ue[ne]=ie(Q[ne],ne,Q);return Ue}function iu(Q,ie){for(var ne=-1,Me=ie.length,Ue=Q.length;++ne<Me;)Q[Ue+ne]=ie[ne];return Q}function u0(Q,ie,ne,Me){var Ue=-1,gt=Q==null?0:Q.length;for(Me&&gt&&(ne=Q[++Ue]);++Ue<gt;)ne=ie(ne,Q[Ue],Ue,Q);return ne}function Gx(Q,ie,ne,Me){var Ue=Q==null?0:Q.length;for(Me&&Ue&&(ne=Q[--Ue]);Ue--;)ne=ie(ne,Q[Ue],Ue,Q);return ne}function l0(Q,ie){for(var ne=-1,Me=Q==null?0:Q.length;++ne<Me;)if(ie(Q[ne],ne,Q))return!0;return!1}var zx=d0("length");function Ux(Q){return Q.split("")}function $x(Q){return Q.match($)||[]}function bM(Q,ie,ne){var Me;return ne(Q,function(Ue,gt,In){if(ie(Ue,gt,In))return Me=gt,!1}),Me}function gv(Q,ie,ne,Me){for(var Ue=Q.length,gt=ne+(Me?1:-1);Me?gt--:++gt<Ue;)if(ie(Q[gt],gt,Q))return gt;return-1}function mf(Q,ie,ne){return ie===ie?oF(Q,ie,ne):gv(Q,SM,ne)}function Yx(Q,ie,ne,Me){for(var Ue=ne-1,gt=Q.length;++Ue<gt;)if(Me(Q[Ue],ie))return Ue;return-1}function SM(Q){return Q!==Q}function EM(Q,ie){var ne=Q==null?0:Q.length;return ne?h0(Q,ie)/ne:ce}function d0(Q){return function(ie){return ie==null?t:ie[Q]}}function f0(Q){return function(ie){return Q==null?t:Q[ie]}}function CM(Q,ie,ne,Me,Ue){return Ue(Q,function(gt,In,Bt){ne=Me?(Me=!1,gt):ie(ne,gt,In,Bt)}),ne}function Wx(Q,ie){var ne=Q.length;for(Q.sort(ie);ne--;)Q[ne]=Q[ne].value;return Q}function h0(Q,ie){for(var ne,Me=-1,Ue=Q.length;++Me<Ue;){var gt=ie(Q[Me]);gt!==t&&(ne=ne===t?gt:ne+gt)}return ne}function p0(Q,ie){for(var ne=-1,Me=Array(Q);++ne<Q;)Me[ne]=ie(ne);return Me}function Zx(Q,ie){return Qt(ie,function(ne){return[ne,Q[ne]]})}function PM(Q){return Q&&Q.slice(0,wM(Q)+1).replace(pf,"")}function Mr(Q){return function(ie){return Q(ie)}}function g0(Q,ie){return Qt(ie,function(ne){return Q[ne]})}function Eh(Q,ie){return Q.has(ie)}function RM(Q,ie){for(var ne=-1,Me=Q.length;++ne<Me&&mf(ie,Q[ne],0)>-1;);return ne}function MM(Q,ie){for(var ne=Q.length;ne--&&mf(ie,Q[ne],0)>-1;);return ne}function Qx(Q,ie){for(var ne=Q.length,Me=0;ne--;)Q[ne]===ie&&++Me;return Me}var Jx=f0(Nx),Xx=f0(Bx);function eF(Q){return"\\"+Fx[Q]}function tF(Q,ie){return Q==null?t:Q[ie]}function vf(Q){return Dx.test(Q)}function nF(Q){return Ox.test(Q)}function iF(Q){for(var ie,ne=[];!(ie=Q.next()).done;)ne.push(ie.value);return ne}function m0(Q){var ie=-1,ne=Array(Q.size);return Q.forEach(function(Me,Ue){ne[++ie]=[Ue,Me]}),ne}function AM(Q,ie){return function(ne){return Q(ie(ne))}}function ru(Q,ie){for(var ne=-1,Me=Q.length,Ue=0,gt=[];++ne<Me;){var In=Q[ne];(In===ie||In===c)&&(Q[ne]=c,gt[Ue++]=ne)}return gt}function mv(Q){var ie=-1,ne=Array(Q.size);return Q.forEach(function(Me){ne[++ie]=Me}),ne}function rF(Q){var ie=-1,ne=Array(Q.size);return Q.forEach(function(Me){ne[++ie]=[Me,Me]}),ne}function oF(Q,ie,ne){for(var Me=ne-1,Ue=Q.length;++Me<Ue;)if(Q[Me]===ie)return Me;return-1}function sF(Q,ie,ne){for(var Me=ne+1;Me--;)if(Q[Me]===ie)return Me;return Me}function yf(Q){return vf(Q)?cF(Q):zx(Q)}function Jo(Q){return vf(Q)?uF(Q):Ux(Q)}function wM(Q){for(var ie=Q.length;ie--&&dv.test(Q.charAt(ie)););return ie}var aF=f0(xx);function cF(Q){for(var ie=o0.lastIndex=0;o0.test(Q);)++ie;return ie}function uF(Q){return Q.match(o0)||[]}function lF(Q){return Q.match(Tx)||[]}var dF=function Q(ie){ie=ie==null?Yn:_f.defaults(Yn.Object(),ie,_f.pick(Yn,Lx));var ne=ie.Array,Me=ie.Date,Ue=ie.Error,gt=ie.Function,In=ie.Math,Bt=ie.Object,v0=ie.RegExp,fF=ie.String,eo=ie.TypeError,vv=ne.prototype,hF=gt.prototype,bf=Bt.prototype,yv=ie["__core-js_shared__"],_v=hF.toString,Ct=bf.hasOwnProperty,pF=0,IM=function(){var y=/[^.]+$/.exec(yv&&yv.keys&&yv.keys.IE_PROTO||"");return y?"Symbol(src)_1."+y:""}(),bv=bf.toString,gF=_v.call(Bt),mF=Yn._,vF=v0("^"+_v.call(Ct).replace(bh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sv=fM?ie.Buffer:t,ou=ie.Symbol,Ev=ie.Uint8Array,TM=Sv?Sv.allocUnsafe:t,Cv=AM(Bt.getPrototypeOf,Bt),DM=Bt.create,OM=bf.propertyIsEnumerable,Pv=vv.splice,LM=ou?ou.isConcatSpreadable:t,Ch=ou?ou.iterator:t,gl=ou?ou.toStringTag:t,Rv=function(){try{var y=bl(Bt,"defineProperty");return y({},"",{}),y}catch{}}(),yF=ie.clearTimeout!==Yn.clearTimeout&&ie.clearTimeout,_F=Me&&Me.now!==Yn.Date.now&&Me.now,bF=ie.setTimeout!==Yn.setTimeout&&ie.setTimeout,Mv=In.ceil,Av=In.floor,y0=Bt.getOwnPropertySymbols,SF=Sv?Sv.isBuffer:t,jM=ie.isFinite,EF=vv.join,CF=AM(Bt.keys,Bt),Tn=In.max,vi=In.min,PF=Me.now,RF=ie.parseInt,NM=In.random,MF=vv.reverse,_0=bl(ie,"DataView"),Ph=bl(ie,"Map"),b0=bl(ie,"Promise"),Sf=bl(ie,"Set"),Rh=bl(ie,"WeakMap"),Mh=bl(Bt,"create"),wv=Rh&&new Rh,Ef={},AF=Sl(_0),wF=Sl(Ph),IF=Sl(b0),TF=Sl(Sf),DF=Sl(Rh),Iv=ou?ou.prototype:t,Ah=Iv?Iv.valueOf:t,BM=Iv?Iv.toString:t;function k(y){if(un(y)&&!We(y)&&!(y instanceof st)){if(y instanceof to)return y;if(Ct.call(y,"__wrapped__"))return xA(y)}return new to(y)}var Cf=function(){function y(){}return function(b){if(!en(b))return{};if(DM)return DM(b);y.prototype=b;var P=new y;return y.prototype=t,P}}();function Tv(){}function to(y,b){this.__wrapped__=y,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=t}k.templateSettings={escape:St,evaluate:Nt,interpolate:mi,variable:"",imports:{_:k}},k.prototype=Tv.prototype,k.prototype.constructor=k,to.prototype=Cf(Tv.prototype),to.prototype.constructor=to;function st(y){this.__wrapped__=y,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=de,this.__views__=[]}function OF(){var y=new st(this.__wrapped__);return y.__actions__=Ui(this.__actions__),y.__dir__=this.__dir__,y.__filtered__=this.__filtered__,y.__iteratees__=Ui(this.__iteratees__),y.__takeCount__=this.__takeCount__,y.__views__=Ui(this.__views__),y}function LF(){if(this.__filtered__){var y=new st(this);y.__dir__=-1,y.__filtered__=!0}else y=this.clone(),y.__dir__*=-1;return y}function jF(){var y=this.__wrapped__.value(),b=this.__dir__,P=We(y),O=b<0,N=P?y.length:0,q=Uk(0,N,this.__views__),z=q.start,W=q.end,J=W-z,oe=O?W:z-1,ae=this.__iteratees__,le=ae.length,Ce=0,Oe=vi(J,this.__takeCount__);if(!P||!O&&N==J&&Oe==J)return sA(y,this.__actions__);var qe=[];e:for(;J--&&Ce<Oe;){oe+=b;for(var Je=-1,He=y[oe];++Je<le;){var nt=ae[Je],ut=nt.iteratee,Ir=nt.type,Ai=ut(He);if(Ir==H)He=Ai;else if(!Ai){if(Ir==B)continue e;break e}}qe[Ce++]=He}return qe}st.prototype=Cf(Tv.prototype),st.prototype.constructor=st;function ml(y){var b=-1,P=y==null?0:y.length;for(this.clear();++b<P;){var O=y[b];this.set(O[0],O[1])}}function NF(){this.__data__=Mh?Mh(null):{},this.size=0}function BF(y){var b=this.has(y)&&delete this.__data__[y];return this.size-=b?1:0,b}function xF(y){var b=this.__data__;if(Mh){var P=b[y];return P===d?t:P}return Ct.call(b,y)?b[y]:t}function FF(y){var b=this.__data__;return Mh?b[y]!==t:Ct.call(b,y)}function kF(y,b){var P=this.__data__;return this.size+=this.has(y)?0:1,P[y]=Mh&&b===t?d:b,this}ml.prototype.clear=NF,ml.prototype.delete=BF,ml.prototype.get=xF,ml.prototype.has=FF,ml.prototype.set=kF;function ec(y){var b=-1,P=y==null?0:y.length;for(this.clear();++b<P;){var O=y[b];this.set(O[0],O[1])}}function KF(){this.__data__=[],this.size=0}function qF(y){var b=this.__data__,P=Dv(b,y);if(P<0)return!1;var O=b.length-1;return P==O?b.pop():Pv.call(b,P,1),--this.size,!0}function HF(y){var b=this.__data__,P=Dv(b,y);return P<0?t:b[P][1]}function VF(y){return Dv(this.__data__,y)>-1}function GF(y,b){var P=this.__data__,O=Dv(P,y);return O<0?(++this.size,P.push([y,b])):P[O][1]=b,this}ec.prototype.clear=KF,ec.prototype.delete=qF,ec.prototype.get=HF,ec.prototype.has=VF,ec.prototype.set=GF;function tc(y){var b=-1,P=y==null?0:y.length;for(this.clear();++b<P;){var O=y[b];this.set(O[0],O[1])}}function zF(){this.size=0,this.__data__={hash:new ml,map:new(Ph||ec),string:new ml}}function UF(y){var b=Vv(this,y).delete(y);return this.size-=b?1:0,b}function $F(y){return Vv(this,y).get(y)}function YF(y){return Vv(this,y).has(y)}function WF(y,b){var P=Vv(this,y),O=P.size;return P.set(y,b),this.size+=P.size==O?0:1,this}tc.prototype.clear=zF,tc.prototype.delete=UF,tc.prototype.get=$F,tc.prototype.has=YF,tc.prototype.set=WF;function vl(y){var b=-1,P=y==null?0:y.length;for(this.__data__=new tc;++b<P;)this.add(y[b])}function ZF(y){return this.__data__.set(y,d),this}function QF(y){return this.__data__.has(y)}vl.prototype.add=vl.prototype.push=ZF,vl.prototype.has=QF;function Xo(y){var b=this.__data__=new ec(y);this.size=b.size}function JF(){this.__data__=new ec,this.size=0}function XF(y){var b=this.__data__,P=b.delete(y);return this.size=b.size,P}function ek(y){return this.__data__.get(y)}function tk(y){return this.__data__.has(y)}function nk(y,b){var P=this.__data__;if(P instanceof ec){var O=P.__data__;if(!Ph||O.length<a-1)return O.push([y,b]),this.size=++P.size,this;P=this.__data__=new tc(O)}return P.set(y,b),this.size=P.size,this}Xo.prototype.clear=JF,Xo.prototype.delete=XF,Xo.prototype.get=ek,Xo.prototype.has=tk,Xo.prototype.set=nk;function xM(y,b){var P=We(y),O=!P&&El(y),N=!P&&!O&&lu(y),q=!P&&!O&&!N&&Af(y),z=P||O||N||q,W=z?p0(y.length,fF):[],J=W.length;for(var oe in y)(b||Ct.call(y,oe))&&!(z&&(oe=="length"||N&&(oe=="offset"||oe=="parent")||q&&(oe=="buffer"||oe=="byteLength"||oe=="byteOffset")||oc(oe,J)))&&W.push(oe);return W}function FM(y){var b=y.length;return b?y[D0(0,b-1)]:t}function ik(y,b){return Gv(Ui(y),yl(b,0,y.length))}function rk(y){return Gv(Ui(y))}function S0(y,b,P){(P!==t&&!es(y[b],P)||P===t&&!(b in y))&&nc(y,b,P)}function wh(y,b,P){var O=y[b];(!(Ct.call(y,b)&&es(O,P))||P===t&&!(b in y))&&nc(y,b,P)}function Dv(y,b){for(var P=y.length;P--;)if(es(y[P][0],b))return P;return-1}function ok(y,b,P,O){return su(y,function(N,q,z){b(O,N,P(N),z)}),O}function kM(y,b){return y&&js(b,qn(b),y)}function sk(y,b){return y&&js(b,Yi(b),y)}function nc(y,b,P){b=="__proto__"&&Rv?Rv(y,b,{configurable:!0,enumerable:!0,value:P,writable:!0}):y[b]=P}function E0(y,b){for(var P=-1,O=b.length,N=ne(O),q=y==null;++P<O;)N[P]=q?t:nb(y,b[P]);return N}function yl(y,b,P){return y===y&&(P!==t&&(y=y<=P?y:P),b!==t&&(y=y>=b?y:b)),y}function no(y,b,P,O,N,q){var z,W=b&u,J=b&f,oe=b&h;if(P&&(z=N?P(y,O,N,q):P(y)),z!==t)return z;if(!en(y))return y;var ae=We(y);if(ae){if(z=Yk(y),!W)return Ui(y,z)}else{var le=yi(y),Ce=le==Ge||le==pn;if(lu(y))return uA(y,W);if(le==At||le==ot||Ce&&!N){if(z=J||Ce?{}:wA(y),!W)return J?xk(y,sk(z,y)):Bk(y,kM(z,y))}else{if(!qt[le])return N?y:{};z=Wk(y,le,W)}}q||(q=new Xo);var Oe=q.get(y);if(Oe)return Oe;q.set(y,z),iw(y)?y.forEach(function(He){z.add(no(He,b,P,He,y,q))}):tw(y)&&y.forEach(function(He,nt){z.set(nt,no(He,b,P,nt,y,q))});var qe=oe?J?H0:q0:J?Yi:qn,Je=ae?t:qe(y);return Xr(Je||y,function(He,nt){Je&&(nt=He,He=y[nt]),wh(z,nt,no(He,b,P,nt,y,q))}),z}function ak(y){var b=qn(y);return function(P){return KM(P,y,b)}}function KM(y,b,P){var O=P.length;if(y==null)return!O;for(y=Bt(y);O--;){var N=P[O],q=b[N],z=y[N];if(z===t&&!(N in y)||!q(z))return!1}return!0}function qM(y,b,P){if(typeof y!="function")throw new eo(s);return Nh(function(){y.apply(t,P)},b)}function Ih(y,b,P,O){var N=-1,q=pv,z=!0,W=y.length,J=[],oe=b.length;if(!W)return J;P&&(b=Qt(b,Mr(P))),O?(q=c0,z=!1):b.length>=a&&(q=Eh,z=!1,b=new vl(b));e:for(;++N<W;){var ae=y[N],le=P==null?ae:P(ae);if(ae=O||ae!==0?ae:0,z&&le===le){for(var Ce=oe;Ce--;)if(b[Ce]===le)continue e;J.push(ae)}else q(b,le,O)||J.push(ae)}return J}var su=pA(Ls),HM=pA(P0,!0);function ck(y,b){var P=!0;return su(y,function(O,N,q){return P=!!b(O,N,q),P}),P}function Ov(y,b,P){for(var O=-1,N=y.length;++O<N;){var q=y[O],z=b(q);if(z!=null&&(W===t?z===z&&!wr(z):P(z,W)))var W=z,J=q}return J}function uk(y,b,P,O){var N=y.length;for(P=Qe(P),P<0&&(P=-P>N?0:N+P),O=O===t||O>N?N:Qe(O),O<0&&(O+=N),O=P>O?0:ow(O);P<O;)y[P++]=b;return y}function VM(y,b){var P=[];return su(y,function(O,N,q){b(O,N,q)&&P.push(O)}),P}function Wn(y,b,P,O,N){var q=-1,z=y.length;for(P||(P=Qk),N||(N=[]);++q<z;){var W=y[q];b>0&&P(W)?b>1?Wn(W,b-1,P,O,N):iu(N,W):O||(N[N.length]=W)}return N}var C0=gA(),GM=gA(!0);function Ls(y,b){return y&&C0(y,b,qn)}function P0(y,b){return y&&GM(y,b,qn)}function Lv(y,b){return nu(b,function(P){return sc(y[P])})}function _l(y,b){b=cu(b,y);for(var P=0,O=b.length;y!=null&&P<O;)y=y[Ns(b[P++])];return P&&P==O?y:t}function zM(y,b,P){var O=b(y);return We(y)?O:iu(O,P(y))}function Ri(y){return y==null?y===t?vh:Kt:gl&&gl in Bt(y)?zk(y):rK(y)}function R0(y,b){return y>b}function lk(y,b){return y!=null&&Ct.call(y,b)}function dk(y,b){return y!=null&&b in Bt(y)}function fk(y,b,P){return y>=vi(b,P)&&y<Tn(b,P)}function M0(y,b,P){for(var O=P?c0:pv,N=y[0].length,q=y.length,z=q,W=ne(q),J=1/0,oe=[];z--;){var ae=y[z];z&&b&&(ae=Qt(ae,Mr(b))),J=vi(ae.length,J),W[z]=!P&&(b||N>=120&&ae.length>=120)?new vl(z&&ae):t}ae=y[0];var le=-1,Ce=W[0];e:for(;++le<N&&oe.length<J;){var Oe=ae[le],qe=b?b(Oe):Oe;if(Oe=P||Oe!==0?Oe:0,!(Ce?Eh(Ce,qe):O(oe,qe,P))){for(z=q;--z;){var Je=W[z];if(!(Je?Eh(Je,qe):O(y[z],qe,P)))continue e}Ce&&Ce.push(qe),oe.push(Oe)}}return oe}function hk(y,b,P,O){return Ls(y,function(N,q,z){b(O,P(N),q,z)}),O}function Th(y,b,P){b=cu(b,y),y=OA(y,b);var O=y==null?y:y[Ns(ro(b))];return O==null?t:Rr(O,y,P)}function UM(y){return un(y)&&Ri(y)==ot}function pk(y){return un(y)&&Ri(y)==zi}function gk(y){return un(y)&&Ri(y)==fe}function Dh(y,b,P,O,N){return y===b?!0:y==null||b==null||!un(y)&&!un(b)?y!==y&&b!==b:mk(y,b,P,O,Dh,N)}function mk(y,b,P,O,N,q){var z=We(y),W=We(b),J=z?Be:yi(y),oe=W?Be:yi(b);J=J==ot?At:J,oe=oe==ot?At:oe;var ae=J==At,le=oe==At,Ce=J==oe;if(Ce&&lu(y)){if(!lu(b))return!1;z=!0,ae=!1}if(Ce&&!ae)return q||(q=new Xo),z||Af(y)?RA(y,b,P,O,N,q):Vk(y,b,J,P,O,N,q);if(!(P&p)){var Oe=ae&&Ct.call(y,"__wrapped__"),qe=le&&Ct.call(b,"__wrapped__");if(Oe||qe){var Je=Oe?y.value():y,He=qe?b.value():b;return q||(q=new Xo),N(Je,He,P,O,q)}}return Ce?(q||(q=new Xo),Gk(y,b,P,O,N,q)):!1}function vk(y){return un(y)&&yi(y)==he}function A0(y,b,P,O){var N=P.length,q=N,z=!O;if(y==null)return!q;for(y=Bt(y);N--;){var W=P[N];if(z&&W[2]?W[1]!==y[W[0]]:!(W[0]in y))return!1}for(;++N<q;){W=P[N];var J=W[0],oe=y[J],ae=W[1];if(z&&W[2]){if(oe===t&&!(J in y))return!1}else{var le=new Xo;if(O)var Ce=O(oe,ae,J,y,b,le);if(!(Ce===t?Dh(ae,oe,p|g,O,le):Ce))return!1}}return!0}function $M(y){if(!en(y)||Xk(y))return!1;var b=sc(y)?vF:Xt;return b.test(Sl(y))}function yk(y){return un(y)&&Ri(y)==Kn}function _k(y){return un(y)&&yi(y)==dt}function bk(y){return un(y)&&Zv(y.length)&&!!Yt[Ri(y)]}function YM(y){return typeof y=="function"?y:y==null?Wi:typeof y=="object"?We(y)?QM(y[0],y[1]):ZM(y):mw(y)}function w0(y){if(!jh(y))return CF(y);var b=[];for(var P in Bt(y))Ct.call(y,P)&&P!="constructor"&&b.push(P);return b}function Sk(y){if(!en(y))return iK(y);var b=jh(y),P=[];for(var O in y)O=="constructor"&&(b||!Ct.call(y,O))||P.push(O);return P}function I0(y,b){return y<b}function WM(y,b){var P=-1,O=$i(y)?ne(y.length):[];return su(y,function(N,q,z){O[++P]=b(N,q,z)}),O}function ZM(y){var b=G0(y);return b.length==1&&b[0][2]?TA(b[0][0],b[0][1]):function(P){return P===y||A0(P,y,b)}}function QM(y,b){return U0(y)&&IA(b)?TA(Ns(y),b):function(P){var O=nb(P,y);return O===t&&O===b?ib(P,y):Dh(b,O,p|g)}}function jv(y,b,P,O,N){y!==b&&C0(b,function(q,z){if(N||(N=new Xo),en(q))Ek(y,b,z,P,jv,O,N);else{var W=O?O(Y0(y,z),q,z+"",y,b,N):t;W===t&&(W=q),S0(y,z,W)}},Yi)}function Ek(y,b,P,O,N,q,z){var W=Y0(y,P),J=Y0(b,P),oe=z.get(J);if(oe){S0(y,P,oe);return}var ae=q?q(W,J,P+"",y,b,z):t,le=ae===t;if(le){var Ce=We(J),Oe=!Ce&&lu(J),qe=!Ce&&!Oe&&Af(J);ae=J,Ce||Oe||qe?We(W)?ae=W:mn(W)?ae=Ui(W):Oe?(le=!1,ae=uA(J,!0)):qe?(le=!1,ae=lA(J,!0)):ae=[]:Bh(J)||El(J)?(ae=W,El(W)?ae=sw(W):(!en(W)||sc(W))&&(ae=wA(J))):le=!1}le&&(z.set(J,ae),N(ae,J,O,q,z),z.delete(J)),S0(y,P,ae)}function JM(y,b){var P=y.length;if(P)return b+=b<0?P:0,oc(b,P)?y[b]:t}function XM(y,b,P){b.length?b=Qt(b,function(q){return We(q)?function(z){return _l(z,q.length===1?q[0]:q)}:q}):b=[Wi];var O=-1;b=Qt(b,Mr(xe()));var N=WM(y,function(q,z,W){var J=Qt(b,function(oe){return oe(q)});return{criteria:J,index:++O,value:q}});return Wx(N,function(q,z){return Nk(q,z,P)})}function Ck(y,b){return eA(y,b,function(P,O){return ib(y,O)})}function eA(y,b,P){for(var O=-1,N=b.length,q={};++O<N;){var z=b[O],W=_l(y,z);P(W,z)&&Oh(q,cu(z,y),W)}return q}function Pk(y){return function(b){return _l(b,y)}}function T0(y,b,P,O){var N=O?Yx:mf,q=-1,z=b.length,W=y;for(y===b&&(b=Ui(b)),P&&(W=Qt(y,Mr(P)));++q<z;)for(var J=0,oe=b[q],ae=P?P(oe):oe;(J=N(W,ae,J,O))>-1;)W!==y&&Pv.call(W,J,1),Pv.call(y,J,1);return y}function tA(y,b){for(var P=y?b.length:0,O=P-1;P--;){var N=b[P];if(P==O||N!==q){var q=N;oc(N)?Pv.call(y,N,1):j0(y,N)}}return y}function D0(y,b){return y+Av(NM()*(b-y+1))}function Rk(y,b,P,O){for(var N=-1,q=Tn(Mv((b-y)/(P||1)),0),z=ne(q);q--;)z[O?q:++N]=y,y+=P;return z}function O0(y,b){var P="";if(!y||b<1||b>U)return P;do b%2&&(P+=y),b=Av(b/2),b&&(y+=y);while(b);return P}function tt(y,b){return W0(DA(y,b,Wi),y+"")}function Mk(y){return FM(wf(y))}function Ak(y,b){var P=wf(y);return Gv(P,yl(b,0,P.length))}function Oh(y,b,P,O){if(!en(y))return y;b=cu(b,y);for(var N=-1,q=b.length,z=q-1,W=y;W!=null&&++N<q;){var J=Ns(b[N]),oe=P;if(J==="__proto__"||J==="constructor"||J==="prototype")return y;if(N!=z){var ae=W[J];oe=O?O(ae,J,W):t,oe===t&&(oe=en(ae)?ae:oc(b[N+1])?[]:{})}wh(W,J,oe),W=W[J]}return y}var nA=wv?function(y,b){return wv.set(y,b),y}:Wi,wk=Rv?function(y,b){return Rv(y,"toString",{configurable:!0,enumerable:!1,value:ob(b),writable:!0})}:Wi;function Ik(y){return Gv(wf(y))}function io(y,b,P){var O=-1,N=y.length;b<0&&(b=-b>N?0:N+b),P=P>N?N:P,P<0&&(P+=N),N=b>P?0:P-b>>>0,b>>>=0;for(var q=ne(N);++O<N;)q[O]=y[O+b];return q}function Tk(y,b){var P;return su(y,function(O,N,q){return P=b(O,N,q),!P}),!!P}function Nv(y,b,P){var O=0,N=y==null?O:y.length;if(typeof b=="number"&&b===b&&N<=pe){for(;O<N;){var q=O+N>>>1,z=y[q];z!==null&&!wr(z)&&(P?z<=b:z<b)?O=q+1:N=q}return N}return L0(y,b,Wi,P)}function L0(y,b,P,O){var N=0,q=y==null?0:y.length;if(q===0)return 0;b=P(b);for(var z=b!==b,W=b===null,J=wr(b),oe=b===t;N<q;){var ae=Av((N+q)/2),le=P(y[ae]),Ce=le!==t,Oe=le===null,qe=le===le,Je=wr(le);if(z)var He=O||qe;else oe?He=qe&&(O||Ce):W?He=qe&&Ce&&(O||!Oe):J?He=qe&&Ce&&!Oe&&(O||!Je):Oe||Je?He=!1:He=O?le<=b:le<b;He?N=ae+1:q=ae}return vi(q,ke)}function iA(y,b){for(var P=-1,O=y.length,N=0,q=[];++P<O;){var z=y[P],W=b?b(z):z;if(!P||!es(W,J)){var J=W;q[N++]=z===0?0:z}}return q}function rA(y){return typeof y=="number"?y:wr(y)?ce:+y}function Ar(y){if(typeof y=="string")return y;if(We(y))return Qt(y,Ar)+"";if(wr(y))return BM?BM.call(y):"";var b=y+"";return b=="0"&&1/y==-1/0?"-0":b}function au(y,b,P){var O=-1,N=pv,q=y.length,z=!0,W=[],J=W;if(P)z=!1,N=c0;else if(q>=a){var oe=b?null:qk(y);if(oe)return mv(oe);z=!1,N=Eh,J=new vl}else J=b?[]:W;e:for(;++O<q;){var ae=y[O],le=b?b(ae):ae;if(ae=P||ae!==0?ae:0,z&&le===le){for(var Ce=J.length;Ce--;)if(J[Ce]===le)continue e;b&&J.push(le),W.push(ae)}else N(J,le,P)||(J!==W&&J.push(le),W.push(ae))}return W}function j0(y,b){return b=cu(b,y),y=OA(y,b),y==null||delete y[Ns(ro(b))]}function oA(y,b,P,O){return Oh(y,b,P(_l(y,b)),O)}function Bv(y,b,P,O){for(var N=y.length,q=O?N:-1;(O?q--:++q<N)&&b(y[q],q,y););return P?io(y,O?0:q,O?q+1:N):io(y,O?q+1:0,O?N:q)}function sA(y,b){var P=y;return P instanceof st&&(P=P.value()),u0(b,function(O,N){return N.func.apply(N.thisArg,iu([O],N.args))},P)}function N0(y,b,P){var O=y.length;if(O<2)return O?au(y[0]):[];for(var N=-1,q=ne(O);++N<O;)for(var z=y[N],W=-1;++W<O;)W!=N&&(q[N]=Ih(q[N]||z,y[W],b,P));return au(Wn(q,1),b,P)}function aA(y,b,P){for(var O=-1,N=y.length,q=b.length,z={};++O<N;){var W=O<q?b[O]:t;P(z,y[O],W)}return z}function B0(y){return mn(y)?y:[]}function x0(y){return typeof y=="function"?y:Wi}function cu(y,b){return We(y)?y:U0(y,b)?[y]:BA(yt(y))}var Dk=tt;function uu(y,b,P){var O=y.length;return P=P===t?O:P,!b&&P>=O?y:io(y,b,P)}var cA=yF||function(y){return Yn.clearTimeout(y)};function uA(y,b){if(b)return y.slice();var P=y.length,O=TM?TM(P):new y.constructor(P);return y.copy(O),O}function F0(y){var b=new y.constructor(y.byteLength);return new Ev(b).set(new Ev(y)),b}function Ok(y,b){var P=b?F0(y.buffer):y.buffer;return new y.constructor(P,y.byteOffset,y.byteLength)}function Lk(y){var b=new y.constructor(y.source,wt.exec(y));return b.lastIndex=y.lastIndex,b}function jk(y){return Ah?Bt(Ah.call(y)):{}}function lA(y,b){var P=b?F0(y.buffer):y.buffer;return new y.constructor(P,y.byteOffset,y.length)}function dA(y,b){if(y!==b){var P=y!==t,O=y===null,N=y===y,q=wr(y),z=b!==t,W=b===null,J=b===b,oe=wr(b);if(!W&&!oe&&!q&&y>b||q&&z&&J&&!W&&!oe||O&&z&&J||!P&&J||!N)return 1;if(!O&&!q&&!oe&&y<b||oe&&P&&N&&!O&&!q||W&&P&&N||!z&&N||!J)return-1}return 0}function Nk(y,b,P){for(var O=-1,N=y.criteria,q=b.criteria,z=N.length,W=P.length;++O<z;){var J=dA(N[O],q[O]);if(J){if(O>=W)return J;var oe=P[O];return J*(oe=="desc"?-1:1)}}return y.index-b.index}function fA(y,b,P,O){for(var N=-1,q=y.length,z=P.length,W=-1,J=b.length,oe=Tn(q-z,0),ae=ne(J+oe),le=!O;++W<J;)ae[W]=b[W];for(;++N<z;)(le||N<q)&&(ae[P[N]]=y[N]);for(;oe--;)ae[W++]=y[N++];return ae}function hA(y,b,P,O){for(var N=-1,q=y.length,z=-1,W=P.length,J=-1,oe=b.length,ae=Tn(q-W,0),le=ne(ae+oe),Ce=!O;++N<ae;)le[N]=y[N];for(var Oe=N;++J<oe;)le[Oe+J]=b[J];for(;++z<W;)(Ce||N<q)&&(le[Oe+P[z]]=y[N++]);return le}function Ui(y,b){var P=-1,O=y.length;for(b||(b=ne(O));++P<O;)b[P]=y[P];return b}function js(y,b,P,O){var N=!P;P||(P={});for(var q=-1,z=b.length;++q<z;){var W=b[q],J=O?O(P[W],y[W],W,P,y):t;J===t&&(J=y[W]),N?nc(P,W,J):wh(P,W,J)}return P}function Bk(y,b){return js(y,z0(y),b)}function xk(y,b){return js(y,MA(y),b)}function xv(y,b){return function(P,O){var N=We(P)?Hx:ok,q=b?b():{};return N(P,y,xe(O,2),q)}}function Pf(y){return tt(function(b,P){var O=-1,N=P.length,q=N>1?P[N-1]:t,z=N>2?P[2]:t;for(q=y.length>3&&typeof q=="function"?(N--,q):t,z&&Mi(P[0],P[1],z)&&(q=N<3?t:q,N=1),b=Bt(b);++O<N;){var W=P[O];W&&y(b,W,O,q)}return b})}function pA(y,b){return function(P,O){if(P==null)return P;if(!$i(P))return y(P,O);for(var N=P.length,q=b?N:-1,z=Bt(P);(b?q--:++q<N)&&O(z[q],q,z)!==!1;);return P}}function gA(y){return function(b,P,O){for(var N=-1,q=Bt(b),z=O(b),W=z.length;W--;){var J=z[y?W:++N];if(P(q[J],J,q)===!1)break}return b}}function Fk(y,b,P){var O=b&m,N=Lh(y);function q(){var z=this&&this!==Yn&&this instanceof q?N:y;return z.apply(O?P:this,arguments)}return q}function mA(y){return function(b){b=yt(b);var P=vf(b)?Jo(b):t,O=P?P[0]:b.charAt(0),N=P?uu(P,1).join(""):b.slice(1);return O[y]()+N}}function Rf(y){return function(b){return u0(pw(hw(b).replace(wx,"")),y,"")}}function Lh(y){return function(){var b=arguments;switch(b.length){case 0:return new y;case 1:return new y(b[0]);case 2:return new y(b[0],b[1]);case 3:return new y(b[0],b[1],b[2]);case 4:return new y(b[0],b[1],b[2],b[3]);case 5:return new y(b[0],b[1],b[2],b[3],b[4]);case 6:return new y(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new y(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var P=Cf(y.prototype),O=y.apply(P,b);return en(O)?O:P}}function kk(y,b,P){var O=Lh(y);function N(){for(var q=arguments.length,z=ne(q),W=q,J=Mf(N);W--;)z[W]=arguments[W];var oe=q<3&&z[0]!==J&&z[q-1]!==J?[]:ru(z,J);if(q-=oe.length,q<P)return SA(y,b,Fv,N.placeholder,t,z,oe,t,t,P-q);var ae=this&&this!==Yn&&this instanceof N?O:y;return Rr(ae,this,z)}return N}function vA(y){return function(b,P,O){var N=Bt(b);if(!$i(b)){var q=xe(P,3);b=qn(b),P=function(W){return q(N[W],W,N)}}var z=y(b,P,O);return z>-1?N[q?b[z]:z]:t}}function yA(y){return rc(function(b){var P=b.length,O=P,N=to.prototype.thru;for(y&&b.reverse();O--;){var q=b[O];if(typeof q!="function")throw new eo(s);if(N&&!z&&Hv(q)=="wrapper")var z=new to([],!0)}for(O=z?O:P;++O<P;){q=b[O];var W=Hv(q),J=W=="wrapper"?V0(q):t;J&&$0(J[0])&&J[1]==(L|S|C|I)&&!J[4].length&&J[9]==1?z=z[Hv(J[0])].apply(z,J[3]):z=q.length==1&&$0(q)?z[W]():z.thru(q)}return function(){var oe=arguments,ae=oe[0];if(z&&oe.length==1&&We(ae))return z.plant(ae).value();for(var le=0,Ce=P?b[le].apply(this,oe):ae;++le<P;)Ce=b[le].call(this,Ce);return Ce}})}function Fv(y,b,P,O,N,q,z,W,J,oe){var ae=b&L,le=b&m,Ce=b&v,Oe=b&(S|E),qe=b&R,Je=Ce?t:Lh(y);function He(){for(var nt=arguments.length,ut=ne(nt),Ir=nt;Ir--;)ut[Ir]=arguments[Ir];if(Oe)var Ai=Mf(He),Tr=Qx(ut,Ai);if(O&&(ut=fA(ut,O,N,Oe)),q&&(ut=hA(ut,q,z,Oe)),nt-=Tr,Oe&&nt<oe){var vn=ru(ut,Ai);return SA(y,b,Fv,He.placeholder,P,ut,vn,W,J,oe-nt)}var ts=le?P:this,cc=Ce?ts[y]:y;return nt=ut.length,W?ut=oK(ut,W):qe&&nt>1&&ut.reverse(),ae&&J<nt&&(ut.length=J),this&&this!==Yn&&this instanceof He&&(cc=Je||Lh(cc)),cc.apply(ts,ut)}return He}function _A(y,b){return function(P,O){return hk(P,y,b(O),{})}}function kv(y,b){return function(P,O){var N;if(P===t&&O===t)return b;if(P!==t&&(N=P),O!==t){if(N===t)return O;typeof P=="string"||typeof O=="string"?(P=Ar(P),O=Ar(O)):(P=rA(P),O=rA(O)),N=y(P,O)}return N}}function k0(y){return rc(function(b){return b=Qt(b,Mr(xe())),tt(function(P){var O=this;return y(b,function(N){return Rr(N,O,P)})})})}function Kv(y,b){b=b===t?" ":Ar(b);var P=b.length;if(P<2)return P?O0(b,y):b;var O=O0(b,Mv(y/yf(b)));return vf(b)?uu(Jo(O),0,y).join(""):O.slice(0,y)}function Kk(y,b,P,O){var N=b&m,q=Lh(y);function z(){for(var W=-1,J=arguments.length,oe=-1,ae=O.length,le=ne(ae+J),Ce=this&&this!==Yn&&this instanceof z?q:y;++oe<ae;)le[oe]=O[oe];for(;J--;)le[oe++]=arguments[++W];return Rr(Ce,N?P:this,le)}return z}function bA(y){return function(b,P,O){return O&&typeof O!="number"&&Mi(b,P,O)&&(P=O=t),b=ac(b),P===t?(P=b,b=0):P=ac(P),O=O===t?b<P?1:-1:ac(O),Rk(b,P,O,y)}}function qv(y){return function(b,P){return typeof b=="string"&&typeof P=="string"||(b=oo(b),P=oo(P)),y(b,P)}}function SA(y,b,P,O,N,q,z,W,J,oe){var ae=b&S,le=ae?z:t,Ce=ae?t:z,Oe=ae?q:t,qe=ae?t:q;b|=ae?C:M,b&=~(ae?M:C),b&_||(b&=-4);var Je=[y,b,N,Oe,le,qe,Ce,W,J,oe],He=P.apply(t,Je);return $0(y)&&LA(He,Je),He.placeholder=O,jA(He,y,b)}function K0(y){var b=In[y];return function(P,O){if(P=oo(P),O=O==null?0:vi(Qe(O),292),O&&jM(P)){var N=(yt(P)+"e").split("e"),q=b(N[0]+"e"+(+N[1]+O));return N=(yt(q)+"e").split("e"),+(N[0]+"e"+(+N[1]-O))}return b(P)}}var qk=Sf&&1/mv(new Sf([,-0]))[1]==K?function(y){return new Sf(y)}:cb;function EA(y){return function(b){var P=yi(b);return P==he?m0(b):P==dt?rF(b):Zx(b,y(b))}}function ic(y,b,P,O,N,q,z,W){var J=b&v;if(!J&&typeof y!="function")throw new eo(s);var oe=O?O.length:0;if(oe||(b&=-97,O=N=t),z=z===t?z:Tn(Qe(z),0),W=W===t?W:Qe(W),oe-=N?N.length:0,b&M){var ae=O,le=N;O=N=t}var Ce=J?t:V0(y),Oe=[y,b,P,O,N,ae,le,q,z,W];if(Ce&&nK(Oe,Ce),y=Oe[0],b=Oe[1],P=Oe[2],O=Oe[3],N=Oe[4],W=Oe[9]=Oe[9]===t?J?0:y.length:Tn(Oe[9]-oe,0),!W&&b&(S|E)&&(b&=-25),!b||b==m)var qe=Fk(y,b,P);else b==S||b==E?qe=kk(y,b,W):(b==C||b==(m|C))&&!N.length?qe=Kk(y,b,P,O):qe=Fv.apply(t,Oe);var Je=Ce?nA:LA;return jA(Je(qe,Oe),y,b)}function CA(y,b,P,O){return y===t||es(y,bf[P])&&!Ct.call(O,P)?b:y}function PA(y,b,P,O,N,q){return en(y)&&en(b)&&(q.set(b,y),jv(y,b,t,PA,q),q.delete(b)),y}function Hk(y){return Bh(y)?t:y}function RA(y,b,P,O,N,q){var z=P&p,W=y.length,J=b.length;if(W!=J&&!(z&&J>W))return!1;var oe=q.get(y),ae=q.get(b);if(oe&&ae)return oe==b&&ae==y;var le=-1,Ce=!0,Oe=P&g?new vl:t;for(q.set(y,b),q.set(b,y);++le<W;){var qe=y[le],Je=b[le];if(O)var He=z?O(Je,qe,le,b,y,q):O(qe,Je,le,y,b,q);if(He!==t){if(He)continue;Ce=!1;break}if(Oe){if(!l0(b,function(nt,ut){if(!Eh(Oe,ut)&&(qe===nt||N(qe,nt,P,O,q)))return Oe.push(ut)})){Ce=!1;break}}else if(!(qe===Je||N(qe,Je,P,O,q))){Ce=!1;break}}return q.delete(y),q.delete(b),Ce}function Vk(y,b,P,O,N,q,z){switch(P){case Zo:if(y.byteLength!=b.byteLength||y.byteOffset!=b.byteOffset)return!1;y=y.buffer,b=b.buffer;case zi:return!(y.byteLength!=b.byteLength||!q(new Ev(y),new Ev(b)));case ge:case fe:case Ke:return es(+y,+b);case Le:return y.name==b.name&&y.message==b.message;case Kn:case Lt:return y==b+"";case he:var W=m0;case dt:var J=O&p;if(W||(W=mv),y.size!=b.size&&!J)return!1;var oe=z.get(y);if(oe)return oe==b;O|=g,z.set(y,b);var ae=RA(W(y),W(b),O,N,q,z);return z.delete(y),ae;case Gi:if(Ah)return Ah.call(y)==Ah.call(b)}return!1}function Gk(y,b,P,O,N,q){var z=P&p,W=q0(y),J=W.length,oe=q0(b),ae=oe.length;if(J!=ae&&!z)return!1;for(var le=J;le--;){var Ce=W[le];if(!(z?Ce in b:Ct.call(b,Ce)))return!1}var Oe=q.get(y),qe=q.get(b);if(Oe&&qe)return Oe==b&&qe==y;var Je=!0;q.set(y,b),q.set(b,y);for(var He=z;++le<J;){Ce=W[le];var nt=y[Ce],ut=b[Ce];if(O)var Ir=z?O(ut,nt,Ce,b,y,q):O(nt,ut,Ce,y,b,q);if(!(Ir===t?nt===ut||N(nt,ut,P,O,q):Ir)){Je=!1;break}He||(He=Ce=="constructor")}if(Je&&!He){var Ai=y.constructor,Tr=b.constructor;Ai!=Tr&&"constructor"in y&&"constructor"in b&&!(typeof Ai=="function"&&Ai instanceof Ai&&typeof Tr=="function"&&Tr instanceof Tr)&&(Je=!1)}return q.delete(y),q.delete(b),Je}function rc(y){return W0(DA(y,t,KA),y+"")}function q0(y){return zM(y,qn,z0)}function H0(y){return zM(y,Yi,MA)}var V0=wv?function(y){return wv.get(y)}:cb;function Hv(y){for(var b=y.name+"",P=Ef[b],O=Ct.call(Ef,b)?P.length:0;O--;){var N=P[O],q=N.func;if(q==null||q==y)return N.name}return b}function Mf(y){var b=Ct.call(k,"placeholder")?k:y;return b.placeholder}function xe(){var y=k.iteratee||sb;return y=y===sb?YM:y,arguments.length?y(arguments[0],arguments[1]):y}function Vv(y,b){var P=y.__data__;return Jk(b)?P[typeof b=="string"?"string":"hash"]:P.map}function G0(y){for(var b=qn(y),P=b.length;P--;){var O=b[P],N=y[O];b[P]=[O,N,IA(N)]}return b}function bl(y,b){var P=tF(y,b);return $M(P)?P:t}function zk(y){var b=Ct.call(y,gl),P=y[gl];try{y[gl]=t;var O=!0}catch{}var N=bv.call(y);return O&&(b?y[gl]=P:delete y[gl]),N}var z0=y0?function(y){return y==null?[]:(y=Bt(y),nu(y0(y),function(b){return OM.call(y,b)}))}:ub,MA=y0?function(y){for(var b=[];y;)iu(b,z0(y)),y=Cv(y);return b}:ub,yi=Ri;(_0&&yi(new _0(new ArrayBuffer(1)))!=Zo||Ph&&yi(new Ph)!=he||b0&&yi(b0.resolve())!=cn||Sf&&yi(new Sf)!=dt||Rh&&yi(new Rh)!=Qa)&&(yi=function(y){var b=Ri(y),P=b==At?y.constructor:t,O=P?Sl(P):"";if(O)switch(O){case AF:return Zo;case wF:return he;case IF:return cn;case TF:return dt;case DF:return Qa}return b});function Uk(y,b,P){for(var O=-1,N=P.length;++O<N;){var q=P[O],z=q.size;switch(q.type){case"drop":y+=z;break;case"dropRight":b-=z;break;case"take":b=vi(b,y+z);break;case"takeRight":y=Tn(y,b-z);break}}return{start:y,end:b}}function $k(y){var b=y.match(fv);return b?b[1].split(tu):[]}function AA(y,b,P){b=cu(b,y);for(var O=-1,N=b.length,q=!1;++O<N;){var z=Ns(b[O]);if(!(q=y!=null&&P(y,z)))break;y=y[z]}return q||++O!=N?q:(N=y==null?0:y.length,!!N&&Zv(N)&&oc(z,N)&&(We(y)||El(y)))}function Yk(y){var b=y.length,P=new y.constructor(b);return b&&typeof y[0]=="string"&&Ct.call(y,"index")&&(P.index=y.index,P.input=y.input),P}function wA(y){return typeof y.constructor=="function"&&!jh(y)?Cf(Cv(y)):{}}function Wk(y,b,P){var O=y.constructor;switch(b){case zi:return F0(y);case ge:case fe:return new O(+y);case Zo:return Ok(y,P);case Qr:case eu:case Ja:case X:case te:case re:case me:case Ne:case jt:return lA(y,P);case he:return new O;case Ke:case Lt:return new O(y);case Kn:return Lk(y);case dt:return new O;case Gi:return jk(y)}}function Zk(y,b){var P=b.length;if(!P)return y;var O=P-1;return b[O]=(P>1?"& ":"")+b[O],b=b.join(P>2?", ":" "),y.replace(Sh,`{
/* [wrapped with `+b+`] */
`)}function Qk(y){return We(y)||El(y)||!!(LM&&y&&y[LM])}function oc(y,b){var P=typeof y;return b=b??U,!!b&&(P=="number"||P!="symbol"&&$t.test(y))&&y>-1&&y%1==0&&y<b}function Mi(y,b,P){if(!en(P))return!1;var O=typeof b;return(O=="number"?$i(P)&&oc(b,P.length):O=="string"&&b in P)?es(P[b],y):!1}function U0(y,b){if(We(y))return!1;var P=typeof y;return P=="number"||P=="symbol"||P=="boolean"||y==null||wr(y)?!0:Xa.test(y)||!Qo.test(y)||b!=null&&y in Bt(b)}function Jk(y){var b=typeof y;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?y!=="__proto__":y===null}function $0(y){var b=Hv(y),P=k[b];if(typeof P!="function"||!(b in st.prototype))return!1;if(y===P)return!0;var O=V0(P);return!!O&&y===O[0]}function Xk(y){return!!IM&&IM in y}var eK=yv?sc:lb;function jh(y){var b=y&&y.constructor,P=typeof b=="function"&&b.prototype||bf;return y===P}function IA(y){return y===y&&!en(y)}function TA(y,b){return function(P){return P==null?!1:P[y]===b&&(b!==t||y in Bt(P))}}function tK(y){var b=Yv(y,function(O){return P.size===l&&P.clear(),O}),P=b.cache;return b}function nK(y,b){var P=y[1],O=b[1],N=P|O,q=N<(m|v|L),z=O==L&&P==S||O==L&&P==I&&y[7].length<=b[8]||O==(L|I)&&b[7].length<=b[8]&&P==S;if(!(q||z))return y;O&m&&(y[2]=b[2],N|=P&m?0:_);var W=b[3];if(W){var J=y[3];y[3]=J?fA(J,W,b[4]):W,y[4]=J?ru(y[3],c):b[4]}return W=b[5],W&&(J=y[5],y[5]=J?hA(J,W,b[6]):W,y[6]=J?ru(y[5],c):b[6]),W=b[7],W&&(y[7]=W),O&L&&(y[8]=y[8]==null?b[8]:vi(y[8],b[8])),y[9]==null&&(y[9]=b[9]),y[0]=b[0],y[1]=N,y}function iK(y){var b=[];if(y!=null)for(var P in Bt(y))b.push(P);return b}function rK(y){return bv.call(y)}function DA(y,b,P){return b=Tn(b===t?y.length-1:b,0),function(){for(var O=arguments,N=-1,q=Tn(O.length-b,0),z=ne(q);++N<q;)z[N]=O[b+N];N=-1;for(var W=ne(b+1);++N<b;)W[N]=O[N];return W[b]=P(z),Rr(y,this,W)}}function OA(y,b){return b.length<2?y:_l(y,io(b,0,-1))}function oK(y,b){for(var P=y.length,O=vi(b.length,P),N=Ui(y);O--;){var q=b[O];y[O]=oc(q,P)?N[q]:t}return y}function Y0(y,b){if(!(b==="constructor"&&typeof y[b]=="function")&&b!="__proto__")return y[b]}var LA=NA(nA),Nh=bF||function(y,b){return Yn.setTimeout(y,b)},W0=NA(wk);function jA(y,b,P){var O=b+"";return W0(y,Zk(O,sK($k(O),P)))}function NA(y){var b=0,P=0;return function(){var O=PF(),N=D-(O-P);if(P=O,N>0){if(++b>=j)return arguments[0]}else b=0;return y.apply(t,arguments)}}function Gv(y,b){var P=-1,O=y.length,N=O-1;for(b=b===t?O:b;++P<b;){var q=D0(P,N),z=y[q];y[q]=y[P],y[P]=z}return y.length=b,y}var BA=tK(function(y){var b=[];return y.charCodeAt(0)===46&&b.push(""),y.replace(_h,function(P,O,N,q){b.push(N?q.replace(ye,"$1"):O||P)}),b});function Ns(y){if(typeof y=="string"||wr(y))return y;var b=y+"";return b=="0"&&1/y==-1/0?"-0":b}function Sl(y){if(y!=null){try{return _v.call(y)}catch{}try{return y+""}catch{}}return""}function sK(y,b){return Xr(et,function(P){var O="_."+P[0];b&P[1]&&!pv(y,O)&&y.push(O)}),y.sort()}function xA(y){if(y instanceof st)return y.clone();var b=new to(y.__wrapped__,y.__chain__);return b.__actions__=Ui(y.__actions__),b.__index__=y.__index__,b.__values__=y.__values__,b}function aK(y,b,P){(P?Mi(y,b,P):b===t)?b=1:b=Tn(Qe(b),0);var O=y==null?0:y.length;if(!O||b<1)return[];for(var N=0,q=0,z=ne(Mv(O/b));N<O;)z[q++]=io(y,N,N+=b);return z}function cK(y){for(var b=-1,P=y==null?0:y.length,O=0,N=[];++b<P;){var q=y[b];q&&(N[O++]=q)}return N}function uK(){var y=arguments.length;if(!y)return[];for(var b=ne(y-1),P=arguments[0],O=y;O--;)b[O-1]=arguments[O];return iu(We(P)?Ui(P):[P],Wn(b,1))}var lK=tt(function(y,b){return mn(y)?Ih(y,Wn(b,1,mn,!0)):[]}),dK=tt(function(y,b){var P=ro(b);return mn(P)&&(P=t),mn(y)?Ih(y,Wn(b,1,mn,!0),xe(P,2)):[]}),fK=tt(function(y,b){var P=ro(b);return mn(P)&&(P=t),mn(y)?Ih(y,Wn(b,1,mn,!0),t,P):[]});function hK(y,b,P){var O=y==null?0:y.length;return O?(b=P||b===t?1:Qe(b),io(y,b<0?0:b,O)):[]}function pK(y,b,P){var O=y==null?0:y.length;return O?(b=P||b===t?1:Qe(b),b=O-b,io(y,0,b<0?0:b)):[]}function gK(y,b){return y&&y.length?Bv(y,xe(b,3),!0,!0):[]}function mK(y,b){return y&&y.length?Bv(y,xe(b,3),!0):[]}function vK(y,b,P,O){var N=y==null?0:y.length;return N?(P&&typeof P!="number"&&Mi(y,b,P)&&(P=0,O=N),uk(y,b,P,O)):[]}function FA(y,b,P){var O=y==null?0:y.length;if(!O)return-1;var N=P==null?0:Qe(P);return N<0&&(N=Tn(O+N,0)),gv(y,xe(b,3),N)}function kA(y,b,P){var O=y==null?0:y.length;if(!O)return-1;var N=O-1;return P!==t&&(N=Qe(P),N=P<0?Tn(O+N,0):vi(N,O-1)),gv(y,xe(b,3),N,!0)}function KA(y){var b=y==null?0:y.length;return b?Wn(y,1):[]}function yK(y){var b=y==null?0:y.length;return b?Wn(y,K):[]}function _K(y,b){var P=y==null?0:y.length;return P?(b=b===t?1:Qe(b),Wn(y,b)):[]}function bK(y){for(var b=-1,P=y==null?0:y.length,O={};++b<P;){var N=y[b];O[N[0]]=N[1]}return O}function qA(y){return y&&y.length?y[0]:t}function SK(y,b,P){var O=y==null?0:y.length;if(!O)return-1;var N=P==null?0:Qe(P);return N<0&&(N=Tn(O+N,0)),mf(y,b,N)}function EK(y){var b=y==null?0:y.length;return b?io(y,0,-1):[]}var CK=tt(function(y){var b=Qt(y,B0);return b.length&&b[0]===y[0]?M0(b):[]}),PK=tt(function(y){var b=ro(y),P=Qt(y,B0);return b===ro(P)?b=t:P.pop(),P.length&&P[0]===y[0]?M0(P,xe(b,2)):[]}),RK=tt(function(y){var b=ro(y),P=Qt(y,B0);return b=typeof b=="function"?b:t,b&&P.pop(),P.length&&P[0]===y[0]?M0(P,t,b):[]});function MK(y,b){return y==null?"":EF.call(y,b)}function ro(y){var b=y==null?0:y.length;return b?y[b-1]:t}function AK(y,b,P){var O=y==null?0:y.length;if(!O)return-1;var N=O;return P!==t&&(N=Qe(P),N=N<0?Tn(O+N,0):vi(N,O-1)),b===b?sF(y,b,N):gv(y,SM,N,!0)}function wK(y,b){return y&&y.length?JM(y,Qe(b)):t}var IK=tt(HA);function HA(y,b){return y&&y.length&&b&&b.length?T0(y,b):y}function TK(y,b,P){return y&&y.length&&b&&b.length?T0(y,b,xe(P,2)):y}function DK(y,b,P){return y&&y.length&&b&&b.length?T0(y,b,t,P):y}var OK=rc(function(y,b){var P=y==null?0:y.length,O=E0(y,b);return tA(y,Qt(b,function(N){return oc(N,P)?+N:N}).sort(dA)),O});function LK(y,b){var P=[];if(!(y&&y.length))return P;var O=-1,N=[],q=y.length;for(b=xe(b,3);++O<q;){var z=y[O];b(z,O,y)&&(P.push(z),N.push(O))}return tA(y,N),P}function Z0(y){return y==null?y:MF.call(y)}function jK(y,b,P){var O=y==null?0:y.length;return O?(P&&typeof P!="number"&&Mi(y,b,P)?(b=0,P=O):(b=b==null?0:Qe(b),P=P===t?O:Qe(P)),io(y,b,P)):[]}function NK(y,b){return Nv(y,b)}function BK(y,b,P){return L0(y,b,xe(P,2))}function xK(y,b){var P=y==null?0:y.length;if(P){var O=Nv(y,b);if(O<P&&es(y[O],b))return O}return-1}function FK(y,b){return Nv(y,b,!0)}function kK(y,b,P){return L0(y,b,xe(P,2),!0)}function KK(y,b){var P=y==null?0:y.length;if(P){var O=Nv(y,b,!0)-1;if(es(y[O],b))return O}return-1}function qK(y){return y&&y.length?iA(y):[]}function HK(y,b){return y&&y.length?iA(y,xe(b,2)):[]}function VK(y){var b=y==null?0:y.length;return b?io(y,1,b):[]}function GK(y,b,P){return y&&y.length?(b=P||b===t?1:Qe(b),io(y,0,b<0?0:b)):[]}function zK(y,b,P){var O=y==null?0:y.length;return O?(b=P||b===t?1:Qe(b),b=O-b,io(y,b<0?0:b,O)):[]}function UK(y,b){return y&&y.length?Bv(y,xe(b,3),!1,!0):[]}function $K(y,b){return y&&y.length?Bv(y,xe(b,3)):[]}var YK=tt(function(y){return au(Wn(y,1,mn,!0))}),WK=tt(function(y){var b=ro(y);return mn(b)&&(b=t),au(Wn(y,1,mn,!0),xe(b,2))}),ZK=tt(function(y){var b=ro(y);return b=typeof b=="function"?b:t,au(Wn(y,1,mn,!0),t,b)});function QK(y){return y&&y.length?au(y):[]}function JK(y,b){return y&&y.length?au(y,xe(b,2)):[]}function XK(y,b){return b=typeof b=="function"?b:t,y&&y.length?au(y,t,b):[]}function Q0(y){if(!(y&&y.length))return[];var b=0;return y=nu(y,function(P){if(mn(P))return b=Tn(P.length,b),!0}),p0(b,function(P){return Qt(y,d0(P))})}function VA(y,b){if(!(y&&y.length))return[];var P=Q0(y);return b==null?P:Qt(P,function(O){return Rr(b,t,O)})}var eq=tt(function(y,b){return mn(y)?Ih(y,b):[]}),tq=tt(function(y){return N0(nu(y,mn))}),nq=tt(function(y){var b=ro(y);return mn(b)&&(b=t),N0(nu(y,mn),xe(b,2))}),iq=tt(function(y){var b=ro(y);return b=typeof b=="function"?b:t,N0(nu(y,mn),t,b)}),rq=tt(Q0);function oq(y,b){return aA(y||[],b||[],wh)}function sq(y,b){return aA(y||[],b||[],Oh)}var aq=tt(function(y){var b=y.length,P=b>1?y[b-1]:t;return P=typeof P=="function"?(y.pop(),P):t,VA(y,P)});function GA(y){var b=k(y);return b.__chain__=!0,b}function cq(y,b){return b(y),y}function zv(y,b){return b(y)}var uq=rc(function(y){var b=y.length,P=b?y[0]:0,O=this.__wrapped__,N=function(q){return E0(q,y)};return b>1||this.__actions__.length||!(O instanceof st)||!oc(P)?this.thru(N):(O=O.slice(P,+P+(b?1:0)),O.__actions__.push({func:zv,args:[N],thisArg:t}),new to(O,this.__chain__).thru(function(q){return b&&!q.length&&q.push(t),q}))});function lq(){return GA(this)}function dq(){return new to(this.value(),this.__chain__)}function fq(){this.__values__===t&&(this.__values__=rw(this.value()));var y=this.__index__>=this.__values__.length,b=y?t:this.__values__[this.__index__++];return{done:y,value:b}}function hq(){return this}function pq(y){for(var b,P=this;P instanceof Tv;){var O=xA(P);O.__index__=0,O.__values__=t,b?N.__wrapped__=O:b=O;var N=O;P=P.__wrapped__}return N.__wrapped__=y,b}function gq(){var y=this.__wrapped__;if(y instanceof st){var b=y;return this.__actions__.length&&(b=new st(this)),b=b.reverse(),b.__actions__.push({func:zv,args:[Z0],thisArg:t}),new to(b,this.__chain__)}return this.thru(Z0)}function mq(){return sA(this.__wrapped__,this.__actions__)}var vq=xv(function(y,b,P){Ct.call(y,P)?++y[P]:nc(y,P,1)});function yq(y,b,P){var O=We(y)?_M:ck;return P&&Mi(y,b,P)&&(b=t),O(y,xe(b,3))}function _q(y,b){var P=We(y)?nu:VM;return P(y,xe(b,3))}var bq=vA(FA),Sq=vA(kA);function Eq(y,b){return Wn(Uv(y,b),1)}function Cq(y,b){return Wn(Uv(y,b),K)}function Pq(y,b,P){return P=P===t?1:Qe(P),Wn(Uv(y,b),P)}function zA(y,b){var P=We(y)?Xr:su;return P(y,xe(b,3))}function UA(y,b){var P=We(y)?Vx:HM;return P(y,xe(b,3))}var Rq=xv(function(y,b,P){Ct.call(y,P)?y[P].push(b):nc(y,P,[b])});function Mq(y,b,P,O){y=$i(y)?y:wf(y),P=P&&!O?Qe(P):0;var N=y.length;return P<0&&(P=Tn(N+P,0)),Qv(y)?P<=N&&y.indexOf(b,P)>-1:!!N&&mf(y,b,P)>-1}var Aq=tt(function(y,b,P){var O=-1,N=typeof b=="function",q=$i(y)?ne(y.length):[];return su(y,function(z){q[++O]=N?Rr(b,z,P):Th(z,b,P)}),q}),wq=xv(function(y,b,P){nc(y,P,b)});function Uv(y,b){var P=We(y)?Qt:WM;return P(y,xe(b,3))}function Iq(y,b,P,O){return y==null?[]:(We(b)||(b=b==null?[]:[b]),P=O?t:P,We(P)||(P=P==null?[]:[P]),XM(y,b,P))}var Tq=xv(function(y,b,P){y[P?0:1].push(b)},function(){return[[],[]]});function Dq(y,b,P){var O=We(y)?u0:CM,N=arguments.length<3;return O(y,xe(b,4),P,N,su)}function Oq(y,b,P){var O=We(y)?Gx:CM,N=arguments.length<3;return O(y,xe(b,4),P,N,HM)}function Lq(y,b){var P=We(y)?nu:VM;return P(y,Wv(xe(b,3)))}function jq(y){var b=We(y)?FM:Mk;return b(y)}function Nq(y,b,P){(P?Mi(y,b,P):b===t)?b=1:b=Qe(b);var O=We(y)?ik:Ak;return O(y,b)}function Bq(y){var b=We(y)?rk:Ik;return b(y)}function xq(y){if(y==null)return 0;if($i(y))return Qv(y)?yf(y):y.length;var b=yi(y);return b==he||b==dt?y.size:w0(y).length}function Fq(y,b,P){var O=We(y)?l0:Tk;return P&&Mi(y,b,P)&&(b=t),O(y,xe(b,3))}var kq=tt(function(y,b){if(y==null)return[];var P=b.length;return P>1&&Mi(y,b[0],b[1])?b=[]:P>2&&Mi(b[0],b[1],b[2])&&(b=[b[0]]),XM(y,Wn(b,1),[])}),$v=_F||function(){return Yn.Date.now()};function Kq(y,b){if(typeof b!="function")throw new eo(s);return y=Qe(y),function(){if(--y<1)return b.apply(this,arguments)}}function $A(y,b,P){return b=P?t:b,b=y&&b==null?y.length:b,ic(y,L,t,t,t,t,b)}function YA(y,b){var P;if(typeof b!="function")throw new eo(s);return y=Qe(y),function(){return--y>0&&(P=b.apply(this,arguments)),y<=1&&(b=t),P}}var J0=tt(function(y,b,P){var O=m;if(P.length){var N=ru(P,Mf(J0));O|=C}return ic(y,O,b,P,N)}),WA=tt(function(y,b,P){var O=m|v;if(P.length){var N=ru(P,Mf(WA));O|=C}return ic(b,O,y,P,N)});function ZA(y,b,P){b=P?t:b;var O=ic(y,S,t,t,t,t,t,b);return O.placeholder=ZA.placeholder,O}function QA(y,b,P){b=P?t:b;var O=ic(y,E,t,t,t,t,t,b);return O.placeholder=QA.placeholder,O}function JA(y,b,P){var O,N,q,z,W,J,oe=0,ae=!1,le=!1,Ce=!0;if(typeof y!="function")throw new eo(s);b=oo(b)||0,en(P)&&(ae=!!P.leading,le="maxWait"in P,q=le?Tn(oo(P.maxWait)||0,b):q,Ce="trailing"in P?!!P.trailing:Ce);function Oe(vn){var ts=O,cc=N;return O=N=t,oe=vn,z=y.apply(cc,ts),z}function qe(vn){return oe=vn,W=Nh(nt,b),ae?Oe(vn):z}function Je(vn){var ts=vn-J,cc=vn-oe,vw=b-ts;return le?vi(vw,q-cc):vw}function He(vn){var ts=vn-J,cc=vn-oe;return J===t||ts>=b||ts<0||le&&cc>=q}function nt(){var vn=$v();if(He(vn))return ut(vn);W=Nh(nt,Je(vn))}function ut(vn){return W=t,Ce&&O?Oe(vn):(O=N=t,z)}function Ir(){W!==t&&cA(W),oe=0,O=J=N=W=t}function Ai(){return W===t?z:ut($v())}function Tr(){var vn=$v(),ts=He(vn);if(O=arguments,N=this,J=vn,ts){if(W===t)return qe(J);if(le)return cA(W),W=Nh(nt,b),Oe(J)}return W===t&&(W=Nh(nt,b)),z}return Tr.cancel=Ir,Tr.flush=Ai,Tr}var qq=tt(function(y,b){return qM(y,1,b)}),Hq=tt(function(y,b,P){return qM(y,oo(b)||0,P)});function Vq(y){return ic(y,R)}function Yv(y,b){if(typeof y!="function"||b!=null&&typeof b!="function")throw new eo(s);var P=function(){var O=arguments,N=b?b.apply(this,O):O[0],q=P.cache;if(q.has(N))return q.get(N);var z=y.apply(this,O);return P.cache=q.set(N,z)||q,z};return P.cache=new(Yv.Cache||tc),P}Yv.Cache=tc;function Wv(y){if(typeof y!="function")throw new eo(s);return function(){var b=arguments;switch(b.length){case 0:return!y.call(this);case 1:return!y.call(this,b[0]);case 2:return!y.call(this,b[0],b[1]);case 3:return!y.call(this,b[0],b[1],b[2])}return!y.apply(this,b)}}function Gq(y){return YA(2,y)}var zq=Dk(function(y,b){b=b.length==1&&We(b[0])?Qt(b[0],Mr(xe())):Qt(Wn(b,1),Mr(xe()));var P=b.length;return tt(function(O){for(var N=-1,q=vi(O.length,P);++N<q;)O[N]=b[N].call(this,O[N]);return Rr(y,this,O)})}),X0=tt(function(y,b){var P=ru(b,Mf(X0));return ic(y,C,t,b,P)}),XA=tt(function(y,b){var P=ru(b,Mf(XA));return ic(y,M,t,b,P)}),Uq=rc(function(y,b){return ic(y,I,t,t,t,b)});function $q(y,b){if(typeof y!="function")throw new eo(s);return b=b===t?b:Qe(b),tt(y,b)}function Yq(y,b){if(typeof y!="function")throw new eo(s);return b=b==null?0:Tn(Qe(b),0),tt(function(P){var O=P[b],N=uu(P,0,b);return O&&iu(N,O),Rr(y,this,N)})}function Wq(y,b,P){var O=!0,N=!0;if(typeof y!="function")throw new eo(s);return en(P)&&(O="leading"in P?!!P.leading:O,N="trailing"in P?!!P.trailing:N),JA(y,b,{leading:O,maxWait:b,trailing:N})}function Zq(y){return $A(y,1)}function Qq(y,b){return X0(x0(b),y)}function Jq(){if(!arguments.length)return[];var y=arguments[0];return We(y)?y:[y]}function Xq(y){return no(y,h)}function eH(y,b){return b=typeof b=="function"?b:t,no(y,h,b)}function tH(y){return no(y,u|h)}function nH(y,b){return b=typeof b=="function"?b:t,no(y,u|h,b)}function iH(y,b){return b==null||KM(y,b,qn(b))}function es(y,b){return y===b||y!==y&&b!==b}var rH=qv(R0),oH=qv(function(y,b){return y>=b}),El=UM(function(){return arguments}())?UM:function(y){return un(y)&&Ct.call(y,"callee")&&!OM.call(y,"callee")},We=ne.isArray,sH=hM?Mr(hM):pk;function $i(y){return y!=null&&Zv(y.length)&&!sc(y)}function mn(y){return un(y)&&$i(y)}function aH(y){return y===!0||y===!1||un(y)&&Ri(y)==ge}var lu=SF||lb,cH=pM?Mr(pM):gk;function uH(y){return un(y)&&y.nodeType===1&&!Bh(y)}function lH(y){if(y==null)return!0;if($i(y)&&(We(y)||typeof y=="string"||typeof y.splice=="function"||lu(y)||Af(y)||El(y)))return!y.length;var b=yi(y);if(b==he||b==dt)return!y.size;if(jh(y))return!w0(y).length;for(var P in y)if(Ct.call(y,P))return!1;return!0}function dH(y,b){return Dh(y,b)}function fH(y,b,P){P=typeof P=="function"?P:t;var O=P?P(y,b):t;return O===t?Dh(y,b,t,P):!!O}function eb(y){if(!un(y))return!1;var b=Ri(y);return b==Le||b==Ae||typeof y.message=="string"&&typeof y.name=="string"&&!Bh(y)}function hH(y){return typeof y=="number"&&jM(y)}function sc(y){if(!en(y))return!1;var b=Ri(y);return b==Ge||b==pn||b==ee||b==gn}function ew(y){return typeof y=="number"&&y==Qe(y)}function Zv(y){return typeof y=="number"&&y>-1&&y%1==0&&y<=U}function en(y){var b=typeof y;return y!=null&&(b=="object"||b=="function")}function un(y){return y!=null&&typeof y=="object"}var tw=gM?Mr(gM):vk;function pH(y,b){return y===b||A0(y,b,G0(b))}function gH(y,b,P){return P=typeof P=="function"?P:t,A0(y,b,G0(b),P)}function mH(y){return nw(y)&&y!=+y}function vH(y){if(eK(y))throw new Ue(o);return $M(y)}function yH(y){return y===null}function _H(y){return y==null}function nw(y){return typeof y=="number"||un(y)&&Ri(y)==Ke}function Bh(y){if(!un(y)||Ri(y)!=At)return!1;var b=Cv(y);if(b===null)return!0;var P=Ct.call(b,"constructor")&&b.constructor;return typeof P=="function"&&P instanceof P&&_v.call(P)==gF}var tb=mM?Mr(mM):yk;function bH(y){return ew(y)&&y>=-9007199254740991&&y<=U}var iw=vM?Mr(vM):_k;function Qv(y){return typeof y=="string"||!We(y)&&un(y)&&Ri(y)==Lt}function wr(y){return typeof y=="symbol"||un(y)&&Ri(y)==Gi}var Af=yM?Mr(yM):bk;function SH(y){return y===t}function EH(y){return un(y)&&yi(y)==Qa}function CH(y){return un(y)&&Ri(y)==yh}var PH=qv(I0),RH=qv(function(y,b){return y<=b});function rw(y){if(!y)return[];if($i(y))return Qv(y)?Jo(y):Ui(y);if(Ch&&y[Ch])return iF(y[Ch]());var b=yi(y),P=b==he?m0:b==dt?mv:wf;return P(y)}function ac(y){if(!y)return y===0?y:0;if(y=oo(y),y===K||y===-1/0){var b=y<0?-1:1;return b*Z}return y===y?y:0}function Qe(y){var b=ac(y),P=b%1;return b===b?P?b-P:b:0}function ow(y){return y?yl(Qe(y),0,de):0}function oo(y){if(typeof y=="number")return y;if(wr(y))return ce;if(en(y)){var b=typeof y.valueOf=="function"?y.valueOf():y;y=en(b)?b+"":b}if(typeof y!="string")return y===0?y:+y;y=PM(y);var P=It.test(y);return P||ct.test(y)?Kx(y.slice(2),P?2:8):Et.test(y)?ce:+y}function sw(y){return js(y,Yi(y))}function MH(y){return y?yl(Qe(y),-9007199254740991,U):y===0?y:0}function yt(y){return y==null?"":Ar(y)}var AH=Pf(function(y,b){if(jh(b)||$i(b)){js(b,qn(b),y);return}for(var P in b)Ct.call(b,P)&&wh(y,P,b[P])}),aw=Pf(function(y,b){js(b,Yi(b),y)}),Jv=Pf(function(y,b,P,O){js(b,Yi(b),y,O)}),wH=Pf(function(y,b,P,O){js(b,qn(b),y,O)}),IH=rc(E0);function TH(y,b){var P=Cf(y);return b==null?P:kM(P,b)}var DH=tt(function(y,b){y=Bt(y);var P=-1,O=b.length,N=O>2?b[2]:t;for(N&&Mi(b[0],b[1],N)&&(O=1);++P<O;)for(var q=b[P],z=Yi(q),W=-1,J=z.length;++W<J;){var oe=z[W],ae=y[oe];(ae===t||es(ae,bf[oe])&&!Ct.call(y,oe))&&(y[oe]=q[oe])}return y}),OH=tt(function(y){return y.push(t,PA),Rr(cw,t,y)});function LH(y,b){return bM(y,xe(b,3),Ls)}function jH(y,b){return bM(y,xe(b,3),P0)}function NH(y,b){return y==null?y:C0(y,xe(b,3),Yi)}function BH(y,b){return y==null?y:GM(y,xe(b,3),Yi)}function xH(y,b){return y&&Ls(y,xe(b,3))}function FH(y,b){return y&&P0(y,xe(b,3))}function kH(y){return y==null?[]:Lv(y,qn(y))}function KH(y){return y==null?[]:Lv(y,Yi(y))}function nb(y,b,P){var O=y==null?t:_l(y,b);return O===t?P:O}function qH(y,b){return y!=null&&AA(y,b,lk)}function ib(y,b){return y!=null&&AA(y,b,dk)}var HH=_A(function(y,b,P){b!=null&&typeof b.toString!="function"&&(b=bv.call(b)),y[b]=P},ob(Wi)),VH=_A(function(y,b,P){b!=null&&typeof b.toString!="function"&&(b=bv.call(b)),Ct.call(y,b)?y[b].push(P):y[b]=[P]},xe),GH=tt(Th);function qn(y){return $i(y)?xM(y):w0(y)}function Yi(y){return $i(y)?xM(y,!0):Sk(y)}function zH(y,b){var P={};return b=xe(b,3),Ls(y,function(O,N,q){nc(P,b(O,N,q),O)}),P}function UH(y,b){var P={};return b=xe(b,3),Ls(y,function(O,N,q){nc(P,N,b(O,N,q))}),P}var $H=Pf(function(y,b,P){jv(y,b,P)}),cw=Pf(function(y,b,P,O){jv(y,b,P,O)}),YH=rc(function(y,b){var P={};if(y==null)return P;var O=!1;b=Qt(b,function(q){return q=cu(q,y),O||(O=q.length>1),q}),js(y,H0(y),P),O&&(P=no(P,u|f|h,Hk));for(var N=b.length;N--;)j0(P,b[N]);return P});function WH(y,b){return uw(y,Wv(xe(b)))}var ZH=rc(function(y,b){return y==null?{}:Ck(y,b)});function uw(y,b){if(y==null)return{};var P=Qt(H0(y),function(O){return[O]});return b=xe(b),eA(y,P,function(O,N){return b(O,N[0])})}function QH(y,b,P){b=cu(b,y);var O=-1,N=b.length;for(N||(N=1,y=t);++O<N;){var q=y==null?t:y[Ns(b[O])];q===t&&(O=N,q=P),y=sc(q)?q.call(y):q}return y}function JH(y,b,P){return y==null?y:Oh(y,b,P)}function XH(y,b,P,O){return O=typeof O=="function"?O:t,y==null?y:Oh(y,b,P,O)}var lw=EA(qn),dw=EA(Yi);function eV(y,b,P){var O=We(y),N=O||lu(y)||Af(y);if(b=xe(b,4),P==null){var q=y&&y.constructor;N?P=O?new q:[]:en(y)?P=sc(q)?Cf(Cv(y)):{}:P={}}return(N?Xr:Ls)(y,function(z,W,J){return b(P,z,W,J)}),P}function tV(y,b){return y==null?!0:j0(y,b)}function nV(y,b,P){return y==null?y:oA(y,b,x0(P))}function iV(y,b,P,O){return O=typeof O=="function"?O:t,y==null?y:oA(y,b,x0(P),O)}function wf(y){return y==null?[]:g0(y,qn(y))}function rV(y){return y==null?[]:g0(y,Yi(y))}function oV(y,b,P){return P===t&&(P=b,b=t),P!==t&&(P=oo(P),P=P===P?P:0),b!==t&&(b=oo(b),b=b===b?b:0),yl(oo(y),b,P)}function sV(y,b,P){return b=ac(b),P===t?(P=b,b=0):P=ac(P),y=oo(y),fk(y,b,P)}function aV(y,b,P){if(P&&typeof P!="boolean"&&Mi(y,b,P)&&(b=P=t),P===t&&(typeof b=="boolean"?(P=b,b=t):typeof y=="boolean"&&(P=y,y=t)),y===t&&b===t?(y=0,b=1):(y=ac(y),b===t?(b=y,y=0):b=ac(b)),y>b){var O=y;y=b,b=O}if(P||y%1||b%1){var N=NM();return vi(y+N*(b-y+kx("1e-"+((N+"").length-1))),b)}return D0(y,b)}var cV=Rf(function(y,b,P){return b=b.toLowerCase(),y+(P?fw(b):b)});function fw(y){return rb(yt(y).toLowerCase())}function hw(y){return y=yt(y),y&&y.replace(pt,Jx).replace(Ix,"")}function uV(y,b,P){y=yt(y),b=Ar(b);var O=y.length;P=P===t?O:yl(Qe(P),0,O);var N=P;return P-=b.length,P>=0&&y.slice(P,N)==b}function lV(y){return y=yt(y),y&&Ye.test(y)?y.replace(Re,Xx):y}function dV(y){return y=yt(y),y&&hl.test(y)?y.replace(bh,"\\$&"):y}var fV=Rf(function(y,b,P){return y+(P?"-":"")+b.toLowerCase()}),hV=Rf(function(y,b,P){return y+(P?" ":"")+b.toLowerCase()}),pV=mA("toLowerCase");function gV(y,b,P){y=yt(y),b=Qe(b);var O=b?yf(y):0;if(!b||O>=b)return y;var N=(b-O)/2;return Kv(Av(N),P)+y+Kv(Mv(N),P)}function mV(y,b,P){y=yt(y),b=Qe(b);var O=b?yf(y):0;return b&&O<b?y+Kv(b-O,P):y}function vV(y,b,P){y=yt(y),b=Qe(b);var O=b?yf(y):0;return b&&O<b?Kv(b-O,P)+y:y}function yV(y,b,P){return P||b==null?b=0:b&&(b=+b),RF(yt(y).replace(pf,""),b||0)}function _V(y,b,P){return(P?Mi(y,b,P):b===t)?b=1:b=Qe(b),O0(yt(y),b)}function bV(){var y=arguments,b=yt(y[0]);return y.length<3?b:b.replace(y[1],y[2])}var SV=Rf(function(y,b,P){return y+(P?"_":"")+b.toLowerCase()});function EV(y,b,P){return P&&typeof P!="number"&&Mi(y,b,P)&&(b=P=t),P=P===t?de:P>>>0,P?(y=yt(y),y&&(typeof b=="string"||b!=null&&!tb(b))&&(b=Ar(b),!b&&vf(y))?uu(Jo(y),0,P):y.split(b,P)):[]}var CV=Rf(function(y,b,P){return y+(P?" ":"")+rb(b)});function PV(y,b,P){return y=yt(y),P=P==null?0:yl(Qe(P),0,y.length),b=Ar(b),y.slice(P,P+b.length)==b}function RV(y,b,P){var O=k.templateSettings;P&&Mi(y,b,P)&&(b=t),y=yt(y),b=Jv({},b,O,CA);var N=Jv({},b.imports,O.imports,CA),q=qn(N),z=g0(N,q),W,J,oe=0,ae=b.interpolate||Zt,le="__p += '",Ce=v0((b.escape||Zt).source+"|"+ae.source+"|"+(ae===mi?De:Zt).source+"|"+(b.evaluate||Zt).source+"|$","g"),Oe="//# sourceURL="+(Ct.call(b,"sourceURL")?(b.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++jx+"]")+`
`;y.replace(Ce,function(He,nt,ut,Ir,Ai,Tr){return ut||(ut=Ir),le+=y.slice(oe,Tr).replace($n,eF),nt&&(W=!0,le+=`' +
__e(`+nt+`) +
'`),Ai&&(J=!0,le+=`';
`+Ai+`;
__p += '`),ut&&(le+=`' +
((__t = (`+ut+`)) == null ? '' : __t) +
'`),oe=Tr+He.length,He}),le+=`';
`;var qe=Ct.call(b,"variable")&&b.variable;if(!qe)le=`with (obj) {
`+le+`
}
`;else if(se.test(qe))throw new Ue(r);le=(J?le.replace(Jt,""):le).replace(Ze,"$1").replace(Ee,"$1;"),le="function("+(qe||"obj")+`) {
`+(qe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(W?", __e = _.escape":"")+(J?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+le+`return __p
}`;var Je=gw(function(){return gt(q,Oe+"return "+le).apply(t,z)});if(Je.source=le,eb(Je))throw Je;return Je}function MV(y){return yt(y).toLowerCase()}function AV(y){return yt(y).toUpperCase()}function wV(y,b,P){if(y=yt(y),y&&(P||b===t))return PM(y);if(!y||!(b=Ar(b)))return y;var O=Jo(y),N=Jo(b),q=RM(O,N),z=MM(O,N)+1;return uu(O,q,z).join("")}function IV(y,b,P){if(y=yt(y),y&&(P||b===t))return y.slice(0,wM(y)+1);if(!y||!(b=Ar(b)))return y;var O=Jo(y),N=MM(O,Jo(b))+1;return uu(O,0,N).join("")}function TV(y,b,P){if(y=yt(y),y&&(P||b===t))return y.replace(pf,"");if(!y||!(b=Ar(b)))return y;var O=Jo(y),N=RM(O,Jo(b));return uu(O,N).join("")}function DV(y,b){var P=w,O=T;if(en(b)){var N="separator"in b?b.separator:N;P="length"in b?Qe(b.length):P,O="omission"in b?Ar(b.omission):O}y=yt(y);var q=y.length;if(vf(y)){var z=Jo(y);q=z.length}if(P>=q)return y;var W=P-yf(O);if(W<1)return O;var J=z?uu(z,0,W).join(""):y.slice(0,W);if(N===t)return J+O;if(z&&(W+=J.length-W),tb(N)){if(y.slice(W).search(N)){var oe,ae=J;for(N.global||(N=v0(N.source,yt(wt.exec(N))+"g")),N.lastIndex=0;oe=N.exec(ae);)var le=oe.index;J=J.slice(0,le===t?W:le)}}else if(y.indexOf(Ar(N),W)!=W){var Ce=J.lastIndexOf(N);Ce>-1&&(J=J.slice(0,Ce))}return J+O}function OV(y){return y=yt(y),y&&we.test(y)?y.replace(be,aF):y}var LV=Rf(function(y,b,P){return y+(P?" ":"")+b.toUpperCase()}),rb=mA("toUpperCase");function pw(y,b,P){return y=yt(y),b=P?t:b,b===t?nF(y)?lF(y):$x(y):y.match(b)||[]}var gw=tt(function(y,b){try{return Rr(y,t,b)}catch(P){return eb(P)?P:new Ue(P)}}),jV=rc(function(y,b){return Xr(b,function(P){P=Ns(P),nc(y,P,J0(y[P],y))}),y});function NV(y){var b=y==null?0:y.length,P=xe();return y=b?Qt(y,function(O){if(typeof O[1]!="function")throw new eo(s);return[P(O[0]),O[1]]}):[],tt(function(O){for(var N=-1;++N<b;){var q=y[N];if(Rr(q[0],this,O))return Rr(q[1],this,O)}})}function BV(y){return ak(no(y,u))}function ob(y){return function(){return y}}function xV(y,b){return y==null||y!==y?b:y}var FV=yA(),kV=yA(!0);function Wi(y){return y}function sb(y){return YM(typeof y=="function"?y:no(y,u))}function KV(y){return ZM(no(y,u))}function qV(y,b){return QM(y,no(b,u))}var HV=tt(function(y,b){return function(P){return Th(P,y,b)}}),VV=tt(function(y,b){return function(P){return Th(y,P,b)}});function ab(y,b,P){var O=qn(b),N=Lv(b,O);P==null&&!(en(b)&&(N.length||!O.length))&&(P=b,b=y,y=this,N=Lv(b,qn(b)));var q=!(en(P)&&"chain"in P)||!!P.chain,z=sc(y);return Xr(N,function(W){var J=b[W];y[W]=J,z&&(y.prototype[W]=function(){var oe=this.__chain__;if(q||oe){var ae=y(this.__wrapped__),le=ae.__actions__=Ui(this.__actions__);return le.push({func:J,args:arguments,thisArg:y}),ae.__chain__=oe,ae}return J.apply(y,iu([this.value()],arguments))})}),y}function GV(){return Yn._===this&&(Yn._=mF),this}function cb(){}function zV(y){return y=Qe(y),tt(function(b){return JM(b,y)})}var UV=k0(Qt),$V=k0(_M),YV=k0(l0);function mw(y){return U0(y)?d0(Ns(y)):Pk(y)}function WV(y){return function(b){return y==null?t:_l(y,b)}}var ZV=bA(),QV=bA(!0);function ub(){return[]}function lb(){return!1}function JV(){return{}}function XV(){return""}function eG(){return!0}function tG(y,b){if(y=Qe(y),y<1||y>U)return[];var P=de,O=vi(y,de);b=xe(b),y-=de;for(var N=p0(O,b);++P<y;)b(P);return N}function nG(y){return We(y)?Qt(y,Ns):wr(y)?[y]:Ui(BA(yt(y)))}function iG(y){var b=++pF;return yt(y)+b}var rG=kv(function(y,b){return y+b},0),oG=K0("ceil"),sG=kv(function(y,b){return y/b},1),aG=K0("floor");function cG(y){return y&&y.length?Ov(y,Wi,R0):t}function uG(y,b){return y&&y.length?Ov(y,xe(b,2),R0):t}function lG(y){return EM(y,Wi)}function dG(y,b){return EM(y,xe(b,2))}function fG(y){return y&&y.length?Ov(y,Wi,I0):t}function hG(y,b){return y&&y.length?Ov(y,xe(b,2),I0):t}var pG=kv(function(y,b){return y*b},1),gG=K0("round"),mG=kv(function(y,b){return y-b},0);function vG(y){return y&&y.length?h0(y,Wi):0}function yG(y,b){return y&&y.length?h0(y,xe(b,2)):0}return k.after=Kq,k.ary=$A,k.assign=AH,k.assignIn=aw,k.assignInWith=Jv,k.assignWith=wH,k.at=IH,k.before=YA,k.bind=J0,k.bindAll=jV,k.bindKey=WA,k.castArray=Jq,k.chain=GA,k.chunk=aK,k.compact=cK,k.concat=uK,k.cond=NV,k.conforms=BV,k.constant=ob,k.countBy=vq,k.create=TH,k.curry=ZA,k.curryRight=QA,k.debounce=JA,k.defaults=DH,k.defaultsDeep=OH,k.defer=qq,k.delay=Hq,k.difference=lK,k.differenceBy=dK,k.differenceWith=fK,k.drop=hK,k.dropRight=pK,k.dropRightWhile=gK,k.dropWhile=mK,k.fill=vK,k.filter=_q,k.flatMap=Eq,k.flatMapDeep=Cq,k.flatMapDepth=Pq,k.flatten=KA,k.flattenDeep=yK,k.flattenDepth=_K,k.flip=Vq,k.flow=FV,k.flowRight=kV,k.fromPairs=bK,k.functions=kH,k.functionsIn=KH,k.groupBy=Rq,k.initial=EK,k.intersection=CK,k.intersectionBy=PK,k.intersectionWith=RK,k.invert=HH,k.invertBy=VH,k.invokeMap=Aq,k.iteratee=sb,k.keyBy=wq,k.keys=qn,k.keysIn=Yi,k.map=Uv,k.mapKeys=zH,k.mapValues=UH,k.matches=KV,k.matchesProperty=qV,k.memoize=Yv,k.merge=$H,k.mergeWith=cw,k.method=HV,k.methodOf=VV,k.mixin=ab,k.negate=Wv,k.nthArg=zV,k.omit=YH,k.omitBy=WH,k.once=Gq,k.orderBy=Iq,k.over=UV,k.overArgs=zq,k.overEvery=$V,k.overSome=YV,k.partial=X0,k.partialRight=XA,k.partition=Tq,k.pick=ZH,k.pickBy=uw,k.property=mw,k.propertyOf=WV,k.pull=IK,k.pullAll=HA,k.pullAllBy=TK,k.pullAllWith=DK,k.pullAt=OK,k.range=ZV,k.rangeRight=QV,k.rearg=Uq,k.reject=Lq,k.remove=LK,k.rest=$q,k.reverse=Z0,k.sampleSize=Nq,k.set=JH,k.setWith=XH,k.shuffle=Bq,k.slice=jK,k.sortBy=kq,k.sortedUniq=qK,k.sortedUniqBy=HK,k.split=EV,k.spread=Yq,k.tail=VK,k.take=GK,k.takeRight=zK,k.takeRightWhile=UK,k.takeWhile=$K,k.tap=cq,k.throttle=Wq,k.thru=zv,k.toArray=rw,k.toPairs=lw,k.toPairsIn=dw,k.toPath=nG,k.toPlainObject=sw,k.transform=eV,k.unary=Zq,k.union=YK,k.unionBy=WK,k.unionWith=ZK,k.uniq=QK,k.uniqBy=JK,k.uniqWith=XK,k.unset=tV,k.unzip=Q0,k.unzipWith=VA,k.update=nV,k.updateWith=iV,k.values=wf,k.valuesIn=rV,k.without=eq,k.words=pw,k.wrap=Qq,k.xor=tq,k.xorBy=nq,k.xorWith=iq,k.zip=rq,k.zipObject=oq,k.zipObjectDeep=sq,k.zipWith=aq,k.entries=lw,k.entriesIn=dw,k.extend=aw,k.extendWith=Jv,ab(k,k),k.add=rG,k.attempt=gw,k.camelCase=cV,k.capitalize=fw,k.ceil=oG,k.clamp=oV,k.clone=Xq,k.cloneDeep=tH,k.cloneDeepWith=nH,k.cloneWith=eH,k.conformsTo=iH,k.deburr=hw,k.defaultTo=xV,k.divide=sG,k.endsWith=uV,k.eq=es,k.escape=lV,k.escapeRegExp=dV,k.every=yq,k.find=bq,k.findIndex=FA,k.findKey=LH,k.findLast=Sq,k.findLastIndex=kA,k.findLastKey=jH,k.floor=aG,k.forEach=zA,k.forEachRight=UA,k.forIn=NH,k.forInRight=BH,k.forOwn=xH,k.forOwnRight=FH,k.get=nb,k.gt=rH,k.gte=oH,k.has=qH,k.hasIn=ib,k.head=qA,k.identity=Wi,k.includes=Mq,k.indexOf=SK,k.inRange=sV,k.invoke=GH,k.isArguments=El,k.isArray=We,k.isArrayBuffer=sH,k.isArrayLike=$i,k.isArrayLikeObject=mn,k.isBoolean=aH,k.isBuffer=lu,k.isDate=cH,k.isElement=uH,k.isEmpty=lH,k.isEqual=dH,k.isEqualWith=fH,k.isError=eb,k.isFinite=hH,k.isFunction=sc,k.isInteger=ew,k.isLength=Zv,k.isMap=tw,k.isMatch=pH,k.isMatchWith=gH,k.isNaN=mH,k.isNative=vH,k.isNil=_H,k.isNull=yH,k.isNumber=nw,k.isObject=en,k.isObjectLike=un,k.isPlainObject=Bh,k.isRegExp=tb,k.isSafeInteger=bH,k.isSet=iw,k.isString=Qv,k.isSymbol=wr,k.isTypedArray=Af,k.isUndefined=SH,k.isWeakMap=EH,k.isWeakSet=CH,k.join=MK,k.kebabCase=fV,k.last=ro,k.lastIndexOf=AK,k.lowerCase=hV,k.lowerFirst=pV,k.lt=PH,k.lte=RH,k.max=cG,k.maxBy=uG,k.mean=lG,k.meanBy=dG,k.min=fG,k.minBy=hG,k.stubArray=ub,k.stubFalse=lb,k.stubObject=JV,k.stubString=XV,k.stubTrue=eG,k.multiply=pG,k.nth=wK,k.noConflict=GV,k.noop=cb,k.now=$v,k.pad=gV,k.padEnd=mV,k.padStart=vV,k.parseInt=yV,k.random=aV,k.reduce=Dq,k.reduceRight=Oq,k.repeat=_V,k.replace=bV,k.result=QH,k.round=gG,k.runInContext=Q,k.sample=jq,k.size=xq,k.snakeCase=SV,k.some=Fq,k.sortedIndex=NK,k.sortedIndexBy=BK,k.sortedIndexOf=xK,k.sortedLastIndex=FK,k.sortedLastIndexBy=kK,k.sortedLastIndexOf=KK,k.startCase=CV,k.startsWith=PV,k.subtract=mG,k.sum=vG,k.sumBy=yG,k.template=RV,k.times=tG,k.toFinite=ac,k.toInteger=Qe,k.toLength=ow,k.toLower=MV,k.toNumber=oo,k.toSafeInteger=MH,k.toString=yt,k.toUpper=AV,k.trim=wV,k.trimEnd=IV,k.trimStart=TV,k.truncate=DV,k.unescape=OV,k.uniqueId=iG,k.upperCase=LV,k.upperFirst=rb,k.each=zA,k.eachRight=UA,k.first=qA,ab(k,function(){var y={};return Ls(k,function(b,P){Ct.call(k.prototype,P)||(y[P]=b)}),y}(),{chain:!1}),k.VERSION=i,Xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(y){k[y].placeholder=k}),Xr(["drop","take"],function(y,b){st.prototype[y]=function(P){P=P===t?1:Tn(Qe(P),0);var O=this.__filtered__&&!b?new st(this):this.clone();return O.__filtered__?O.__takeCount__=vi(P,O.__takeCount__):O.__views__.push({size:vi(P,de),type:y+(O.__dir__<0?"Right":"")}),O},st.prototype[y+"Right"]=function(P){return this.reverse()[y](P).reverse()}}),Xr(["filter","map","takeWhile"],function(y,b){var P=b+1,O=P==B||P==F;st.prototype[y]=function(N){var q=this.clone();return q.__iteratees__.push({iteratee:xe(N,3),type:P}),q.__filtered__=q.__filtered__||O,q}}),Xr(["head","last"],function(y,b){var P="take"+(b?"Right":"");st.prototype[y]=function(){return this[P](1).value()[0]}}),Xr(["initial","tail"],function(y,b){var P="drop"+(b?"":"Right");st.prototype[y]=function(){return this.__filtered__?new st(this):this[P](1)}}),st.prototype.compact=function(){return this.filter(Wi)},st.prototype.find=function(y){return this.filter(y).head()},st.prototype.findLast=function(y){return this.reverse().find(y)},st.prototype.invokeMap=tt(function(y,b){return typeof y=="function"?new st(this):this.map(function(P){return Th(P,y,b)})}),st.prototype.reject=function(y){return this.filter(Wv(xe(y)))},st.prototype.slice=function(y,b){y=Qe(y);var P=this;return P.__filtered__&&(y>0||b<0)?new st(P):(y<0?P=P.takeRight(-y):y&&(P=P.drop(y)),b!==t&&(b=Qe(b),P=b<0?P.dropRight(-b):P.take(b-y)),P)},st.prototype.takeRightWhile=function(y){return this.reverse().takeWhile(y).reverse()},st.prototype.toArray=function(){return this.take(de)},Ls(st.prototype,function(y,b){var P=/^(?:filter|find|map|reject)|While$/.test(b),O=/^(?:head|last)$/.test(b),N=k[O?"take"+(b=="last"?"Right":""):b],q=O||/^find/.test(b);N&&(k.prototype[b]=function(){var z=this.__wrapped__,W=O?[1]:arguments,J=z instanceof st,oe=W[0],ae=J||We(z),le=function(nt){var ut=N.apply(k,iu([nt],W));return O&&Ce?ut[0]:ut};ae&&P&&typeof oe=="function"&&oe.length!=1&&(J=ae=!1);var Ce=this.__chain__,Oe=!!this.__actions__.length,qe=q&&!Ce,Je=J&&!Oe;if(!q&&ae){z=Je?z:new st(this);var He=y.apply(z,W);return He.__actions__.push({func:zv,args:[le],thisArg:t}),new to(He,Ce)}return qe&&Je?y.apply(this,W):(He=this.thru(le),qe?O?He.value()[0]:He.value():He)})}),Xr(["pop","push","shift","sort","splice","unshift"],function(y){var b=vv[y],P=/^(?:push|sort|unshift)$/.test(y)?"tap":"thru",O=/^(?:pop|shift)$/.test(y);k.prototype[y]=function(){var N=arguments;if(O&&!this.__chain__){var q=this.value();return b.apply(We(q)?q:[],N)}return this[P](function(z){return b.apply(We(z)?z:[],N)})}}),Ls(st.prototype,function(y,b){var P=k[b];if(P){var O=P.name+"";Ct.call(Ef,O)||(Ef[O]=[]),Ef[O].push({name:b,func:P})}}),Ef[Fv(t,v).name]=[{name:"wrapper",func:t}],st.prototype.clone=OF,st.prototype.reverse=LF,st.prototype.value=jF,k.prototype.at=uq,k.prototype.chain=lq,k.prototype.commit=dq,k.prototype.next=fq,k.prototype.plant=pq,k.prototype.reverse=gq,k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=mq,k.prototype.first=k.prototype.head,Ch&&(k.prototype[Ch]=hq),k},_f=dF();pl?((pl.exports=_f)._=_f,s0._=_f):Yn._=_f}).call(w$)}(Vg,Vg.exports)),Vg.exports}var aj;function p6(){if(aj)return mg;aj=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.FeedbackMoveMouseListener=void 0;const e=Y(),n=cf(),t=Jc(),i=Un(),a=kt(),o=Pr(),s=af();class r extends t.DragAwareMouseListener{constructor(l){super(),this.tool=l,this.elementId2startPos=new Map,this.tracker=l.createChangeBoundsTracker(),this.moveInitializedFeedback=l.createFeedbackEmitter(),this.moveFeedback=l.createFeedbackEmitter()}mouseDown(l,c){return super.mouseDown(l,c),c.button===0?this.tracker.isTracking()?(this.draggingMouseUp(l,c),[]):(this.initializeMove(l,c),[]):(this.tracker.stopTracking(),[])}initializeMove(l,c){if(l instanceof o.GResizeHandle)return;(0,e.findParentByFeature)(l,this.isValidMoveable)!==void 0?(this.tracker.startTracking(),this.scheduleMoveInitialized()):this.tracker.stopTracking()}scheduleMoveInitialized(){var l;(l=this.pendingMoveInitialized)===null||l===void 0||l.cancel(),this.pendingMoveInitialized=(0,n.debounce)(()=>{this.moveInitialized(),this.pendingMoveInitialized=void 0},750),this.pendingMoveInitialized()}moveInitializationTimeout(){return 750}moveInitialized(){this.isMouseDown&&this.moveInitializedFeedback.add(s.MoveInitializedEventAction.create(),s.MoveFinishedEventAction.create()).add((0,i.cursorFeedbackAction)(i.CursorCSS.MOVE),(0,i.cursorFeedbackAction)(i.CursorCSS.DEFAULT)).submit()}isValidMoveable(l){return!!l&&(0,a.isNonRoutableSelectedMovableBoundsAware)(l)&&!(l instanceof o.GResizeHandle)}isValidRevertable(l){return!!l&&(0,a.isNonRoutableMovableBoundsAware)(l)&&!(l instanceof o.GResizeHandle)}nonDraggingMouseUp(l,c){return this.moveInitializedFeedback.dispose(),this.tracker.stopTracking(),[]}draggingMouseMove(l,c){return super.draggingMouseMove(l,c),this.tracker.isTracking()?this.moveElements(l,c):[]}moveElements(l,c){var u;this.elementId2startPos.size===0&&this.initializeElementsToMove(l.root);const f=this.getElementsToMove(l),h=this.tracker.moveElements(f,{snap:c,restrict:c});return h.elementMoves.length===0?[]:((u=this.pendingMoveInitialized)===null||u===void 0||u.cancel(),this.moveFeedback.add(this.createMoveAction(h),()=>this.resetElementPositions(l)),this.addMoveFeedback(h,l,c),this.tracker.updateTrackingPosition(h),this.moveFeedback.submit(),[])}createMoveAction(l){return e.MoveAction.create(l.elementMoves.map(c=>({elementId:c.element.id,toPosition:c.toPosition})),{animate:!1})}addMoveFeedback(l,c,u){this.tool.changeBoundsManager.addMoveFeedback(this.moveFeedback,l,c,u)}initializeElementsToMove(l){this.collectElementsToMove(l).forEach(u=>this.elementId2startPos.set(u.id,u.position))}collectElementsToMove(l){const c=(0,a.filter)(l.index,this.isValidMoveable),u=(0,a.removeDescendants)(c);return Array.from(u)}getElementsToMove(l,c=this.isValidMoveable){return(0,a.getElements)(l.root.index,Array.from(this.elementId2startPos.keys()),c)}resetElementPositions(l){const c=this.revertElementMoves(l);return e.MoveAction.create(c,{animate:!1,finished:!0})}revertElementMoves(l){var c;const u=[];return!((c=l==null?void 0:l.root)===null||c===void 0)&&c.index&&this.getElementsToMove(l,this.isValidRevertable).forEach(h=>u.push({elementId:h.id,toPosition:this.elementId2startPos.get(h.id)})),u}draggingMouseUp(l,c){if(!this.tracker.isTracking())return[];const u=this.getElementsToMove(l);return this.tool.movementOptions.allElementsNeedToBeValid?u.length>0&&u.every(f=>this.tool.changeBoundsManager.isValid(f))&&this.elementId2startPos.clear():u.filter(f=>this.tool.changeBoundsManager.isValid(f)).forEach(f=>this.elementId2startPos.delete(f.id)),this.dispose(),[]}selectionChanged(l,c,u){this.dispose()}dispose(){var l;(l=this.pendingMoveInitialized)===null||l===void 0||l.cancel(),this.moveInitializedFeedback.dispose(),this.moveFeedback.dispose(),this.tracker.dispose(),this.elementId2startPos.clear(),super.dispose()}}return mg.FeedbackMoveMouseListener=r,mg}var cj;function g6(){if(cj)return jo;cj=1;var e=jo&&jo.__decorate||function(v,_,S,E){var C=arguments.length,M=C<3?_:E===null?E=Object.getOwnPropertyDescriptor(_,S):E,L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(v,_,S,E);else for(var I=v.length-1;I>=0;I--)(L=v[I])&&(M=(C<3?L(M):C>3?L(_,S,M):L(_,S))||M);return C>3&&M&&Object.defineProperty(_,S,M),M},n=jo&&jo.__metadata||function(v,_){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,_)},t;Object.defineProperty(jo,"__esModule",{value:!0}),jo.ChangeBoundsListener=jo.ChangeBoundsTool=void 0;const i=G(),a=Y(),o=Jc(),s=Er(),r=kt(),d=lh(),l=zm(),c=Pr(),u=Wa(),f=zP(),h=af(),p=p6();let g=t=class extends u.BaseEditTool{constructor(){super(...arguments),this.movementOptions={allElementsNeedToBeValid:!0}}get id(){return t.ID}enable(){const _=this.createMoveMouseListener();this.toDisposeOnDisable.push(this.mouseTool.registerListener(_)),a.Disposable.is(_)&&this.toDisposeOnDisable.push(_),s.ISelectionListener.is(_)&&this.toDisposeOnDisable.push(this.selectionService.addListener(_));const S=this.createChangeBoundsListener();this.toDisposeOnDisable.push(this.mouseTool.registerListener(S)),a.Disposable.is(S)&&this.toDisposeOnDisable.push(S),s.ISelectionListener.is(S)&&this.toDisposeOnDisable.push(this.selectionService.addListener(S))}createChangeBoundsTracker(){return this.changeBoundsManager.createTracker()}createMoveMouseListener(){return new p.FeedbackMoveMouseListener(this)}createChangeBoundsListener(){return new m(this)}};jo.ChangeBoundsTool=g,g.ID="glsp.change-bounds-tool",e([(0,i.inject)(s.SelectionService),n("design:type",s.SelectionService)],g.prototype,"selectionService",void 0),e([(0,i.inject)(a.EdgeRouterRegistry),(0,i.optional)(),n("design:type",a.EdgeRouterRegistry)],g.prototype,"edgeRouterRegistry",void 0),e([(0,i.inject)(a.TYPES.IMovementRestrictor),(0,i.optional)(),n("design:type",Object)],g.prototype,"movementRestrictor",void 0),e([(0,i.inject)(a.TYPES.IChangeBoundsManager),n("design:type",Object)],g.prototype,"changeBoundsManager",void 0),e([(0,i.inject)(a.TYPES.IMovementOptions),(0,i.optional)(),n("design:type",Object)],g.prototype,"movementOptions",void 0),jo.ChangeBoundsTool=g=t=e([(0,i.injectable)()],g);class m extends o.DragAwareMouseListener{constructor(_){super(),this.tool=_,this.tracker=_.createChangeBoundsTracker(),this.handleFeedback=_.createFeedbackEmitter(),this.resizeFeedback=_.createFeedbackEmitter()}mouseDown(_,S){return super.mouseDown(_,S),S.button!==0||_ instanceof a.GModelRoot?[]:(this.updateResizeElement(_,S),[])}updateResizeElement(_,S){var E,C;return this.activeResizeHandle=_ instanceof c.GResizeHandle?_:void 0,this.activeResizeElement=(C=(E=this.activeResizeHandle)===null||E===void 0?void 0:E.parent)!==null&&C!==void 0?C:this.findResizeElement(_),this.activeResizeElement?(S&&this.tracker.startTracking(),this.initialBounds={newSize:this.activeResizeElement.bounds,newPosition:this.activeResizeElement.bounds,elementId:this.activeResizeElement.id},this.tool.createFeedbackEmitter().add(d.LocalRequestBoundsAction.create(_.root,[this.activeResizeElement.id])).submit().dispose(),this.handleFeedback.add(h.ShowChangeBoundsToolResizeFeedbackAction.create({elementId:this.activeResizeElement.id}),h.HideChangeBoundsToolResizeFeedbackAction.create()),this.handleFeedback.submit(),!0):(this.disposeResize(),!1)}findResizeElement(_){return(0,a.findParentByFeature)(_,c.isResizable)}draggingMouseMove(_,S){if(this.activeResizeHandle&&this.tracker.isTracking()){const E=this.tracker.resizeElements(this.activeResizeHandle,{snap:S,symmetric:S,restrict:S}),C=this.resizeBoundsAction(E);C.bounds.length>0&&(this.resizeFeedback.add(C,()=>this.resetBounds()),this.tracker.updateTrackingPosition(E.handleMove.moveVector),this.addResizeFeedback(E,_,S),this.resizeFeedback.submit())}return super.draggingMouseMove(_,S)}resizeBoundsAction(_){const S=_.elementResizes.filter(E=>E.valid.size);return l.SetBoundsFeedbackAction.create(S.map(E=>this.toElementAndBounds(E)))}toElementAndBounds(_){return{elementId:_.element.id,newSize:_.toBounds,newPosition:_.toBounds}}addResizeFeedback(_,S,E){this.tool.changeBoundsManager.addResizeFeedback(this.resizeFeedback,_,S,E)}resetBounds(){return this.initialBounds?[l.SetBoundsFeedbackAction.create([this.initialBounds]),h.MoveFinishedEventAction.create()]:[h.MoveFinishedEventAction.create()]}draggingMouseUp(_,S){const E=[];return this.activeResizeHandle?E.push(...this.handleResizeOnServer(this.activeResizeHandle)):E.push(...this.handleMoveOnServer(_)),this.disposeResize({keepHandles:!0}),E}nonDraggingMouseUp(_,S){return this.disposeResize({keepHandles:!0}),super.nonDraggingMouseUp(_,S)}handleMoveOnServer(_){const S=[],E=this.getElementsToMove(_);return S.push(...this.handleMoveElementsOnServer(E)),S.push(...this.handleMoveRoutingPointsOnServer(E)),S.length>0?[a.CompoundOperation.create(S)]:[]}getElementsToMove(_){const S=(0,r.getMatchingElements)(_.index,r.isNonRoutableSelectedMovableBoundsAware),E=new Set(S),C=S.filter(M=>this.isValidMove(M,E));return this.tool.movementOptions.allElementsNeedToBeValid&&C.length!==E.size?[]:C}handleMoveElementsOnServer(_){const S=_.map(r.toElementAndBounds);return S.length>0?[a.ChangeBoundsOperation.create(S)]:[]}isValidMove(_,S=new Set){return this.tool.changeBoundsManager.hasValidPosition(_)&&!this.isChildOfSelected(S,_)}isChildOfSelected(_,S){if(_.size===0)return!1;for(;S instanceof a.GChildElement;)if(S=S.parent,_.has(S))return!0;return!1}handleMoveRoutingPointsOnServer(_){const S=[],E=this.tool.edgeRouterRegistry;return E&&_.forEach(C=>{C instanceof a.GConnectableElement&&(C.incomingEdges.map(M=>(0,r.calcElementAndRoutingPoints)(M,E)).forEach(M=>S.push(M)),C.outgoingEdges.map(M=>(0,r.calcElementAndRoutingPoints)(M,E)).forEach(M=>S.push(M)))}),S.length>0?[a.ChangeRoutingPointsOperation.create(S)]:[]}handleResizeOnServer(_){if(this.initialBounds&&this.isValidResize(_.parent)){const S=(0,r.toElementAndBounds)(_.parent);if(!this.initialBounds.newPosition||!S.newPosition)return[];if(!a.Point.equals(this.initialBounds.newPosition,S.newPosition)||!a.Dimension.equals(this.initialBounds.newSize,S.newSize))return this.initialBounds=void 0,[a.ChangeBoundsOperation.create([S])]}return[]}isValidResize(_){return this.tool.changeBoundsManager.isValid(_)}selectionChanged(_,S){if(!(this.activeResizeElement&&S.includes(this.activeResizeElement.id))){for(const E of S.reverse()){const C=_.index.getById(E);if(C&&this.updateResizeElement(C))return}this.dispose()}}isActiveResizeElement(_){return _!==void 0&&this.activeResizeElement!==void 0&&_.id===this.activeResizeElement.id}disposeResize(_={keepHandles:!1}){_.keepHandles||this.handleFeedback.dispose(),this.resizeFeedback.dispose(),this.tracker.dispose(),this.activeResizeElement=void 0,this.activeResizeHandle=void 0,this.initialBounds=void 0}dispose(){this.disposeResize(),super.dispose()}}return jo.ChangeBoundsListener=m,m.CSS_CLASS_ACTIVE=f.CSS_ACTIVE_HANDLE,jo}var Ps={},uj;function m6(){if(uj)return Ps;uj=1;var e=Ps&&Ps.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Ps,"__esModule",{value:!0}),Ps.SResizeHandleView=Ps.GResizeHandleView=void 0;const n=Y(),t=G(),i=Pr();let a=class{render(s,r){if(r.targetKind==="hidden")return;const d=this.getPosition(s);if(d!==void 0){const l=(0,n.svg)("circle",{"class-sprotty-resize-handle":!0,"class-mouseover":s.hoverFeedback,cx:d.x,cy:d.y,r:this.getRadius()});return(0,n.setAttr)(l,"data-kind",s.location),l}return(0,n.svg)("g",null)}getPosition(s){return n.Point.subtract(i.GResizeHandle.getHandlePosition(s),s.parent.bounds)}getRadius(){return 7}};return Ps.GResizeHandleView=a,Ps.SResizeHandleView=a,Ps.SResizeHandleView=Ps.GResizeHandleView=a=e([(0,t.injectable)()],a),Ps}var lj;function v6(){if(lj)return gg;lj=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.changeBoundsToolModule=void 0;const e=Y(),n=Pr(),t=zP(),i=g6(),a=af(),o=m6();return gg.changeBoundsToolModule=new e.FeatureModule((s,r,d,l)=>{const c={bind:s,unbind:r,isBound:d,rebind:l};(0,e.bindAsService)(c,e.TYPES.IChangeBoundsManager,t.ChangeBoundsManager),(0,e.bindAsService)(c,e.TYPES.IDefaultTool,i.ChangeBoundsTool),(0,e.configureCommand)(c,a.ShowChangeBoundsToolResizeFeedbackCommand),(0,e.configureCommand)(c,a.HideChangeBoundsToolResizeFeedbackCommand),(0,e.configureView)(c,n.GResizeHandle.TYPE,o.GResizeHandleView)},{featureId:Symbol("changeBoundsTool")}),gg}var vg={},dj;function y6(){if(dj)return vg;dj=1,Object.defineProperty(vg,"__esModule",{value:!0}),vg.deletionToolModule=void 0;const e=Y(),n=D_();return vg.deletionToolModule=new e.FeatureModule((t,i,a,o)=>{const s={bind:t,unbind:i,isBound:a,rebind:o};(0,e.bindAsService)(s,e.TYPES.IDefaultTool,n.DelKeyDeleteTool),(0,e.bindAsService)(s,e.TYPES.ITool,n.MouseDeleteTool)},{featureId:Symbol("deletionTool")}),vg}var yg={},fj;function _6(){if(fj)return yg;fj=1,Object.defineProperty(yg,"__esModule",{value:!0}),yg.edgeCreationToolModule=void 0;const e=Y(),n=ul(),t=kP();return yg.edgeCreationToolModule=new e.FeatureModule((i,a,o,s)=>{const r={bind:i,unbind:a,isBound:o,rebind:s};(0,e.bindAsService)(r,e.TYPES.ITool,t.EdgeCreationTool),(0,e.configureActionHandler)(r,e.TriggerEdgeCreationAction.KIND,t.EdgeCreationTool),(0,n.configureDanglingFeedbackEdge)(r)},{featureId:Symbol("edgeCreationTool")}),yg}var _g={},No={},rt={},hj;function L_(){if(hj)return rt;hj=1;var e=rt&&rt.__decorate||function(R,w,T,j){var D=arguments.length,B=D<3?w:j===null?j=Object.getOwnPropertyDescriptor(w,T):j,H;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(R,w,T,j);else for(var F=R.length-1;F>=0;F--)(H=R[F])&&(B=(D<3?H(B):D>3?H(w,T,B):H(w,T))||B);return D>3&&B&&Object.defineProperty(w,T,B),B},n=rt&&rt.__metadata||function(R,w){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(R,w)},t=rt&&rt.__param||function(R,w){return function(T,j){w(T,j,R)}};Object.defineProperty(rt,"__esModule",{value:!0}),rt.drawFeedbackEdgeSource=rt.FeedbackEdgeRouteMovingMouseListener=rt.FeedbackEdgeSourceMovingMouseListener=rt.FeedbackEdgeTargetMovingMouseListener=rt.DrawFeedbackEdgeSourceCommand=rt.DrawFeedbackEdgeSourceAction=rt.SwitchRoutingModeCommand=rt.SwitchRoutingModeAction=rt.HideEdgeReconnectHandlesFeedbackCommand=rt.ShowEdgeReconnectHandlesFeedbackCommand=rt.HideEdgeReconnectHandlesFeedbackAction=rt.ShowEdgeReconnectHandlesFeedbackAction=void 0;const i=Y(),a=G(),o=Jc(),s=Cr(),r=kt(),d=Wo(),l=T_(),c=GP(),u=ul(),f=FP();var h;(function(R){R.KIND="showReconnectHandlesFeedback";function w(j){return i.Action.hasKind(j,R.KIND)}R.is=w;function T(j){return{kind:R.KIND,elementId:j}}R.create=T})(h||(rt.ShowEdgeReconnectHandlesFeedbackAction=h={}));var p;(function(R){R.KIND="hideReconnectHandlesFeedback";function w(j){return i.Action.hasKind(j,R.KIND)}R.is=w;function T(){return{kind:R.KIND}}R.create=T})(p||(rt.HideEdgeReconnectHandlesFeedbackAction=p={}));let g=class extends s.FeedbackCommand{constructor(w){super(),this.action=w}execute(w){const T=w.root.index;(0,r.forEachElement)(T,r.isRoutable,l.removeReconnectHandles);const j=T.getById(this.action.elementId);return j&&(0,r.isRoutable)(j)&&(0,l.addReconnectHandles)(j),w.root}};rt.ShowEdgeReconnectHandlesFeedbackCommand=g,g.KIND=h.KIND,rt.ShowEdgeReconnectHandlesFeedbackCommand=g=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],g);let m=class extends s.FeedbackCommand{constructor(w){super(),this.action=w}execute(w){const T=w.root.index;return(0,r.forEachElement)(T,r.isRoutable,l.removeReconnectHandles),w.root}};rt.HideEdgeReconnectHandlesFeedbackCommand=m,m.KIND=p.KIND,rt.HideEdgeReconnectHandlesFeedbackCommand=m=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],m);var v;(function(R){R.KIND="switchRoutingMode";function w(T){return{...i.SwitchEditModeAction.create(T),kind:R.KIND}}R.create=w})(v||(rt.SwitchRoutingModeAction=v={}));let _=class extends i.SwitchEditModeCommand{constructor(w){super({...w,kind:i.SwitchEditModeAction.KIND})}};rt.SwitchRoutingModeCommand=_,_.KIND=v.KIND,rt.SwitchRoutingModeCommand=_=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],_);var S;(function(R){R.KIND="drawFeedbackEdgeSource";function w(j){return i.Action.hasKind(j,R.KIND)&&(0,i.hasStringProp)(j,"elementTypeId")&&(0,i.hasStringProp)(j,"targetId")}R.is=w;function T(j){return{kind:R.KIND,...j}}R.create=T})(S||(rt.DrawFeedbackEdgeSourceAction=S={}));let E=class extends s.FeedbackCommand{constructor(w){super(),this.action=w}execute(w){return I(w,this.action.targetId,this.action.elementTypeId),w.root}};rt.DrawFeedbackEdgeSourceCommand=E,E.KIND=S.KIND,rt.DrawFeedbackEdgeSourceCommand=E=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],E);class C extends f.FeedbackEdgeEndMovingMouseListener{constructor(w,T){super(w,T)}}rt.FeedbackEdgeTargetMovingMouseListener=C;class M extends i.MouseListener{constructor(w,T){super(),this.anchorRegistry=w,this.feedbackDispatcher=T,this.feedback=T.createEmitter()}mouseMove(w,T){const j=w.root,D=j.index.getById((0,u.feedbackEdgeEndId)(j));if(!(D instanceof u.FeedbackEdgeEnd)||!D.feedbackEdge)return[];const B=D.feedbackEdge,H=(0,d.getAbsolutePosition)(D,T),F=(0,i.findChildrenAtPosition)(w.root,H).find(K=>(0,i.isConnectable)(K)&&K.canConnect(B,"source"));if(F instanceof i.GConnectableElement&&B.target&&(0,i.isBoundsAware)(B.target)){const K=this.computeAbsoluteAnchor(F,i.Bounds.center(B.target.bounds));i.Point.euclideanDistance(K,D.position)>1&&this.feedback.add(i.MoveAction.create([{elementId:D.id,toPosition:K}],{animate:!1})).submit()}else this.feedback.add(i.MoveAction.create([{elementId:D.id,toPosition:H}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(w,T,j){let B=this.anchorRegistry.get(i.PolylineEdgeRouter.KIND,w.anchorKind).getAnchor(w,T,j);if(w.parent!==w.root){const H=(0,i.findParentByFeature)(w.parent,i.isBoundsAware);if(H){const F=(0,d.toAbsoluteBounds)(H);B=i.Point.add(F,B)}}return B}dispose(){this.feedback.dispose()}}rt.FeedbackEdgeSourceMovingMouseListener=M;class L extends o.DragAwareMouseListener{constructor(w,T){super(),this.changeBoundsManager=w,this.edgeRouterRegistry=T,this.tracker=this.changeBoundsManager.createTracker()}mouseDown(w,T){const j=super.mouseDown(w,T);return T.button===0&&((0,i.findParentByFeature)(w,r.isRoutingHandle)!==void 0?(j.push(v.create({elementsToActivate:[w.id]})),this.tracker.startTracking()):this.tracker.dispose()),j}draggingMouseMove(w,T){return super.draggingMouseMove(w,T),this.tracker.isTracking()?this.moveRoutingHandles(w,T):[]}moveRoutingHandles(w,T){const j=this.getRoutingHandlesToMove(w),D=this.tracker.moveElements(j,{snap:T,restrict:T});return D.elementMoves.length===0?[]:(this.tracker.updateTrackingPosition(D),[i.MoveAction.create(D.elementMoves.map(B=>({elementId:B.element.id,toPosition:B.toPosition})),{animate:!1})])}getRoutingHandlesToMove(w){return(0,r.getMatchingElements)(w.root.index,(0,i.typeGuard)(r.isRoutingHandle,i.isSelected)).map(j=>{const D=this.getHandlePosition(j);return D?new c.MoveableRoutingHandle(j,D):void 0}).filter((0,i.toTypeGuard)(c.MoveableRoutingHandle))}getHandlePosition(w){if(this.edgeRouterRegistry){const T=w.parent;if(!(0,r.isRoutable)(T))return;const j=this.edgeRouterRegistry.get(T.routerKind),D=j.route(T);return j.getHandlePosition(T,D,w)}}nonDraggingMouseUp(w,T){return this.tracker.stopTracking(),[]}draggingMouseUp(w,T){return this.tracker.isTracking()?(this.dispose(),[]):[]}dispose(){this.tracker.dispose(),super.dispose()}}rt.FeedbackEdgeRouteMovingMouseListener=L;function I(R,w,T){const j=R.root,D=j.index.getById(w);if(!D)return;const B=(0,i.findParentByFeature)(D,i.isConnectable);if(!B||!(0,i.isBoundsAware)(B))return;const H=new u.FeedbackEdgeEnd(B.id,T);H.id=(0,u.feedbackEdgeEndId)(j),H.position={x:B.bounds.x,y:B.bounds.y};const F={type:"edge",id:(0,u.feedbackEdgeId)(j),sourceId:H.id,targetId:B.id,opacity:.3},K=R.modelFactory.createElement(F);(0,r.isRoutable)(K)&&(H.feedbackEdge=K,j.add(H),j.add(K))}return rt.drawFeedbackEdgeSource=I,rt}var pj;function b6(){if(pj)return No;pj=1;var e=No&&No.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},n=No&&No.__metadata||function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},t;Object.defineProperty(No,"__esModule",{value:!0}),No.EdgeEditListener=No.EdgeEditTool=void 0;const i=Y(),a=G(),o=Jc(),s=Un(),r=Er(),d=kt(),l=T_(),c=Wa(),u=ul(),f=L_();let h=t=class extends c.BaseEditTool{get id(){return t.ID}enable(){this.edgeEditListener=new p(this),this.feedbackEdgeSourceMovingListener=new f.FeedbackEdgeSourceMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackEdgeTargetMovingListener=new f.FeedbackEdgeTargetMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackMovingListener=new f.FeedbackEdgeRouteMovingMouseListener(this.changeBoundsManager,this.edgeRouterRegistry),this.toDisposeOnDisable.push(this.edgeEditListener,this.mouseTool.registerListener(this.edgeEditListener),this.feedbackEdgeSourceMovingListener,this.feedbackEdgeTargetMovingListener,this.feedbackMovingListener,this.selectionService.addListener(this.edgeEditListener))}registerFeedbackListeners(){this.mouseTool.register(this.feedbackMovingListener),this.mouseTool.register(this.feedbackEdgeSourceMovingListener),this.mouseTool.register(this.feedbackEdgeTargetMovingListener)}deregisterFeedbackListeners(){this.feedbackEdgeSourceMovingListener.dispose(),this.feedbackEdgeTargetMovingListener.dispose(),this.mouseTool.deregister(this.feedbackEdgeSourceMovingListener),this.mouseTool.deregister(this.feedbackEdgeTargetMovingListener),this.mouseTool.deregister(this.feedbackMovingListener)}};No.EdgeEditTool=h,h.ID="glsp.edge-edit-tool",e([(0,a.inject)(r.SelectionService),n("design:type",r.SelectionService)],h.prototype,"selectionService",void 0),e([(0,a.inject)(i.AnchorComputerRegistry),n("design:type",i.AnchorComputerRegistry)],h.prototype,"anchorRegistry",void 0),e([(0,a.inject)(i.EdgeRouterRegistry),(0,a.optional)(),n("design:type",i.EdgeRouterRegistry)],h.prototype,"edgeRouterRegistry",void 0),e([(0,a.inject)(i.TYPES.IChangeBoundsManager),n("design:type",Object)],h.prototype,"changeBoundsManager",void 0),No.EdgeEditTool=h=t=e([(0,a.injectable)()],h);class p extends o.DragAwareMouseListener{constructor(m){super(),this.tool=m,this.cursorFeedback=this.tool.createFeedbackEmitter(),this.editFeedback=this.tool.createFeedbackEmitter()}isValidEdge(m){return m!==void 0&&m.id!==(0,u.feedbackEdgeId)(m.root)&&(0,i.isSelected)(m)}setEdgeSelected(m){this.edge=m,(0,i.canEditRouting)(m)&&this.editFeedback.add(f.SwitchRoutingModeAction.create({elementsToActivate:[this.edge.id]}),f.SwitchRoutingModeAction.create({elementsToDeactivate:[this.edge.id]})),(0,l.isReconnectable)(m)&&this.editFeedback.add(f.ShowEdgeReconnectHandlesFeedbackAction.create(this.edge.id),f.HideEdgeReconnectHandlesFeedbackAction.create()),this.editFeedback.submit()}isEdgeSelected(){return this.edge!==void 0&&(0,i.isSelected)(this.edge)}setReconnectHandleSelected(m,v){this.edge&&this.edge.target&&this.edge.source&&(this.editFeedback.dispose(),(0,l.isSourceRoutingHandle)(m,v)?(this.editFeedback.add((0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_RECONNECT),(0,s.cursorFeedbackAction)()).add(f.DrawFeedbackEdgeSourceAction.create({elementTypeId:this.edge.type,targetId:this.edge.targetId}),u.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_SOURCE"):(0,l.isTargetRoutingHandle)(m,v)&&(this.editFeedback.add((0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_CREATION_TARGET),(0,s.cursorFeedbackAction)()).add(u.DrawFeedbackEdgeAction.create({elementTypeId:this.edge.type,sourceId:this.edge.sourceId}),u.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_TARGET"))}isReconnecting(){return this.reconnectMode!==void 0}isReconnectingNewSource(){return this.reconnectMode==="NEW_SOURCE"}setRoutingHandleSelected(m,v){this.edge&&this.edge.target&&this.edge.source&&(this.routingHandle=v)}requiresReconnect(m,v){return this.edge!==void 0&&(this.edge.sourceId!==m||this.edge.targetId!==v)}setNewConnectable(m){this.newConnectable=m}isReadyToReconnect(){return this.edge&&this.isReconnecting()&&this.newConnectable!==void 0}isReadyToReroute(){return this.routingHandle!==void 0}mouseDown(m,v){const _=super.mouseDown(m,v);if(v.button===0){const S=(0,i.findParentByFeature)(m,l.isReconnectHandle),E=S?void 0:(0,i.findParentByFeature)(m,d.isRoutingHandle),C=(0,i.findParentByFeature)(m,d.isRoutable);this.isEdgeSelected()&&C&&S?this.setReconnectHandleSelected(C,S):this.isEdgeSelected()&&C&&E?this.setRoutingHandleSelected(C,E):this.isValidEdge(C)&&(this.dispose(),this.tool.registerFeedbackListeners(),this.setEdgeSelected(C))}else v.button===2&&this.dispose();return _}draggingMouseMove(m,v){return this.setNewConnectable(void 0),super.draggingMouseMove(m,v)}mouseUp(m,v){const _=super.mouseUp(m,v);if(!this.isReadyToReconnect()&&!this.isReadyToReroute())return _;if(this.edge&&this.newConnectable){const S=this.isReconnectingNewSource()?this.newConnectable.id:this.edge.sourceId,E=this.isReconnectingNewSource()?this.edge.targetId:this.newConnectable.id;this.requiresReconnect(S,E)&&_.push(i.ReconnectEdgeOperation.create({edgeElementId:this.edge.id,sourceElementId:S,targetElementId:E})),this.dispose()}else if(this.edge&&this.routingHandle){const S=m.index.getById(this.edge.id);if(S&&(0,d.isRoutable)(S)){const E=(0,d.calcElementAndRoutingPoints)(S,this.tool.edgeRouterRegistry);_.push(i.ChangeRoutingPointsOperation.create([E])),this.routingHandle=void 0}}return _}mouseOver(m,v){if(this.edge&&this.isReconnecting()){const _=(0,i.findParentByFeature)(m,i.isConnectable);if(!this.newConnectable||_!==this.newConnectable){if(this.setNewConnectable(_),_&&(this.reconnectMode==="NEW_SOURCE"&&_.canConnect(this.edge,"source")||this.reconnectMode==="NEW_TARGET"&&_.canConnect(this.edge,"target")))return this.cursorFeedback.add((0,s.cursorFeedbackAction)(s.CursorCSS.EDGE_RECONNECT),(0,s.cursorFeedbackAction)()).submit(),[];this.cursorFeedback.add((0,s.cursorFeedbackAction)(s.CursorCSS.OPERATION_NOT_ALLOWED),(0,s.cursorFeedbackAction)()).submit()}}return[]}selectionChanged(m,v){if(this.edge){if(v.indexOf(this.edge.id)>-1||this.isReconnecting())return;for(const _ of v.reverse()){const S=m.index.getById(_);if(S){const E=(0,i.findParentByFeature)(S,d.isRoutable);if(this.isValidEdge(E)){this.setEdgeSelected(E);return}}}this.dispose()}}dispose(){this.edge=void 0,this.reconnectMode=void 0,this.newConnectable=void 0,this.routingHandle=void 0,this.cursorFeedback.dispose(),this.editFeedback.dispose(),this.tool.deregisterFeedbackListeners(),super.dispose()}}return No.EdgeEditListener=p,No}var gj;function S6(){if(gj)return _g;gj=1,Object.defineProperty(_g,"__esModule",{value:!0}),_g.edgeEditToolModule=void 0;const e=Y(),n=ul(),t=b6(),i=L_();return _g.edgeEditToolModule=new e.FeatureModule((a,o,s,r)=>{const d={bind:a,unbind:o,isBound:s,rebind:r};(0,e.bindAsService)(d,e.TYPES.IDefaultTool,t.EdgeEditTool),(0,e.configureCommand)(d,i.ShowEdgeReconnectHandlesFeedbackCommand),(0,e.configureCommand)(d,i.HideEdgeReconnectHandlesFeedbackCommand),(0,e.configureCommand)(d,i.DrawFeedbackEdgeSourceCommand),(0,e.configureCommand)(d,i.SwitchRoutingModeCommand),(0,n.configureDanglingFeedbackEdge)(d)},{featureId:Symbol("edgeEditTool")}),_g}var bg={},Hr={},mj;function E6(){if(mj)return Hr;mj=1;var e=Hr&&Hr.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=Hr&&Hr.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)},t;Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.MarqueeKeyListener=Hr.MarqueeTool=void 0;const i=Y(),a=G(),o=Er(),s=an(),r=Wa(),d=dh();let l=t=class extends r.BaseEditTool{get id(){return t.ID}enable(){this.marqueeKeyListener||(this.marqueeKeyListener=new c(this.selectionService)),this.toDisposeOnDisable.push(this.keyTool.registerListener(this.marqueeKeyListener))}};Hr.MarqueeTool=l,l.ID="glsp.marquee-tool",e([(0,a.inject)(o.SelectionService),n("design:type",o.SelectionService)],l.prototype,"selectionService",void 0),Hr.MarqueeTool=l=t=e([(0,a.injectable)()],l);let c=class extends i.KeyListener{constructor(f){super(),this.selectionService=f}keyDown(f,h){return h.shiftKey&&!this.selectionService.hasSelectedElements()?[s.EnableToolsAction.create([d.MarqueeMouseTool.ID])]:[]}};return Hr.MarqueeKeyListener=c,Hr.MarqueeKeyListener=c=e([(0,a.injectable)(),n("design:paramtypes",[o.SelectionService])],c),Hr}var Sg={},vj;function C6(){if(vj)return Sg;vj=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.MarqueeNode=void 0;const e=Y();class n extends e.RectangularNode{}return Sg.MarqueeNode=n,n.DEFAULT_FEATURES=[e.boundsFeature],Sg}var zu={},yj;function P6(){if(yj)return zu;yj=1;var e=zu&&zu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(zu,"__esModule",{value:!0}),zu.MarqueeView=void 0;const n=Y(),t=G();let i=class extends n.RectangularNodeView{render(o,s){return(0,n.svg)("g",null,(0,n.svg)("rect",{"class-sprotty-node":!0,"class-marquee":!0,x:o.startPoint.x-o.endPoint.x<=0?o.startPoint.x:o.endPoint.x,y:o.startPoint.y-o.endPoint.y<=0?o.startPoint.y:o.endPoint.y,rx:0,ry:0,width:Math.abs(o.startPoint.x-o.endPoint.x),height:Math.abs(o.startPoint.y-o.endPoint.y)}))}};return zu.MarqueeView=i,zu.MarqueeView=i=e([(0,t.injectable)()],i),zu}var _j;function R6(){if(_j)return bg;_j=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.marqueeSelectionToolModule=void 0;const e=Y(),n=dh(),t=E6(),i=O_(),a=C6(),o=P6(),s=HP();return bg.marqueeSelectionToolModule=new e.FeatureModule((r,d,l,c)=>{const u={bind:r,unbind:d,isBound:l,rebind:c};u.bind(s.MarqueeUtil).toSelf().inSingletonScope(),(0,e.bindAsService)(u,e.TYPES.IDefaultTool,t.MarqueeTool),(0,e.bindAsService)(u,e.TYPES.ITool,n.MarqueeMouseTool),(0,e.configureCommand)(u,i.DrawMarqueeCommand),(0,e.configureCommand)(u,i.RemoveMarqueeCommand),(0,e.configureModelElement)(u,i.MARQUEE,a.MarqueeNode,o.MarqueeView)},{featureId:Symbol("marqueeSelectionTool")}),bg}var Eg={},ad={},bj;function UP(){return bj||(bj=1,function(e){var n=ad&&ad.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},t=ad&&ad.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)};Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerManager=e.DEFAULT_INSERT_OPTIONS=void 0;const i=Y(),a=G(),o=Un(),s=Um();e.DEFAULT_INSERT_OPTIONS={validateLocationInContainer:!1};let r=class{insert(l,c,u,f){var h;const p={...e.DEFAULT_INSERT_OPTIONS,...f},g=this.findContainer(c,l,f==null?void 0:f.evt);let m=this.isCreationAllowed(g,u,f);return m&&(!g||p.validateLocationInContainer)&&(m=(h=f==null?void 0:f.validLocationOverwrite)!==null&&h!==void 0?h:this.changeBoundsManager.hasValidPosition(l,c)),{elementTypeId:u,container:g,location:c,valid:m,options:p}}isCreationAllowed(l,c,u){return!l||l.isContainableElement(c)}findContainer(l,c,u){return(0,i.findChildrenAtPosition)(c.root,l).reverse().find(f=>{var h;return(0,s.isContainable)(f)&&!(!((h=f.cssClasses)===null||h===void 0)&&h.includes(o.CSS_GHOST_ELEMENT))})}addInsertFeedback(l,c,u,f){return c.valid?l.add((0,o.cursorFeedbackAction)(o.CursorCSS.NODE_CREATION),(0,o.cursorFeedbackAction)()):l.add((0,o.cursorFeedbackAction)(o.CursorCSS.OPERATION_NOT_ALLOWED),(0,o.cursorFeedbackAction)(o.CursorCSS.DEFAULT)),l}};e.ContainerManager=r,n([(0,a.inject)(i.TYPES.IChangeBoundsManager),t("design:type",Object)],r.prototype,"changeBoundsManager",void 0),e.ContainerManager=r=n([(0,a.injectable)()],r)}(ad)),ad}var dr={},Cg={},Sj;function M6(){if(Sj)return Cg;Sj=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.MouseTrackingElementPositionListener=void 0;const e=Y(),n=Jc(),t=Un(),i=Wo(),a=af();class o extends n.DragAwareMouseListener{constructor(r,d,l="top-left",c){super(),this.elementId=r,this.tool=d,this.cursorPosition=l,this.editorContext=c,this.toDispose=new e.DisposableCollection,this.tracker=this.tool.changeBoundsManager.createTracker(),this.moveGhostFeedback=this.tool.createFeedbackEmitter(),this.toDispose.push(this.moveGhostFeedback);const u=c==null?void 0:c.onModelRootChanged(f=>this.modelRootChanged(f));u&&this.toDispose.push(u)}getTrackedElement(r,d){const l=r.root.index.getById(this.elementId);return!l||!(0,e.isMoveable)(l)?void 0:l}mouseMove(r,d){super.mouseMove(r,d);const l=this.getTrackedElement(r,d);if(!l)return[];const c=!this.tracker.isTracking();c&&this.initialize(l,r,d);const u=this.tracker.moveElements([l],{snap:d,restrict:d,skipStatic:!c}),f=u.elementMoves[0];return f?(this.moveGhostFeedback.add(e.MoveAction.create([{elementId:this.elementId,toPosition:f.toPosition}],{animate:!1}),a.MoveFinishedEventAction.create()),this.addMoveFeedback(u,r,d),this.moveGhostFeedback.submit(),this.tracker.updateTrackingPosition(f.moveVector),[]):[]}initialize(r,d,l){this.tracker.startTracking(),r.position=this.initializeElementPosition(r,d,l)}initializeElementPosition(r,d,l){const c=(0,i.getAbsolutePosition)(d,l);return this.cursorPosition==="middle"&&(0,e.isBoundsAware)(r)?e.Point.subtract(c,e.Dimension.center(r.bounds)):c}addMoveFeedback(r,d,l){this.moveGhostFeedback.add(t.ModifyCSSFeedbackAction.create({elements:[this.elementId],remove:[t.CSS_HIDDEN]})),this.tool.changeBoundsManager.addMoveFeedback(this.moveGhostFeedback,r,d,l)}modelRootChanged(r){this.tracker.stopTracking()}dispose(){this.toDispose.dispose(),super.dispose()}}return Cg.MouseTrackingElementPositionListener=o,Cg}var Ej;function A6(){if(Ej)return dr;Ej=1;var e=dr&&dr.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=dr&&dr.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)},t;Object.defineProperty(dr,"__esModule",{value:!0}),dr.NodeCreationToolMouseListener=dr.NodeInsertTrackingListener=dr.NodeCreationTool=void 0;const i=Y(),a=G(),o=Jc(),s=Un(),r=an(),d=I_(),l=M6(),c=NP(),u=Wa(),f=Zm();let h=t=class extends u.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=i.TriggerNodeCreationAction.is}get id(){return t.ID}doEnable(){var v;const _=(v=this.triggerAction.ghostElement)!==null&&v!==void 0?v:{template:this.modelFactory.createSchema(this.createInsertIndicator())};this.toDisposeOnDisable.push(this.createGhostElementTracker(_,"middle")),this.toDisposeOnDisable.push(this.createNodeCreationListener(_)),this.toDisposeOnDisable.push(this.createNodeCreationCursorFeedback().submit())}createInsertIndicator(){return new f.InsertIndicator}createGhostElementTracker(v,_){const S=new p((0,d.getTemplateElementId)(v.template),this.triggerAction.elementTypeId,this,_,this.editorContext);return new i.DisposableCollection(S,this.mouseTool.registerListener(S))}createNodeCreationListener(v){const _=new g(this.triggerAction,this,v);return new i.DisposableCollection(_,this.mouseTool.registerListener(_))}createNodeCreationCursorFeedback(){return this.createFeedbackEmitter().add((0,s.cursorFeedbackAction)(s.CursorCSS.NODE_CREATION),(0,s.cursorFeedbackAction)())}};dr.NodeCreationTool=h,h.ID="tool_create_node",e([(0,a.inject)(i.TYPES.IChangeBoundsManager),n("design:type",Object)],h.prototype,"changeBoundsManager",void 0),e([(0,a.inject)(i.TYPES.IContainerManager),n("design:type",Object)],h.prototype,"containerManager",void 0),e([(0,a.inject)(i.TYPES.IModelFactory),n("design:type",Object)],h.prototype,"modelFactory",void 0),dr.NodeCreationTool=h=t=e([(0,a.injectable)()],h);class p extends l.MouseTrackingElementPositionListener{constructor(v,_,S,E="top-left",C){super(v,S,E,C),this.elementTypeId=_,this.tool=S}addMoveFeedback(v,_,S){super.addMoveFeedback(v,_,S);const E=v.elementMoves[0].element,C=v.elementMoves[0].toPosition,M=this.tool.containerManager.insert(E,C,this.elementTypeId,{evt:S});this.tool.containerManager.addInsertFeedback(this.moveGhostFeedback,M,_,S)}}dr.NodeInsertTrackingListener=p;class g extends o.DragAwareMouseListener{constructor(v,_,S){super(),this.triggerAction=v,this.tool=_,this.ghostElement=S,this.cursorFeedback=_.createFeedbackEmitter(),this.ghostElementFeedback=_.createFeedbackEmitter(),this.ghostElementId=(0,d.getTemplateElementId)(S.template),this.createGhostElement(S)}get elementTypeId(){return this.triggerAction.elementTypeId}nonDraggingMouseUp(v,_){const S=[],E=this.getTrackedInsert(v,_);return E.valid&&S.push(this.getCreateOperation(v,_,E)),this.isContinuousMode(v,_)?(this.disposeAllButGhostElement(),S):(E.valid?this.ghostElementFeedback.discard():this.dispose(),S.push(r.EnableDefaultToolsAction.create()),S)}isContinuousMode(v,_){return(0,i.isCtrlOrCmd)(_)}getCreateOperation(v,_,S){var E;return i.CreateNodeOperation.create(this.elementTypeId,{location:S.location,containerId:(E=S.container)===null||E===void 0?void 0:E.id,args:this.getCreateNodeOperationArgs(S,v,_)})}getCreateNodeOperationArgs(v,_,S){let E={...this.triggerAction.args};const C=this.getGhostElement(_,S);if(C){const M=(0,i.isBoundsAware)(C)?i.Bounds.dimension(C.bounds):i.Dimension.ZERO;E={...E,"ghost-x":C.position.x,"ghost-y":C.position.y,"ghost-width":M.width,"ghost-height":M.height}}return E}createGhostElement(v){const _=[v.template];return this.ghostElementFeedback.add(d.AddTemplateElementsAction.create({templates:_,addClasses:[s.CSS_HIDDEN,s.CSS_GHOST_ELEMENT]}),c.RemoveTemplateElementsAction.create({templates:_})),this.ghostElementFeedback.submit(),(0,d.getTemplateElementId)(v.template)}getGhostElement(v,_){const S=v.index.getById(this.ghostElementId);return S&&(0,i.isMoveable)(S)?S:void 0}getTrackedInsert(v,_){const S=this.getGhostElement(v,_);return S?this.tool.containerManager.insert(S,S.position,this.elementTypeId,{evt:_}):{elementTypeId:this.elementTypeId,location:i.Point.ORIGIN,valid:!1,options:{evt:_}}}disposeAllButGhostElement(){super.dispose()}dispose(){this.ghostElementFeedback.dispose(),this.disposeAllButGhostElement()}}return dr.NodeCreationToolMouseListener=g,dr}var ma={},Oc={},Cj;function j_(){if(Cj)return Oc;Cj=1,Object.defineProperty(Oc,"__esModule",{value:!0}),Oc.CornerRadius=Oc.EdgePadding=Oc.GArgument=void 0;const e=Vm();var n;(function(a){function o(E){return typeof E=="number"?E:void 0}a.asNumber=o;function s(E){return E.map(o)}a.asNumbers=s;function r(E){return typeof E=="string"?E:void 0}a.asString=r;function d(E){return E.map(r)}a.asStrings=d;function l(E){return typeof E=="boolean"?E:void 0}a.asBoolean=l;function c(E){return E.map(l)}a.asBooleans=c;function u(E,C){return(0,e.hasArgs)(E)?E.args[C]:void 0}a.getArgument=u;function f(E,C){return(0,e.hasArgs)(E)?o(E.args[C]):void 0}a.getNumber=f;function h(E,C){return(0,e.hasArgs)(E)?r(E.args[C]):void 0}a.getString=h;function p(E,C){return(0,e.hasArgs)(E)?l(E.args[C]):void 0}a.getBoolean=p;function g(E,...C){if(!(0,e.hasArgs)(E))return;const M=[];for(const L of C){const I=E.args[L];I&&M.push(I)}return M}a.getArguments=g;function m(E,...C){const M=g(E,...C);return M?s(M):void 0}a.getNumbers=m;function v(E,...C){const M=g(E,...C);return M?d(M):void 0}a.getStrings=v;function _(E,...C){const M=g(E,...C);return M?c(M):void 0}a.getBooleans=_;function S(E,C){return E.length===C&&E.filter(M=>M===void 0).length===0}a.hasNValues=S})(n||(Oc.GArgument=n={}));var t;(function(a){const o="edgePadding";function s(r){return n.getNumber(r,o)}a.from=s})(t||(Oc.EdgePadding=t={}));class i{constructor(o=0,s=o,r=o,d=s){this.topLeft=o,this.topRight=s,this.bottomRight=r,this.bottomLeft=d}static from(o){const s=n.getNumbers(o,this.KEY_RADIUS_TOP_LEFT,this.KEY_RADIUS_TOP_RIGHT,this.KEY_RADIUS_BOTTOM_RIGHT,this.KEY_RADIUS_BOTTOM_LEFT);if(!(s===void 0||s[0]===void 0))return n.hasNValues(s,4)?new i(s[0],s[1],s[2],s[3]):new i(s[0])}}return Oc.CornerRadius=i,i.NO_RADIUS=new i(0),i.KEY_RADIUS_TOP_LEFT="radiusTopLeft",i.KEY_RADIUS_TOP_RIGHT="radiusTopRight",i.KEY_RADIUS_BOTTOM_RIGHT="radiusBottomRight",i.KEY_RADIUS_BOTTOM_LEFT="radiusBottomLeft",Oc}var Pj;function w6(){if(Pj)return ma;Pj=1;var e=ma&&ma.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ma&&ma.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(ma,"__esModule",{value:!0}),ma.InsertIndicatorView=void 0;const t=Y(),i=G(),a=j_(),o=Zm();let s=class{render(d,l){if(l.targetKind==="hidden")return;const c=this.getSize(d),u=(0,t.svg)("g",null,(0,t.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`0,${-c/2} 0,${c/2}`}),(0,t.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`${-c/2},0 ${c/2},0`}));return d.cssClasses.forEach(f=>(0,t.setClass)(u,f,!0)),u}getSize(d){var l,c,u;return(u=(l=a.GArgument.getNumber(d,o.ARG_LENGTH))!==null&&l!==void 0?l:(c=this.grid)===null||c===void 0?void 0:c.x)!==null&&u!==void 0?u:10}};return ma.InsertIndicatorView=s,e([(0,i.optional)(),(0,i.inject)(t.TYPES.Grid),n("design:type",Object)],s.prototype,"grid",void 0),ma.InsertIndicatorView=s=e([(0,i.injectable)()],s),ma}var Rj;function I6(){if(Rj)return Eg;Rj=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.nodeCreationToolModule=void 0;const e=Y(),n=BP(),t=UP(),i=Zm(),a=A6(),o=w6();return Eg.nodeCreationToolModule=new e.FeatureModule((s,r,d,l)=>{const c={bind:s,unbind:r,isBound:d,rebind:l};(0,e.bindAsService)(c,e.TYPES.IContainerManager,t.ContainerManager),(0,e.bindAsService)(c,e.TYPES.ITool,a.NodeCreationTool),(0,e.configureActionHandler)(c,e.TriggerNodeCreationAction.KIND,a.NodeCreationTool),(0,e.configureModelElement)(c,i.InsertIndicator.TYPE,i.InsertIndicator,o.InsertIndicatorView)},{featureId:Symbol("nodeCreationTool"),requires:n.elementTemplateModule}),Eg}var va={},Mj;function T6(){if(Mj)return va;Mj=1;var e=va&&va.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(va,"__esModule",{value:!0}),va.toolFocusLossModule=va.EnableDefaultToolsOnFocusLossHandler=void 0;const n=Y(),t=G(),i=of(),a=an();let o=class{handle(r){if(i.FocusStateChangedAction.is(r)&&!r.hasFocus)return a.EnableDefaultToolsAction.create()}};return va.EnableDefaultToolsOnFocusLossHandler=o,va.EnableDefaultToolsOnFocusLossHandler=o=e([(0,t.injectable)()],o),va.toolFocusLossModule=new n.FeatureModule((s,r,d)=>{(0,n.configureActionHandler)({bind:s,isBound:d},i.FocusStateChangedAction.KIND,o)},{featureId:Symbol("toolFocusLoss ")}),va}var pS={},Gt={},cd={},Aj;function D6(){if(Aj)return cd;Aj=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.collectIssueMarkers=cd.MarkerPredicates=void 0;const e=Y(),n=$m();var t;(function(a){a.ALL=()=>!0,a.ERRORS=s=>o(s,e.MarkerKind.ERROR),a.WARNINGS=s=>o(s,e.MarkerKind.WARNING),a.INFOS=s=>o(s,e.MarkerKind.INFO);function o(s,r){return s.issues.find(d=>d.severity===r)!==void 0}a.hasIssueWithSeverity=o})(t||(cd.MarkerPredicates=t={}));function i(a){const o=[];for(const s of a.children)s instanceof n.GIssueMarker&&o.push(s),o.push(...i(s));return o}return cd.collectIssueMarkers=i,cd}var wj;function O6(){if(wj)return Gt;wj=1;var e=Gt&&Gt.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=Gt&&Gt.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)};Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.MarkerNavigatorKeyListener=Gt.MarkerNavigatorContextMenuItemProvider=Gt.NavigateToMarkerActionHandler=Gt.MarkerNavigator=Gt.LeftToRightTopToBottomComparator=Gt.GModelElementComparator=Gt.NavigateToMarkerAction=void 0;const t=Y(),i=G(),a=Er(),o=kt(),s=D6();var r;(function(p){p.KIND="navigateToMarker";function g(v){return t.Action.hasKind(v,p.KIND)&&(0,t.hasStringProp)(v,"direction")&&(0,t.hasArrayProp)(v,"severities")}p.is=g;function m(v){return{kind:p.KIND,direction:"next",severities:c.ALL_SEVERITIES,...v}}p.create=m})(r||(Gt.NavigateToMarkerAction=r={}));class d{compare(g,m){return 0}}Gt.GModelElementComparator=d;let l=class{compare(g,m){const v=(0,t.findParentByFeature)(g,o.isSelectableAndBoundsAware),_=(0,t.findParentByFeature)(m,o.isSelectableAndBoundsAware);if(v&&_){if(v.bounds.y!==_.bounds.y)return v.bounds.y-_.bounds.y;if(v.bounds.x!==_.bounds.x)return v.bounds.x-_.bounds.x}return 0}};Gt.LeftToRightTopToBottomComparator=l,Gt.LeftToRightTopToBottomComparator=l=e([(0,i.injectable)()],l);let c=class{next(g,m,v=s.MarkerPredicates.ALL){const _=this.getMarkers(g,v);return m===void 0?_.length>0?_[0]:void 0:_[this.getNextIndex(m,_)%_.length]}previous(g,m,v=s.MarkerPredicates.ALL){const _=this.getMarkers(g,v);return m===void 0?_.length>0?_[0]:void 0:_[this.getPreviousIndex(m,_)%_.length]}getMarkers(g,m){return(0,s.collectIssueMarkers)(g).filter(m).sort(this.markerComparator.compare)}getNextIndex(g,m){for(let v=0;v<m.length;v++)if(this.markerComparator.compare(m[v],g)>0)return v;return 0}getPreviousIndex(g,m){for(let v=m.length-1;v>=0;v--)if(this.markerComparator.compare(m[v],g)<0)return v;return m.length-1}};Gt.MarkerNavigator=c,c.ALL_SEVERITIES=["error","warning","info"],e([(0,i.inject)(d),n("design:type",d)],c.prototype,"markerComparator",void 0),Gt.MarkerNavigator=c=e([(0,i.injectable)()],c);let u=class{handle(g){const m=this.getSelectedElements(g),v=this.getTarget(g,m),_=v?(0,t.findParentByFeature)(v,t.isSelectable):void 0;if(_){const S=m.map(E=>E.id).filter(E=>E!==_.id);this.actionDispatcher.dispatch(t.SelectAction.create({selectedElementsIDs:[_.id],deselectedElementsIDs:S})),this.actionDispatcher.dispatch(t.CenterAction.create([_.id]))}}getSelectedElements(g){return g.selectedElementIds&&g.selectedElementIds.length>0?(0,o.getElements)(this.selectionService.getModelRoot().index,g.selectedElementIds,t.isSelectable):this.selectionService.getSelectedElements()}getTarget(g,m){const v=this.selectionService.getModelRoot(),_=m.sort(this.markerComparator.compare).find(t.isBoundsAware);return g.direction==="previous"?this.markerNavigator.previous(v,_,S=>this.matchesSeverities(g,S)):this.markerNavigator.next(v,_,S=>this.matchesSeverities(g,S))}matchesSeverities(g,m){return m.issues.find(v=>g.severities.includes(v.severity))!==void 0}};Gt.NavigateToMarkerActionHandler=u,e([(0,i.inject)(d),n("design:type",d)],u.prototype,"markerComparator",void 0),e([(0,i.inject)(c),n("design:type",c)],u.prototype,"markerNavigator",void 0),e([(0,i.inject)(a.SelectionService),n("design:type",a.SelectionService)],u.prototype,"selectionService",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],u.prototype,"actionDispatcher",void 0),Gt.NavigateToMarkerActionHandler=u=e([(0,i.injectable)()],u);let f=class{getItems(g,m){const v=Array.from(this.selectionService.getSelectedElementIDs()),_=(0,s.collectIssueMarkers)(g).length>0;return Promise.resolve([{id:"navigate",label:"Go to",group:"navigate",actions:[],children:[{id:"next-marker",label:"Next marker",group:"marker",actions:[r.create({direction:"next",selectedElementIds:v})],isEnabled:()=>_},{id:"previous-marker",label:"Previous marker",group:"marker",actions:[r.create({direction:"previous",selectedElementIds:v})],isEnabled:()=>_}]}])}};Gt.MarkerNavigatorContextMenuItemProvider=f,e([(0,i.inject)(a.SelectionService),n("design:type",a.SelectionService)],f.prototype,"selectionService",void 0),Gt.MarkerNavigatorContextMenuItemProvider=f=e([(0,i.injectable)()],f);let h=class extends t.KeyListener{keyDown(g,m){return(0,t.matchesKeystroke)(m,"Period","ctrl")?[r.create({direction:"next"})]:(0,t.matchesKeystroke)(m,"Comma","ctrl")?[r.create({direction:"previous"})]:[]}};return Gt.MarkerNavigatorKeyListener=h,Gt.MarkerNavigatorKeyListener=h=e([(0,i.injectable)()],h),Gt}var zt={},Ij;function L6(){if(Ij)return zt;Ij=1;var e=zt&&zt.__decorate||function(v,_,S,E){var C=arguments.length,M=C<3?_:E===null?E=Object.getOwnPropertyDescriptor(_,S):E,L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")M=Reflect.decorate(v,_,S,E);else for(var I=v.length-1;I>=0;I--)(L=v[I])&&(M=(C<3?L(M):C>3?L(_,S,M):L(_,S))||M);return C>3&&M&&Object.defineProperty(_,S,M),M},n=zt&&zt.__metadata||function(v,_){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,_)},t=zt&&zt.__param||function(v,_){return function(S,E){_(S,E,v)}};Object.defineProperty(zt,"__esModule",{value:!0}),zt.DeleteMarkersCommand=zt.ApplyMarkersCommand=zt.ApplyMarkersAction=zt.SetMarkersActionHandler=zt.ExternalMarkerManager=zt.ValidationFeedbackEmitter=void 0;const i=Y(),a=G(),o=kn(),s=Cr(),r=kt(),d=$m();let l=class{constructor(){this.registeredFeedbackByReason=new Map}registerValidationFeedbackAction(_,S=""){var E,C;const M=(C=(E=this.registeredFeedbackByReason.get(S))===null||E===void 0?void 0:E.dispose())!==null&&C!==void 0?C:this.feedbackActionDispatcher.createEmitter();M.add(_,()=>i.DeleteMarkersAction.create(_.markers)).submit(),this.registeredFeedbackByReason.set(S,M)}};zt.ValidationFeedbackEmitter=l,e([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],l.prototype,"feedbackActionDispatcher",void 0),zt.ValidationFeedbackEmitter=l=e([(0,a.injectable)()],l);let c=class{connect(_){this.actionDispatcher=_}removeMarkers(_){this.actionDispatcher&&this.actionDispatcher.dispatch(i.DeleteMarkersAction.create(_))}};zt.ExternalMarkerManager=c,zt.ExternalMarkerManager=c=e([(0,a.injectable)()],c);let u=class{handle(_){const S=_.markers;this.setMarkers(S,_.reason)}async setMarkers(_,S){var E;const C=this.editorContextService.sourceUri;(E=this.externalMarkerManager)===null||E===void 0||E.setMarkers(_,S,C);const M=f.create(_);this.validationFeedbackEmitter.registerValidationFeedbackAction(M,S)}};zt.SetMarkersActionHandler=u,e([(0,a.inject)(l),n("design:type",l)],u.prototype,"validationFeedbackEmitter",void 0),e([(0,a.inject)(c),(0,a.optional)(),n("design:type",c)],u.prototype,"externalMarkerManager",void 0),e([(0,a.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],u.prototype,"editorContextService",void 0),zt.SetMarkersActionHandler=u=e([(0,a.injectable)()],u);var f;(function(v){v.KIND="applyMarkers";function _(E){return i.Action.hasKind(E,v.KIND)&&(0,i.hasArrayProp)(E,"markers")}v.is=_;function S(E){return{kind:v.KIND,markers:E}}v.create=S})(f||(zt.ApplyMarkersAction=f={}));let h=class extends s.FeedbackCommand{constructor(_){super(),this.action=_}execute(_){return this.action.markers.forEach(S=>{const E=_.root.index.getById(S.elementId);if(E instanceof i.GParentElement){const C=(0,d.getOrCreateGIssueMarker)(E),M=(0,d.createGIssue)(S);C.issues.push(M),C instanceof d.GIssueMarker&&C.computeProjectionCssClasses(),p(E,C)}}),_.root}};zt.ApplyMarkersCommand=h,h.KIND=f.KIND,zt.ApplyMarkersCommand=h=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],h);function p(v,_){const S=(0,d.getSeverity)(_);v.cssClasses?(v.cssClasses=v.cssClasses.filter(E=>!E.match("info|warning|error")),v.cssClasses.push(S)):v.cssClasses=[S]}function g(v,_){const S=(0,d.getSeverity)(_);(0,r.removeCssClasses)(v,[S])}let m=class extends s.FeedbackCommand{constructor(_){super(),this.action=_}execute(_){return this.action.markers.forEach(S=>{const E=_.root.index.getById(S.elementId);if(E instanceof i.GParentElement){const C=(0,d.getGIssueMarker)(E);if(C){g(E,C);for(let M=0;M<C.issues.length;++M)C.issues[M].message===S.description&&C.issues.splice(M--,1);C.issues.length===0?E.remove(C):p(E,C)}}}),_.root}};return zt.DeleteMarkersCommand=m,m.KIND=i.DeleteMarkersAction.KIND,zt.DeleteMarkersCommand=m=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],m),zt}var Tj;function $P(){return Tj||(Tj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.standaloneMarkerNavigatorModule=e.markerNavigatorModule=e.validationModule=void 0;const n=Y(),t=O6(),i=L6();e.validationModule=new n.FeatureModule((a,o,s)=>{const r={bind:a,isBound:s};(0,n.configureActionHandler)(r,n.SetMarkersAction.KIND,i.SetMarkersActionHandler),(0,n.configureCommand)(r,i.ApplyMarkersCommand),(0,n.configureCommand)(r,i.DeleteMarkersCommand),a(i.ValidationFeedbackEmitter).toSelf().inSingletonScope()},{featureId:Symbol("validation")}),e.markerNavigatorModule=new n.FeatureModule((a,o,s)=>{a(t.GModelElementComparator).to(t.LeftToRightTopToBottomComparator).inSingletonScope(),a(t.MarkerNavigator).toSelf().inSingletonScope(),(0,n.configureActionHandler)({bind:a,isBound:s},t.NavigateToMarkerAction.KIND,t.NavigateToMarkerActionHandler)},{featureId:Symbol("markerNavigator")}),e.standaloneMarkerNavigatorModule=new n.FeatureModule(a=>{(0,n.bindAsService)(a,n.TYPES.IContextMenuProvider,t.MarkerNavigatorContextMenuItemProvider),(0,n.bindAsService)(a,n.TYPES.KeyListener,t.MarkerNavigatorKeyListener)},{featureId:Symbol("standaloneMarkerNavigator"),requires:e.markerNavigatorModule})}(pS)),pS}var gS={},Pg={},Dj;function fh(){if(Dj)return Pg;Dj=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.FocusDomAction=void 0;const e=Y();var n;return function(t){t.KIND="focusDomAction";function i(o){return e.Action.hasKind(o,t.KIND)&&(0,e.hasStringProp)(o,"id")}t.is=i;function a(o){return{kind:t.KIND,id:o}}t.create=a}(n||(Pg.FocusDomAction=n={})),Pg}var Uu={},Oj;function j6(){if(Oj)return Uu;Oj=1;var e=Uu&&Uu.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u};Object.defineProperty(Uu,"__esModule",{value:!0}),Uu.GLSPScrollMouseListener=void 0;const n=G(),t=Y(),i=an(),a=dh();let o=class extends t.ScrollMouseListener{constructor(){super(...arguments),this.preventScrolling=!1}handle(r){r.kind===i.EnableToolsAction.KIND?r.toolIds.includes(a.MarqueeMouseTool.ID)&&(this.preventScrolling=!0):r.kind===i.EnableDefaultToolsAction.KIND&&(this.preventScrolling=!1)}mouseDown(r,d){return this.preventScrolling?[]:super.mouseDown(r,d)}};return Uu.GLSPScrollMouseListener=o,Uu.GLSPScrollMouseListener=o=e([(0,n.injectable)()],o),Uu}var fr={},Lj;function N_(){if(Lj)return fr;Lj=1;var e=fr&&fr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=fr&&fr.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=fr&&fr.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(fr,"__esModule",{value:!0}),fr.RepositionCommand=fr.RepositionAction=void 0;const i=Y(),a=G(),o=Zr(),s=kt();var r;(function(l){l.KIND="repositionAction";function c(f){return i.Action.hasKind(f,l.KIND)&&(0,i.hasArrayProp)(f,"elementIDs")}l.is=c;function u(f){return{kind:l.KIND,elementIDs:f}}l.create=u})(r||(fr.RepositionAction=r={}));let d=class extends i.BoundsAwareViewportCommand{constructor(c){super(!0),this.action=c}boundsInViewport(c,u,f){var h;if(c instanceof i.GChildElement&&c.parent!==f)return this.boundsInViewport(c.parent,c.parent.localToParent(u),f);if(c instanceof o.GEdge){const p=(0,i.getRouteBounds)((h=(0,s.calcElementAndRoute)(c).newRoutingPoints)!==null&&h!==void 0?h:[]);return c instanceof i.GChildElement&&c.parent!==f?this.boundsInViewport(c.parent,c.parent.localToParent(p),f):p}return u}getElementIds(){return this.action.elementIDs}getNewViewport(c,u){if(i.Dimension.isValid(u.canvasBounds)&&(0,i.isViewport)(u)){if(this.isFullyVisible(c,u))return;{const f=u.zoom,h=i.Bounds.center(c),p=i.Dimension.center(u.canvasBounds),g=i.Point.subtract(h,p);return{scroll:i.Point.map(g,v=>v/f),zoom:f}}}}isFullyVisible(c,u){return c.x>=u.scroll.x&&c.x+c.width<=u.scroll.x+u.canvasBounds.width/u.zoom&&c.y>=u.scroll.y&&c.y+c.height<=u.scroll.y+u.canvasBounds.height/u.zoom}};return fr.RepositionCommand=d,d.KIND=r.KIND,fr.RepositionCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],d),fr}var ya={},jj;function N6(){if(jj)return ya;jj=1;var e=ya&&ya.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=ya&&ya.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)};Object.defineProperty(ya,"__esModule",{value:!0}),ya.RestoreViewportHandler=void 0;const t=Y(),i=G(),a=kn(),o=Gm(),s=an(),r=fh();let d=class{handle(c){(s.EnableDefaultToolsAction.is(c)||r.FocusDomAction.is(c)&&c.id==="graph")&&this.focusGraph()}get graphSelector(){return`#${CSS.escape(this.domHelper.createUniqueDOMElementId(this.editorContext.modelRoot))}`}async postRequestModel(){await this.waitForElement(this.graphSelector),this.focusGraph()}focusGraph(){var c;if(this.focusTracker.hasFocus){const u=(c=this.focusTracker.diagramElement)===null||c===void 0?void 0:c.querySelector(this.graphSelector);u==null||u.focus()}}waitForElement(c){return new Promise(u=>{if(document.querySelector(c))return u(document.querySelector(c));const f=new MutationObserver(h=>{document.querySelector(c)&&(f.disconnect(),u(document.querySelector(c)))});f.observe(document.body,{childList:!0,subtree:!0})})}};return ya.RestoreViewportHandler=d,e([(0,i.inject)(t.TYPES.DOMHelper),n("design:type",t.DOMHelper)],d.prototype,"domHelper",void 0),e([(0,i.inject)(o.FocusTracker),n("design:type",o.FocusTracker)],d.prototype,"focusTracker",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],d.prototype,"editorContext",void 0),ya.RestoreViewportHandler=d=e([(0,i.injectable)()],d),ya}var Nj;function YP(){return Nj||(Nj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.standaloneViewportModule=e.viewportModule=void 0;const n=Y(),t=an(),i=fh(),a=j6(),o=VP(),s=N_(),r=N6();e.viewportModule=new n.FeatureModule((d,l,c)=>{const u={bind:d,isBound:c};(0,n.configureCommand)(u,n.CenterCommand),(0,n.configureCommand)(u,n.FitToScreenCommand),(0,n.configureCommand)(u,n.GetViewportCommand),(0,n.configureCommand)(u,n.SetViewportCommand),(0,n.configureCommand)(u,s.RepositionCommand),(0,n.configureCommand)(u,o.OriginViewportCommand),(0,n.bindAsService)(u,n.TYPES.MouseListener,n.ZoomMouseListener),(0,n.bindAsService)(u,n.TYPES.MouseListener,a.GLSPScrollMouseListener),(0,n.configureActionHandler)(u,t.EnableToolsAction.KIND,a.GLSPScrollMouseListener),(0,n.configureActionHandler)(u,t.EnableDefaultToolsAction.KIND,a.GLSPScrollMouseListener),(0,n.bindAsService)(u,n.TYPES.IDiagramStartup,r.RestoreViewportHandler),(0,n.configureActionHandler)(u,t.EnableDefaultToolsAction.KIND,r.RestoreViewportHandler),(0,n.configureActionHandler)(u,i.FocusDomAction.KIND,r.RestoreViewportHandler)},{featureId:Symbol("viewport")}),e.standaloneViewportModule=new n.FeatureModule((d,l,c)=>{const u={bind:d,isBound:c};(0,n.bindAsService)(u,n.TYPES.KeyListener,n.CenterKeyboardListener)},{featureId:Symbol("standaloneViewport"),requires:e.viewportModule})}(gS)),gS}var Bj;function I$(){return Bj||(Bj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.initializeDiagramContainer=e.configureDiagramOptions=e.createDiagramOptionsModule=e.DEFAULT_MODULES=void 0;const n=Y(),t=S9(),i=A9(),a=D9(),o=j9(),s=jP(),r=F9(),d=BP(),l=xP(),c=H9(),u=z9(),f=$9(),h=Z9(),p=J9(),g=e6(),m=n6(),v=qP(),_=s6(),S=c6(),E=l6(),C=d6(),M=v6(),L=y6(),I=_6(),R=S6(),w=R6(),T=I6(),j=T6(),D=$P(),B=YP();e.DEFAULT_MODULES=[t.defaultModule,n.buttonModule,n.edgeIntersectionModule,n.edgeLayoutModule,n.expandModule,l.exportModule,n.fadeModule,i.boundsModule,a.commandPaletteModule,o.contextMenuModule,r.decorationModule,h.labelEditModule,u.hoverModule,v.selectModule,s.copyPasteModule,B.viewportModule,f.labelEditUiModule,p.layoutModule,D.markerNavigatorModule,c.typeHintsModule,n.modelSourceModule,_.sourceModelWatcherModule,g.navigationModule,m.routingModule,C.toolPaletteModule,I.edgeCreationToolModule,R.edgeEditToolModule,L.deletionToolModule,d.elementTemplateModule,T.nodeCreationToolModule,M.changeBoundsToolModule,w.marqueeSelectionToolModule,j.toolFocusLossModule,D.validationModule,n.zorderModule,E.svgMetadataModule,S.statusModule];function H(U,Z){return new n.FeatureModule((ce,de,ke,pe)=>F({bind:ce,unbind:de,isBound:ke,rebind:pe},U,Z))}e.createDiagramOptionsModule=H;function F(U,Z,ce){(0,n.configureViewerOptions)(U,{baseDiv:Z.clientId,hiddenDiv:Z.clientId+"_hidden",zoomLimits:{min:.1,max:20},...ce}),U.bind(n.TYPES.IDiagramOptions).toConstantValue(Z)}e.configureDiagramOptions=F;function K(U,...Z){const ce=(0,n.resolveContainerConfiguration)(...e.DEFAULT_MODULES,...Z),de=ce[0];if(!de||!(de instanceof n.FeatureModule&&de.featureId===t.defaultModule.featureId))throw new Error("Invalid module configuration. The first module to load should be the `defaultModule` (or an equivalent replacement module)");return U.load(...ce),U}e.initializeDiagramContainer=K}(rS)),rS}var Rg={},mS={},Bo={},_a={},xj;function Xc(){if(xj)return _a;xj=1;var e=_a&&_a.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n;Object.defineProperty(_a,"__esModule",{value:!0}),_a.KeyShortcutUIExtension=_a.SetAccessibleKeyShortcutAction=void 0;const t=Y(),i=G(),a=cf(),o=Ya();var s;(function(d){d.KIND="setAccessibleKeyShortcut";function l(u){return t.Action.hasKind(u,d.KIND)}d.is=l;function c(u){return{kind:d.KIND,token:u.token,keys:u.keys}}d.create=c})(s||(_a.SetAccessibleKeyShortcutAction=s={}));let r=n=class extends o.GLSPAbstractUIExtension{constructor(){super(...arguments),this.registrations={}}handle(l){s.is(l)&&(this.registrations[l.token]=l.keys,this.containerElement&&this.refreshUI())}id(){return n.ID}containerClass(){return n.ID}show(l,...c){super.show(l,...c),this.shortcutsContainer.focus()}refreshUI(){this.shortcutsContainer.innerHTML="";const l=Object.values(this.registrations).flatMap(v=>v);l.sort((v,_)=>v.group<_.group?-1:v.group>_.group?1:v.position-_.position);const c=(0,a.groupBy)(l,v=>v.group),u=document.createElement("table");u.classList.add("shortcut-table");const f=document.createElement("thead"),h=document.createElement("tbody"),p=document.createElement("tr"),g=document.createElement("th"),m=document.createElement("th");g.classList.add("column-title"),g.innerText="Command",m.innerText="Keybinding",p.appendChild(g),p.appendChild(m),f.appendChild(p);for(const[v,_]of Object.entries(c))h.appendChild(this.createGroupHeader(v)),_.forEach(S=>{h.appendChild(this.createEntry(S))});u.appendChild(f),u.appendChild(h),this.shortcutsContainer.append(u)}createGroupHeader(l){const c=document.createElement("tr"),u=document.createElement("td"),f=document.createElement("strong"),h=document.createElement("td");return f.innerText=l,u.appendChild(f),c.appendChild(u),c.appendChild(h),c}getShortcutHTML(l){const c=document.createElement("span");return c.innerHTML=l.map(u=>`<kbd>${u}</kbd>`).join(" + "),c}createEntry(l){const c=document.createElement("tr"),u=document.createElement("td"),f=document.createElement("td"),h=this.getShortcutHTML(l.shortcuts);return f.innerText=l.description,u.appendChild(h),c.appendChild(f),c.appendChild(u),c}initializeContents(l){this.container=document.createElement("div"),this.container.classList.add("keyboard-shortcuts-menu");const c=document.createElement("h3");c.classList.add("menu-header"),c.innerText="Keyboard Shortcuts",this.container.appendChild(c);const u=document.createElement("button");u.id="key-shortcut-close-btn",u.textContent="x",u.addEventListener("click",()=>{this.hide()}),this.container.appendChild(u),this.shortcutsContainer=document.createElement("div"),this.shortcutsContainer.classList.add("keyboard-shortcuts-container"),this.shortcutsContainer.tabIndex=30,this.shortcutsContainer.addEventListener("keydown",f=>{(f.key==="Escape"||(0,t.matchesKeystroke)(f,"KeyH","alt"))&&this.hide()}),this.container.appendChild(this.shortcutsContainer),l.appendChild(this.container),l.ariaLabel="Shortcut-Menu",this.refreshUI()}};return _a.KeyShortcutUIExtension=r,r.ID="key-shortcut",_a.KeyShortcutUIExtension=r=n=e([(0,i.injectable)()],r),_a}var xo={},Fj;function WP(){if(Fj)return xo;Fj=1;var e=xo&&xo.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=xo&&xo.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t;Object.defineProperty(xo,"__esModule",{value:!0}),xo.AccessibleShortcutKeyListener=xo.AccessibleKeyShortcutTool=void 0;const i=G(),a=Y(),o=Wa(),s=Xc();let r=t=class extends o.BaseEditTool{constructor(){super(...arguments),this.shortcutKeyListener=new d}get id(){return t.ID}enable(){this.keytool.register(this.shortcutKeyListener)}disable(){this.keytool.deregister(this.shortcutKeyListener)}};xo.AccessibleKeyShortcutTool=r,r.ID="accessible-key-shortcut-tool",e([(0,i.inject)(a.KeyTool),n("design:type",a.KeyTool)],r.prototype,"keytool",void 0),xo.AccessibleKeyShortcutTool=r=t=e([(0,i.injectable)()],r);class d extends a.KeyListener{constructor(){super(...arguments),this.token=Symbol(d.name)}keyDown(c,u){return this.matchesActivateShortcutHelpKeystroke(u)?[a.SetUIExtensionVisibilityAction.create({extensionId:s.KeyShortcutUIExtension.ID,visible:!0})]:[]}matchesActivateShortcutHelpKeystroke(c){return(0,a.matchesKeystroke)(c,"KeyH","alt")}}return xo.AccessibleShortcutKeyListener=d,xo}var Fo={},hr={},kj;function Qm(){if(kj)return hr;kj=1;var e=hr&&hr.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},n;Object.defineProperty(hr,"__esModule",{value:!0}),hr.SearchAutocompletePalette=hr.RevealEdgeElementAutocompleteSuggestionProvider=hr.RevealNodesWithoutNameAutocompleteSuggestionProvider=hr.RevealNamedElementAutocompleteSuggestionProvider=void 0;const t=Y(),i=G(),a=cf(),o=u9(),s=Un(),r=N_(),d=Zr(),l="search-hidden",c="search-highlighted";class u{async retrieveSuggestions(m,v){return(0,t.toArray)(m.index.all().filter(S=>(0,t.isNameable)(S))).map(S=>{var E;return{element:S,action:{label:`[${S.type}] ${(E=(0,t.name)(S))!==null&&E!==void 0?E:"<no-name>"}`,actions:this.getActions(S),icon:(0,t.codiconCSSString)("eye")}}})}getActions(m){return[t.SelectAction.create({selectedElementsIDs:[m.id]}),t.CenterAction.create([m.id],{retainZoom:!0})]}}hr.RevealNamedElementAutocompleteSuggestionProvider=u;class f{async retrieveSuggestions(m,v){return(0,t.toArray)(m.index.all().filter(S=>!(0,t.isNameable)(S)&&S instanceof t.GNode)).map(S=>({element:S,action:{label:`[${S.type}]`,actions:this.getActions(S),icon:(0,t.codiconCSSString)("symbol-namespace")}}))}getActions(m){return[t.SelectAction.create({selectedElementsIDs:[m.id]}),t.CenterAction.create([m.id],{retainZoom:!0})]}}hr.RevealNodesWithoutNameAutocompleteSuggestionProvider=f;class h{async retrieveSuggestions(m,v){return(0,t.toArray)(m.index.all().filter(S=>S instanceof d.GEdge)).map(S=>({element:S,action:{label:`[${S.type}]  ${this.getEdgeLabel(m,S)}`,actions:this.getActions(S),icon:(0,t.codiconCSSString)("arrow-both")}}))}getActions(m){return[t.SelectAction.create({selectedElementsIDs:[m.id]}),t.CenterAction.create([m.sourceId,m.targetId])]}getEdgeLabel(m,v){var _,S;let E="",C="";const M=m.index.getById(v.sourceId),L=m.index.getById(v.targetId);return M!==void 0&&(E=(_=(0,t.name)(M))!==null&&_!==void 0?_:M.type),L!==void 0&&(C=(S=(0,t.name)(L))!==null&&S!==void 0?S:L.type),E+" -> "+C}}hr.RevealEdgeElementAutocompleteSuggestionProvider=h;let p=n=class extends o.BaseAutocompletePalette{constructor(){super(...arguments),this.cachedSuggestions=[]}id(){return n.ID}initializeContents(m){super.initializeContents(m),this.autocompleteWidget.inputField.placeholder="Search for elements",m.setAttribute("aria-label","Search Field")}getSuggestionProviders(m,v){return[new u,new h,new f]}async retrieveSuggestions(m,v){const _=this.getSuggestionProviders(m,v),S=(await Promise.all(_.map(E=>E.retrieveSuggestions(m,v)))).flat(1);return this.cachedSuggestions=S,S.map(E=>E.action)}async visibleSuggestionsChanged(m,v){await this.applyCSS(this.getHiddenElements(m,this.getSuggestionsFromLabeledActions(v)),l),await this.deleteCSS(this.getSuggestionsFromLabeledActions(v).map(_=>_.element),l)}async selectedSuggestionChanged(m,v){if(await this.deleteAllCSS(m,c),v!==void 0){const _=this.getSuggestionsFromLabeledActions([v]),S=[];_.map(E=>S.push(r.RepositionAction.create([E.element.id]))),this.actionDispatcher.dispatchAll(S),await this.applyCSS(_.map(E=>E.element),c)}}show(m,...v){this.actionDispatcher.dispatch(t.SelectAllAction.create(!1)),super.show(m,...v)}hide(){this.root!==void 0&&(this.deleteAllCSS(this.root,l),this.deleteAllCSS(this.root,c),this.autocompleteWidget.inputField.value=""),super.hide()}applyCSS(m,v){const _=m.map(S=>(0,s.applyCssClasses)(S,v));return this.actionDispatcher.dispatchAll(_)}deleteCSS(m,v){const _=m.map(S=>(0,s.deleteCssClasses)(S,v));return this.actionDispatcher.dispatchAll(_)}deleteAllCSS(m,v){const _=(0,t.toArray)(m.index.all().map(S=>(0,s.deleteCssClasses)(S,v)));return this.actionDispatcher.dispatchAll(_)}getSuggestionsFromLabeledActions(m){return this.cachedSuggestions.filter(v=>m.find(_=>(0,a.isEqual)(_,v.action)))}getHiddenSuggestionsFromLabeledActions(m){return this.cachedSuggestions.filter(v=>!m.find(_=>(0,a.isEqual)(_,v.action)))}getHiddenElements(m,v){return(0,t.toArray)(m.index.all().filter(_=>_ instanceof t.GNode||_ instanceof d.GEdge).filter(_=>v.find(S=>S.element.id===_.id)===void 0))}};return hr.SearchAutocompletePalette=p,p.ID="search-autocomplete-palette",hr.SearchAutocompletePalette=p=n=e([(0,i.injectable)()],p),hr}var Kj;function ZP(){if(Kj)return Fo;Kj=1;var e=Fo&&Fo.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Fo&&Fo.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t;Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.SearchAutocompletePaletteKeyListener=Fo.SearchAutocompletePaletteTool=void 0;const i=Y(),a=G(),o=Xc(),s=Qm();let r=t=class{constructor(){this.keyListener=new d(this)}get id(){return t.ID}enable(){this.keyTool.register(this.keyListener),this.keyListener.registerShortcutKey()}disable(){this.keyTool.deregister(this.keyListener)}};Fo.SearchAutocompletePaletteTool=r,r.ID="glsp.search-autocomplete-palette-tool",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],r.prototype,"actionDispatcher",void 0),e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],r.prototype,"keyTool",void 0),Fo.SearchAutocompletePaletteTool=r=t=e([(0,a.injectable)()],r);class d extends i.KeyListener{constructor(c){super(),this.tool=c,this.token=s.SearchAutocompletePalette.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(o.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["CTRL","F"],description:"Activate search for elements",group:"Search",position:0}]}))}keyDown(c,u){return this.matchesSearchActivateKeystroke(u)?[i.SetUIExtensionVisibilityAction.create({extensionId:s.SearchAutocompletePalette.ID,visible:!0})]:[]}matchesSearchActivateKeystroke(c){return(0,i.matchesKeystroke)(c,"KeyF","ctrl")}}return Fo.SearchAutocompletePaletteKeyListener=d,Fo}const T$={default_navigation_mode_activated:"Navigation On: Use arrow keys to select preceding () or succeding () elements. Use the up () and down () arrows to navigate paths. Press 'N' to exit.",default_navigation_mode_deactivated:"Navigation Off: Press 'N' for default navigation, 'ALT+N' for position based navigation.",local_navigation_mode_activated:"Position based Nav On: Navigate nearest elements using arrow keys: () for above, () for below, () for previous, () for next element. Press 'ALT+N' to exit.",local_navigation_mode_deactivated:"Position based Nav Off: Press 'N' for default navigation, 'ALT+N' for position based navigation."},D$={focus_on:"Currently focused: "},O$={resize_mode_activated:"Resize On: Use plus(+) and minus(-) to resize, 'CTRL'+'0' for default size. Press 'ESC' to exit.",resize_mode_deactivated:"Resize Off: Press 'ALT'+'A' for resize mode."},L$={zoom_in_grid:"Select a digit from 1-9 to zoom in on the respective box."},j$={marqueeTool:"Currently marquee tool is only usable with mouse."},Jm={navigation:T$,focus:D$,resize:O$,grid:L$,tool_palette:j$};var ud={},qj;function ll(){if(qj)return ud;qj=1,Object.defineProperty(ud,"__esModule",{value:!0}),ud.ShowToastMessageAction=ud.HideToastAction=void 0;const e=Y();var n;(function(i){i.KIND="hideToastMessageAction";function a(s){return e.Action.hasKind(s,i.KIND)}i.is=a;function o(s){return{kind:i.KIND,options:s}}i.create=o})(n||(ud.HideToastAction=n={}));var t;return function(i){i.KIND="showToastMessageAction",i.TIMEOUT=2e3;function a(r){return e.Action.hasKind(r,i.KIND)}i.is=a;function o(r){var d,l;return{kind:i.KIND,options:{...r,position:(d=r.position)!==null&&d!==void 0?d:"center",id:(l=r.id)!==null&&l!==void 0?l:Symbol("toast id")}}}i.create=o;function s(r){var d,l;return{kind:i.KIND,options:{timeout:i.TIMEOUT,...r,position:(d=r.position)!==null&&d!==void 0?d:"center",id:(l=r.id)!==null&&l!==void 0?l:Symbol("toast id")}}}i.createWithTimeout=s}(t||(ud.ShowToastMessageAction=t={})),ud}var Hj;function B_(){if(Hj)return Bo;Hj=1;var e=Bo&&Bo.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=Bo&&Bo.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)},t;Object.defineProperty(Bo,"__esModule",{value:!0}),Bo.ElementNavigatorKeyListener=Bo.ElementNavigatorTool=void 0;const i=Y(),a=G(),o=an(),s=Zr(),r=N_(),d=Xc(),l=WP(),c=ZP(),u=Jm,f=ll();let h=t=class{constructor(){this.isEditTool=!1,this.elementNavigatorKeyListener=new g(this)}get id(){return t.ID}enable(){this.keytool.register(this.elementNavigatorKeyListener),this.elementNavigatorKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.elementNavigatorKeyListener)}};Bo.ElementNavigatorTool=h,h.ID="glsp.diagram-navigation",e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],h.prototype,"keytool",void 0),e([(0,a.inject)(i.TYPES.IElementNavigator),n("design:type",Object)],h.prototype,"elementNavigator",void 0),e([(0,a.inject)(i.TYPES.ILocalElementNavigator),n("design:type",Object)],h.prototype,"localElementNavigator",void 0),e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],h.prototype,"actionDispatcher",void 0),Bo.ElementNavigatorTool=h=t=e([(0,a.injectable)()],h);var p;(function(m){m.POSITION="position",m.DEFAULT="default",m.NONE="none"})(p||(p={}));class g extends i.KeyListener{constructor(v){super(),this.tool=v,this.mode=p.NONE,this.token=g.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(d.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["N"],description:"Activate default navigation",group:"Navigation",position:0},{shortcuts:["ALT","N"],description:"Activate position based navigation",group:"Navigation",position:1},{shortcuts:["      "],description:"Navigate by relation or neighbors according to navigation mode",group:"Navigation",position:2}]}))}keyDown(v,_){return this.resetOnEscape(_,v),this.getSelectedElements(v.root).length>0?(this.triggerPositionNavigationOnEvent(_,v)||this.triggerDefaultNavigationOnEvent(_,v),this.navigate(v,_)):(this.resetPositionNavigationOnEvent(_,v),this.resetDefaultNavigationOnEvent(_,v),[])}resetOnEscape(v,_){var S,E;this.mode!==p.NONE&&this.matchesDeactivateNavigationMode(v)&&((E=(S=this.navigator)===null||S===void 0?void 0:S.clean)===null||E===void 0||E.call(S,_.root),this.clean(),this.mode===p.POSITION?this.tool.actionDispatcher.dispatchAll([o.EnableDefaultToolsAction.create(),f.ShowToastMessageAction.createWithTimeout({id:Symbol.for(g.name),message:u.navigation.local_navigation_mode_deactivated})]):this.mode===p.DEFAULT&&this.tool.actionDispatcher.dispatchAll([o.EnableDefaultToolsAction.create(),f.ShowToastMessageAction.createWithTimeout({id:Symbol.for(g.name),message:u.navigation.default_navigation_mode_deactivated})]),this.mode=p.NONE)}triggerPositionNavigationOnEvent(v,_){return this.matchesActivatePositionNavigation(v)?(this.mode!==p.POSITION?(this.clean(),this.tool.actionDispatcher.dispatchAll([o.EnableToolsAction.create([h.ID,c.SearchAutocompletePaletteTool.ID,l.AccessibleKeyShortcutTool.ID]),f.ShowToastMessageAction.create({id:Symbol.for(g.name),message:u.navigation.local_navigation_mode_activated})]),this.navigator=this.tool.elementNavigator,this.mode=p.POSITION):this.resetPositionNavigationOnEvent(v,_),!0):!1}resetPositionNavigationOnEvent(v,_){var S,E;this.mode===p.POSITION&&this.matchesActivatePositionNavigation(v)&&((E=(S=this.navigator)===null||S===void 0?void 0:S.clean)===null||E===void 0||E.call(S,_.root),this.clean(),this.mode=p.NONE,this.tool.actionDispatcher.dispatchAll([o.EnableDefaultToolsAction.create(),f.ShowToastMessageAction.createWithTimeout({id:Symbol.for(g.name),message:u.navigation.local_navigation_mode_deactivated})]))}triggerDefaultNavigationOnEvent(v,_){return this.matchesActivateDefaultNavigation(v)?(this.mode!==p.DEFAULT?(this.clean(),this.tool.actionDispatcher.dispatchAll([o.EnableToolsAction.create([h.ID,c.SearchAutocompletePaletteTool.ID,l.AccessibleKeyShortcutTool.ID]),f.ShowToastMessageAction.create({id:Symbol.for(g.name),message:u.navigation.default_navigation_mode_activated})]),this.navigator=this.tool.localElementNavigator,this.mode=p.DEFAULT):this.resetDefaultNavigationOnEvent(v,_),!0):!1}resetDefaultNavigationOnEvent(v,_){var S,E;this.mode===p.DEFAULT&&this.matchesActivateDefaultNavigation(v)&&((E=(S=this.navigator)===null||S===void 0?void 0:S.clean)===null||E===void 0||E.call(S,_.root),this.clean(),this.mode=p.NONE,this.tool.actionDispatcher.dispatchAll([o.EnableDefaultToolsAction.create(),f.ShowToastMessageAction.createWithTimeout({id:Symbol.for(g.name),message:u.navigation.default_navigation_mode_deactivated})]))}navigate(v,_){var S,E,C,M;const L=this.getSelectedElements(v.root),I=L.length>0?L[0]:void 0;if(this.mode!==p.NONE&&this.navigator!==void 0&&I!==void 0&&(0,i.isBoundsAware)(I)){(E=(S=this.navigator).clean)===null||E===void 0||E.call(S,I.root,I,this.previousNode);const R=this.navigateOnEvent(_,this.navigator,I);R!==void 0&&((M=(C=this.navigator).process)===null||M===void 0||M.call(C,I.root,I,R,this.previousNode));const w=R?(0,i.findParentByFeature)(R,i.isSelectable):void 0;if(w){I instanceof s.GEdge||(this.previousNode=I);const T=L.map(j=>j.id).filter(j=>j!==w.id);return[i.SelectAction.create({selectedElementsIDs:[w.id],deselectedElementsIDs:T}),r.RepositionAction.create([w.id])]}}return[]}navigateOnEvent(v,_,S){var E,C;if(this.matchesNavigatePrevious(v))return _.previous(S.root,S);if(this.matchesNavigateNext(v))return _.next(S.root,S);if(this.matchesNavigateUp(v))return(E=_.up)===null||E===void 0?void 0:E.call(_,S.root,S,this.previousNode);if(this.matchesNavigateDown(v))return(C=_.down)===null||C===void 0?void 0:C.call(_,S.root,S,this.previousNode)}clean(){this.previousNode=void 0,this.navigator=void 0}getSelectedElements(v){return(0,i.toArray)(v.index.all().filter(_=>(0,i.isSelected)(_)))}matchesDeactivateNavigationMode(v){return(0,i.matchesKeystroke)(v,"Escape")}matchesActivateDefaultNavigation(v){return(0,i.matchesKeystroke)(v,"KeyN")}matchesActivatePositionNavigation(v){return(0,i.matchesKeystroke)(v,"KeyN","alt")}matchesNavigatePrevious(v){return(0,i.matchesKeystroke)(v,"ArrowLeft")}matchesNavigateNext(v){return(0,i.matchesKeystroke)(v,"ArrowRight")}matchesNavigateUp(v){return(0,i.matchesKeystroke)(v,"ArrowUp")}matchesNavigateDown(v){return(0,i.matchesKeystroke)(v,"ArrowDown")}}return Bo.ElementNavigatorKeyListener=g,Bo}var ba={},Vj;function B6(){if(Vj)return ba;Vj=1;var e=ba&&ba.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=ba&&ba.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(ba,"__esModule",{value:!0}),ba.LocalElementNavigator=void 0;const t=Y(),i=G(),a=Un(),o=Zr();let s=class{constructor(){this.navigableElementCSS="navigable-element"}previous(d,l,c,u){return this.getPreviousElement(l,u)}next(d,l,c,u){return this.getNextElement(l,u)}up(d,l,c,u){return this.getIterable(l,c,u)}down(d,l,c,u){return this.getIterable(l,c,u)}process(d,l,c,u,f){let h=[];c instanceof o.GEdge&&(l instanceof o.GEdge?h=this.getIterables(c,l.source===c.source?l.source:l.target,f):h=this.getIterables(c,l,f)),h.filter(p=>p.id!==c.id).forEach(p=>this.actionDispatcher.dispatch((0,a.applyCssClasses)(p,this.navigableElementCSS)))}clean(d,l,c){d.index.all().forEach(u=>this.actionDispatcher.dispatch((0,a.deleteCssClasses)(u,this.navigableElementCSS)))}getIterables(d,l,c=()=>!0){var u,f;const h=[];return d instanceof o.GEdge&&(d.target===l?(u=d.target)===null||u===void 0||u.incomingEdges.forEach(p=>h.push(p)):(f=d.source)===null||f===void 0||f.outgoingEdges.forEach(p=>h.push(p))),h.filter(c)}getIterable(d,l,c=()=>!0){return this.getIterables(d,l,c).filter(u=>u.id!==d.id)[0]}getNextElement(d,l=()=>!0){const c=[];if(d instanceof t.GConnectableElement)d.outgoingEdges.forEach(u=>c.push(u));else if(d instanceof o.GEdge){const u=d.target;c.push(u)}return c.filter(l)[0]}getPreviousElement(d,l=()=>!0){const c=[];if(d instanceof t.GConnectableElement)d.incomingEdges.forEach(u=>c.push(u));else if(d instanceof o.GEdge){const u=d.source;c.push(u)}return c.filter(l)[0]}};return ba.LocalElementNavigator=s,e([(0,i.inject)(t.EdgeRouterRegistry),(0,i.optional)(),n("design:type",t.EdgeRouterRegistry)],s.prototype,"edgeRouterRegistry",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],s.prototype,"actionDispatcher",void 0),ba.LocalElementNavigator=s=e([(0,i.injectable)()],s),ba}var Sa={},Gj;function x6(){if(Gj)return Sa;Gj=1;var e=Sa&&Sa.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c},n=Sa&&Sa.__metadata||function(o,s){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,s)};Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.PositionNavigator=void 0;const t=Y(),i=G();let a=class{previous(s,r,d,l){return this.getNearestElement(s,r,c=>this.bounds(s,c).x<this.bounds(s,r).x)}next(s,r,d,l){return this.getNearestElement(s,r,c=>this.bounds(s,c).x>this.bounds(s,r).x)}up(s,r,d,l){return this.getNearestElement(s,r,c=>this.bounds(s,c).y<this.bounds(s,r).y)}down(s,r,d,l){return this.getNearestElement(s,r,c=>this.bounds(s,c).y>this.bounds(s,r).y)}getNearestElement(s,r,d){const l=this.boundElements(s).filter(d);return this.sortByDistance(s,r,l)[0]}sortByDistance(s,r,d){const l=(c,u)=>{const f=u.x-c.x,h=u.y-c.y;return Math.sqrt(f*f+h*h)};return d.sort((c,u)=>l(this.bounds(s,c),this.bounds(s,r))-l(this.bounds(s,u),this.bounds(s,r)))}boundElements(s){return(0,t.toArray)(s.index.all().filter(r=>r instanceof t.GNode&&(0,t.isSelectable)(r)&&(0,t.isBoundsAware)(r)))}bounds(s,r){return this.boundsInViewport(r,r.bounds,s)}boundsInViewport(s,r,d){return s instanceof t.GChildElement&&s.parent!==d?this.boundsInViewport(s.parent,s.parent.localToParent(r),d):r}};return Sa.PositionNavigator=a,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],a.prototype,"actionDispatcher",void 0),Sa.PositionNavigator=a=e([(0,i.injectable)()],a),Sa}var zj;function F6(){return zj||(zj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.glspElementNavigationModule=e.configureElementNavigationTool=e.elementNavigationModule=void 0;const n=Y(),t=B_(),i=B6(),a=x6();e.elementNavigationModule=new n.FeatureModule((s,r,d,l)=>{o({bind:s,unbind:r,isBound:d,rebind:l})},{featureId:Symbol("elementNavigation")}),e.glspElementNavigationModule=e.elementNavigationModule;function o(s){(0,n.bindAsService)(s,n.TYPES.IDefaultTool,t.ElementNavigatorTool),(0,n.bindAsService)(s,n.TYPES.IElementNavigator,a.PositionNavigator),(0,n.bindAsService)(s,n.TYPES.ILocalElementNavigator,i.LocalElementNavigator)}e.configureElementNavigationTool=o}(mS)),mS}var vS={},Ea={},Uj;function k6(){if(Uj)return Ea;Uj=1;var e=Ea&&Ea.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=Ea&&Ea.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)},t;Object.defineProperty(Ea,"__esModule",{value:!0}),Ea.FocusTrackerTool=void 0;const i=Y(),a=G(),o=Jm,s=ll();let r=t=class{constructor(){this.isEditTool=!1,this.focusInFunction=l=>this.focusIn(l),this.focusOutFunction=l=>this.focusOut(l),this.registered=!1}get id(){return t.ID}enable(){this.registered||(document.addEventListener("focusin",this.focusInFunction),document.addEventListener("focusout",this.focusOutFunction)),this.registered=!0}disable(){}async focusOut(l){await this.showToast("Focus not set")}async focusIn(l){let c;const u=l.target;if(u instanceof HTMLElement){const f=this.parentWithAriaLabel(u),h=this.handleTextNode(u);u.ariaLabel!==null?c=this.handleAriaLabel(u):f===void 0&&h!==void 0?c=h:f!==void 0&&h===void 0?c=`Focus is in ${f.ariaLabel}`:f!==void 0&&h!==void 0&&(c=`${f.ariaLabel} -> ${h}`)}await this.showToast(c)}handleTextNode(l){const c=Array.prototype.filter.call(l.childNodes,u=>u.nodeType===Node.TEXT_NODE).map(u=>u.textContent).join("");if(c.trim().length!==0)return c}handleAriaLabel(l){return l.ariaLabel===null?void 0:l.ariaLabel}showToast(l){return this.actionDispatcher.dispatchAll([s.ShowToastMessageAction.create({id:Symbol.for(t.ID),message:`${o.focus.focus_on} ${l??"unknown"}`,position:"left"})])}parentWithAriaLabel(l){let c=l.parentElement;for(;c!==null&&c!==document.body&&c!==document.getElementById(this.viewerOptions.baseDiv)&&c.ariaLabel===null;)c=c.parentElement;if(!(c===document.getElementById(this.viewerOptions.baseDiv)||c===document.body))return c??void 0}};return Ea.FocusTrackerTool=r,r.ID="glsp.focus-tracker",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],r.prototype,"actionDispatcher",void 0),e([(0,a.inject)(i.TYPES.ViewerOptions),n("design:type",Object)],r.prototype,"viewerOptions",void 0),Ea.FocusTrackerTool=r=t=e([(0,a.injectable)()],r),Ea}var $j;function K6(){return $j||($j=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.glspFocusTrackerModule=e.configureFocusTrackerTool=e.focusTrackerModule=void 0;const n=Y(),t=k6();e.focusTrackerModule=new n.FeatureModule((a,o,s,r)=>{i({bind:a,unbind:o,isBound:s,rebind:r})},{featureId:Symbol("focusTracker")}),e.glspFocusTrackerModule=e.focusTrackerModule;function i(a){(0,n.bindAsService)(a,n.TYPES.IDefaultTool,t.FocusTrackerTool)}e.configureFocusTrackerTool=i}(vS)),vS}var yS={},Yj;function q6(){return Yj||(Yj=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.glspShortcutHelpModule=e.configureShortcutHelpTool=e.shortcutHelpModule=void 0;const n=Y(),t=Xc(),i=WP();e.shortcutHelpModule=new n.FeatureModule((o,s,r,d)=>{a({bind:o,unbind:s,isBound:r,rebind:d})},{featureId:Symbol("shortcutHelp")}),e.glspShortcutHelpModule=e.shortcutHelpModule;function a(o){(0,n.bindAsService)(o,n.TYPES.IDefaultTool,i.AccessibleKeyShortcutTool),(0,n.bindAsService)(o,n.TYPES.IUIExtension,t.KeyShortcutUIExtension),(0,n.configureActionHandler)(o,t.SetAccessibleKeyShortcutAction.KIND,t.KeyShortcutUIExtension)}e.configureShortcutHelpTool=a}(yS)),yS}var ld={},Mg={},Wj;function QP(){if(Wj)return Mg;Wj=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.SetEdgeTargetSelectionAction=void 0;const e=Y();var n;return function(t){t.KIND="setEdgeTargetSelectionAction";function i(o){return e.Action.hasKind(o,t.KIND)&&(0,e.hasStringProp)(o,"elementId")&&(0,e.hasObjectProp)(o,"context")}t.is=i;function a(o,s){return{kind:t.KIND,elementId:o,context:s}}t.create=a}(n||(Mg.SetEdgeTargetSelectionAction=n={})),Mg}var Vr={},Zj;function x_(){if(Zj)return Vr;Zj=1;var e=Vr&&Vr.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m};Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.PossibleEdgeTargetAutocompleteSuggestionProvider=Vr.EdgeAutocompletePalette=Vr.EdgeAutocompletePaletteMetadata=void 0;const n=Y(),t=G(),i=IP(),a=an(),o=Zr(),s=Qm(),r=QP();var d;(function(u){u.ID="edge-autocomplete-palette"})(d||(Vr.EdgeAutocompletePaletteMetadata=d={}));let l=class extends s.SearchAutocompletePalette{constructor(){super(...arguments),this.targetSuggestionProvider=new c}id(){return d.ID}handle(f){n.TriggerEdgeCreationAction.is(f)&&(this.context={trigger:f,role:"source"},this.targetSuggestionProvider.setContext(f,this.context))}onBeforeShow(f,h,...p){var g;super.onBeforeShow(f,h,...p),this.autocompleteWidget.inputField.placeholder=`Search for ${(g=this.context)===null||g===void 0?void 0:g.role} elements`}getSuggestionProviders(f,h){return[this.targetSuggestionProvider]}reload(){const f=this.context;this.hide(),this.context=f,this.actionDispatcher.dispatch(n.SetUIExtensionVisibilityAction.create({extensionId:d.ID,visible:!0}))}executeSuggestion(f){var h,p,g,m;const v=(0,i.toActionArray)(f)[0];((h=this.context)===null||h===void 0?void 0:h.role)==="source"?(this.context.sourceId=v.elementId,this.context.role="target",this.reload()):((p=this.context)===null||p===void 0?void 0:p.role)==="target"&&(this.context.targetId=v.elementId),((g=this.context)===null||g===void 0?void 0:g.sourceId)!==void 0&&((m=this.context)===null||m===void 0?void 0:m.targetId)!==void 0&&(this.actionDispatcher.dispatchAll([n.CreateEdgeOperation.create({elementTypeId:this.context.trigger.elementTypeId,sourceElementId:this.context.sourceId,targetElementId:this.context.targetId,args:this.context.trigger.args}),a.EnableDefaultToolsAction.create()]),this.hide())}autocompleteHide(f){f!=="submission"&&this.hide()}};Vr.EdgeAutocompletePalette=l,Vr.EdgeAutocompletePalette=l=e([(0,t.injectable)()],l);let c=class{setContext(f,h){this.proxyEdge=new o.GEdge,this.proxyEdge.type=f.elementTypeId,this.context=h}isAllowedSource(f,h){return f!==void 0&&this.proxyEdge!==void 0&&(0,n.isConnectable)(f)&&f.canConnect(this.proxyEdge,h)}async retrieveSuggestions(f,h){const p=this.context;return this.context===void 0?[]:(0,n.toArray)(f.index.all().filter(m=>this.isAllowedSource(m,p.role))).map(m=>{var v;return{element:m,action:{label:`[${m.type}] ${(v=(0,n.name)(m))!==null&&v!==void 0?v:"<no-name>"}`,actions:[r.SetEdgeTargetSelectionAction.create(m.id,p.role)],icon:(0,n.codiconCSSString)("arrow-both")}}})}};return Vr.PossibleEdgeTargetAutocompleteSuggestionProvider=c,Vr.PossibleEdgeTargetAutocompleteSuggestionProvider=c=e([(0,t.injectable)()],c),Vr}var ko={},Qj;function H6(){if(Qj)return ko;Qj=1;var e=ko&&ko.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=ko&&ko.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)},t;Object.defineProperty(ko,"__esModule",{value:!0}),ko.EdgeAutocompletePaletteKeyListener=ko.EdgeAutocompletePaletteTool=void 0;const i=Y(),a=G(),o=x_();let s=t=class{constructor(){this.keyListener=new r}get id(){return t.ID}enable(){this.keyTool.register(this.keyListener)}disable(){this.keyTool.deregister(this.keyListener)}};ko.EdgeAutocompletePaletteTool=s,s.ID="glsp.edge-autocomplete-palette-tool",e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],s.prototype,"keyTool",void 0),ko.EdgeAutocompletePaletteTool=s=t=e([(0,a.injectable)()],s);class r extends i.KeyListener{keyDown(l,c){return(0,i.matchesKeystroke)(c,"Escape")?[i.SetUIExtensionVisibilityAction.create({extensionId:o.EdgeAutocompletePaletteMetadata.ID,visible:!1,contextElementsId:[]})]:[]}}return ko.EdgeAutocompletePaletteKeyListener=r,ko}var Ca={},dd={},Jj;function uf(){if(Jj)return dd;Jj=1,Object.defineProperty(dd,"__esModule",{value:!0}),dd.KeyboardNodeGridMetadata=dd.KeyboardGridMetadata=void 0;var e;(function(t){t.ID="keyboard-grid",t.TAB_INDEX=15})(e||(dd.KeyboardGridMetadata=e={}));var n;return function(t){t.ID="keyboard-node-grid"}(n||(dd.KeyboardNodeGridMetadata=n={})),dd}var Ag={},Xj;function hh(){if(Xj)return Ag;Xj=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.KeyboardPointerMetadata=void 0;var e;return function(n){n.ID="keyboard-pointer",n.CRICLE_HEIGHT=16,n.CIRCLE_WIDTH=16,n.TAB_INDEX=10}(e||(Ag.KeyboardPointerMetadata=e={})),Ag}var $u={},eN;function JP(){if(eN)return $u;eN=1;var e=$u&&$u.__decorate||function(w,T,j,D){var B=arguments.length,H=B<3?T:D===null?D=Object.getOwnPropertyDescriptor(T,j):D,F;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(w,T,j,D);else for(var K=w.length-1;K>=0;K--)(F=w[K])&&(H=(B<3?F(H):B>3?F(T,j,H):F(T,j))||H);return B>3&&H&&Object.defineProperty(T,j,H),H};Object.defineProperty($u,"__esModule",{value:!0}),$u.KeyboardToolPalette=void 0;const n=Y(),t=G(),i=an(),a=Wm(),o=D_(),s=dh(),r=fh(),d=x_(),l=B_(),c=uf(),u=Jm,f=ll(),h="search",p="tools",g="chevron-right",m="500px",v=["Digit1","Numpad1"],_=["Digit2","Numpad2"],S=["Digit3","Numpad3"],E=["Digit4","Numpad4"],C=["Digit5","Numpad5"],M="accessibility-show-shortcuts",L=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyX","KeyY","KeyZ"],I=[v,_,S,E,C];let R=class extends a.ToolPalette{constructor(){super(...arguments),this.keyboardIndexButtonMapping=new Map,this.headerToolsButtonMapping=new Map}get interactablePaletteItems(){return this.paletteItems.sort(a.compare).map(T=>{var j,D;return(D=(j=T.children)===null||j===void 0?void 0:j.sort(a.compare))!==null&&D!==void 0?D:[T]}).reduce((T,j)=>T.concat(j),[])}initializeContents(T){this.containerElement.setAttribute("aria-label","Tool Palette"),this.containerElement.tabIndex=20,this.containerElement.classList.add("accessibility-tool-palette"),this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,this.containerElement.onkeyup=j=>{this.clearToolOnEscape(j),this.isShortcutsVisible()&&(this.selectItemOnCharacter(j),this.triggerHeaderToolsByKey(j))}}handle(T){if(a.EnableToolPaletteAction.is(T)){const j=n.RequestContextActions.create({contextId:a.ToolPalette.ID,editorContext:{selectedElementIds:[]}});this.actionDispatcher.requestUntil(j).then(D=>{n.SetContextActions.is(D)&&(this.paletteItems=D.actions.map(B=>B),this.actionDispatcher.dispatchAll([n.SetUIExtensionVisibilityAction.create({extensionId:a.ToolPalette.ID,visible:!this.editorContext.isReadonly})]))})}else r.FocusDomAction.is(T)&&T.id===a.ToolPalette.ID?(this.containerElement.contains(document.activeElement)?this.toggleShortcutVisibility():this.showShortcuts(),this.containerElement.focus()):super.handle(T)}addMinimizePaletteButton(){const T=document.getElementById(this.options.baseDiv),j=document.createElement("div");if(j.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),T){const D=T.insertBefore(j,T.firstChild),B=(0,a.createIcon)(g);this.updateMinimizePaletteButtonTooltip(j),B.onclick=H=>{this.isPaletteMaximized()?(this.containerElement.style.overflow="hidden",this.containerElement.style.maxHeight="0px"):(this.containerElement.style.overflow="visible",this.containerElement.style.maxHeight=m),this.updateMinimizePaletteButtonTooltip(j),(0,a.changeCodiconClass)(B,p),(0,a.changeCodiconClass)(B,g)},D.appendChild(B)}}createBody(){const T=document.createElement("div");T.classList.add("palette-body");const j=21;let D=0;if(this.keyboardIndexButtonMapping.clear(),this.paletteItems.sort(a.compare).forEach(B=>{if(B.children){const H=(0,a.createToolGroup)(B);B.children.sort(a.compare).forEach(F=>{const K=this.createKeyboardToolButton(F,j,D);H.appendChild(K),this.keyboardIndexButtonMapping.set(D,K),D++}),T.appendChild(H)}else{const H=this.createKeyboardToolButton(B,j,D);T.appendChild(H),this.keyboardIndexButtonMapping.set(D,H),D++}}),this.paletteItems.length===0){const B=document.createElement("div");B.innerText="No results found.",B.classList.add("tool-button"),T.appendChild(B)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(T),this.bodyDiv=T}createHeaderTools(){this.headerToolsButtonMapping.clear();let T=0;const j=document.createElement("div");j.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),this.headerToolsButtonMapping.set(T++,this.defaultToolsButton),j.appendChild(this.defaultToolsButton),this.deleteToolButton=this.createMouseDeleteToolButton(),this.headerToolsButtonMapping.set(T++,this.deleteToolButton),j.appendChild(this.deleteToolButton),this.marqueeToolButton=this.createMarqueeToolButton(),this.headerToolsButtonMapping.set(T++,this.marqueeToolButton),j.appendChild(this.marqueeToolButton),this.validateToolButton=this.createValidateButton(),this.headerToolsButtonMapping.set(T++,this.validateToolButton),j.appendChild(this.validateToolButton);const D=this.createResetViewportButton();if(this.headerToolsButtonMapping.set(T++,D),j.appendChild(D),this.gridManager){const B=this.createToggleGridButton();this.headerToolsButtonMapping.set(T++,B),j.appendChild(B)}if(this.debugManager){const B=this.createToggleDebugButton();this.headerToolsButtonMapping.set(T++,B),j.appendChild(B)}return this.searchToolButton=this.createSearchButton(),this.headerToolsButtonMapping.set(T++,this.searchToolButton),j.appendChild(this.searchToolButton),j}createDefaultToolButton(){const T=(0,a.createIcon)("inspect");return T.id="btn_default_tools",T.title="Enable selection tool",T.onclick=this.onClickStaticToolButton(T),T.appendChild(this.createKeyboardShotcut(v[0])),T}createMouseDeleteToolButton(){const T=(0,a.createIcon)("chrome-close");return T.title="Enable deletion tool",T.onclick=this.onClickStaticToolButton(T,o.MouseDeleteTool.ID),T.appendChild(this.createKeyboardShotcut(_[0])),T}createMarqueeToolButton(){const T=(0,a.createIcon)("screen-full");T.title="Enable marquee tool";const j=f.ShowToastMessageAction.createWithTimeout({id:Symbol.for(l.ElementNavigatorKeyListener.name),message:u.tool_palette.marqueeTool});return T.onclick=this.onClickStaticToolButton(T,s.MarqueeMouseTool.ID,j),T.appendChild(this.createKeyboardShotcut(S[0])),T}createValidateButton(){const T=(0,a.createIcon)("pass");return T.title="Validate model",T.onclick=j=>{const D=[this.modelRootId];this.actionDispatcher.dispatch(n.RequestMarkersAction.create(D))},T.appendChild(this.createKeyboardShotcut(E[0])),T}onClickStaticToolButton(T,j,D){return B=>{if(!this.editorContext.isReadonly){const H=j?i.EnableToolsAction.create([j]):i.EnableDefaultToolsAction.create();D?this.actionDispatcher.dispatchAll([H,D]):this.actionDispatcher.dispatchAll([H]),this.changeActiveButton(T),T.focus()}}}createSearchButton(){const T=(0,a.createIcon)(h);return T.onclick=j=>{const D=document.getElementById(this.containerElement.id+"_search_field");D&&(D.style.display==="none"?(D.style.display="",D.focus()):D.style.display="none")},T.classList.add("search-icon"),T.title="Filter palette entries",T.appendChild(this.createKeyboardShotcut(C[0])),T}createHeaderSearchField(){const T=document.createElement("input");return T.classList.add("search-input"),T.tabIndex=21,T.id=this.containerElement.id+"_search_field",T.type="text",T.placeholder="Search...",T.style.display="none",T.onkeyup=j=>{this.requestFilterUpdate(this.searchField.value),j.stopPropagation(),T.value===""?this.focusToolPaletteOnEscape(j):this.clearOnEscape(j)},T}focusToolPaletteOnEscape(T){(0,n.matchesKeystroke)(T,"Escape")&&this.containerElement.focus()}createKeyboardShotcut(T){const j=document.createElement("div");j.classList.add("key-shortcut");let D=T.toString();return T.includes("Key")?D=T.toString().substring(3):T.includes("Digit")&&(D=T.toString().substring(5)),j.innerHTML=D,j}createKeyboardToolButton(T,j,D){const B=document.createElement("div");return D<L.length&&B.appendChild(this.createKeyboardShotcut(L[D])),B.tabIndex=j,B.classList.add("tool-button"),T.icon&&B.appendChild((0,a.createIcon)(T.icon)),B.insertAdjacentText("beforeend",T.label),B.onclick=this.onClickCreateToolButton(B,T),B.onkeydown=H=>{this.clickToolOnEnter(H,B,T),this.clearToolOnEscape(H),(0,n.matchesKeystroke)(H,"ArrowDown")?D+1>this.keyboardIndexButtonMapping.size-1?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(0)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(D+1)):(0,n.matchesKeystroke)(H,"ArrowUp")&&(D-1<0?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(this.keyboardIndexButtonMapping.size-1)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(D-1)))},B}clickToolOnEnter(T,j,D){(0,n.matchesKeystroke)(T,"Enter")&&(this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(D.actions),this.changeActiveButton(j),this.selectItemOnCharacter(T)))}selectItemOnCharacter(T){var j;let D;const B=this.interactablePaletteItems,H=B.length<L.length?B.length:L.length;for(let F=0;F<H;F++){const K=L[F];if((0,n.matchesKeystroke)(T,K)){D=F;break}}D!==void 0&&(B[D].actions.some(F=>F.kind===n.TriggerNodeCreationAction.KIND)?this.actionDispatcher.dispatchAll([...B[D].actions,n.SetUIExtensionVisibilityAction.create({extensionId:c.KeyboardNodeGridMetadata.ID,visible:!0,contextElementsId:[]})]):this.actionDispatcher.dispatchAll([...B[D].actions,n.SetUIExtensionVisibilityAction.create({extensionId:d.EdgeAutocompletePaletteMetadata.ID,visible:!0,contextElementsId:[]})]),this.changeActiveButton(this.keyboardIndexButtonMapping.get(D)),(j=this.keyboardIndexButtonMapping.get(D))===null||j===void 0||j.focus())}triggerHeaderToolsByKey(T){var j;let D;for(let B=0;B<I.length;B++)for(let H=0;H<I[B].length;H++){const F=I[B][H];if((0,n.matchesKeystroke)(T,F)){T.stopPropagation(),T.preventDefault(),D=B;break}}D!==void 0&&((j=this.headerToolsButtonMapping.get(D))===null||j===void 0||j.click())}selectItemViaArrowKey(T){T!==void 0&&(this.changeActiveButton(T),T==null||T.focus())}clearToolOnEscape(T){(0,n.matchesKeystroke)(T,"Escape")&&(T.target instanceof HTMLElement&&T.target.blur(),this.actionDispatcher.dispatch(i.EnableDefaultToolsAction.create()))}toggleShortcutVisibility(){this.isShortcutsVisible()?this.hideShortcuts():this.showShortcuts()}isShortcutsVisible(){return this.containerElement.classList.contains(M)}showShortcuts(){this.containerElement.classList.add(M)}hideShortcuts(){this.containerElement.classList.remove(M)}};return $u.KeyboardToolPalette=R,$u.KeyboardToolPalette=R=e([(0,t.injectable)()],R),$u}var tN;function V6(){if(tN)return Ca;tN=1;var e=Ca&&Ca.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=Ca&&Ca.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)},t;Object.defineProperty(Ca,"__esModule",{value:!0}),Ca.GlobalKeyListenerTool=void 0;const i=Y(),a=G(),o=uf(),s=Wm(),r=fh(),d=Xc(),l=hh(),c=JP();let u=t=class{constructor(){this.isEditTool=!1,this.alreadyRegistered=!1}get id(){return t.ID}enable(){this.alreadyRegistered||(this.alreadyRegistered=!0,document.addEventListener("keyup",this.trigger.bind(this)),this.registerShortcutKey())}disable(){}registerShortcutKey(){this.actionDispatcher.onceModelInitialized().then(()=>{this.actionDispatcher.dispatchAll([d.SetAccessibleKeyShortcutAction.create({token:c.KeyboardToolPalette.name,keys:[{shortcuts:["ALT","P"],description:"Focus on tool palette",group:"Tool-Palette",position:0}]}),d.SetAccessibleKeyShortcutAction.create({token:"Graph",keys:[{shortcuts:["ALT","G"],description:"Focus on graph",group:"Graph",position:0}]})])})}trigger(h){this.actionDispatcher.dispatchAll(this.handleKeyEvent(h))}handleKeyEvent(h){return this.matchesSetFocusOnToolPalette(h)?[r.FocusDomAction.create(s.ToolPalette.ID)]:this.matchesSetFocusOnDiagram(h)?[r.FocusDomAction.create("graph")]:this.matchesReleaseFocusFromToolPalette(h)?[i.SetUIExtensionVisibilityAction.create({extensionId:l.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),i.SetUIExtensionVisibilityAction.create({extensionId:o.KeyboardGridMetadata.ID,visible:!1,contextElementsId:[]}),i.SetUIExtensionVisibilityAction.create({extensionId:o.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]})]:[]}matchesSetFocusOnToolPalette(h){return(0,i.matchesKeystroke)(h,"KeyP","alt")}matchesSetFocusOnDiagram(h){return(0,i.matchesKeystroke)(h,"KeyG","alt")}matchesReleaseFocusFromToolPalette(h){return(0,i.matchesKeystroke)(h,"Escape")}};return Ca.GlobalKeyListenerTool=u,u.ID="glsp.global-key-listener",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],u.prototype,"actionDispatcher",void 0),Ca.GlobalKeyListenerTool=u=t=e([(0,a.injectable)()],u),Ca}var Lc={},nN;function ph(){if(nN)return Lc;nN=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.KeyboardGridKeyboardEventAction=Lc.KeyboardGridCellSelectedAction=Lc.EnableKeyboardGridAction=void 0;const e=Y();var n;(function(a){a.KIND="enableKeyboardGrid";function o(r){return e.Action.hasKind(r,a.KIND)&&(0,e.hasObjectProp)(r,"options")}a.is=o;function s(r){return{kind:a.KIND,options:r}}a.create=s})(n||(Lc.EnableKeyboardGridAction=n={}));var t;(function(a){a.KIND="keyboardGridCellSelectedAction";function o(r){return e.Action.hasKind(r,a.KIND)&&(0,e.hasObjectProp)(r,"options")}a.is=o;function s(r){return{kind:a.KIND,options:r}}a.create=s})(t||(Lc.KeyboardGridCellSelectedAction=t={}));var i;return function(a){a.KIND="keyboardGridKeyboardEvent";function o(r){return e.Action.hasKind(r,a.KIND)&&(0,e.hasObjectProp)(r,"options")}a.is=o;function s(r){return{kind:a.KIND,options:r}}a.create=s}(i||(Lc.KeyboardGridKeyboardEventAction=i={})),Lc}var Pa={},iN;function XP(){if(iN)return Pa;iN=1;var e=Pa&&Pa.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=Pa&&Pa.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)};Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.KeyboardGrid=void 0;const t=Y(),i=G(),a=Ya(),o=ph(),s=uf();let r=class extends a.GLSPAbstractUIExtension{constructor(){super(...arguments),this.triggerActions=[]}id(){return s.KeyboardGridMetadata.ID}containerClass(){return s.KeyboardGridMetadata.ID}handle(l){o.EnableKeyboardGridAction.is(l)&&(this.triggerActions=l.options.triggerActions,this.originId=l.options.originId,this.actionDispatcher.dispatch(t.SetUIExtensionVisibilityAction.create({extensionId:s.KeyboardGridMetadata.ID,visible:!0})))}initializeContents(l){l.tabIndex=s.KeyboardGridMetadata.TAB_INDEX,l.classList.add("grid-container");for(let c=1;c<=9;c++){const u=document.createElement("div"),f=document.createElement("div");f.classList.add("grid-item"),f.id=`keyboard-grid-item-${c}`,u.classList.add("grid-item-number"),u.innerHTML=c.toString(),f.appendChild(u),l.appendChild(f)}this.containerElement.onkeydown=c=>{this.onKeyDown(c)}}onKeyDown(l){this.activateCellIfDigitEvent(l),this.hideIfEscapeEvent(l),this.actionDispatcher.dispatch(o.KeyboardGridKeyboardEventAction.create({originId:this.originId,event:l}))}setContainerVisible(l){this.containerElement&&(l?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="0.7"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}show(l,...c){super.show(l,...c),this.containerElement.focus()}hideIfEscapeEvent(l){this.matchesDeactivateGrid(l)&&this.hide()}activateCellIfDigitEvent(l){let c;for(let u=1;u<=9;u++)if(this.matchesGridBoxAtIndex(l,u)){c=u;break}if(c!==void 0){const u=this.centerPositionOfCell(c);this.dispatchActionsForCell(c,u)}}dispatchActionsForCell(l,c){this.actionDispatcher.dispatchAll([...this.triggerActions,o.KeyboardGridCellSelectedAction.create({originId:this.originId,cellId:l.toString(),centerCellPosition:c})])}centerPositionOfCell(l){let c=0,u=0;const f=document.getElementById(`keyboard-grid-item-${l}`);if(f!==null){const h=this.getCenterOfCell(f);c=h[0],u=h[1]}return{x:c,y:u}}matchesDeactivateGrid(l){return(0,t.matchesKeystroke)(l,"Escape")}matchesGridBoxAtIndex(l,c){return(0,t.matchesKeystroke)(l,"Digit"+c)||(0,t.matchesKeystroke)(l,"Numpad"+c)}getOffset(l){let c=0,u=0;for(;l&&!isNaN(l.offsetLeft)&&!isNaN(l.offsetTop);)c+=l.offsetLeft-l.scrollLeft,u+=l.offsetTop-l.scrollTop,l=l.offsetParent;return{top:u,left:c}}getCenterOfCell(l){const c=this.getOffset(l).left,u=this.getOffset(l).top,f=l.offsetWidth,h=l.offsetHeight,p=f/2,g=h/2;return[c+p,u+g]}};return Pa.KeyboardGrid=r,e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],r.prototype,"actionDispatcher",void 0),Pa.KeyboardGrid=r=e([(0,i.injectable)()],r),Pa}var pr={},rN;function eR(){if(rN)return pr;rN=1;var e=pr&&pr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p};Object.defineProperty(pr,"__esModule",{value:!0}),pr.GridRevealNamedElementSuggestionProvider=pr.GridRevealEdgeSuggestionProvider=pr.GridSearchPalette=pr.GridSearchPaletteMetadata=void 0;const n=Y(),t=G(),i=Qm(),a=uf();var o;(function(l){l.ID="grid-search-palette"})(o||(pr.GridSearchPaletteMetadata=o={}));let s=class extends i.SearchAutocompletePalette{id(){return o.ID}getSuggestionProviders(c,u){return[new d,new r]}};pr.GridSearchPalette=s,pr.GridSearchPalette=s=e([(0,t.injectable)()],s);class r extends i.RevealEdgeElementAutocompleteSuggestionProvider{getActions(c){return[...super.getActions(c),n.SetUIExtensionVisibilityAction.create({extensionId:a.KeyboardGridMetadata.ID,visible:!0})]}}pr.GridRevealEdgeSuggestionProvider=r;class d extends i.RevealNamedElementAutocompleteSuggestionProvider{getActions(c){return[...super.getActions(c),n.SetUIExtensionVisibilityAction.create({extensionId:a.KeyboardGridMetadata.ID,visible:!0})]}}return pr.GridRevealNamedElementSuggestionProvider=d,pr}var Ra={},Ko={},wg={},oN;function tR(){if(oN)return wg;oN=1,Object.defineProperty(wg,"__esModule",{value:!0}),wg.SetKeyboardPointerRenderPositionAction=void 0;const e=Y();var n;return function(t){t.KIND="setKeyboardPointerRenderPositionAction";function i(o){return e.Action.hasKind(o,t.KIND)&&(0,e.hasNumberProp)(o,"x")&&(0,e.hasNumberProp)(o,"y")}t.is=i;function a(o,s){return{kind:t.KIND,x:o,y:s}}t.create=a}(n||(wg.SetKeyboardPointerRenderPositionAction=n={})),wg}var Ig={},sN;function G6(){if(sN)return Ig;sN=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.KeyboardPointerKeyboardListener=void 0;const e=Y(),n=Un(),t=an(),i=uf(),a=hh();class o{get position(){return this.keyboardPointer.getPosition}constructor(r,d){this.keyboardPointer=r,this.actionDispatcher=d}keyDown(r){this.moveIfArrows(r),this.createIfEnterEvent(r),this.hideIfEscapeEvent(r)}moveIfArrows(r){this.matchesMovePointerDown(r)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,10),this.keyboardPointer.render()):this.matchesMovePointerUp(r)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,-10),this.keyboardPointer.render()):this.matchesMovePointerRight(r)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(10,0),this.keyboardPointer.render()):this.matchesMovePointerLeft(r)&&(this.position.renderPosition=this.position.calcRelativeRenderPosition(-10,0),this.keyboardPointer.render())}createIfEnterEvent(r){const d=this.keyboardPointer.triggerAction.elementTypeId,{container:l,status:c}=this.position.containableParentAtDiagramPosition(d);if(l!==void 0&&c===n.CursorCSS.NODE_CREATION){if(this.matchesConfirmPointerPosition(r)){const u=l.id,f=this.position.diagramPosition;this.actionDispatcher.dispatchAll([e.SetUIExtensionVisibilityAction.create({extensionId:a.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),e.SetUIExtensionVisibilityAction.create({extensionId:i.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]}),e.CreateNodeOperation.create(d,{location:f,containerId:u,args:this.keyboardPointer.triggerAction.args}),t.EnableDefaultToolsAction.create()])}else if(this.matchesConfirmPointerPositionAndStayInMode(r)){const u=l.id,f=this.position.diagramPosition;this.actionDispatcher.dispatch(e.CreateNodeOperation.create(d,{location:f,containerId:u,args:this.keyboardPointer.triggerAction.args}))}}}hideIfEscapeEvent(r){this.matchesDeactivatePointer(r)&&this.keyboardPointer.hide()}matchesDeactivatePointer(r){return(0,e.matchesKeystroke)(r,"Escape")}matchesConfirmPointerPosition(r){return(0,e.matchesKeystroke)(r,"Enter")}matchesConfirmPointerPositionAndStayInMode(r){return(0,e.matchesKeystroke)(r,"Enter","ctrl")}matchesMovePointerLeft(r){return(0,e.matchesKeystroke)(r,"ArrowLeft")}matchesMovePointerRight(r){return(0,e.matchesKeystroke)(r,"ArrowRight")}matchesMovePointerUp(r){return(0,e.matchesKeystroke)(r,"ArrowUp")}matchesMovePointerDown(r){return(0,e.matchesKeystroke)(r,"ArrowDown")}}return Ig.KeyboardPointerKeyboardListener=o,Ig}var Tg={},aN;function z6(){if(aN)return Tg;aN=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.KeyboardPointerPosition=void 0;const e=Y(),n=Un(),t=Wo(),i=Um(),a=hh();class o{constructor(r){this.keyboardPointer=r,this.renderPosition={x:20,y:20}}get centerizedRenderPosition(){return{x:this.renderPosition.x+a.KeyboardPointerMetadata.CIRCLE_WIDTH/2,y:this.renderPosition.y+a.KeyboardPointerMetadata.CRICLE_HEIGHT/2}}get diagramPosition(){return(0,t.getAbsolutePositionByPoint)(this.keyboardPointer.editorContextService.modelRoot,this.centerizedRenderPosition)}childrenAtDiagramPosition(){const r=this.diagramPosition;return[this.keyboardPointer.editorContextService.modelRoot,...(0,e.findChildrenAtPosition)(this.keyboardPointer.editorContextService.modelRoot,r)]}containableParentAtDiagramPosition(r){const d=this.childrenAtDiagramPosition();return this.containableParentOf(d.reverse()[0],r)}calcRelativeRenderPosition(r,d){return{x:this.renderPosition.x+r,y:this.renderPosition.y+d}}containableParentOf(r,d){const l=(0,e.findParentByFeature)(r,i.isContainable);return{container:l,status:this.keyboardPointer.containerManager.isCreationAllowed(l,d)?n.CursorCSS.NODE_CREATION:n.CursorCSS.OPERATION_NOT_ALLOWED}}}return Tg.KeyboardPointerPosition=o,Tg}var cN;function nR(){if(cN)return Ko;cN=1;var e=Ko&&Ko.__decorate||function(g,m,v,_){var S=arguments.length,E=S<3?m:_===null?_=Object.getOwnPropertyDescriptor(m,v):_,C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,m,v,_);else for(var M=g.length-1;M>=0;M--)(C=g[M])&&(E=(S<3?C(E):S>3?C(m,v,E):C(m,v))||E);return S>3&&E&&Object.defineProperty(m,v,E),E},n=Ko&&Ko.__metadata||function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},t=Ko&&Ko.__param||function(g,m){return function(v,_){m(v,_,g)}};Object.defineProperty(Ko,"__esModule",{value:!0}),Ko.KeyboardPointer=void 0;const i=Y(),a=G(),o=kn(),s=Un(),r=Ya(),d=UP(),l=ph(),c=tR(),u=hh(),f=G6(),h=z6();let p=class extends r.GLSPAbstractUIExtension{constructor(m){super(),this.actionDispatcher=m,this._triggerAction={elementTypeId:"task:automated",kind:"triggerNodeCreation"},this.position=new h.KeyboardPointerPosition(this),this.keyListener=new f.KeyboardPointerKeyboardListener(this,m)}get triggerAction(){return this._triggerAction}get isVisible(){var m;return((m=this.containerElement)===null||m===void 0?void 0:m.style.visibility)==="visible"}get getPosition(){return this.position}get getKeyListener(){return this.keyListener}id(){return u.KeyboardPointerMetadata.ID}containerClass(){return u.KeyboardPointerMetadata.ID}initializeContents(m){m.style.position="absolute",m.style.height=`${u.KeyboardPointerMetadata.CRICLE_HEIGHT}px`,m.style.width=`${u.KeyboardPointerMetadata.CIRCLE_WIDTH}px`,m.style.borderRadius="100%"}onBeforeShow(m,v,..._){this.render()}handle(m){i.TriggerNodeCreationAction.is(m)?this._triggerAction=m:c.SetKeyboardPointerRenderPositionAction.is(m)?(this.position.renderPosition={x:m.x,y:m.y},this.render()):l.KeyboardGridCellSelectedAction.is(m)&&m.options.originId===u.KeyboardPointerMetadata.ID&&(this.position.renderPosition=m.options.centerCellPosition,this.render())}render(){if(this.containerElement!==void 0){const{x:m,y:v}=this.position.renderPosition;this.containerElement.style.left=`${m}px`,this.containerElement.style.top=`${v}px`;const{status:_}=this.position.containableParentAtDiagramPosition(this._triggerAction.elementTypeId);switch(this.containerElement.style.borderStyle="solid",this.containerElement.style.borderWidth="thick",_){case s.CursorCSS.NODE_CREATION:{this.containerElement.style.borderColor="green";break}case s.CursorCSS.OPERATION_NOT_ALLOWED:{this.containerElement.style.borderColor="red";break}}}}};return Ko.KeyboardPointer=p,e([(0,a.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],p.prototype,"editorContextService",void 0),e([(0,a.inject)(i.TYPES.IContainerManager),n("design:type",d.ContainerManager)],p.prototype,"containerManager",void 0),Ko.KeyboardPointer=p=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.IActionDispatcher)),n("design:paramtypes",[Object])],p),Ko}var uN;function U6(){if(uN)return Ra;uN=1;var e=Ra&&Ra.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Ra&&Ra.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)};Object.defineProperty(Ra,"__esModule",{value:!0}),Ra.KeyboardNodeGrid=void 0;const t=Y(),i=G(),a=hh(),o=nR(),s=uf(),r=XP(),d=eR();let l=class extends r.KeyboardGrid{constructor(){super(...arguments),this.triggerActions=[t.SetUIExtensionVisibilityAction.create({extensionId:a.KeyboardPointerMetadata.ID,visible:!0})],this.originId=a.KeyboardPointerMetadata.ID}id(){return s.KeyboardNodeGridMetadata.ID}handle(u){}onKeyDown(u){super.onKeyDown(u),this.showSearchOnEvent(u),this.keyboardPointer.isVisible&&this.keyboardPointer.getKeyListener.keyDown(u)}showSearchOnEvent(u){(0,t.matchesKeystroke)(u,"KeyF","ctrl")&&(u.preventDefault(),this.actionDispatcher.dispatch(t.SetUIExtensionVisibilityAction.create({extensionId:d.GridSearchPaletteMetadata.ID,visible:!0})),this.hide())}};return Ra.KeyboardNodeGrid=l,e([(0,i.inject)(o.KeyboardPointer),n("design:type",o.KeyboardPointer)],l.prototype,"keyboardPointer",void 0),Ra.KeyboardNodeGrid=l=e([(0,i.injectable)()],l),Ra}var lN;function $6(){if(lN)return ld;lN=1,Object.defineProperty(ld,"__esModule",{value:!0}),ld.configureKeyboardControlTools=ld.keyboardControlModule=void 0;const e=Y(),n=QP(),t=x_(),i=H6(),a=V6(),o=ph(),s=XP(),r=eR(),d=U6(),l=tR(),c=nR();ld.keyboardControlModule=new e.FeatureModule((f,h,p,g)=>{u({bind:f,unbind:h,isBound:p,rebind:g})},{featureId:Symbol("keyboardControl")});function u(f){(0,e.bindAsService)(f,e.TYPES.IDefaultTool,a.GlobalKeyListenerTool),(0,e.bindAsService)(f,e.TYPES.IUIExtension,c.KeyboardPointer),(0,e.bindAsService)(f,e.TYPES.IUIExtension,s.KeyboardGrid),(0,e.bindAsService)(f,e.TYPES.IUIExtension,d.KeyboardNodeGrid),(0,e.configureActionHandler)(f,e.TriggerNodeCreationAction.KIND,c.KeyboardPointer),(0,e.configureActionHandler)(f,l.SetKeyboardPointerRenderPositionAction.KIND,c.KeyboardPointer),(0,e.bindAsService)(f,e.TYPES.IUIExtension,t.EdgeAutocompletePalette),(0,e.bindAsService)(f,e.TYPES.IDefaultTool,i.EdgeAutocompletePaletteTool),(0,e.configureActionHandler)(f,o.EnableKeyboardGridAction.KIND,s.KeyboardGrid),(0,e.configureActionHandler)(f,o.KeyboardGridCellSelectedAction.KIND,c.KeyboardPointer),(0,e.configureActionHandler)(f,e.TriggerEdgeCreationAction.KIND,t.EdgeAutocompletePalette),(0,e.configureActionHandler)(f,n.SetEdgeTargetSelectionAction.KIND,t.EdgeAutocompletePalette),(0,e.bindAsService)(f,e.TYPES.IUIExtension,r.GridSearchPalette)}return ld.configureKeyboardControlTools=u,ld}var fd={},dN;function Y6(){if(dN)return fd;dN=1,Object.defineProperty(fd,"__esModule",{value:!0}),fd.configureKeyboardToolPaletteTool=fd.keyboardToolPaletteModule=void 0;const e=Y(),n=an(),t=Wm(),i=fh(),a=JP();fd.keyboardToolPaletteModule=new e.FeatureModule((s,r,d,l)=>{o({bind:s,unbind:r,isBound:d,rebind:l})},{featureId:Symbol("keyboardToolPalette")});function o(s){(0,e.bindAsService)(s,e.TYPES.IUIExtension,a.KeyboardToolPalette),s.bind(e.TYPES.IDiagramStartup).toService(a.KeyboardToolPalette),(0,e.configureActionHandler)(s,n.EnableDefaultToolsAction.KIND,a.KeyboardToolPalette),(0,e.configureActionHandler)(s,i.FocusDomAction.KIND,a.KeyboardToolPalette),(0,e.configureActionHandler)(s,t.EnableToolPaletteAction.KIND,a.KeyboardToolPalette),(0,e.configureActionHandler)(s,e.UpdateModelAction.KIND,a.KeyboardToolPalette),(0,e.configureActionHandler)(s,e.SetModelAction.KIND,a.KeyboardToolPalette)}return fd.configureKeyboardToolPaletteTool=o,fd}var hd={},li={},fN;function iR(){if(fN)return li;fN=1;var e=li&&li.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=li&&li.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)};Object.defineProperty(li,"__esModule",{value:!0}),li.MoveElementHandler=li.MoveViewportHandler=li.MoveElementAction=li.MoveViewportAction=void 0;const t=Y(),i=G(),a=cf(),o=kn(),s=kt(),r=Ym(),d=Wo();var l;(function(h){h.KIND="moveViewportAction";function p(m){return t.Action.hasKind(m,h.KIND)}h.is=p;function g(m,v){return{kind:h.KIND,moveX:m,moveY:v}}h.create=g})(l||(li.MoveViewportAction=l={}));var c;(function(h){h.KIND="moveElementAction";function p(m){return t.Action.hasKind(m,h.KIND)}h.is=p;function g(m,v,_,S=!0){return{kind:h.KIND,elementIds:m,moveX:v,moveY:_,snap:S}}h.create=g})(c||(li.MoveElementAction=c={}));let u=class{handle(p){l.is(p)&&this.handleMoveViewport(p)}handleMoveViewport(p){const g=(0,t.findParentByFeature)(this.editorContextService.modelRoot,t.isViewport);g&&this.dispatcher.dispatch(this.moveViewport(g,p.moveX,p.moveY))}moveViewport(p,g,m){const v={scroll:{x:p.scroll.x+g,y:p.scroll.y+m},zoom:p.zoom};return t.SetViewportAction.create(p.id,v,{animate:!1})}};li.MoveViewportHandler=u,e([(0,i.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],u.prototype,"editorContextService",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],u.prototype,"dispatcher",void 0),li.MoveViewportHandler=u=e([(0,i.injectable)()],u);let f=class{init(){this.moveFeedback=this.feedbackDispatcher.createEmitter()}handle(p){c.is(p)&&this.handleMoveElement(p)}handleMoveElement(p){const g=this.editorContextService.modelRoot,m=(0,t.findParentByFeature)(g,t.isViewport);if(!m)return;const v=[],_=[],S=(0,s.getElements)(g.index,p.elementIds,s.isSelectableAndBoundsAware);for(const C of S){const M=this.getTargetBounds(C,p);_.push({elementId:C.id,fromPosition:{x:C.bounds.x,y:C.bounds.y},toPosition:M}),(0,d.outsideOfViewport)(M,m)&&v.push(l.create(p.moveX,p.moveY))}this.dispatcher.dispatchAll(v);const E=t.MoveAction.create(_,{animate:!1});this.moveFeedback.add(E).submit(),this.scheduleChangeBounds(this.toElementAndBounds(_))}getTargetBounds(p,g){let m=t.Point.add(p.bounds,{x:g.moveX,y:g.moveY});return this.snapper&&g.snap&&(m=this.snapper.snap(m,p)),(0,r.isValidMove)(p,m,this.movementRestrictor)||(m={x:p.bounds.x,y:p.bounds.y}),m}scheduleChangeBounds(p){var g;(g=this.debouncedChangeBounds)===null||g===void 0||g.cancel(),this.debouncedChangeBounds=(0,a.debounce)(()=>{this.moveFeedback.dispose(),this.dispatcher.dispatchAll([t.ChangeBoundsOperation.create(p)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}toElementAndBounds(p){const g=[];for(const m of p){const v=this.editorContextService.modelRoot.index.getById(m.elementId);v&&(0,t.isBoundsAware)(v)&&g.push({elementId:m.elementId,newSize:{height:v.bounds.height,width:v.bounds.width},newPosition:{x:m.toPosition.x,y:m.toPosition.y}})}return g}};return li.MoveElementHandler=f,e([(0,i.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],f.prototype,"editorContextService",void 0),e([(0,i.inject)(t.TYPES.IActionDispatcher),n("design:type",Object)],f.prototype,"dispatcher",void 0),e([(0,i.inject)(t.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],f.prototype,"feedbackDispatcher",void 0),e([(0,i.inject)(t.TYPES.ISnapper),(0,i.optional)(),n("design:type",Object)],f.prototype,"snapper",void 0),e([(0,i.inject)(t.TYPES.IMovementRestrictor),(0,i.optional)(),n("design:type",Object)],f.prototype,"movementRestrictor",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],f.prototype,"init",null),li.MoveElementHandler=f=e([(0,i.injectable)()],f),li}var di={},hN;function rR(){if(hN)return di;hN=1;var e=di&&di.__decorate||function(u,f,h,p){var g=arguments.length,m=g<3?f:p===null?p=Object.getOwnPropertyDescriptor(f,h):p,v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(u,f,h,p);else for(var _=u.length-1;_>=0;_--)(v=u[_])&&(m=(g<3?v(m):g>3?v(f,h,m):v(f,h))||m);return g>3&&m&&Object.defineProperty(f,h,m),m},n=di&&di.__metadata||function(u,f){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,f)};Object.defineProperty(di,"__esModule",{value:!0}),di.ZoomElementHandler=di.ZoomViewportHandler=di.ZoomElementAction=di.ZoomViewportAction=void 0;const t=G(),i=cf(),a=Y(),o=kn(),s=kt();var r;(function(u){u.KIND="zoomViewportAction";function f(p){return a.Action.hasKind(p,u.KIND)}u.is=f;function h(p){return{kind:u.KIND,zoomFactor:p}}u.create=h})(r||(di.ZoomViewportAction=r={}));var d;(function(u){u.KIND="zoomElementAction";function f(p){return a.Action.hasKind(p,u.KIND)}u.is=f;function h(p,g){return{kind:u.KIND,elementIds:p,zoomFactor:g}}u.create=h})(d||(di.ZoomElementAction=d={}));let l=class{constructor(){this.throttledHandleViewportZoom=(0,i.throttle)(f=>this.handleZoomViewport(f),150)}handle(f){r.is(f)&&this.throttledHandleViewportZoom(f)}handleZoomViewport(f){const h=(0,a.findParentByFeature)(this.editorContextService.modelRoot,a.isViewport);h&&this.dispatcher.dispatch(this.setNewZoomFactor(h,f.zoomFactor))}setNewZoomFactor(f,h){const p=f.zoom*h,g={scroll:f.scroll,zoom:p};return a.SetViewportAction.create(f.id,g,{animate:!0})}};di.ZoomViewportHandler=l,l.defaultZoomInFactor=1.1,l.defaultZoomOutFactor=.9,e([(0,t.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],l.prototype,"editorContextService",void 0),e([(0,t.inject)(a.TYPES.IActionDispatcher),n("design:type",Object)],l.prototype,"dispatcher",void 0),di.ZoomViewportHandler=l=e([(0,t.injectable)()],l);let c=class{constructor(){this.throttledHandleElementZoom=(0,i.throttle)(f=>this.handleZoomElement(f),150)}handle(f){d.is(f)&&this.throttledHandleElementZoom(f)}handleZoomElement(f){const h=(0,a.findParentByFeature)(this.editorContextService.modelRoot,a.isViewport);if(!h)return;const p=(0,s.getElements)(this.editorContextService.modelRoot.index,f.elementIds,s.isSelectableAndBoundsAware),g=this.getCenter(h,p);this.dispatcher.dispatch(this.setNewZoomFactor(h,f.zoomFactor,g))}getCenter(f,h){const g=h.map(m=>this.boundsInViewport(f,m,m.bounds)).reduce((m,v)=>a.Bounds.combine(m,v));return a.Bounds.center(g)}boundsInViewport(f,h,p){return h instanceof a.GChildElement&&h.parent!==f?this.boundsInViewport(f,h.parent,h.parent.localToParent(p)):p}setNewZoomFactor(f,h,p){const g=f.zoom*h,m={scroll:{x:p.x-.5*f.canvasBounds.width/g,y:p.y-.5*f.canvasBounds.height/g},zoom:g};return a.SetViewportAction.create(f.id,m,{animate:!0})}};return di.ZoomElementHandler=c,e([(0,t.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],c.prototype,"editorContextService",void 0),e([(0,t.inject)(a.TYPES.IActionDispatcher),n("design:type",Object)],c.prototype,"dispatcher",void 0),di.ZoomElementHandler=c=e([(0,t.injectable)()],c),di}var pN;function W6(){if(pN)return hd;pN=1,Object.defineProperty(hd,"__esModule",{value:!0}),hd.configureMoveZoom=hd.moveZoomModule=void 0;const e=Y(),n=iR(),t=rR();hd.moveZoomModule=new e.FeatureModule((a,o,s,r)=>{i({bind:a,unbind:o,isBound:s,rebind:r})},{featureId:Symbol("moveZoom")});function i(a){a.bind(n.MoveViewportHandler).toSelf().inSingletonScope(),a.bind(n.MoveElementHandler).toSelf().inSingletonScope(),a.bind(t.ZoomViewportHandler).toSelf().inSingletonScope(),a.bind(t.ZoomElementHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)(a,n.MoveViewportAction.KIND,n.MoveViewportHandler),(0,e.configureActionHandler)(a,n.MoveElementAction.KIND,n.MoveElementHandler),(0,e.configureActionHandler)(a,t.ZoomViewportAction.KIND,t.ZoomViewportHandler),(0,e.configureActionHandler)(a,t.ZoomElementAction.KIND,t.ZoomElementHandler)}return hd.configureMoveZoom=i,hd}var pd={},Ci={},gN;function oR(){if(gN)return Ci;gN=1;var e=Ci&&Ci.__decorate||function(h,p,g,m){var v=arguments.length,_=v<3?p:m===null?m=Object.getOwnPropertyDescriptor(p,g):m,S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")_=Reflect.decorate(h,p,g,m);else for(var E=h.length-1;E>=0;E--)(S=h[E])&&(_=(v<3?S(_):v>3?S(p,g,_):S(p,g))||_);return v>3&&_&&Object.defineProperty(p,g,_),_},n=Ci&&Ci.__metadata||function(h,p){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(h,p)},t=Ci&&Ci.__param||function(h,p){return function(g,m){p(g,m,h)}},i;Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.ResizeElementHandler=Ci.ResizeElementAction=Ci.ResizeType=void 0;const a=Y(),o=G(),s=cf(),r=kn(),d=kt(),l=Ym();var c;(function(h){h[h.Increase=0]="Increase",h[h.Decrease=1]="Decrease",h[h.MinSize=2]="MinSize"})(c||(Ci.ResizeType=c={}));var u;(function(h){h.KIND="resizeElementAction";function p(m){return a.Action.hasKind(m,h.KIND)}h.is=p;function g(m,v){return{kind:h.KIND,elementIds:m,resizeType:v}}h.create=g})(u||(Ci.ResizeElementAction=u={}));let f=i=class{constructor(p){this.snapper=p,this.grid={x:i.defaultResizeX,y:i.defaultResizeY},this.isEditMode=!1}init(){this.resizeFeedback=this.feedbackDispatcher.createEmitter()}handle(p){u.is(p)&&this.handleResizeElement(p)}handleResizeElement(p){var g;const m=(0,d.getElements)(this.editorContextService.modelRoot.index,p.elementIds,d.isSelectableAndBoundsAware),v=this.computeElementAndBounds(m,p);this.resizeFeedback.add(a.SetBoundsAction.create(v)).submit(),(g=this.debouncedChangeBounds)===null||g===void 0||g.cancel(),this.debouncedChangeBounds=(0,s.debounce)(()=>{this.resizeFeedback.dispose(),this.dispatcher.dispatchAll([a.ChangeBoundsOperation.create(v)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}computeElementAndBounds(p,g){const m=[];return p.forEach(v=>{const{x:_,y:S,width:E,height:C}=v.bounds;let M=0,L=0;if(g.resizeType===c.Decrease?(M=E-this.grid.x,L=C-this.grid.y):g.resizeType===c.Increase?(M=E+this.grid.x,L=C+this.grid.y):g.resizeType===c.MinSize&&(M=(0,l.minWidth)(v),L=(0,l.minHeight)(v)),this.isValidBoundChange(v,{x:_,y:S},{width:M,height:L})){const I={id:v.id,bounds:{x:_,y:S,width:M,height:L}};m.push((0,d.toElementAndBounds)(I))}}),m}isValidBoundChange(p,g,m){return(0,l.isValidSize)(p,m)&&(0,l.isValidMove)(p,g)}};return Ci.ResizeElementHandler=f,f.defaultResizeX=20,f.defaultResizeY=20,e([(0,o.inject)(r.EditorContextService),n("design:type",r.EditorContextService)],f.prototype,"editorContextService",void 0),e([(0,o.inject)(a.TYPES.IActionDispatcher),n("design:type",Object)],f.prototype,"dispatcher",void 0),e([(0,o.inject)(a.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],f.prototype,"feedbackDispatcher",void 0),e([(0,o.inject)(a.TYPES.Grid),(0,o.optional)(),n("design:type",Object)],f.prototype,"grid",void 0),e([(0,o.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],f.prototype,"init",null),Ci.ResizeElementHandler=f=i=e([(0,o.injectable)(),t(0,(0,o.inject)(a.TYPES.ISnapper)),t(0,(0,o.optional)()),n("design:paramtypes",[Object])],f),Ci}var Gr={},mN;function Z6(){if(mN)return Gr;mN=1;var e=Gr&&Gr.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},n=Gr&&Gr.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)},t,i;Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.ResizeKeyListener=Gr.ResizeKeyTool=void 0;const a=Y(),o=G(),s=Er(),r=an(),d=Xc(),l=Jm,c=ll(),u=oR();let f=t=class{constructor(){this.isEditTool=!0,this.resizeKeyListener=new h(this)}get id(){return t.ID}enable(){this.keytool.register(this.resizeKeyListener),this.resizeKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.resizeKeyListener)}};Gr.ResizeKeyTool=f,f.ID="glsp.resize-key-tool",e([(0,o.inject)(a.KeyTool),n("design:type",a.KeyTool)],f.prototype,"keytool",void 0),e([(0,o.inject)(a.TYPES.IMovementRestrictor),(0,o.optional)(),n("design:type",Object)],f.prototype,"movementRestrictor",void 0),e([(0,o.inject)(a.TYPES.ISnapper),(0,o.optional)(),n("design:type",Object)],f.prototype,"snapper",void 0),e([(0,o.inject)(a.TYPES.IActionDispatcher),n("design:type",Object)],f.prototype,"actionDispatcher",void 0),e([(0,o.inject)(s.SelectionService),n("design:type",s.SelectionService)],f.prototype,"selectionService",void 0),Gr.ResizeKeyTool=f=t=e([(0,o.injectable)()],f);let h=i=class extends a.KeyListener{constructor(g){super(),this.tool=g,this.isEditMode=!1,this.token=i.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(d.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["ALT","A"],description:"Activate resize mode for selected element",group:"Resize",position:0},{shortcuts:["+"],description:"Increase size of element",group:"Resize",position:1},{shortcuts:["-"],description:"Increase size of element",group:"Resize",position:2},{shortcuts:["CTRL","0"],description:"Set element size to default",group:"Resize",position:3}]}))}keyDown(g,m){const v=[],_=this.tool.selectionService.getSelectedElementIDs();return this.isEditMode&&this.matchesDeactivateResizeModeKeystroke(m)&&(this.isEditMode=!1,this.tool.actionDispatcher.dispatch(c.ShowToastMessageAction.createWithTimeout({id:Symbol.for(i.name),message:l.resize.resize_mode_deactivated})),v.push(r.EnableDefaultToolsAction.create())),_.length>0&&(!this.isEditMode&&this.matchesActivateResizeModeKeystroke(m)&&(this.isEditMode=!0,this.tool.actionDispatcher.dispatch(c.ShowToastMessageAction.create({id:Symbol.for(i.name),message:l.resize.resize_mode_activated})),v.push(r.EnableToolsAction.create([f.ID]))),this.isEditMode&&(this.matchesIncreaseSizeKeystroke(m)?v.push(u.ResizeElementAction.create(_,u.ResizeType.Increase)):this.matchesDecreaseSizeKeystroke(m)?v.push(u.ResizeElementAction.create(_,u.ResizeType.Decrease)):this.matchesMinSizeKeystroke(m)&&v.push(u.ResizeElementAction.create(_,u.ResizeType.MinSize)))),v}matchesIncreaseSizeKeystroke(g){return g.key==="+"||(0,a.matchesKeystroke)(g,"NumpadAdd")}matchesActivateResizeModeKeystroke(g){return(0,a.matchesKeystroke)(g,"KeyA","alt")}matchesDeactivateResizeModeKeystroke(g){return(0,a.matchesKeystroke)(g,"Escape")}matchesMinSizeKeystroke(g){return(0,a.matchesKeystroke)(g,"Digit0","ctrl")||(0,a.matchesKeystroke)(g,"Numpad0","ctrl")}matchesDecreaseSizeKeystroke(g){return(0,a.matchesKeystroke)(g,"Minus")||(0,a.matchesKeystroke)(g,"NumpadSubtract")}};return Gr.ResizeKeyListener=h,Gr.ResizeKeyListener=h=i=e([(0,o.injectable)(),n("design:paramtypes",[f])],h),Gr}var vN;function Q6(){if(vN)return pd;vN=1,Object.defineProperty(pd,"__esModule",{value:!0}),pd.configureResizeTools=pd.resizeKeyModule=void 0;const e=Y(),n=oR(),t=Z6();pd.resizeKeyModule=new e.FeatureModule((a,o,s,r)=>{i({bind:a,unbind:o,isBound:s,rebind:r})},{featureId:Symbol("resizeKey")});function i(a){a.bind(n.ResizeElementHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)(a,n.ResizeElementAction.KIND,n.ResizeElementHandler),(0,e.bindAsService)(a,e.TYPES.IDefaultTool,t.ResizeKeyTool)}return pd.configureResizeTools=i,pd}var gd={},yN;function J6(){if(yN)return gd;yN=1,Object.defineProperty(gd,"__esModule",{value:!0}),gd.configureSearchPaletteModule=gd.searchPaletteModule=void 0;const e=Y(),n=Qm(),t=ZP();gd.searchPaletteModule=new e.FeatureModule((a,o,s,r)=>{i({bind:a,isBound:s,rebind:r})},{featureId:Symbol("searchPalette")});function i(a){(0,e.bindAsService)(a,e.TYPES.IUIExtension,n.SearchAutocompletePalette),(0,e.bindAsService)(a,e.TYPES.IDefaultTool,t.SearchAutocompletePaletteTool)}return gd.configureSearchPaletteModule=i,gd}var _S={},Ma={},_N;function X6(){if(_N)return Ma;_N=1;var e=Ma&&Ma.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=Ma&&Ma.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t;Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.Toast=void 0;const i=Y(),a=G(),o=kn(),s=Ya(),r=ll();let d=t=class extends s.GLSPAbstractUIExtension{constructor(){super(...arguments),this.messages={}}id(){return t.ID}containerClass(){return t.ID}initializeContents(c){this.render()}handle(c){r.ShowToastMessageAction.is(c)?(this.messages[c.options.id]=c.options,this.render(),c.options.timeout&&setTimeout(()=>{this.delete(c.options.id)},c.options.timeout)):r.HideToastAction.is(c)&&(c.options.timeout?setTimeout(()=>{this.delete(c.options.id)},c.options.timeout):this.delete(c.options.id))}render(){this.containerElement!==void 0&&(this.containerElement.innerHTML="",this.values(this.messages).forEach(c=>{this.containerElement.appendChild(this.createToastMessage(c))}))}delete(c){delete this.messages[c],this.render()}createToastMessage(c){const u=document.createElement("div");u.classList.add("toast-cell",`toast-column-${c.position}`);const f=document.createElement("div");f.classList.add("toast-container");const h=document.createElement("span");return h.textContent=c.message,f.appendChild(h),u.appendChild(f),u}preInitialize(){this.actionDispatcher.dispatch(i.SetUIExtensionVisibilityAction.create({extensionId:t.ID,visible:!0}))}values(c){return Object.getOwnPropertySymbols(c).map(u=>c[u])}};return Ma.Toast=d,d.ID="toast",e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],d.prototype,"actionDispatcher",void 0),e([(0,a.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],d.prototype,"editorContext",void 0),Ma.Toast=d=t=e([(0,a.injectable)()],d),Ma}var bN;function e4(){return bN||(bN=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.glspToastModule=e.configureToastTool=e.toastModule=void 0;const n=Y(),t=ll(),i=X6();e.toastModule=new n.FeatureModule((o,s,r,d)=>{a({bind:o,unbind:s,isBound:r,rebind:d})},{featureId:Symbol("toast")}),e.glspToastModule=e.toastModule;function a(o){(0,n.bindAsService)(o,n.TYPES.IUIExtension,i.Toast),o.bind(n.TYPES.IDiagramStartup).toService(i.Toast),(0,n.configureActionHandler)(o,t.ShowToastMessageAction.KIND,i.Toast),(0,n.configureActionHandler)(o,t.HideToastAction.KIND,i.Toast)}e.configureToastTool=a}(_S)),_S}var md={},qo={},SN;function t4(){if(SN)return qo;SN=1;var e=qo&&qo.__decorate||function(d,l,c,u){var f=arguments.length,h=f<3?l:u===null?u=Object.getOwnPropertyDescriptor(l,c):u,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")h=Reflect.decorate(d,l,c,u);else for(var g=d.length-1;g>=0;g--)(p=d[g])&&(h=(f<3?p(h):f>3?p(l,c,h):p(l,c))||h);return f>3&&h&&Object.defineProperty(l,c,h),h},n=qo&&qo.__metadata||function(d,l){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(d,l)},t;Object.defineProperty(qo,"__esModule",{value:!0}),qo.DeselectKeyListener=qo.DeselectKeyTool=void 0;const i=Y(),a=G(),o=L_();let s=t=class{constructor(){this.isEditTool=!0,this.deselectKeyListener=new r}get id(){return t.ID}enable(){this.keytool.register(this.deselectKeyListener)}disable(){this.keytool.deregister(this.deselectKeyListener)}};qo.DeselectKeyTool=s,s.ID="glsp.deselect-key-tool",e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],s.prototype,"keytool",void 0),e([(0,a.inject)(i.TYPES.IToolManager),n("design:type",Object)],s.prototype,"toolManager",void 0),qo.DeselectKeyTool=s=t=e([(0,a.injectable)()],s);class r extends i.KeyListener{keyDown(l,c){if(this.matchesDeselectKeystroke(c)){const u=(0,i.toArray)(l.root.index.all().filter(p=>(0,i.isSelectable)(p)&&p.selected)),f=[];u.length>0&&f.push(i.SelectAction.create({deselectedElementsIDs:u.map(p=>p.id)}));const h=u.filter(p=>p instanceof i.GRoutableElement).map(p=>p.id);return h.length>0&&f.push(o.SwitchRoutingModeAction.create({elementsToDeactivate:h})),f}return[]}matchesDeselectKeystroke(l){return(0,i.matchesKeystroke)(l,"Escape")}}return qo.DeselectKeyListener=r,qo}var Ho={},EN;function n4(){if(EN)return Ho;EN=1;var e=Ho&&Ho.__decorate||function(c,u,f,h){var p=arguments.length,g=p<3?u:h===null?h=Object.getOwnPropertyDescriptor(u,f):h,m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(c,u,f,h);else for(var v=c.length-1;v>=0;v--)(m=c[v])&&(g=(p<3?m(g):p>3?m(u,f,g):m(u,f))||g);return p>3&&g&&Object.defineProperty(u,f,g),g},n=Ho&&Ho.__metadata||function(c,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(c,u)},t;Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.MoveKeyListener=Ho.MovementKeyTool=void 0;const i=Y(),a=G(),o=Er(),s=Xc(),r=iR();let d=t=class{constructor(){this.isEditTool=!0}get id(){return t.ID}enable(){this.movementKeyListener||(this.movementKeyListener=new l(this,this.grid)),this.keytool.register(this.movementKeyListener),this.movementKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.movementKeyListener)}};Ho.MovementKeyTool=d,d.ID="glsp.movement-key-tool",e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],d.prototype,"keytool",void 0),e([(0,a.inject)(o.SelectionService),n("design:type",o.SelectionService)],d.prototype,"selectionService",void 0),e([(0,a.inject)(i.TYPES.ISnapper),(0,a.optional)(),n("design:type",Object)],d.prototype,"snapper",void 0),e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],d.prototype,"actionDispatcher",void 0),e([(0,a.inject)(i.TYPES.Grid),(0,a.optional)(),n("design:type",Object)],d.prototype,"grid",void 0),e([(0,a.inject)(i.TYPES.IChangeBoundsManager),n("design:type",Object)],d.prototype,"changeBoundsManager",void 0),Ho.MovementKeyTool=d=t=e([(0,a.injectable)()],d);class l extends i.KeyListener{constructor(u,f={x:l.defaultMoveX,y:l.defaultMoveY}){super(),this.tool=u,this.grid=f,this.token=l.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(s.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["      "],description:"Move element or viewport",group:"Move",position:0}]}))}keyDown(u,f){const h=this.tool.selectionService.getSelectedElementIDs(),p=this.tool.changeBoundsManager.usePositionSnap(f),g=p?this.grid.x:1,m=p?this.grid.y:1;if(h.length>0){if(this.matchesMoveUpKeystroke(f))return[r.MoveElementAction.create(h,0,-m,p)];if(this.matchesMoveDownKeystroke(f))return[r.MoveElementAction.create(h,0,m,p)];if(this.matchesMoveRightKeystroke(f))return[r.MoveElementAction.create(h,g,0,p)];if(this.matchesMoveLeftKeystroke(f))return[r.MoveElementAction.create(h,-g,0,p)]}else{if(this.matchesMoveUpKeystroke(f))return[r.MoveViewportAction.create(0,-m)];if(this.matchesMoveDownKeystroke(f))return[r.MoveViewportAction.create(0,m)];if(this.matchesMoveRightKeystroke(f))return[r.MoveViewportAction.create(g,0)];if(this.matchesMoveLeftKeystroke(f))return[r.MoveViewportAction.create(-g,0)]}return[]}matchesMoveUpKeystroke(u){const f=this.tool.changeBoundsManager.unsnapModifier();return(0,i.matchesKeystroke)(u,"ArrowUp")||!!f&&(0,i.matchesKeystroke)(u,"ArrowUp",f)}matchesMoveDownKeystroke(u){const f=this.tool.changeBoundsManager.unsnapModifier();return(0,i.matchesKeystroke)(u,"ArrowDown")||!!f&&(0,i.matchesKeystroke)(u,"ArrowDown",f)}matchesMoveRightKeystroke(u){const f=this.tool.changeBoundsManager.unsnapModifier();return(0,i.matchesKeystroke)(u,"ArrowRight")||!!f&&(0,i.matchesKeystroke)(u,"ArrowRight",f)}matchesMoveLeftKeystroke(u){const f=this.tool.changeBoundsManager.unsnapModifier();return(0,i.matchesKeystroke)(u,"ArrowLeft")||!!f&&(0,i.matchesKeystroke)(u,"ArrowLeft",f)}}return Ho.MoveKeyListener=l,l.defaultMoveX=20,l.defaultMoveY=20,Ho}var Vo={},CN;function i4(){if(CN)return Vo;CN=1;var e=Vo&&Vo.__decorate||function(m,v,_,S){var E=arguments.length,C=E<3?v:S===null?S=Object.getOwnPropertyDescriptor(v,_):S,M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(m,v,_,S);else for(var L=m.length-1;L>=0;L--)(M=m[L])&&(C=(E<3?M(C):E>3?M(v,_,C):M(v,_))||C);return E>3&&C&&Object.defineProperty(v,_,C),C},n=Vo&&Vo.__metadata||function(m,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)},t;Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.ZoomKeyListener=Vo.ZoomKeyTool=void 0;const i=Y(),a=G(),o=kn(),s=Er(),r=Wo(),d=B_(),l=Xc(),c=ph(),u=rR(),f=Jm,h=ll();let p=t=class{constructor(){this.isEditTool=!1,this.zoomKeyListener=new g(this)}get id(){return t.ID}enable(){this.keytool.register(this.zoomKeyListener),this.zoomKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.zoomKeyListener)}handle(v){if((0,i.isViewport)(this.editorContextService.modelRoot)){let _;c.KeyboardGridCellSelectedAction.is(v)&&v.options.originId===t.ID?_=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,g.defaultZoomInFactor,(0,r.getAbsolutePositionByPoint)(this.editorContextService.modelRoot,v.options.centerCellPosition)):c.KeyboardGridKeyboardEventAction.is(v)&&v.options.originId===t.ID&&((0,i.matchesKeystroke)(v.options.event,"Minus")?_=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,g.defaultZoomOutFactor):(0,i.matchesKeystroke)(v.options.event,"Digit0","ctrl")&&(_=i.CenterAction.create([]))),_&&this.actionDispatcher.dispatchAll([_,h.HideToastAction.create({id:Symbol.for(d.ElementNavigatorKeyListener.name)})])}}};Vo.ZoomKeyTool=p,p.ID="glsp.zoom-key-tool",e([(0,a.inject)(i.KeyTool),n("design:type",i.KeyTool)],p.prototype,"keytool",void 0),e([(0,a.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],p.prototype,"actionDispatcher",void 0),e([(0,a.inject)(s.SelectionService),n("design:type",s.SelectionService)],p.prototype,"selectionService",void 0),e([(0,a.inject)(o.EditorContextService),n("design:type",o.EditorContextService)],p.prototype,"editorContextService",void 0),Vo.ZoomKeyTool=p=t=e([(0,a.injectable)()],p);class g extends i.KeyListener{constructor(v){super(),this.tool=v,this.token=g.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(l.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["+"],description:"Zoom in to element or viewport",group:"Zoom",position:0},{shortcuts:["-"],description:"Zoom out to element or viewport",group:"Zoom",position:1},{shortcuts:["CTRL","0"],description:"Reset zoom to default",group:"Zoom",position:2},{shortcuts:["CTRL","+"],description:"Zoom in via Grid",group:"Zoom",position:3}]}))}setNewZoomFactor(v,_,S){let E;const C=v.zoom*_;return S?E={scroll:{x:S.x-.5*v.canvasBounds.width/C,y:S.y-.5*v.canvasBounds.height/C},zoom:C}:E={scroll:v.scroll,zoom:C},i.SetViewportAction.create(v.id,E,{animate:!0})}keyDown(v,_){const S=this.tool.selectionService.getSelectedElementIDs();return this.matchesZoomViaGrid(_)?[c.EnableKeyboardGridAction.create({originId:p.ID,triggerActions:[]}),h.ShowToastMessageAction.createWithTimeout({id:Symbol.for(d.ElementNavigatorKeyListener.name),message:f.grid.zoom_in_grid})]:this.matchesZoomOutKeystroke(_)?S.length>0?[u.ZoomElementAction.create(S,g.defaultZoomOutFactor)]:[u.ZoomViewportAction.create(g.defaultZoomOutFactor)]:this.matchesZoomInKeystroke(_)?S.length>0?[u.ZoomElementAction.create(S,g.defaultZoomInFactor)]:[u.ZoomViewportAction.create(g.defaultZoomInFactor)]:this.matchesMinZoomLevelKeystroke(_)?[i.CenterAction.create(S)]:[]}matchesZoomInKeystroke(v){return v.key==="+"||(0,i.matchesKeystroke)(v,"NumpadAdd")}matchesZoomViaGrid(v){return v.key==="+"&&v.ctrlKey}matchesMinZoomLevelKeystroke(v){return(0,i.matchesKeystroke)(v,"Digit0","ctrl")||(0,i.matchesKeystroke)(v,"Numpad0","ctrl")}matchesZoomOutKeystroke(v){return(0,i.matchesKeystroke)(v,"Minus")||(0,i.matchesKeystroke)(v,"NumpadSubtract")}}return Vo.ZoomKeyListener=g,g.defaultZoomInFactor=1.1,g.defaultZoomOutFactor=.9,Vo}var PN;function r4(){if(PN)return md;PN=1,Object.defineProperty(md,"__esModule",{value:!0}),md.configureViewKeyTools=md.viewKeyToolsModule=void 0;const e=Y(),n=ph(),t=t4(),i=n4(),a=i4();md.viewKeyToolsModule=new e.FeatureModule((s,r,d,l)=>{o({bind:s,isBound:d,rebind:l})},{featureId:Symbol("viewKeyTools")});function o(s){(0,e.bindAsService)(s,e.TYPES.IDefaultTool,i.MovementKeyTool),(0,e.bindAsService)(s,e.TYPES.IDefaultTool,a.ZoomKeyTool),(0,e.configureActionHandler)(s,n.KeyboardGridCellSelectedAction.KIND,a.ZoomKeyTool),(0,e.configureActionHandler)(s,n.KeyboardGridKeyboardEventAction.KIND,a.ZoomKeyTool),(0,e.bindAsService)(s,e.TYPES.IDefaultTool,t.DeselectKeyTool)}return md.configureViewKeyTools=o,md}var RN;function N$(){if(RN)return Rg;RN=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.accessibilityModule=void 0;const e=Y(),n=F6(),t=K6(),i=q6(),a=$6(),o=Y6(),s=W6(),r=Q6(),d=J6(),l=e4(),c=r4();return Rg.accessibilityModule=new e.FeatureModule((u,f,h,p)=>{const g={bind:u,unbind:f,isBound:h,rebind:p};(0,r.configureResizeTools)(g),(0,c.configureViewKeyTools)(g),(0,s.configureMoveZoom)(g),(0,d.configureSearchPaletteModule)(g),(0,i.configureShortcutHelpTool)(g),(0,o.configureKeyboardToolPaletteTool)(g),(0,a.configureKeyboardControlTools)(g),(0,n.configureElementNavigationTool)(g),(0,t.configureFocusTrackerTool)(g),(0,l.configureToastTool)(g)},{featureId:Symbol("accessibility")}),Rg}var bS={},MN;function B$(){return MN||(MN=1,Object.defineProperty(bS,"__esModule",{value:!0})),bS}var SS={},AN;function x$(){return AN||(AN=1,Object.defineProperty(SS,"__esModule",{value:!0})),SS}var Aa={},wN;function F$(){if(wN)return Aa;wN=1;var e=Aa&&Aa.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Aa&&Aa.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(Aa,"__esModule",{value:!0}),Aa.LeftToRightTopToBottomElementNavigator=void 0;const t=Y(),i=G(),a=Zr(),o=kt();let s=class{previous(d,l,c,u=()=>!0){const f=this.getElements(d,u);return l===void 0?f.length>0?f[0]:void 0:f[this.getPreviousIndex(l,f)%f.length]}next(d,l,c,u=()=>!0){const f=this.getElements(d,u);return l===void 0?f.length>0?f[0]:void 0:f[this.getNextIndex(l,f)%f.length]}getElements(d,l){return(0,t.toArray)(d.index.all().filter(u=>(0,o.isSelectableAndBoundsAware)(u))).sort((u,f)=>this.compare(u,f)).filter(l)}getNextIndex(d,l){for(let c=0;c<l.length;c++)if(this.compare(l[c],d)>0)return c;return 0}getPreviousIndex(d,l){for(let c=l.length-1;c>=0;c--)if(this.compare(l[c],d)<0)return c;return l.length-1}compare(d,l){var c,u;let f,h;d instanceof a.GEdge&&(0,o.isRoutable)(d)&&(f=(c=(0,o.calcElementAndRoute)(d,this.edgeRouterRegistry).newRoutingPoints)===null||c===void 0?void 0:c[0]),l instanceof a.GEdge&&(0,o.isRoutable)(l)&&(h=(u=(0,o.calcElementAndRoute)(l,this.edgeRouterRegistry).newRoutingPoints)===null||u===void 0?void 0:u[0]);const p=(0,t.findParentByFeature)(d,o.isSelectableAndBoundsAware),g=(0,t.findParentByFeature)(l,o.isSelectableAndBoundsAware);if(f===void 0&&p&&(f=p.bounds),h===void 0&&g&&(h=g.bounds),f&&h){if(f.y!==h.y)return f.y-h.y;if(f.x!==h.x)return f.x-h.x}return 0}};return Aa.LeftToRightTopToBottomElementNavigator=s,e([(0,i.inject)(t.EdgeRouterRegistry),(0,i.optional)(),n("design:type",t.EdgeRouterRegistry)],s.prototype,"edgeRouterRegistry",void 0),Aa.LeftToRightTopToBottomElementNavigator=s=e([(0,i.injectable)()],s),Aa}var Dg={},vd={},IN;function o4(){if(IN)return vd;IN=1,Object.defineProperty(vd,"__esModule",{value:!0}),vd.isMouseEvent=vd.createElementFromHTML=void 0;const e=Y();function n(i){const a=document.createElement("template");i=i.trim(),a.innerHTML=i;const o=a.content.firstChild;if(o&&o instanceof HTMLElement)return o}vd.createElementFromHTML=n;function t(i){return e.AnyObject.is(i)&&(0,e.hasNumberProp)(i,"pageX")&&(0,e.hasNumberProp)(i,"pageY")}return vd.isMouseEvent=t,vd}var yd={},TN;function s4(){if(TN)return yd;TN=1,Object.defineProperty(yd,"__esModule",{value:!0}),yd.unsnapModifier=yd.useSnap=void 0;function e(t){return!t.shiftKey}yd.useSnap=e;function n(){return"shift"}return yd.unsnapModifier=n,yd}var DN;function k$(){if(DN)return Dg;DN=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.PointPositionUpdater=void 0;const e=Y(),n=kt(),t=o4(),i=uh(),a=LP(),o=s4();class s{constructor(d,l){this.positionDelta={x:0,y:0},this.positionSnapper=d instanceof a.PositionSnapper?d:new a.PositionSnapper(d,l)}updateLastDragPosition(d){this.lastDragPosition=(0,t.isMouseEvent)(d)?{x:d.pageX,y:d.pageY}:d}isLastDragPositionUndefined(){return this.lastDragPosition===void 0}resetPosition(){this.lastDragPosition=void 0,this.positionDelta={x:0,y:0}}updatePosition(d,l,c,u){if(!this.lastDragPosition)return;const f=(0,t.isMouseEvent)(l)?{x:l.pageX,y:l.pageY}:l,h=typeof c=="boolean"?c:(0,o.useSnap)(l),p=typeof c!="boolean"?c:u,g=(0,n.calculateDeltaBetweenPoints)(f,this.lastDragPosition,d);if(this.lastDragPosition=f,e.Point.equals(g,e.Point.ORIGIN))return;this.positionDelta.x+=g.x,this.positionDelta.y+=g.y;const m=p??(0,i.getDirectionOf)(this.positionDelta),v=this.positionSnapper.snapDelta(this.positionDelta,d,h,m);if(!e.Point.equals(v,e.Point.ORIGIN))return this.positionDelta.x-=v.x,this.positionDelta.y-=v.y,v}}return Dg.PointPositionUpdater=s,Dg}var wa={},ON;function K$(){if(ON)return wa;ON=1;var e=wa&&wa.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=wa&&wa.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(wa,"__esModule",{value:!0}),wa.DeleteElementContextMenuItemProvider=void 0;const t=Y(),i=G(),a=kn();let o=class{async getItems(r,d){return[this.createDeleteMenuItem()]}createDeleteMenuItem(){return{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[t.DeleteElementOperation.create(this.editorContext.selectedElements.map(r=>r.id))],isEnabled:()=>!this.editorContext.isReadonly&&this.editorContext.selectedElements.length>0}}};return wa.DeleteElementContextMenuItemProvider=o,e([(0,i.inject)(t.TYPES.IEditorContextServiceProvider),n("design:type",Function)],o.prototype,"editorContextServiceProvider",void 0),e([(0,i.inject)(a.EditorContextService),n("design:type",a.EditorContextService)],o.prototype,"editorContext",void 0),wa.DeleteElementContextMenuItemProvider=o=e([(0,i.injectable)()],o),wa}var rn={},LN;function q$(){if(LN)return rn;LN=1;var e=rn&&rn.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},n=rn&&rn.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)};Object.defineProperty(rn,"__esModule",{value:!0}),rn.isNative=rn.supportsPaste=rn.supportsCut=rn.supportsCopy=rn.CopyPasteContextMenuItemProvider=rn.InvokeCopyPasteActionHandler=rn.InvokeCopyPasteAction=void 0;const t=G(),i=Y();var a;(function(f){f.KIND="invokeCopyPaste";function h(g){return i.Action.hasKind(g,f.KIND)&&(0,i.hasStringProp)(g,"command")}f.is=h;function p(g){return{kind:f.KIND,command:g}}f.create=p})(a||(rn.InvokeCopyPasteAction=a={}));let o=class{handle(h){switch(h.command){case"copy":r()?document.execCommand("copy"):this.notifyUserToUseShortcut("copy");break;case"paste":l()?document.execCommand("paste"):this.notifyUserToUseShortcut("paste");break;case"cut":d()?document.execCommand("cut"):this.notifyUserToUseShortcut("cut");break}}notifyUserToUseShortcut(h){const p=`Please use the browser's ${h} command or shortcut.`,g=1e4,m="WARNING";this.dispatcher.dispatchAll([i.StatusAction.create(p,{severity:m,timeout:g}),i.MessageAction.create(p,{severity:m})])}};rn.InvokeCopyPasteActionHandler=o,e([(0,t.inject)(i.TYPES.IActionDispatcher),n("design:type",Object)],o.prototype,"dispatcher",void 0),rn.InvokeCopyPasteActionHandler=o=e([(0,t.injectable)()],o);let s=class{getItems(h,p){const g=Array.from(h.index.all().filter(i.isSelected)).length>0;return Promise.resolve([this.createCopyMenuItem(g),this.createCutMenuItem(g),this.createPasteMenuItem()])}createPasteMenuItem(){return{id:"paste",label:"Paste",group:"copy-paste",actions:[a.create("paste")],isEnabled:()=>!0}}createCutMenuItem(h){return{id:"cut",label:"Cut",group:"copy-paste",actions:[a.create("cut")],isEnabled:()=>h}}createCopyMenuItem(h){return{id:"copy",label:"Copy",group:"copy-paste",actions:[a.create("copy")],isEnabled:()=>h}}};rn.CopyPasteContextMenuItemProvider=s,rn.CopyPasteContextMenuItemProvider=s=e([(0,t.injectable)()],s);function r(){return c()||document.queryCommandSupported("copy")}rn.supportsCopy=r;function d(){return c()||document.queryCommandSupported("cut")}rn.supportsCut=d;function l(){const f=u().indexOf("Chrome")>=0;return c()||!f&&document.queryCommandSupported("paste")}rn.supportsPaste=l;function c(){return typeof window.process<"u"}rn.isNative=c;function u(){return typeof navigator<"u"?navigator.userAgent:""}return rn}var _d={},jN;function a4(){return jN||(jN=1,function(e){var n=_d&&_d.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},t=_d&&_d.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.DebugBoundsDecorator=e.CSS_DEBUG_BOUNDS=void 0;const i=Y(),a=G(),o=Zr();e.CSS_DEBUG_BOUNDS="debug-bounds";let s=class{decorate(d,l){var c;return!((c=this.debugManager)===null||c===void 0)&&c.isDebugEnabled&&((0,i.isSizeable)(l)&&this.shouldDecorateSizeable(l)&&this.decorateSizeable(d,l),l instanceof o.GGraph&&this.shouldDecorateGraph(l)&&this.decorateGraph(d,l)),d}postUpdate(){}get decorationSize(){return 5}shouldDecorateGraph(d){return!0}decorateGraph(d,l){var c,u,f;(0,i.setClass)(d,e.CSS_DEBUG_BOUNDS,!0);const h=(c=d.children)===null||c===void 0?void 0:c.find(g=>typeof g!="string"&&g.sel==="svg"),p=(u=h==null?void 0:h.children)===null||u===void 0?void 0:u.find(g=>typeof g!="string"&&g.sel==="g");(f=p==null?void 0:p.children)===null||f===void 0||f.push(this.renderOrigin(l))}renderOrigin(d){return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-origin":!0,points:`0,${this.decorationSize} 0,0  ${this.decorationSize},0`},(0,i.svg)("title",null,"Origin = x: 0, y: 0"))}shouldDecorateSizeable(d){return!(0,i.isDecoration)(d)}decorateSizeable(d,l){var c,u,f,h,p;(0,i.setClass)(d,e.CSS_DEBUG_BOUNDS,!0),(c=d.children)===null||c===void 0||c.push(this.renderTopLeftCorner(l)),(u=d.children)===null||u===void 0||u.push(this.renderTopRightCorner(l)),(f=d.children)===null||f===void 0||f.push(this.renderBottomLeftCorner(l)),(h=d.children)===null||h===void 0||h.push(this.renderBottomRightCorner(l)),(p=d.children)===null||p===void 0||p.push(this.renderCenter(l))}renderTopLeftCorner(d){const l=i.Bounds.position(d.bounds),c=i.Bounds.topLeft(d.bounds),u=i.Point.subtract(c,l);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-left":!0,points:`${u.x},${u.y+this.decorationSize} ${u.x},${u.y} ${u.x+this.decorationSize},${u.y}`},(0,i.svg)("title",null,"Top Left = x: ",c.x,", y: ",c.y))}renderTopRightCorner(d){const l=i.Bounds.position(d.bounds),c=i.Bounds.topRight(d.bounds),u=i.Point.subtract(c,l);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-right":!0,points:`${u.x-this.decorationSize},${u.y} ${u.x},${u.y} ${u.x},${u.y+this.decorationSize}`},(0,i.svg)("title",null,"Top Right = x: ",c.x,", y: ",c.y))}renderBottomLeftCorner(d){const l=i.Bounds.position(d.bounds),c=i.Bounds.bottomLeft(d.bounds),u=i.Point.subtract(c,l);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-left":!0,points:`${u.x},${u.y-this.decorationSize} ${u.x},${u.y} ${u.x+this.decorationSize},${u.y}`},(0,i.svg)("title",null,"Bottom Left = x: ",c.x,", y: ",c.y))}renderBottomRightCorner(d){const l=i.Bounds.position(d.bounds),c=i.Bounds.bottomRight(d.bounds),u=i.Point.subtract(c,l);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-right":!0,points:`${u.x-this.decorationSize},${u.y} ${u.x},${u.y} ${u.x},${u.y-this.decorationSize}`},(0,i.svg)("title",null,"Bottom Right = x: ",c.x,", y: ",c.y))}renderCenter(d){const l=d.bounds,c=i.Bounds.position(l),u=i.Bounds.center(l),f=i.Point.subtract(u,c);return(0,i.svg)("g",null,(0,i.svg)("title",null,"Center = x: ",u.x,", y: ",u.y,"\rBounds = x: ",l.x,", y: ",l.y,", width: ",l.width,", height: ",l.height),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${f.x-this.decorationSize/2},${f.y-this.decorationSize/2} ${f.x+this.decorationSize/2},${f.y+this.decorationSize/2}`}),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${f.x+this.decorationSize/2},${f.y-this.decorationSize/2} ${f.x-this.decorationSize/2},${f.y+this.decorationSize/2}`}))}};e.DebugBoundsDecorator=s,n([(0,a.inject)(i.TYPES.IDebugManager),(0,a.optional)(),t("design:type",Object)],s.prototype,"debugManager",void 0),e.DebugBoundsDecorator=s=n([(0,a.injectable)()],s)}(_d)),_d}var Ia={},gr={},NN;function sR(){if(NN)return gr;NN=1;var e=gr&&gr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=gr&&gr.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=gr&&gr.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(gr,"__esModule",{value:!0}),gr.EnableDebugModeCommand=gr.EnableDebugModeAction=void 0;const i=Y(),a=G(),o=Cr(),s=kt();var r;(function(l){l.KIND="enableDebugMode",l.CSS_ROOT_CLASS="debug-mode";function c(f){return i.Action.hasKind(f,l.KIND)&&(0,i.hasBooleanProp)(f,"enable")}l.is=c;function u(f){return{kind:l.KIND,...f}}l.create=u})(r||(gr.EnableDebugModeAction=r={}));let d=class extends o.FeedbackCommand{constructor(c){super(),this.action=c}execute(c){return this.setDebugMode(c.root,this.action.enable)}setDebugMode(c,u){return u?(0,s.addCssClasses)(c,[r.CSS_ROOT_CLASS]):(0,s.removeCssClasses)(c,[r.CSS_ROOT_CLASS]),c}};return gr.EnableDebugModeCommand=d,d.KIND=r.KIND,gr.EnableDebugModeCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],d),gr}var BN;function c4(){if(BN)return Ia;BN=1;var e=Ia&&Ia.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Ia&&Ia.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.DebugManager=void 0;const t=Y(),i=G(),a=sR();let o=class{constructor(){this._debugEnabled=!1}get isDebugEnabled(){return this._debugEnabled}init(){this.debugFeedback=this.feedbackDispatcher.createEmitter()}handle(r){this.setDebugEnabled(r.enable)}setDebugEnabled(r){this._debugEnabled&&!r?(this._debugEnabled=!1,this.debugFeedback.dispose()):!this._debugEnabled&&r&&(this._debugEnabled=!0,this.debugFeedback.add(a.EnableDebugModeAction.create({enable:!0}),a.EnableDebugModeAction.create({enable:!1})).submit())}toggleDebugEnabled(){this.setDebugEnabled(!this._debugEnabled)}};return Ia.DebugManager=o,e([(0,i.inject)(t.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],o.prototype,"feedbackDispatcher",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],o.prototype,"init",null),Ia.DebugManager=o=e([(0,i.injectable)()],o),Ia}var Og={},xN;function H$(){if(xN)return Og;xN=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.debugModule=void 0;const e=Y(),n=a4(),t=c4(),i=sR();return Og.debugModule=new e.FeatureModule((a,o,s,r)=>{const d={bind:a,unbind:o,isBound:s,rebind:r};(0,e.configureCommand)(d,i.EnableDebugModeCommand),(0,e.bindAsService)(d,e.TYPES.IDebugManager,t.DebugManager),(0,e.configureActionHandler)(d,i.EnableDebugModeAction.KIND,t.DebugManager),(0,e.bindAsService)(d,e.TYPES.IVNodePostprocessor,n.DebugBoundsDecorator)},{featureId:Symbol("debug")}),Og}var ES={},FN;function V$(){return FN||(FN=1,Object.defineProperty(ES,"__esModule",{value:!0})),ES}var Ta={},mr={},kN;function aR(){if(kN)return mr;kN=1;var e=mr&&mr.__decorate||function(l,c,u,f){var h=arguments.length,p=h<3?c:f===null?f=Object.getOwnPropertyDescriptor(c,u):f,g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(l,c,u,f);else for(var m=l.length-1;m>=0;m--)(g=l[m])&&(p=(h<3?g(p):h>3?g(c,u,p):g(c,u))||p);return h>3&&p&&Object.defineProperty(c,u,p),p},n=mr&&mr.__metadata||function(l,c){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(l,c)},t=mr&&mr.__param||function(l,c){return function(u,f){c(u,f,l)}};Object.defineProperty(mr,"__esModule",{value:!0}),mr.ShowGridCommand=mr.ShowGridAction=void 0;const i=Y(),a=G(),o=Cr(),s=kt();var r;(function(l){l.KIND="showGrid",l.CSS_ROOT_CLASS="grid-background";function c(f){return i.Action.hasKind(f,l.KIND)&&(0,i.hasBooleanProp)(f,"show")}l.is=c;function u(f){return{kind:d.KIND,...f}}l.create=u})(r||(mr.ShowGridAction=r={}));let d=class extends o.FeedbackCommand{constructor(c){super(),this.action=c}execute(c){return this.setGrid(c.root,this.action.show)}setGrid(c,u){return u?(0,s.addCssClasses)(c,[r.CSS_ROOT_CLASS]):(0,s.removeCssClasses)(c,[r.CSS_ROOT_CLASS]),c}};return mr.ShowGridCommand=d,d.KIND=r.KIND,mr.ShowGridCommand=d=e([(0,a.injectable)(),t(0,(0,a.inject)(i.TYPES.Action)),n("design:paramtypes",[Object])],d),mr}var KN;function u4(){if(KN)return Ta;KN=1;var e=Ta&&Ta.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Ta&&Ta.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.GridManager=void 0;const t=Y(),i=G(),a=aR();let o=class{constructor(){this._gridVisible=!1}get isGridVisible(){return this._gridVisible}init(){this.gridFeedback=this.feedbackDispatcher.createEmitter()}handle(r){this.setGridVisible(r.show)}setGridVisible(r){this._gridVisible&&!r?(this._gridVisible=!1,this.gridFeedback.dispose()):!this._gridVisible&&r&&(this._gridVisible=!0,this.gridFeedback.add(a.ShowGridAction.create({show:!0}),a.ShowGridAction.create({show:!1})).submit())}toggleGridVisible(){this.setGridVisible(!this._gridVisible)}};return Ta.GridManager=o,e([(0,i.inject)(t.TYPES.IFeedbackActionDispatcher),n("design:type",Object)],o.prototype,"feedbackDispatcher",void 0),e([(0,i.inject)(t.TYPES.Grid),n("design:type",Object)],o.prototype,"grid",void 0),e([(0,i.postConstruct)(),n("design:type",Function),n("design:paramtypes",[]),n("design:returntype",void 0)],o.prototype,"init",null),Ta.GridManager=o=e([(0,i.injectable)()],o),Ta}var Lg={},Ki={},qN;function l4(){if(qN)return Ki;qN=1;var e=Ki&&Ki.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=Ki&&Ki.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)},t=Ki&&Ki.__param||function(r,d){return function(l,c){d(l,c,r)}};Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.GLSPCenterGridSnapper=Ki.GridSnapper=void 0;const i=Y(),a=G();let o=class{constructor(d={x:10,y:10}){this.grid=d}snap(d,l){return i.Point.snapToGrid(d,this.grid)}};Ki.GridSnapper=o,Ki.GridSnapper=o=e([(0,a.injectable)(),t(0,(0,a.optional)()),t(0,(0,a.inject)(i.TYPES.Grid)),n("design:paramtypes",[Object])],o);let s=class extends i.CenterGridSnapper{constructor(d={x:10,y:10}){super(),this.grid=d}get gridX(){return this.grid.x}get gridY(){return this.grid.y}};return Ki.GLSPCenterGridSnapper=s,Ki.GLSPCenterGridSnapper=s=e([(0,a.injectable)(),t(0,(0,a.optional)()),t(0,(0,a.inject)(i.TYPES.Grid)),n("design:paramtypes",[Object])],s),Ki}var HN;function G$(){if(HN)return Lg;HN=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.gridModule=void 0;const e=Y(),n=u4(),t=aR(),i=l4();return Lg.gridModule=new e.FeatureModule((a,o,s,r)=>{const d={bind:a,unbind:o,isBound:s,rebind:r};a(e.TYPES.Grid).toConstantValue({x:10,y:10}),(0,e.configureCommand)(d,t.ShowGridCommand),(0,e.bindAsService)(d,e.TYPES.IGridManager,n.GridManager),(0,e.configureActionHandler)(d,t.ShowGridAction.KIND,n.GridManager),a(e.TYPES.ISnapper).to(i.GridSnapper)},{featureId:Symbol("grid")}),Lg}var jg={},VN;function cR(){if(VN)return jg;VN=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.GridProperty=void 0;var e;return function(n){n.GRID_BACKGROUND_X="--grid-background-x",n.GRID_BACKGROUND_Y="--grid-background-y",n.GRID_BACKGROUND_WIDTH="--grid-background-width",n.GRID_BACKGROUND_HEIGHT="--grid-background-height",n.GRID_BACKGROUND_ZOOM="--grid-background-zoom",n.GRID_COLOR="--grid-color"}(e||(jg.GridProperty=e={})),jg}var jc={},GN;function uR(){return GN||(GN=1,function(e){var n=jc&&jc.__decorate||function(C,M,L,I){var R=arguments.length,w=R<3?M:I===null?I=Object.getOwnPropertyDescriptor(M,L):I,T;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(C,M,L,I);else for(var j=C.length-1;j>=0;j--)(T=C[j])&&(w=(R<3?T(w):R>3?T(M,L,w):T(M,L))||w);return R>3&&w&&Object.defineProperty(M,L,w),w},t=jc&&jc.__metadata||function(C,M){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,M)},i=jc&&jc.__param||function(C,M){return function(L,I){M(L,I,C)}};Object.defineProperty(e,"__esModule",{value:!0}),e.boundsInViewport=e.removeSelectionBounds=e.removeHelperLines=e.RemoveHelperLinesFeedbackCommand=e.RemoveHelperLinesFeedbackAction=e.DrawHelperLinesFeedbackCommand=e.DrawHelperLinesFeedbackAction=e.DEFAULT_DEBUG=e.DEFAULT_ALIGNABLE_ELEMENT_FILTER=e.DEFAULT_EPSILON=e.DEFAULT_VIEWPORT_LINES=e.DEFAULT_ELEMENT_LINES=e.ALL_VIEWPORT_LINE_TYPES=e.ALL_ELEMENT_LINE_TYPES=e.isTopLevelBoundsAwareElement=void 0;const a=Y(),o=G(),s=cf(),r=Cr(),d=kt(),l=Wo(),c=ul(),u=uh(),f=C=>(0,d.findTopLevelElementByFeature)(C,a.isBoundsAware,a.isViewport)===C;e.isTopLevelBoundsAwareElement=f,e.ALL_ELEMENT_LINE_TYPES=Object.values(u.HelperLineType),e.ALL_VIEWPORT_LINE_TYPES=[u.HelperLineType.Center,u.HelperLineType.Middle],e.DEFAULT_ELEMENT_LINES=e.ALL_ELEMENT_LINE_TYPES,e.DEFAULT_VIEWPORT_LINES=e.ALL_VIEWPORT_LINE_TYPES,e.DEFAULT_EPSILON=1;const h=C=>(0,d.isVisibleOnCanvas)(C)&&!(0,d.isRoutable)(C)&&!(C instanceof a.GLabel)&&C.id!==(0,c.feedbackEdgeId)(C.root)&&C.id!==(0,c.feedbackEdgeEndId)(C.root)&&!(0,a.isDecoration)(C);e.DEFAULT_ALIGNABLE_ELEMENT_FILTER=h,e.DEFAULT_DEBUG=!1;var p;(function(C){C.KIND="drawHelperLines";function M(L){return{kind:C.KIND,...L}}C.create=M})(p||(e.DrawHelperLinesFeedbackAction=p={}));let g=class extends r.FeedbackCommand{constructor(M,L){var I,R,w,T,j;super(),this.logger=L,this.elementIds=M.elementIds,this.elementLines=(I=M.elementLines)!==null&&I!==void 0?I:e.DEFAULT_ELEMENT_LINES,this.viewportLines=(R=M.viewportLines)!==null&&R!==void 0?R:e.DEFAULT_VIEWPORT_LINES,this.alignmentEpsilon=(w=M.alignmentEpsilon)!==null&&w!==void 0?w:e.DEFAULT_EPSILON,this.alignableElementFilter=(T=M.alignmentElementFilter)!==null&&T!==void 0?T:e.DEFAULT_ALIGNABLE_ELEMENT_FILTER,this.isAlignableElementPredicate=this.isAlignableElement.bind(this),this.debug=(j=M.debug)!==null&&j!==void 0?j:e.DEFAULT_DEBUG}execute(M){_(M.root),S(M.root);const L=(0,d.getMatchingElements)(M.root.index,this.isAlignableElementPredicate);this.log("All alignable elements: ",L);const[I,R]=(0,s.partition)(L,j=>this.elementIds.includes(j.id));if(this.log("Split alignable elements into reference elements and other elements: ",I,R),I.length===0)return this.log("--> No helper lines as we do not have any reference elements."),M.root;const w=this.calcReferenceBounds(I);this.log("Bounds encompasing all reference elements: ",w);const T=this.calcHelperLines(R,w,M);return I.length>1&&(M.root.add(new u.SelectionBounds(w)),this.log("Render selection bounds for more than one reference element:",w)),T.forEach(j=>M.root.add(j)),T.length>0?this.log(`--> Add ${T.length} helper lines to root:`,T):this.log("--> Add no helper lines to root."),M.root}isAlignableElement(M){return(0,a.isBoundsAware)(M)&&this.alignableElementFilter(M,this.elementIds)}calcReferenceBounds(M){return M.map(L=>this.calcBounds(L)).reduce(a.Bounds.combine,a.Bounds.EMPTY)}calcBounds(M){return(0,l.toAbsoluteBounds)(M)}calcHelperLines(M,L,I){const R=[],w=(0,a.findParentByFeature)(I.root,a.isViewport);return w&&R.push(...this.calcHelperLinesForViewport(w,L,this.viewportLines)),M.flatMap(T=>this.calcHelperLinesForElement(T,L,this.elementLines)).forEach(T=>R.push(T)),R}calcHelperLinesForViewport(M,L,I){const R=[];this.log("Find helperlines for viewport:",M);const w=(0,l.getViewportBounds)(M,M.canvasBounds);return I.includes(u.HelperLineType.Center)&&this.isAligned(a.Bounds.centerX,w,L,2)&&(R.push(new u.HelperLine(a.Bounds.topCenter(w),a.Bounds.bottomCenter(w),u.HelperLineType.Center)),this.log("- Reference bounds center align with viewport.",w)),I.includes(u.HelperLineType.Middle)&&this.isAligned(a.Bounds.middle,w,L,2)&&(R.push(new u.HelperLine(a.Bounds.middleLeft(w),a.Bounds.middleRight(w),u.HelperLineType.Middle)),this.log("- Reference bounds middle align with viewport.",w)),R.length>0&&this.log(`--> Add ${R.length} helperlines for viewport:`,R),R}calcHelperLinesForElement(M,L,I){return this.log("Find helperlines for element:",M),this.calcHelperLinesForBounds(this.calcBounds(M),L,I)}calcHelperLinesForBounds(M,L,I){const R=[];if(I.includes(u.HelperLineType.Left)&&this.isAligned(a.Bounds.left,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.top,M,L);R.push(new u.HelperLine(a.Bounds.bottomLeft(T),a.Bounds.topLeft(w),u.HelperLineType.Left)),this.log("- Reference bounds left align with element",M)}if(I.includes(u.HelperLineType.Center)&&this.isAligned(a.Bounds.centerX,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.top,M,L);R.push(new u.HelperLine(a.Bounds.topCenter(w),a.Bounds.bottomCenter(T),u.HelperLineType.Center)),this.log("- Reference bounds center align with element",M)}if(I.includes(u.HelperLineType.Right)&&this.isAligned(a.Bounds.right,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.top,M,L);R.push(new u.HelperLine(a.Bounds.bottomRight(T),a.Bounds.topRight(w),u.HelperLineType.Right)),this.log("- Reference bounds right align with element",M)}if(I.includes(u.HelperLineType.Bottom)&&this.isAligned(a.Bounds.bottom,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.left,M,L);R.push(new u.HelperLine(a.Bounds.bottomLeft(w),a.Bounds.bottomRight(T),u.HelperLineType.Bottom)),this.log("- Reference bounds bottom align with element",M)}if(I.includes(u.HelperLineType.Middle)&&this.isAligned(a.Bounds.centerY,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.left,M,L);R.push(new u.HelperLine(a.Bounds.middleLeft(w),a.Bounds.middleRight(T),u.HelperLineType.Middle)),this.log("- Reference bounds middle align with element",M)}if(I.includes(u.HelperLineType.Top)&&this.isAligned(a.Bounds.top,M,L,this.alignmentEpsilon)){const[w,T]=a.Bounds.sortBy(a.Bounds.left,M,L);R.push(new u.HelperLine(a.Bounds.topLeft(w),a.Bounds.topRight(T),u.HelperLineType.Top)),this.log("- Reference bounds top align with element",M)}return I.includes(u.HelperLineType.LeftRight)&&this.isMatch(a.Bounds.left(M),a.Bounds.right(L),this.alignmentEpsilon)&&(a.Bounds.isAbove(L,M)?(R.push(new u.HelperLine(a.Bounds.bottomLeft(M),a.Bounds.topRight(L),u.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",M)):(R.push(new u.HelperLine(a.Bounds.topLeft(M),a.Bounds.bottomRight(L),u.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",M))),I.includes(u.HelperLineType.LeftRight)&&this.isMatch(a.Bounds.right(M),a.Bounds.left(L),this.alignmentEpsilon)&&(a.Bounds.isAbove(L,M)?(R.push(new u.HelperLine(a.Bounds.bottomRight(M),a.Bounds.topLeft(L),u.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",M)):(R.push(new u.HelperLine(a.Bounds.topRight(M),a.Bounds.bottomLeft(L),u.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",M))),I.includes(u.HelperLineType.TopBottom)&&this.isMatch(a.Bounds.top(M),a.Bounds.bottom(L),this.alignmentEpsilon)&&(a.Bounds.isBefore(L,M)?(R.push(new u.HelperLine(a.Bounds.topRight(M),a.Bounds.bottomLeft(L),u.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",M)):(R.push(new u.HelperLine(a.Bounds.topLeft(M),a.Bounds.bottomRight(L),u.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",M))),I.includes(u.HelperLineType.TopBottom)&&this.isMatch(a.Bounds.bottom(M),a.Bounds.top(L),this.alignmentEpsilon)&&(a.Bounds.isBefore(L,M)?(R.push(new u.HelperLine(a.Bounds.bottomRight(M),a.Bounds.topLeft(L),u.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",M)):(R.push(new u.HelperLine(a.Bounds.bottomLeft(M),a.Bounds.topRight(L),u.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",M))),R.length>0&&this.log(`--> Add ${R.length} helperlines for element:`,R),R}isAligned(M,L,I,R){return this.isMatch(M(L),M(I),R)}isMatch(M,L,I){return(0,a.equalUpTo)(M,L,I)}log(M,...L){this.debug&&this.logger.log(this,M,L)}};e.DrawHelperLinesFeedbackCommand=g,g.KIND=p.KIND,e.DrawHelperLinesFeedbackCommand=g=n([(0,o.injectable)(),i(0,(0,o.inject)(a.TYPES.Action)),i(1,(0,o.inject)(a.TYPES.ILogger)),t("design:paramtypes",[Object,Object])],g);var m;(function(C){C.KIND="removeHelperLines";function M(L={}){return{kind:C.KIND,...L}}C.create=M})(m||(e.RemoveHelperLinesFeedbackAction=m={}));let v=class extends r.FeedbackCommand{constructor(M){super(),this.action=M}execute(M){return _(M.root),S(M.root),M.root}};e.RemoveHelperLinesFeedbackCommand=v,v.KIND=m.KIND,e.RemoveHelperLinesFeedbackCommand=v=n([(0,o.injectable)(),i(0,(0,o.inject)(a.TYPES.Action)),t("design:paramtypes",[Object])],v);function _(C){(0,d.forEachElement)(C.index,u.isHelperLine,M=>C.remove(M))}e.removeHelperLines=_;function S(C){(0,d.forEachElement)(C.index,u.isSelectionBounds,M=>C.remove(M))}e.removeSelectionBounds=S;function E(C,M){return C instanceof a.GChildElement&&!(0,a.isViewport)(C.parent)?E(C.parent,C.parent.localToParent(M)):M}e.boundsInViewport=E}(jc)),jc}var bd={},zN;function d4(){return zN||(zN=1,function(e){var n=bd&&bd.__decorate||function(f,h,p,g){var m=arguments.length,v=m<3?h:g===null?g=Object.getOwnPropertyDescriptor(h,p):g,_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(f,h,p,g);else for(var S=f.length-1;S>=0;S--)(_=f[S])&&(v=(m<3?_(v):m>3?_(h,p,v):_(h,p))||v);return m>3&&v&&Object.defineProperty(h,p,v),v},t=bd&&bd.__metadata||function(f,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(f,h)};Object.defineProperty(e,"__esModule",{value:!0}),e.HelperLineManager=e.DEFAULT_HELPER_LINE_OPTIONS=e.DEFAULT_MOVE_DELTA=void 0;const i=Y(),a=G(),o=Er(),s=zm(),r=Pr(),d=af(),l=uR(),c=uh();e.DEFAULT_MOVE_DELTA={x:1,y:1},e.DEFAULT_HELPER_LINE_OPTIONS={elementLines:l.DEFAULT_ELEMENT_LINES,viewportLines:l.DEFAULT_VIEWPORT_LINES,alignmentEpsilon:l.DEFAULT_EPSILON,alignmentElementFilter:l.DEFAULT_ALIGNABLE_ELEMENT_FILTER,minimumMoveDelta:e.DEFAULT_MOVE_DELTA,debug:l.DEFAULT_DEBUG};let u=class{init(){this.feedback=this.feedbackDispatcher.createEmitter();const h={};this.grid&&(h.alignmentEpsilon=0,h.minimumMoveDelta=i.Point.multiplyScalar(this.grid,2)),this.options={...e.DEFAULT_HELPER_LINE_OPTIONS,...h,...this.userOptions},this.selectionService.addListener(this)}handle(h){d.MoveInitializedEventAction.is(h)?this.handleMoveInitializedAction(h):i.MoveAction.is(h)?this.handleMoveAction(h):d.MoveFinishedEventAction.is(h)?this.handleMoveFinishedAction(h):(i.SetBoundsAction.is(h)||s.SetBoundsFeedbackAction.is(h))&&this.handleSetBoundsAction(h)}handleMoveInitializedAction(h){this.submitHelperLineFeedback()}handleMoveFinishedAction(h){this.feedback.dispose()}handleMoveAction(h){h.finished?this.feedback.dispose():this.submitHelperLineFeedback(h.moves.map(p=>p.elementId))}submitHelperLineFeedback(h=this.selectionService.getSelectedElementIDs()){const p=this.createHelperLineFeedback(h);this.feedback.add(p,[l.RemoveHelperLinesFeedbackAction.create()]).submit()}createHelperLineFeedback(h){return l.DrawHelperLinesFeedbackAction.create({elementIds:h,...this.options})}handleSetBoundsAction(h){this.submitHelperLineFeedback(h.bounds.map(p=>p.elementId))}selectionChanged(h,p,g){this.feedback.dispose()}getMinimumMoveDelta(h,p,g){if(!p)return 0;const m=this.options.minimumMoveDelta;return g===c.Direction.Left||g===c.Direction.Right?m.x:m.y}getMinimumMoveVector(h,p,g){if(!p)return;const m=this.getHelperLineState(h);if(m.helperLines.length===0)return;const v={...i.Vector.ZERO},_=h instanceof r.GResizeHandle?r.ResizeHandleLocation.direction(h.location):[c.Direction.Left,c.Direction.Right,c.Direction.Up,c.Direction.Down];return(m.types.left||m.types.center)&&g.includes(c.Direction.Left)&&_.includes(c.Direction.Left)?v.x=this.getMinimumMoveDelta(h,p,c.Direction.Left):(m.types.right||m.types.center)&&g.includes(c.Direction.Right)&&_.includes(c.Direction.Right)&&(v.x=this.getMinimumMoveDelta(h,p,c.Direction.Right)),(m.types.top||m.types.middle)&&g.includes(c.Direction.Up)&&_.includes(c.Direction.Up)?v.y=this.getMinimumMoveDelta(h,p,c.Direction.Up):(m.types.bottom||m.types.middle)&&g.includes(c.Direction.Down)&&_.includes(c.Direction.Down)&&(v.y=this.getMinimumMoveDelta(h,p,c.Direction.Down)),i.Vector.isZero(v)?void 0:v}getHelperLineState(h){const p=h.root.children.filter(c.isHelperLine)||[],g={left:!1,right:!1,top:!1,bottom:!1,center:!1,middle:!1};for(const m of p)switch(m.lineType){case c.HelperLineType.Left:case c.HelperLineType.LeftRight:g.left=!0;break;case c.HelperLineType.Right:case c.HelperLineType.RightLeft:g.right=!0;break;case c.HelperLineType.Top:case c.HelperLineType.TopBottom:g.top=!0;break;case c.HelperLineType.Bottom:case c.HelperLineType.BottomTop:g.bottom=!0;break;case c.HelperLineType.Center:g.center=!0;break;case c.HelperLineType.Middle:g.middle=!0;break}return{helperLines:p,types:g}}};e.HelperLineManager=u,n([(0,a.inject)(i.TYPES.IFeedbackActionDispatcher),t("design:type",Object)],u.prototype,"feedbackDispatcher",void 0),n([(0,a.inject)(o.SelectionService),t("design:type",o.SelectionService)],u.prototype,"selectionService",void 0),n([(0,a.optional)(),(0,a.inject)(i.TYPES.IHelperLineOptions),t("design:type",Object)],u.prototype,"userOptions",void 0),n([(0,a.optional)(),(0,a.inject)(i.TYPES.Grid),t("design:type",Object)],u.prototype,"grid",void 0),n([(0,a.postConstruct)(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],u.prototype,"init",null),e.HelperLineManager=u=n([(0,a.injectable)()],u)}(bd)),bd}var Ng={},Rs={},UN;function f4(){if(UN)return Rs;UN=1;var e=Rs&&Rs.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Rs,"__esModule",{value:!0}),Rs.SelectionBoundsView=Rs.HelperLineView=void 0;const n=Y(),t=G();let i=class extends n.ShapeView{render(s,r){return(0,n.svg)("g",null,(0,n.svg)("line",{"data-alignment":s.lineType,x1:s.startPoint.x,y1:s.startPoint.y,x2:s.endPoint.x,y2:s.endPoint.y,"class-helper-line":!0}))}};Rs.HelperLineView=i,Rs.HelperLineView=i=e([(0,t.injectable)()],i);let a=class extends n.ShapeView{render(s,r,d){if(this.isVisible(s,r))return(0,n.svg)("g",null,(0,n.svg)("rect",{"class-selection-bounds":!0,x:0,y:0,width:Math.max(s.size.width,0),height:Math.max(s.size.height,0)}))}};return Rs.SelectionBoundsView=a,Rs.SelectionBoundsView=a=e([(0,t.injectable)()],a),Rs}var $N;function z$(){if($N)return Ng;$N=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.helperLineModule=void 0;const e=Y(),n=zm(),t=af(),i=uR(),a=d4(),o=uh(),s=f4();return Ng.helperLineModule=new e.FeatureModule((r,d,l,c)=>{const u={bind:r,unbind:d,isBound:l,rebind:c};(0,e.configureModelElement)(u,o.HELPER_LINE,o.HelperLine,s.HelperLineView),(0,e.configureModelElement)(u,o.SELECTION_BOUNDS,o.SelectionBounds,s.SelectionBoundsView),(0,e.configureCommand)(u,i.DrawHelperLinesFeedbackCommand),(0,e.configureCommand)(u,i.RemoveHelperLinesFeedbackCommand),(0,e.bindAsService)(r,e.TYPES.IHelperLineManager,a.HelperLineManager),(0,e.configureActionHandler)(u,e.SetBoundsAction.KIND,e.TYPES.IHelperLineManager),(0,e.configureActionHandler)(u,n.SetBoundsFeedbackAction.KIND,e.TYPES.IHelperLineManager),(0,e.configureActionHandler)(u,e.MoveAction.KIND,e.TYPES.IHelperLineManager),(0,e.configureActionHandler)(u,t.MoveInitializedEventAction.KIND,e.TYPES.IHelperLineManager),(0,e.configureActionHandler)(u,t.MoveFinishedEventAction.KIND,e.TYPES.IHelperLineManager)},{featureId:Symbol("helperLine")}),Ng}var Bg={},YN;function h4(){if(YN)return Bg;YN=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.SaveModelKeyboardListener=void 0;const e=Y();class n extends e.KeyListener{keyDown(i,a){return(0,e.matchesKeystroke)(a,"KeyS","ctrlCmd")?[e.SaveModelAction.create()]:[]}}return Bg.SaveModelKeyboardListener=n,Bg}var xg={},WN;function p4(){if(WN)return xg;WN=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.saveModule=void 0;const e=Y(),n=h4();return xg.saveModule=new e.FeatureModule(t=>{(0,e.bindAsService)(t,e.TYPES.KeyListener,n.SaveModelKeyboardListener)},{featureId:Symbol("save")}),xg}var Fg={},ZN;function g4(){if(ZN)return Fg;ZN=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.GLSPUndoRedoKeyListener=void 0;const e=Y();class n extends e.KeyListener{keyDown(i,a){return(0,e.matchesKeystroke)(a,"KeyZ","ctrlCmd")?[e.UndoAction.create()]:(0,e.matchesKeystroke)(a,"KeyZ","ctrlCmd","shift")||!(0,e.isMac)()&&(0,e.matchesKeystroke)(a,"KeyY","ctrlCmd")?[e.RedoAction.create()]:[]}}return Fg.GLSPUndoRedoKeyListener=n,Fg}var kg={},QN;function m4(){if(QN)return kg;QN=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.undoRedoModule=void 0;const e=Y(),n=g4();return kg.undoRedoModule=new e.FeatureModule((t,i,a,o)=>{(0,e.bindAsService)(t,e.TYPES.KeyListener,n.GLSPUndoRedoKeyListener)},{featureId:Symbol("undoRedo")}),kg}var Sd={},JN;function U$(){return JN||(JN=1,function(e){var n=Sd&&Sd.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=Sd&&Sd.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(Y(),e)}(Sd)),Sd}var Ed={},XN;function $$(){return XN||(XN=1,function(e){var n=Ed&&Ed.__decorate||function(p,g,m,v){var _=arguments.length,S=_<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,m):v,E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,g,m,v);else for(var C=p.length-1;C>=0;C--)(E=p[C])&&(S=(_<3?E(S):_>3?E(g,m,S):E(g,m))||S);return _>3&&S&&Object.defineProperty(g,m,S),S},t=Ed&&Ed.__metadata||function(p,g){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,g)};Object.defineProperty(e,"__esModule",{value:!0}),e.STANDALONE_MODULE_CONFIG=e.STANDALONE_MODULES=e.LayoutKeyListener=e.FallbackActionHandler=e.standaloneDefaultModule=void 0;const i=Y(),a=G(),o=jP(),s=xP(),r=p4(),d=qP(),l=m4(),c=$P(),u=YP();e.standaloneDefaultModule=new i.FeatureModule((p,g,m,v)=>{const _={bind:p,unbind:g,isBound:m,rebind:v};p(f).toSelf().inSingletonScope(),(0,i.configureActionHandler)(_,i.MessageAction.KIND,f),(0,i.configureActionHandler)(_,i.StartProgressAction.KIND,f),(0,i.configureActionHandler)(_,i.UpdateProgressAction.KIND,f),(0,i.configureActionHandler)(_,i.EndProgressAction.KIND,f),(0,i.bindAsService)(_,i.TYPES.KeyListener,h)},{featureId:Symbol("standaloneDefault")});let f=class{handle(g){this.logger.log(this,"Unhandled action received:",g)}};e.FallbackActionHandler=f,n([(0,a.inject)(i.TYPES.ILogger),t("design:type",Object)],f.prototype,"logger",void 0),e.FallbackActionHandler=f=n([(0,a.injectable)()],f);let h=class extends i.KeyListener{keyDown(g,m){return(0,i.matchesKeystroke)(m,"KeyL","ctrlCmd","shift")?[i.LayoutOperation.create()]:[]}};e.LayoutKeyListener=h,e.LayoutKeyListener=h=n([(0,a.injectable)()],h),e.STANDALONE_MODULES=[u.standaloneViewportModule,o.standaloneCopyPasteModule,c.standaloneMarkerNavigatorModule,d.standaloneSelectModule,s.standaloneExportModule,e.standaloneDefaultModule,r.saveModule,l.undoRedoModule],e.STANDALONE_MODULE_CONFIG={add:[...e.STANDALONE_MODULES]}}(Ed)),Ed}var ze={},e8;function Y$(){if(e8)return ze;e8=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.isAfter=ze.isBefore=ze.isBelow=ze.isAbove=ze.compareFunction=ze.sortBy=ze.bottomRight=ze.bottomCenter=ze.bottomLeft=ze.middleRight=ze.middleCenter=ze.middleLeft=ze.topRight=ze.topCenter=ze.topLeft=ze.bottom=ze.middle=ze.top=ze.right=ze.center=ze.left=void 0;const e=Y();ze.left=e.Bounds.left,ze.center=e.Bounds.center,ze.right=e.Bounds.right,ze.top=e.Bounds.top,ze.middle=e.Bounds.middle,ze.bottom=e.Bounds.bottom,ze.topLeft=e.Bounds.topLeft,ze.topCenter=e.Bounds.topCenter,ze.topRight=e.Bounds.topRight,ze.middleLeft=e.Bounds.middleLeft,ze.middleCenter=e.Bounds.middleCenter,ze.middleRight=e.Bounds.middleRight,ze.bottomLeft=e.Bounds.bottomLeft,ze.bottomCenter=e.Bounds.bottomCenter,ze.bottomRight=e.Bounds.bottomRight,ze.sortBy=e.Bounds.sortBy;const n=t=>(i,a)=>t(i)-t(a);return ze.compareFunction=n,ze.isAbove=e.Bounds.isAbove,ze.isBelow=e.Bounds.isBelow,ze.isBefore=e.Bounds.isBefore,ze.isAfter=e.Bounds.isAfter,ze}var Cd={},Yu={},t8;function v4(){if(t8)return Yu;t8=1;var e=Yu&&Yu.__decorate||function(o,s,r,d){var l=arguments.length,c=l<3?s:d===null?d=Object.getOwnPropertyDescriptor(s,r):d,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,s,r,d);else for(var f=o.length-1;f>=0;f--)(u=o[f])&&(c=(l<3?u(c):l>3?u(s,r,c):u(s,r))||c);return l>3&&c&&Object.defineProperty(s,r,c),c};Object.defineProperty(Yu,"__esModule",{value:!0}),Yu.GEdgeView=void 0;const n=Y(),t=G(),i=j_();let a=class extends n.PolylineEdgeView{render(s,r){const l=this.edgeRouterRegistry.get(s.routerKind).route(s);return l.length===0?this.renderDanglingEdge("Cannot compute route",s,r):(0,n.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":s.hoverFeedback,...this.additionalClasses(s,r)},this.renderLine(s,l,r),this.renderAdditionals(s,l,r),r.renderChildren(s,{route:l}))}additionalClasses(s,r){return{}}renderLine(s,r,d){return(0,n.svg)("path",{d:this.createPathForSegments(r)})}renderAdditionals(s,r,d){const l=i.EdgePadding.from(s);return l?[this.renderMouseHandle(r,l)]:[]}renderMouseHandle(s,r){return(0,n.svg)("path",{"class-mouse-handle":!0,d:this.createPathForSegments(s),"style-stroke-width":r*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(s){const r=s[0];let d=`M ${r.x},${r.y}`;for(let l=1;l<s.length;l++){const c=s[l];d+=` L ${c.x},${c.y}`}return d}};return Yu.GEdgeView=a,Yu.GEdgeView=a=e([(0,t.injectable)()],a),Yu}var Da={},n8;function y4(){if(n8)return Da;n8=1;var e=Da&&Da.__decorate||function(s,r,d,l){var c=arguments.length,u=c<3?r:l===null?l=Object.getOwnPropertyDescriptor(r,d):l,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,r,d,l);else for(var h=s.length-1;h>=0;h--)(f=s[h])&&(u=(c<3?f(u):c>3?f(r,d,u):f(r,d))||u);return c>3&&u&&Object.defineProperty(r,d,u),u},n=Da&&Da.__metadata||function(s,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,r)};Object.defineProperty(Da,"__esModule",{value:!0}),Da.GGraphView=void 0;const t=Y(),i=G(),a=cR();let o=class extends t.SGraphView{render(r,d){const l=super.render(r,d);return l.data&&(l.data.style={...l.data.style,...this.getGridStyle(r,d)}),l}getGridStyle(r,d){if(d.targetKind==="hidden"||!this.gridManager)return{};const l=this.getBackgroundBounds(r,d,this.gridManager);return{[a.GridProperty.GRID_BACKGROUND_X]:l.x+"px",[a.GridProperty.GRID_BACKGROUND_Y]:l.y+"px",[a.GridProperty.GRID_BACKGROUND_WIDTH]:l.width+"px",[a.GridProperty.GRID_BACKGROUND_HEIGHT]:l.height+"px",[a.GridProperty.GRID_BACKGROUND_ZOOM]:r.zoom+""}}getBackgroundBounds(r,d,l){const c=t.Point.multiplyScalar(t.Point.subtract(l.grid,r.scroll),r.zoom),u=t.Dimension.fromPoint(t.Point.multiplyScalar(l.grid,r.zoom));return{...c,...u}}};return Da.GGraphView=o,e([(0,i.inject)(t.TYPES.IGridManager),(0,i.optional)(),n("design:type",Object)],o.prototype,"gridManager",void 0),Da.GGraphView=o=e([(0,i.injectable)()],o),Da}var Wu={},i8;function _4(){if(i8)return Wu;i8=1;var e=Wu&&Wu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.GIssueMarkerView=void 0;const n=Y(),t=G();let i=class extends n.IssueMarkerView{render(o,s){const r=super.getMaxSeverity(o),d=(0,n.svg)("g",{"class-sprotty-issue":!0},(0,n.svg)("g",null,this.getGlspIssueMarkerBackground(r),(0,n.svg)("path",{d:this.getGlspIssueMarkerPath(r)})));return(0,n.setClass)(d,"sprotty-"+r,!0),d}getGlspIssueMarkerBackground(o){switch(o){case"warning":return(0,n.svg)("polygon",{"class-sprotty-issue-background":!0,points:"8 2, 15.9 14.9, 0.2 14.9"});case"error":case"info":return(0,n.svg)("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 8}getGlspIssueMarkerPath(o){switch(o){case"error":return"m 8.8527788,0.00699568 c 1.8523692,0.115773 3.5889642,1.04195762 4.8624692,2.31546152 1.505048,1.620823 2.31546,3.5889653 2.31546,5.9044268 0,1.852369 -0.694637,3.588965 -1.852367,5.094015 -1.157733,1.389277 -2.778554,2.431235 -4.6309235,2.778554 C 7.6950478,16.446772 5.8426784,16.215226 4.2218552,15.289042 2.6010319,14.362857 1.3275281,12.97358 0.63288942,11.236984 -0.06174907,9.5003878 -0.17752216,7.5322456 0.4013433,5.7956494 0.98020876,3.9432802 2.0221665,2.4382302 3.6429898,1.3962725 5.14804,0.35431486 7.0004094,-0.10877742 8.8527788,0.00699568 Z M 9.4316445,14.941722 c 1.5050505,-0.347319 2.8943275,-1.15773 3.9362845,-2.431234 0.926185,-1.273504 1.50505,-2.778554 1.389277,-4.3993771 0,-1.8523692 -0.69464,-3.7047384 -1.968142,-4.9782422 C 11.631331,1.9751379 10.242054,1.2804995 8.6212324,1.1647264 7.1161824,1.0489533 5.4953592,1.3962725 4.2218552,2.3224572 2.9483511,3.2486418 2.0221665,4.5221456 1.5590742,6.1429686 c -0.4630923,1.50505 -0.4630923,3.1258731 0.2315462,4.6309234 0.6946384,1.50505 1.7365963,2.66278 3.1258734,3.473192 1.3892769,0.810411 3.0101002,1.041958 4.5151507,0.694638 z M 8.042367,7.5322456 10.82092,4.6379187 11.631331,5.4483302 8.8527788,8.3426571 11.631331,11.236984 10.82092,12.047395 8.042367,9.1530686 5.2638128,12.047395 4.4534013,11.236984 7.2319555,8.3426571 4.4534013,5.4483302 5.2638128,4.6379187 Z";case"warning":return"M 7.5587159,0.61312771 H 8.565869 L 16.050847,14.644601 15.54727,15.491525 H 0.55442396 L 0.05084746,14.644601 Z M 8.0622924,2.0780776 1.5157974,14.347033 H 14.585897 Z M 8.7776,13.202541 V 12.058049 H 7.3469848 v 1.144492 z M 7.3469848,10.913557 V 6.3355883 H 8.7776 v 4.5779687 z";case"info":return"M 8.7624795,0.01729008 A 7.8878137,7.8878137 0 0 1 13.625085,2.3592747 8.1894066,8.1894066 0 0 1 14.158672,13.251418 7.9458123,7.9458123 0 0 1 4.2061071,15.26977 8.1198082,8.1198082 0 0 1 0.58699265,11.209866 8.259005,8.259005 0 0 1 0.32019895,5.7463948 8.1198082,8.1198082 0 0 1 3.533323,1.3500986 7.8878137,7.8878137 0 0 1 8.7624795,0.01729008 Z M 9.3099868,14.921778 A 6.8322386,6.8322386 0 0 0 13.265493,12.520635 7.0410337,7.0410337 0 0 0 12.801504,3.1712556 6.7510406,6.7510406 0 0 0 4.1829077,2.3128758 7.029434,7.029434 0 0 0 4.762894,14.248994 6.7394408,6.7394408 0 0 0 9.3099868,14.921778 Z M 7.3786322,5.7811939 H 8.8285979 V 4.6212213 H 7.3786322 Z M 8.8285979,6.9411665 V 11.581057 H 7.3786322 V 6.9411665 Z"}}};return Wu.GIssueMarkerView=i,Wu.GIssueMarkerView=i=e([(0,t.injectable)()],i),Wu}var Oa={},Pd={},r8;function b4(){if(r8)return Pd;r8=1,Object.defineProperty(Pd,"__esModule",{value:!0}),Pd.scaledRadius=Pd.RoundedCornerWrapper=void 0;class e{constructor(i,a){this.element=i,this.cornerRadius=a}get size(){return this.element.size}get topLeftCorner(){return this._topLeftCorner||(this._topLeftCorner={radiusX:n(this.cornerRadius.topLeft,this.element.size.width/2),radiusY:n(this.cornerRadius.topLeft,this.element.size.height/2)}),this._topLeftCorner}get topRightCorner(){return this._topRightCorner||(this._topRightCorner={radiusX:n(this.cornerRadius.topRight,this.element.size.width/2),radiusY:n(this.cornerRadius.topRight,this.element.size.height/2)}),this._topRightCorner}get bottomRightCorner(){return this._bottomRightCorner||(this._bottomRightCorner={radiusX:n(this.cornerRadius.bottomRight,this.element.size.width/2),radiusY:n(this.cornerRadius.bottomRight,this.element.size.height/2)}),this._bottomRightCorner}get bottomLeftCorner(){return this._bottomLeftCorner||(this._bottomLeftCorner={radiusX:n(this.cornerRadius.bottomLeft,this.element.size.width/2),radiusY:n(this.cornerRadius.bottomLeft,this.element.size.height/2)}),this._bottomLeftCorner}}Pd.RoundedCornerWrapper=e;function n(t,i){return t<=i?t:t*(i/t)}return Pd.scaledRadius=n,Pd}var o8;function S4(){if(o8)return Oa;o8=1;var e=Oa&&Oa.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f};Object.defineProperty(Oa,"__esModule",{value:!0}),Oa.toClipPathId=Oa.RoundedCornerNodeView=void 0;const n=Y(),t=G(),i=j_(),a=b4();let o=class extends n.RectangularNodeView{render(d,l){const c=i.CornerRadius.from(d);if(!c)return this.renderWithoutRadius(d,l);const u=new a.RoundedCornerWrapper(d,c);return(0,n.svg)("g",{"class-node":!0},(0,n.svg)("defs",null,(0,n.svg)("clipPath",{id:s(d)},(0,n.svg)("path",{d:this.renderPath(u,l,this.getClipPathInsets()||0)}))),this.renderPathNode(u,l),l.renderChildren(d))}renderWithoutRadius(d,l){return super.render(d,l)}getClipPathInsets(){return 2}renderPathNode(d,l){return(0,n.svg)("path",{d:this.renderPath(d,l,0),"class-sprotty-node":d.element instanceof n.GNode,"class-sprotty-port":d.element instanceof n.GPort,"class-mouseover":d.element.hoverFeedback,"class-selected":d.element.selected,...this.additionalClasses(d.element,l)})}additionalClasses(d,l){return{}}renderPath(d,l,c){const u=Math.max(0,d.size.width-d.cornerRadius.topLeft-d.cornerRadius.topRight),f=Math.max(0,d.size.height-d.cornerRadius.topRight-d.cornerRadius.bottomRight),h=Math.max(0,d.size.width-d.cornerRadius.bottomLeft-d.cornerRadius.bottomRight);return`M${0+c},${0+d.topLeftCorner.radiusY}q0,${-(d.topLeftCorner.radiusY-c)} ${d.topLeftCorner.radiusX-c},${-(d.topLeftCorner.radiusY-c)}h${u}q${d.topRightCorner.radiusX-c},0 ${d.topRightCorner.radiusX-c},${d.topRightCorner.radiusY-c}v${f}q0,${d.bottomRightCorner.radiusY-c} ${-(d.bottomRightCorner.radiusX-c)},${d.bottomRightCorner.radiusY-c}h${-h}q${-(d.bottomLeftCorner.radiusX-c)},0 ${-(d.bottomLeftCorner.radiusX-c)},${-(d.bottomLeftCorner.radiusY-c)}z `}};Oa.RoundedCornerNodeView=o,Oa.RoundedCornerNodeView=o=e([(0,t.injectable)()],o);function s(r){return`${r.id}_clip_path`}return Oa.toClipPathId=s,Oa}var s8;function W$(){if(s8)return Cd;s8=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.configureDefaultModelElements=Cd.baseViewModule=void 0;const e=Y(),n=$m(),t=Zr(),i=v4(),a=y4(),o=_4(),s=S4();Cd.baseViewModule=new e.FeatureModule((d,l,c,u)=>{r({bind:d,unbind:l,isBound:c,rebind:u})},{featureId:Symbol("baseView")});function r(d){(0,e.configureModelElement)(d,e.DefaultTypes.HTML,e.GHtmlRoot,e.HtmlRootView),(0,e.configureModelElement)(d,e.DefaultTypes.FOREIGN_OBJECT,e.GForeignObjectElement,e.ForeignObjectView,{disable:[e.selectFeature,e.moveFeature]}),(0,e.configureModelElement)(d,e.DefaultTypes.PRE_RENDERED,e.GPreRenderedElement,e.PreRenderedView),(0,e.configureModelElement)(d,e.DefaultTypes.SHAPE_PRE_RENDERED,e.GShapedPreRenderedElement,e.PreRenderedView),(0,e.configureModelElement)(d,e.DefaultTypes.SVG,e.GViewportRootElement,e.SvgViewportView),(0,e.configureModelElement)(d,e.DefaultTypes.GRAPH,t.GGraph,a.GGraphView),(0,e.configureModelElement)(d,e.DefaultTypes.NODE,e.GNode,s.RoundedCornerNodeView),(0,e.configureModelElement)(d,e.DefaultTypes.COMPARTMENT,e.GCompartment,e.GCompartmentView),(0,e.configureModelElement)(d,e.DefaultTypes.COMPARTMENT_HEADER,e.GCompartment,e.GCompartmentView),(0,e.configureModelElement)(d,e.DefaultTypes.EDGE,t.GEdge,i.GEdgeView),(0,e.configureModelElement)(d,e.DefaultTypes.PORT,e.GPort,e.RectangularNodeView),(0,e.configureModelElement)(d,e.DefaultTypes.ROUTING_POINT,e.GRoutingHandle,e.GRoutingHandleView),(0,e.configureModelElement)(d,e.DefaultTypes.VOLATILE_ROUTING_POINT,e.GRoutingHandle,e.GRoutingHandleView),(0,e.configureModelElement)(d,e.DefaultTypes.LABEL,e.GLabel,e.GLabelView),(0,e.configureModelElement)(d,e.DefaultTypes.BUTTON_EXPAND,e.GButton,e.ExpandButtonView),(0,e.configureModelElement)(d,e.DefaultTypes.ISSUE_MARKER,n.GIssueMarker,o.GIssueMarkerView),(0,e.configureModelElement)(d,e.DefaultTypes.NODE_CIRCLE,e.CircularNode,e.CircularNodeView),(0,e.configureModelElement)(d,e.DefaultTypes.NODE_DIAMOND,e.DiamondNode,e.DiamondNodeView),(0,e.configureModelElement)(d,e.DefaultTypes.NODE_RECTANGLE,e.RectangularNode,e.RectangularNodeView)}return Cd.configureDefaultModelElements=r,Cd}var Zu={},a8;function Z$(){if(a8)return Zu;a8=1;var e=Zu&&Zu.__decorate||function(a,o,s,r){var d=arguments.length,l=d<3?o:r===null?r=Object.getOwnPropertyDescriptor(o,s):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(a,o,s,r);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(l=(d<3?c(l):d>3?c(o,s,l):c(o,s))||l);return d>3&&l&&Object.defineProperty(o,s,l),l};Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.StructureCompartmentView=void 0;const n=Y(),t=G();let i=class extends n.ShapeView{render(o,s){if(this.isVisible(o,s))return(0,n.svg)("g",null,(0,n.svg)("rect",{"class-sprotty-comp":!0,x:"0",y:"0",width:o.size.width,height:o.size.height}),s.renderChildren(o))}};return Zu.StructureCompartmentView=i,Zu.StructureCompartmentView=i=e([(0,t.injectable)()],i),Zu}var La={},c8;function Q$(){if(c8)return La;c8=1;var e=La&&La.__decorate||function(r,d,l,c){var u=arguments.length,f=u<3?d:c===null?c=Object.getOwnPropertyDescriptor(d,l):c,h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(r,d,l,c);else for(var p=r.length-1;p>=0;p--)(h=r[p])&&(f=(u<3?h(f):u>3?h(d,l,f):h(d,l))||f);return u>3&&f&&Object.defineProperty(d,l,f),f},n=La&&La.__metadata||function(r,d){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,d)};Object.defineProperty(La,"__esModule",{value:!0}),La.GLSPProjectionView=void 0;const t=Y(),i=G(),a=nh,o=cR();let s=class extends t.ProjectedViewportView{render(d,l,c){const u=(0,t.html)("div",{"class-sprotty-graph":!1,style:{width:"100%",height:"100%"}},this.renderSvg(d,l,c),this.renderProjections(d,l,c));return(0,t.setAttr)(u,"tabindex",1),(0,t.setAttr)(u,"aria-label","Diagram"),u}renderSvg(d,l,c){const u=this.edgeRouterRegistry.routeAllChildren(d),f=`scale(${d.zoom}) translate(${-d.scroll.x},${-d.scroll.y})`,h="http://www.w3.org/2000/svg";return(0,a.h)("svg",{ns:h,style:{height:"100%",...this.getGridStyle(d,l)},class:{"sprotty-graph":!0}},(0,a.h)("g",{ns:h,attrs:{transform:f}},l.renderChildren(d,{edgeRouting:u})))}getGridStyle(d,l){if(l.targetKind==="hidden"||!this.gridManager)return{};const c=this.getBackgroundBounds(d,l,this.gridManager);return{[o.GridProperty.GRID_BACKGROUND_X]:c.x+"px",[o.GridProperty.GRID_BACKGROUND_Y]:c.y+"px",[o.GridProperty.GRID_BACKGROUND_WIDTH]:c.width+"px",[o.GridProperty.GRID_BACKGROUND_HEIGHT]:c.height+"px",[o.GridProperty.GRID_BACKGROUND_ZOOM]:d.zoom+""}}getBackgroundBounds(d,l,c){const u=t.Point.multiplyScalar(t.Point.subtract(c.grid,d.scroll),d.zoom),f=t.Dimension.fromPoint(t.Point.multiplyScalar(c.grid,d.zoom));return{...u,...f}}renderProjectionBar(d,l,c,u){const f=super.renderProjectionBar(d,l,c,u);return(0,t.setClass)(f,"bordered-projection-bar",!0),f}renderViewport(d,l){let c,u;l.orientation==="horizontal"?(c=d.canvasBounds.width,u=(d.scroll.x-l.modelBounds.x)*l.factor):(c=d.canvasBounds.height,u=(d.scroll.y-l.modelBounds.y)*l.factor);let f=c*l.zoomedFactor;u<0?(f+=u,u=0):u>c&&(u=c),f<0?f=0:u+f>c&&(f=c-u),Math.abs(f-c)<1&&(f=0);const h=l.orientation==="horizontal"?{left:`${u}px`,width:`${f}px`}:{top:`${u}px`,height:`${f}px`};return(0,t.html)("div",{"class-sprotty-viewport":f!==0,"class-projection-scroll-bar":!0,style:h})}renderProjection(d,l,c){const u=super.renderProjection(d,l,c);(0,t.setClass)(u,"glsp-projection",!0);const f=u.data.style;return f.left?f.height="60%":f.width="60%",u}};return La.GLSPProjectionView=s,e([(0,i.inject)(t.EdgeRouterRegistry),n("design:type",t.EdgeRouterRegistry)],s.prototype,"edgeRouterRegistry",void 0),e([(0,i.inject)(t.TYPES.IGridManager),(0,i.optional)(),n("design:type",Object)],s.prototype,"gridManager",void 0),La.GLSPProjectionView=s=e([(0,i.injectable)()],s),La}var u8;function J$(){return u8||(u8=1,function(e){var n=Cl&&Cl.__createBinding||(Object.create?function(i,a,o,s){s===void 0&&(s=o);var r=Object.getOwnPropertyDescriptor(a,o);(!r||("get"in r?!a.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return a[o]}}),Object.defineProperty(i,s,r)}:function(i,a,o,s){s===void 0&&(s=o),i[s]=a[o]}),t=Cl&&Cl.__exportStar||function(i,a){for(var o in i)o!=="default"&&!Object.prototype.hasOwnProperty.call(a,o)&&n(a,i,o)};Object.defineProperty(e,"__esModule",{value:!0}),t(s9(),e),t(wP(),e),t(Vm(),e),t(a9(),e),t(IP(),e),t(A$(),e),t(u9(),e),t(c9(),e),t(l9(),e),t(S9(),e),t(Jc(),e),t(kn(),e),t(Un(),e),t(TP(),e),t(Cr(),e),t(d9(),e),t(f9(),e),t(h9(),e),t(of(),e),t(Gm(),e),t(p9(),e),t(ch(),e),t(w_(),e),t(g9(),e),t(m9(),e),t(cl(),e),t(v9(),e),t(Er(),e),t(an(),e),t(y9(),e),t(Ya(),e),t(_9(),e),t(DP(),e),t(OP(),e),t(b9(),e),t(I$(),e),t(N$(),e),t(fh(),e),t(QP(),e),t(B$(),e),t(x_(),e),t(H6(),e),t(B_(),e),t(F6(),e),t(x$(),e),t(F$(),e),t(B6(),e),t(x6(),e),t(K6(),e),t(k6(),e),t(V6(),e),t(Xc(),e),t(WP(),e),t(q6(),e),t(ph(),e),t(uf(),e),t(XP(),e),t(eR(),e),t(U6(),e),t(tR(),e),t(hh(),e),t(nR(),e),t(G6(),e),t($6(),e),t(z6(),e),t(JP(),e),t(Y6(),e),t(iR(),e),t(W6(),e),t(rR(),e),t(oR(),e),t(Q6(),e),t(Z6(),e),t(Qm(),e),t(J6(),e),t(ZP(),e),t(ll(),e),t(e4(),e),t(X6(),e),t(t4(),e),t(n4(),e),t(r4(),e),t(i4(),e),t(A9(),e),t(E9(),e),t(C9(),e),t(P9(),e),t(sf(),e),t(R9(),e),t(lh(),e),t(zm(),e),t(M9(),e),t(Pr(),e),t(f6(),e),t(k$(),e),t(LP(),e),t(s4(),e),t(h6(),e),t(w9(),e),t(D9(),e),t(I9(),e),t(T9(),e),t(j9(),e),t(K$(),e),t(O9(),e),t(L9(),e),t(q$(),e),t(N9(),e),t(jP(),e),t(B9(),e),t(a4(),e),t(c4(),e),t(sR(),e),t(H$(),e),t(F9(),e),t(x9(),e),t(I_(),e),t(BP(),e),t(M6(),e),t(NP(),e),t(xP(),e),t(k9(),e),t(K9(),e),t(V$(),e),t(u4(),e),t(aR(),e),t(G$(),e),t(l4(),e),t(cR(),e),t(uR(),e),t(d4(),e),t(z$(),e),t(uh(),e),t(f4(),e),t(Um(),e),t(q9(),e),t(H9(),e),t(G9(),e),t(z9(),e),t(U9(),e),t($9(),e),t(Y9(),e),t(W9(),e),t(Z9(),e),t(Q9(),e),t(J9(),e),t(X9(),e),t(e6(),e),t(KP(),e),t(T_(),e),t(t6(),e),t(n6(),e),t(h4(),e),t(p4(),e),t(i6(),e),t(qP(),e),t(r6(),e),t(o6(),e),t(s6(),e),t(c6(),e),t(a6(),e),t(u6(),e),t(l6(),e),t(Wm(),e),t(d6(),e),t(Wa(),e),t(zP(),e),t(g6(),e),t(af(),e),t(v6(),e),t(p6(),e),t(GP(),e),t(m6(),e),t(D_(),e),t(y6(),e),t(ul(),e),t(_6(),e),t(kP(),e),t(FP(),e),t(V9(),e),t(S6(),e),t(b6(),e),t(L_(),e),t(HP(),e),t(dh(),e),t(R6(),e),t(E6(),e),t(O_(),e),t(C6(),e),t(P6(),e),t(UP(),e),t(Zm(),e),t(I6(),e),t(A6(),e),t(w6(),e),t(T6(),e),t(g4(),e),t(m4(),e),t($m(),e),t(O6(),e),t(L6(),e),t($P(),e),t(j6(),e),t(VP(),e),t(N_(),e),t(N6(),e),t(YP(),e),t(Zr(),e),t(U$(),e),t($$(),e),t(j_(),e),t(Y$(),e),t(kt(),e),t(o4(),e),t(Ym(),e),t(D6(),e),t(Wo(),e),t(W$(),e),t(Z$(),e),t(v4(),e),t(y4(),e),t(Q$(),e),t(_4(),e),t(b4(),e),t(S4(),e)}(Cl)),Cl}var A=J$();const CS=Symbol.for("@inversifyjs/common/islazyServiceIdentifier");var x8,Sm,F8;let X$=(x8=CS,F8=class{constructor(n){x(this,x8);Zn(this,Sm);Dn(this,Sm,n),this[CS]=!0}static is(n){return typeof n=="object"&&n!==null&&n[CS]===!0}unwrap(){return Fe(this,Sm).call(this)}},Sm=new WeakMap,F8);function Hc(e,n){return Reflect.getMetadata(n,e)}function l8(e,n,t,i){const a=i(Hc(e,n)??t);Reflect.defineMetadata(n,a,e)}const F_="named",lR="name",dR="unmanaged",fR="optional",hR="inject",pR="multi_inject",E4="post_construct",C4="pre_destroy",eY=[hR,pR,lR,dR,F_,fR],PS=Symbol.for("@inversifyjs/core/InversifyCoreError");var k8,K8;let Kd=class P4 extends(K8=Error,k8=PS,K8){constructor(t,i,a){super(i,a);x(this,k8);x(this,"kind");this[PS]=!0,this.kind=t}static is(t){return typeof t=="object"&&t!==null&&t[PS]===!0}static isErrorOfKind(t,i){return P4.is(t)&&t.kind===i}};var Vc,yr;function R4(e,n){const t=[];for(let i=0;i<n.length;++i)n[i]===void 0&&t.push(i);if(t.length>0)throw new Kd(Vc.missingInjectionDecorator,`Found unexpected missing metadata on type "${e.name}" at constructor indexes "${t.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}function M4(e){return{kind:yr.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:e}}function k_(e){const n=e.find(s=>s.key===hR),t=e.find(s=>s.key===pR);if(e.find(s=>s.key===dR)!==void 0)return function(s,r){if(r!==void 0||s!==void 0)throw new Kd(Vc.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:yr.unmanaged}}(n,t);if(t===void 0&&n===void 0)throw new Kd(Vc.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");const i=e.find(s=>s.key===F_),a=e.find(s=>s.key===fR),o=e.find(s=>s.key===lR);return{kind:n===void 0?yr.multipleInjection:yr.singleInjection,name:i==null?void 0:i.value,optional:a!==void 0,tags:new Map(e.filter(s=>eY.every(r=>s.key!==r)).map(s=>[s.key,s.value])),targetName:o==null?void 0:o.value,value:n===void 0?t==null?void 0:t.value:n.value}}function A4(e,n,t){try{return k_(t)}catch(i){throw Kd.isErrorOfKind(i,Vc.missingInjectionDecorator)?new Kd(Vc.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${e.name}" at constructor arguments at index "${n.toString()}"`,{cause:i}):i}}function tY(e){const n=Hc(e,"design:paramtypes"),t=Hc(e,"inversify:tagged"),i=[];if(t!==void 0)for(const[a,o]of Object.entries(t)){const s=parseInt(a);i[s]=A4(e,s,o)}if(n!==void 0){for(let a=0;a<n.length;++a)if(i[a]===void 0){const o=n[a];i[a]=M4(o)}}return R4(e,i),i}function w4(e,n,t){try{return k_(t)}catch(i){throw Kd.isErrorOfKind(i,Vc.missingInjectionDecorator)?new Kd(Vc.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${e.name}" at property "${n.toString()}"`,{cause:i}):i}}function I4(e){const n=Hc(e,"inversify:tagged_props"),t=new Map;if(n!==void 0)for(const i of Reflect.ownKeys(n)){const a=n[i];t.set(i,w4(e,i,a))}return t}function nY(e){const n=Hc(e,E4),t=Hc(e,C4);return{constructorArguments:tY(e),lifecycle:{postConstructMethodName:n==null?void 0:n.value,preDestroyMethodName:t==null?void 0:t.value},properties:I4(e)}}function iY(e,n){const t=n.getConstructorMetadata(e),i=[];for(const[a,o]of Object.entries(t.userGeneratedMetadata)){const s=parseInt(a);i[s]=A4(e,s,o)}if(t.compilerGeneratedMetadata!==void 0){for(let a=0;a<t.compilerGeneratedMetadata.length;++a)if(i[a]===void 0){const o=t.compilerGeneratedMetadata[a];i[a]=M4(o)}}return R4(e,i),i}function T4(e,n){const t=n.getPropertiesMetadata(e),i=new Map;for(const a of Reflect.ownKeys(t)){const o=t[a];i.set(a,w4(e,a,o))}return i}function rY(e,n){const t=Hc(e,E4),i=Hc(e,C4);return{constructorArguments:iY(e,n),lifecycle:{postConstructMethodName:t==null?void 0:t.value,preDestroyMethodName:i==null?void 0:i.value},properties:T4(e,n)}}function d8(e){const n=Object.getPrototypeOf(e.prototype);return n==null?void 0:n.constructor}function oY(e){return e.kind===yr.unmanaged?[{key:dR,value:!0}]:function(n){const t=[sY(n)];n.name!==void 0&&t.push({key:F_,value:n.name}),n.optional&&t.push({key:fR,value:!0});for(const[i,a]of n.tags)t.push({key:i,value:a});return n.targetName!==void 0&&t.push({key:lR,value:n.targetName}),t}(e)}function sY(e){let n;switch(e.kind){case yr.multipleInjection:n={key:pR,value:e.value};break;case yr.singleInjection:n={key:hR,value:e.value}}return n}(function(e){e[e.injectionDecoratorConflict=0]="injectionDecoratorConflict",e[e.missingInjectionDecorator=1]="missingInjectionDecorator",e[e.planning=2]="planning",e[e.unknown=3]="unknown"})(Vc||(Vc={})),function(e){e[e.multipleInjection=0]="multipleInjection",e[e.singleInjection=1]="singleInjection",e[e.unmanaged=2]="unmanaged"}(yr||(yr={}));var xc,q8;let aY=(q8=class{constructor(n){Zn(this,xc);Dn(this,xc,n)}startsWith(n){return Fe(this,xc).startsWith(n)}endsWith(n){return Fe(this,xc).endsWith(n)}contains(n){return Fe(this,xc).includes(n)}equals(n){return Fe(this,xc)===n}value(){return Fe(this,xc)}},xc=new WeakMap,q8);const RS="@inversifyjs/core/targetId";var hi,Em,Cm,Ad,Pm,Rm,H8;let hy=(H8=class{constructor(n,t,i){Zn(this,hi);Zn(this,Em);Zn(this,Cm);Zn(this,Ad);Zn(this,Pm);Zn(this,Rm);Dn(this,Em,function(){const a=Hc(Object,RS)??0;return a===Number.MAX_SAFE_INTEGER?l8(Object,RS,a,()=>Number.MIN_SAFE_INTEGER):l8(Object,RS,a,o=>o+1),a}()),Dn(this,Cm,n),Dn(this,Ad,void 0),Dn(this,hi,t),Dn(this,Pm,new aY(typeof n=="string"?n:n.toString().slice(7,-1))),Dn(this,Rm,i)}get id(){return Fe(this,Em)}get identifier(){return Fe(this,Cm)}get metadata(){return Fe(this,Ad)===void 0&&Dn(this,Ad,oY(Fe(this,hi))),Fe(this,Ad)}get name(){return Fe(this,Pm)}get type(){return Fe(this,Rm)}get serviceIdentifier(){return X$.is(Fe(this,hi).value)?Fe(this,hi).value.unwrap():Fe(this,hi).value}getCustomTags(){return[...Fe(this,hi).tags.entries()].map(([n,t])=>({key:n,value:t}))}getNamedTag(){return Fe(this,hi).name===void 0?null:{key:F_,value:Fe(this,hi).name}}hasTag(n){return this.metadata.some(t=>t.key===n)}isArray(){return Fe(this,hi).kind===yr.multipleInjection}isNamed(){return Fe(this,hi).name!==void 0}isOptional(){return Fe(this,hi).optional}isTagged(){return Fe(this,hi).tags.size>0}matchesArray(n){return this.isArray()&&Fe(this,hi).value===n}matchesNamedTag(n){return Fe(this,hi).name===n}matchesTag(n){return t=>this.metadata.some(i=>i.key===n&&i.value===t)}},hi=new WeakMap,Em=new WeakMap,Cm=new WeakMap,Ad=new WeakMap,Pm=new WeakMap,Rm=new WeakMap,H8);const D4=e=>function(n,t){return function(i){const a=n(i);let o=d8(i);for(;o!==void 0&&o!==Object;){const r=t(o);for(const[d,l]of r)a.properties.has(d)||a.properties.set(d,l);o=d8(o)}const s=[];for(const r of a.constructorArguments)if(r.kind!==yr.unmanaged){const d=r.targetName??"";s.push(new hy(d,r,"ConstructorArgument"))}for(const[r,d]of a.properties)if(d.kind!==yr.unmanaged){const l=d.targetName??r;s.push(new hy(l,d,"ClassProperty"))}return s}}(e===void 0?nY:n=>rY(n,e),e===void 0?I4:n=>T4(n,e)),Ms="named",cY="unmanaged",O4="optional",L4="inject",j4="multi_inject",N4="inversify:tagged",B4="inversify:tagged_props",f8="inversify:paramtypes",x4="design:paramtypes",xS="post_construct",FS="pre_destroy",Cn={Request:"Request",Singleton:"Singleton",Transient:"Transient"},Ut={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},F4={ConstructorArgument:"ConstructorArgument",Variable:"Variable"};let uY=0;function Xm(){return uY++}class gR{constructor(n,t){x(this,"id");x(this,"moduleId");x(this,"activated");x(this,"serviceIdentifier");x(this,"implementationType");x(this,"cache");x(this,"dynamicValue");x(this,"scope");x(this,"type");x(this,"factory");x(this,"provider");x(this,"constraint");x(this,"onActivation");x(this,"onDeactivation");this.id=Xm(),this.activated=!1,this.serviceIdentifier=n,this.scope=t,this.type=Ut.Invalid,this.constraint=i=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){const n=new gR(this.serviceIdentifier,this.scope);return n.activated=n.scope===Cn.Singleton&&this.activated,n.implementationType=this.implementationType,n.dynamicValue=this.dynamicValue,n.scope=this.scope,n.type=this.type,n.factory=this.factory,n.provider=this.provider,n.constraint=this.constraint,n.onActivation=this.onActivation,n.onDeactivation=this.onDeactivation,n.cache=this.cache,n}}const k4="Metadata key was used more than once in a parameter:",h8="NULL argument",p8="Key Not Found",lY="Ambiguous match found for serviceIdentifier:",dY="No matching bindings found for serviceIdentifier:",K4="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",kS=(e,n)=>`onDeactivation() error in class ${e}: ${n}`;class fY{getConstructorMetadata(n){return{compilerGeneratedMetadata:Reflect.getMetadata(x4,n)??[],userGeneratedMetadata:Reflect.getMetadata(N4,n)??{}}}getPropertiesMetadata(n){return Reflect.getMetadata(B4,n)??{}}}var Of;function q4(e){return e instanceof RangeError||e.message==="Maximum call stack size exceeded"}(function(e){e[e.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",e[e.NoBindingsAvailable=0]="NoBindingsAvailable",e[e.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"})(Of||(Of={}));function nl(e){return typeof e=="function"?e.name:typeof e=="symbol"?e.toString():e}function g8(e,n,t){let i="";const a=t(e,n);return a.length!==0&&(i=`
Registered bindings:`,a.forEach(o=>{let s="Object";o.implementationType!==null&&(s=G4(o.implementationType)),i=`${i}
 ${s}`,o.constraint.metaData&&(i=`${i} - ${o.constraint.metaData}`)})),i}function H4(e,n){return e.parentRequest!==null&&(e.parentRequest.serviceIdentifier===n||H4(e.parentRequest,n))}function V4(e){e.childRequests.forEach(n=>{if(H4(e,n.serviceIdentifier)){const t=function(i){return function o(s,r=[]){const d=nl(s.serviceIdentifier);return r.push(d),s.parentRequest!==null?o(s.parentRequest,r):r}(i).reverse().join(" --> ")}(n);throw new Error(`Circular dependency found: ${t}`)}V4(n)})}function G4(e){if(e.name!=null&&e.name!=="")return e.name;{const n=e.toString(),t=n.match(/^function\s*([^\s(]+)/);return t===null?`Anonymous function: ${n}`:t[1]}}function m8(e){return`{"key":"${e.key.toString()}","value":"${e.value.toString()}"}`}class z4{constructor(n){x(this,"id");x(this,"container");x(this,"plan");x(this,"currentRequest");this.id=Xm(),this.container=n}addPlan(n){this.plan=n}setCurrentRequest(n){this.currentRequest=n}}class xd{constructor(n,t){x(this,"key");x(this,"value");this.key=n,this.value=t}toString(){return this.key===Ms?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}class hY{constructor(n,t){x(this,"parentContext");x(this,"rootRequest");this.parentContext=n,this.rootRequest=t}}function U4(e,n){const t=function(r){const d=Object.getPrototypeOf(r.prototype);return d==null?void 0:d.constructor}(n);if(t===void 0||t===Object)return 0;const i=D4(e)(t),a=i.map(r=>r.metadata.filter(d=>d.key===cY)),o=[].concat.apply([],a).length,s=i.length-o;return s>0?s:U4(e,t)}class ev{constructor(n,t,i,a,o){x(this,"id");x(this,"serviceIdentifier");x(this,"parentContext");x(this,"parentRequest");x(this,"bindings");x(this,"childRequests");x(this,"target");x(this,"requestScope");this.id=Xm(),this.serviceIdentifier=n,this.parentContext=t,this.parentRequest=i,this.target=o,this.childRequests=[],this.bindings=Array.isArray(a)?a:[a],this.requestScope=i===null?new Map:null}addChildRequest(n,t,i){const a=new ev(n,this.parentContext,this,t,i);return this.childRequests.push(a),a}}function py(e){return e._bindingDictionary}function v8(e,n,t,i,a){let o=Gg(t.container,a.serviceIdentifier),s=[];return o.length===Of.NoBindingsAvailable&&t.container.options.autoBindInjectable===!0&&typeof a.serviceIdentifier=="function"&&e.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(a.serviceIdentifier).toSelf(),o=Gg(t.container,a.serviceIdentifier)),s=n?o:o.filter(r=>{const d=new ev(r.serviceIdentifier,t,i,r,a);return r.constraint(d)}),function(r,d,l,c,u){switch(d.length){case Of.NoBindingsAvailable:if(c.isOptional())return d;{const f=nl(r);let h=dY;throw h+=function(p,g){if(g.isTagged()||g.isNamed()){let m="";const v=g.getNamedTag(),_=g.getCustomTags();return v!==null&&(m+=m8(v)+`
`),_!==null&&_.forEach(S=>{m+=m8(S)+`
`}),` ${p}
 ${p} - ${m}`}return` ${p}`}(f,c),h+=g8(u,f,Gg),l!==null&&(h+=`
Trying to resolve bindings for "${nl(l.serviceIdentifier)}"`),new Error(h)}case Of.OnlyOneBindingAvailable:return d;case Of.MultipleBindingsAvailable:default:if(c.isArray())return d;{const f=nl(r);let h=`${lY} ${f}`;throw h+=g8(u,f,Gg),new Error(h)}}}(a.serviceIdentifier,s,i,a,t.container),s}function $4(e,n){const t=n.isMultiInject?j4:L4,i=[new xd(t,e)];return n.customTag!==void 0&&i.push(new xd(n.customTag.key,n.customTag.value)),n.isOptional===!0&&i.push(new xd(O4,!0)),i}function Y4(e,n,t,i,a,o){let s,r;if(a===null){s=v8(e,n,i,null,o),r=new ev(t,i,null,s,o);const d=new hY(i,r);i.addPlan(d)}else s=v8(e,n,i,a,o),r=a.addChildRequest(o.serviceIdentifier,s,o);s.forEach(d=>{let l=null;if(o.isArray())l=r.addChildRequest(d.serviceIdentifier,d,o);else{if(d.cache!==null)return;l=r}if(d.type===Ut.Instance&&d.implementationType!==null){const c=function(u,f){return D4(u)(f)}(e,d.implementationType);if(i.container.options.skipBaseClassChecks!==!0){const u=U4(e,d.implementationType);if(c.length<u){const f=`The number of constructor arguments in the derived class ${G4(d.implementationType)} must be >= than the number of constructor arguments of its base class.`;throw new Error(f)}}c.forEach(u=>{Y4(e,!1,u.serviceIdentifier,i,l,u)})}})}function Gg(e,n){let t=[];const i=py(e);return i.hasKey(n)?t=i.get(n):e.parent!==null&&(t=Gg(e.parent,n)),t}function pY(e,n,t,i,a,o=!1){const s=new z4(n),r=function(d,l,c){const u=$4(l,c),f=k_(u);if(f.kind===yr.unmanaged)throw new Error("Unexpected metadata when creating target");return new hy("",f,d)}(t,i,a);try{return Y4(e,o,i,s,null,r),s}catch(d){throw q4(d)&&V4(s.plan.rootRequest),d}}function vr(e){return(typeof e=="object"&&e!==null||typeof e=="function")&&typeof e.then=="function"}function W4(e){return!!vr(e)||Array.isArray(e)&&e.some(vr)}const gY=(e,n,t)=>{e.has(n.id)||e.set(n.id,t)},mY=(e,n)=>{e.cache=n,e.activated=!0,vr(n)&&vY(e,n)},vY=async(e,n)=>{try{const t=await n;e.cache=t}catch(t){throw e.cache=null,e.activated=!1,t}};var Wg;(function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"})(Wg||(Wg={}));function yY(e,n,t){let i;if(n.length>0){const a=function(s,r){return s.reduce((d,l)=>{const c=r(l);return l.target.type===F4.ConstructorArgument?d.constructorInjections.push(c):(d.propertyRequests.push(l),d.propertyInjections.push(c)),d.isAsync||(d.isAsync=W4(c)),d},{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}(n,t),o={...a,constr:e};i=a.isAsync?async function(s){const r=await _8(s.constructorInjections),d=await _8(s.propertyInjections);return y8({...s,constructorInjections:r,propertyInjections:d})}(o):y8(o)}else i=new e;return i}function y8(e){const n=new e.constr(...e.constructorInjections);return e.propertyRequests.forEach((t,i)=>{const a=t.target.identifier,o=e.propertyInjections[i];t.target.isOptional()&&o===void 0||(n[a]=o)}),n}async function _8(e){const n=[];for(const t of e)Array.isArray(t)?n.push(Promise.all(t)):n.push(t);return Promise.all(n)}function b8(e,n){const t=function(i,a){var r;if(Reflect.hasMetadata(xS,i)){const d=Reflect.getMetadata(xS,i);try{return(r=a[d.value])==null?void 0:r.call(a)}catch(l){if(l instanceof Error)throw new Error((o=i.name,s=l.message,`@postConstruct error in class ${o}: ${s}`))}}var o,s}(e,n);return vr(t)?t.then(()=>n):n}function _Y(e,n){e.scope!==Cn.Singleton&&function(t,i){const a=`Class cannot be instantiated in ${t.scope===Cn.Request?"request":"transient"} scope.`;if(typeof t.onDeactivation=="function")throw new Error(kS(i.name,a));if(Reflect.hasMetadata(FS,i))throw new Error(`@preDestroy error in class ${i.name}: ${a}`)}(e,n)}const mR=e=>n=>{n.parentContext.setCurrentRequest(n);const t=n.bindings,i=n.childRequests,a=n.target&&n.target.isArray(),o=!(n.parentRequest&&n.parentRequest.target&&n.target&&n.parentRequest.target.matchesArray(n.target.serviceIdentifier));if(a&&o)return i.map(s=>mR(e)(s));{if(n.target.isOptional()&&t.length===0)return;const s=t[0];return CY(e,n,s)}},bY=(e,n)=>{const t=(i=>{switch(i.type){case Ut.Factory:return{factory:i.factory,factoryType:Wg.Factory};case Ut.Provider:return{factory:i.provider,factoryType:Wg.Provider};case Ut.DynamicValue:return{factory:i.dynamicValue,factoryType:Wg.DynamicValue};default:throw new Error(`Unexpected factory type ${i.type}`)}})(e);return((i,a)=>{try{return i()}catch(o){throw q4(o)?a():o}})(()=>t.factory.bind(e)(n),()=>{return new Error((i=t.factoryType,a=n.currentRequest.serviceIdentifier.toString(),`It looks like there is a circular dependency in one of the '${i}' bindings. Please investigate bindings with service identifier '${a}'.`));var i,a})},SY=(e,n,t)=>{let i;const a=n.childRequests;switch((o=>{let s=null;switch(o.type){case Ut.ConstantValue:case Ut.Function:s=o.cache;break;case Ut.Constructor:case Ut.Instance:s=o.implementationType;break;case Ut.DynamicValue:s=o.dynamicValue;break;case Ut.Provider:s=o.provider;break;case Ut.Factory:s=o.factory}if(s===null){const r=nl(o.serviceIdentifier);throw new Error(`Invalid binding type: ${r}`)}})(t),t.type){case Ut.ConstantValue:case Ut.Function:i=t.cache;break;case Ut.Constructor:i=t.implementationType;break;case Ut.Instance:i=function(o,s,r,d){_Y(o,s);const l=yY(s,r,d);return vr(l)?l.then(c=>b8(s,c)):b8(s,l)}(t,t.implementationType,a,mR(e));break;default:i=bY(t,n.parentContext)}return i},EY=(e,n,t)=>{let i=((a,o)=>o.scope===Cn.Singleton&&o.activated?o.cache:o.scope===Cn.Request&&a.has(o.id)?a.get(o.id):null)(e,n);return i!==null||(i=t(),((a,o,s)=>{o.scope===Cn.Singleton&&mY(o,s),o.scope===Cn.Request&&gY(a,o,s)})(e,n,i)),i},CY=(e,n,t)=>EY(e,t,()=>{let i=SY(e,n,t);return i=vr(i)?i.then(a=>S8(n,t,a)):S8(n,t,i),i});function S8(e,n,t){let i=PY(e.parentContext,n,t);const a=AY(e.parentContext.container);let o,s=a.next();do{o=s.value;const r=e.parentContext,d=e.serviceIdentifier,l=MY(o,d);i=vr(i)?Z4(l,r,i):RY(l,r,i),s=a.next()}while(s.done!==!0&&!py(o).hasKey(e.serviceIdentifier));return i}const PY=(e,n,t)=>{let i;return i=typeof n.onActivation=="function"?n.onActivation(e,t):t,i},RY=(e,n,t)=>{let i=e.next();for(;i.done!==!0;){if(vr(t=i.value(n,t)))return Z4(e,n,t);i=e.next()}return t},Z4=async(e,n,t)=>{let i=await t,a=e.next();for(;a.done!==!0;)i=await a.value(n,i),a=e.next();return i},MY=(e,n)=>{const t=e._activations;return t.hasKey(n)?t.get(n).values():[].values()},AY=e=>{const n=[e];let t=e.parent;for(;t!==null;)n.push(t),t=t.parent;return{next:()=>{const i=n.pop();return i!==void 0?{done:!1,value:i}:{done:!0,value:void 0}}}},Nc=(e,n)=>{const t=e.parentRequest;return t!==null&&(!!n(t)||Nc(t,n))},zg=e=>n=>{const t=i=>i!==null&&i.target!==null&&i.target.matchesTag(e)(n);return t.metaData=new xd(e,n),t},ey=zg(Ms),MS=e=>n=>{let t=null;if(n!==null){if(t=n.bindings[0],typeof e=="string")return t.serviceIdentifier===e;{const i=n.bindings[0].implementationType;return e===i}}return!1};class gy{constructor(n){x(this,"_binding");this._binding=n}when(n){return this._binding.constraint=n,new fi(this._binding)}whenTargetNamed(n){return this._binding.constraint=ey(n),new fi(this._binding)}whenTargetIsDefault(){return this._binding.constraint=n=>n===null?!1:n.target!==null&&!n.target.isNamed()&&!n.target.isTagged(),new fi(this._binding)}whenTargetTagged(n,t){return this._binding.constraint=zg(n)(t),new fi(this._binding)}whenInjectedInto(n){return this._binding.constraint=t=>t!==null&&MS(n)(t.parentRequest),new fi(this._binding)}whenParentNamed(n){return this._binding.constraint=t=>t!==null&&ey(n)(t.parentRequest),new fi(this._binding)}whenParentTagged(n,t){return this._binding.constraint=i=>i!==null&&zg(n)(t)(i.parentRequest),new fi(this._binding)}whenAnyAncestorIs(n){return this._binding.constraint=t=>t!==null&&Nc(t,MS(n)),new fi(this._binding)}whenNoAncestorIs(n){return this._binding.constraint=t=>t!==null&&!Nc(t,MS(n)),new fi(this._binding)}whenAnyAncestorNamed(n){return this._binding.constraint=t=>t!==null&&Nc(t,ey(n)),new fi(this._binding)}whenNoAncestorNamed(n){return this._binding.constraint=t=>t!==null&&!Nc(t,ey(n)),new fi(this._binding)}whenAnyAncestorTagged(n,t){return this._binding.constraint=i=>i!==null&&Nc(i,zg(n)(t)),new fi(this._binding)}whenNoAncestorTagged(n,t){return this._binding.constraint=i=>i!==null&&!Nc(i,zg(n)(t)),new fi(this._binding)}whenAnyAncestorMatches(n){return this._binding.constraint=t=>t!==null&&Nc(t,n),new fi(this._binding)}whenNoAncestorMatches(n){return this._binding.constraint=t=>t!==null&&!Nc(t,n),new fi(this._binding)}}class fi{constructor(n){x(this,"_binding");this._binding=n}onActivation(n){return this._binding.onActivation=n,new gy(this._binding)}onDeactivation(n){return this._binding.onDeactivation=n,new gy(this._binding)}}class Bc{constructor(n){x(this,"_bindingWhenSyntax");x(this,"_bindingOnSyntax");x(this,"_binding");this._binding=n,this._bindingWhenSyntax=new gy(this._binding),this._bindingOnSyntax=new fi(this._binding)}when(n){return this._bindingWhenSyntax.when(n)}whenTargetNamed(n){return this._bindingWhenSyntax.whenTargetNamed(n)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(n,t){return this._bindingWhenSyntax.whenTargetTagged(n,t)}whenInjectedInto(n){return this._bindingWhenSyntax.whenInjectedInto(n)}whenParentNamed(n){return this._bindingWhenSyntax.whenParentNamed(n)}whenParentTagged(n,t){return this._bindingWhenSyntax.whenParentTagged(n,t)}whenAnyAncestorIs(n){return this._bindingWhenSyntax.whenAnyAncestorIs(n)}whenNoAncestorIs(n){return this._bindingWhenSyntax.whenNoAncestorIs(n)}whenAnyAncestorNamed(n){return this._bindingWhenSyntax.whenAnyAncestorNamed(n)}whenAnyAncestorTagged(n,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(n,t)}whenNoAncestorNamed(n){return this._bindingWhenSyntax.whenNoAncestorNamed(n)}whenNoAncestorTagged(n,t){return this._bindingWhenSyntax.whenNoAncestorTagged(n,t)}whenAnyAncestorMatches(n){return this._bindingWhenSyntax.whenAnyAncestorMatches(n)}whenNoAncestorMatches(n){return this._bindingWhenSyntax.whenNoAncestorMatches(n)}onActivation(n){return this._bindingOnSyntax.onActivation(n)}onDeactivation(n){return this._bindingOnSyntax.onDeactivation(n)}}class wY{constructor(n){x(this,"_binding");this._binding=n}inRequestScope(){return this._binding.scope=Cn.Request,new Bc(this._binding)}inSingletonScope(){return this._binding.scope=Cn.Singleton,new Bc(this._binding)}inTransientScope(){return this._binding.scope=Cn.Transient,new Bc(this._binding)}}class E8{constructor(n){x(this,"_bindingInSyntax");x(this,"_bindingWhenSyntax");x(this,"_bindingOnSyntax");x(this,"_binding");this._binding=n,this._bindingWhenSyntax=new gy(this._binding),this._bindingOnSyntax=new fi(this._binding),this._bindingInSyntax=new wY(n)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(n){return this._bindingWhenSyntax.when(n)}whenTargetNamed(n){return this._bindingWhenSyntax.whenTargetNamed(n)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(n,t){return this._bindingWhenSyntax.whenTargetTagged(n,t)}whenInjectedInto(n){return this._bindingWhenSyntax.whenInjectedInto(n)}whenParentNamed(n){return this._bindingWhenSyntax.whenParentNamed(n)}whenParentTagged(n,t){return this._bindingWhenSyntax.whenParentTagged(n,t)}whenAnyAncestorIs(n){return this._bindingWhenSyntax.whenAnyAncestorIs(n)}whenNoAncestorIs(n){return this._bindingWhenSyntax.whenNoAncestorIs(n)}whenAnyAncestorNamed(n){return this._bindingWhenSyntax.whenAnyAncestorNamed(n)}whenAnyAncestorTagged(n,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(n,t)}whenNoAncestorNamed(n){return this._bindingWhenSyntax.whenNoAncestorNamed(n)}whenNoAncestorTagged(n,t){return this._bindingWhenSyntax.whenNoAncestorTagged(n,t)}whenAnyAncestorMatches(n){return this._bindingWhenSyntax.whenAnyAncestorMatches(n)}whenNoAncestorMatches(n){return this._bindingWhenSyntax.whenNoAncestorMatches(n)}onActivation(n){return this._bindingOnSyntax.onActivation(n)}onDeactivation(n){return this._bindingOnSyntax.onDeactivation(n)}}class IY{constructor(n){x(this,"_binding");this._binding=n}to(n){return this._binding.type=Ut.Instance,this._binding.implementationType=n,new E8(this._binding)}toSelf(){if(typeof this._binding.serviceIdentifier!="function")throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");const n=this._binding.serviceIdentifier;return this.to(n)}toConstantValue(n){return this._binding.type=Ut.ConstantValue,this._binding.cache=n,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Cn.Singleton,new Bc(this._binding)}toDynamicValue(n){return this._binding.type=Ut.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=n,this._binding.implementationType=null,new E8(this._binding)}toConstructor(n){return this._binding.type=Ut.Constructor,this._binding.implementationType=n,this._binding.scope=Cn.Singleton,new Bc(this._binding)}toFactory(n){return this._binding.type=Ut.Factory,this._binding.factory=n,this._binding.scope=Cn.Singleton,new Bc(this._binding)}toFunction(n){if(typeof n!="function")throw new Error("Value provided to function binding must be a function!");const t=this.toConstantValue(n);return this._binding.type=Ut.Function,this._binding.scope=Cn.Singleton,t}toAutoFactory(n){return this._binding.type=Ut.Factory,this._binding.factory=t=>()=>t.container.get(n),this._binding.scope=Cn.Singleton,new Bc(this._binding)}toAutoNamedFactory(n){return this._binding.type=Ut.Factory,this._binding.factory=t=>i=>t.container.getNamed(n,i),new Bc(this._binding)}toProvider(n){return this._binding.type=Ut.Provider,this._binding.provider=n,this._binding.scope=Cn.Singleton,new Bc(this._binding)}toService(n){this._binding.type=Ut.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get:()=>null,set(t){}}),this._binding.dynamicValue=t=>{try{return t.container.get(n)}catch{return t.container.getAsync(n)}},this._binding.implementationType=null}}class vR{constructor(){x(this,"bindings");x(this,"activations");x(this,"deactivations");x(this,"middleware");x(this,"moduleActivationStore")}static of(n,t,i,a,o){const s=new vR;return s.bindings=n,s.middleware=t,s.deactivations=a,s.activations=i,s.moduleActivationStore=o,s}}class Fc{constructor(){x(this,"_map");this._map=new Map}getMap(){return this._map}add(n,t){if(this._checkNonNulish(n),t==null)throw new Error(h8);const i=this._map.get(n);i!==void 0?i.push(t):this._map.set(n,[t])}get(n){this._checkNonNulish(n);const t=this._map.get(n);if(t!==void 0)return t;throw new Error(p8)}remove(n){if(this._checkNonNulish(n),!this._map.delete(n))throw new Error(p8)}removeIntersection(n){this.traverse((t,i)=>{const a=n.hasKey(t)?n.get(t):void 0;if(a!==void 0){const o=i.filter(s=>!a.some(r=>s===r));this._setValue(t,o)}})}removeByCondition(n){const t=[];return this._map.forEach((i,a)=>{const o=[];for(const s of i)n(s)?t.push(s):o.push(s);this._setValue(a,o)}),t}hasKey(n){return this._checkNonNulish(n),this._map.has(n)}clone(){const n=new Fc;return this._map.forEach((t,i)=>{t.forEach(a=>{var o;n.add(i,typeof(o=a)=="object"&&o!==null&&"clone"in o&&typeof o.clone=="function"?a.clone():a)})}),n}traverse(n){this._map.forEach((t,i)=>{n(i,t)})}_checkNonNulish(n){if(n==null)throw new Error(h8)}_setValue(n,t){t.length>0?this._map.set(n,t):this._map.delete(n)}}class yR{constructor(){x(this,"_map",new Map)}remove(n){const t=this._map.get(n);return t===void 0?this._getEmptyHandlersStore():(this._map.delete(n),t)}addDeactivation(n,t,i){this._getModuleActivationHandlers(n).onDeactivations.add(t,i)}addActivation(n,t,i){this._getModuleActivationHandlers(n).onActivations.add(t,i)}clone(){const n=new yR;return this._map.forEach((t,i)=>{n._map.set(i,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),n}_getModuleActivationHandlers(n){let t=this._map.get(n);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(n,t)),t}_getEmptyHandlersStore(){return{onActivations:new Fc,onDeactivations:new Fc}}}class my{constructor(n){x(this,"id");x(this,"parent");x(this,"options");x(this,"_middleware");x(this,"_bindingDictionary");x(this,"_activations");x(this,"_deactivations");x(this,"_snapshots");x(this,"_metadataReader");x(this,"_moduleActivationStore");const t=n||{};if(typeof t!="object")throw new Error("Invalid Container constructor argument. Container options must be an object.");if(t.defaultScope===void 0)t.defaultScope=Cn.Transient;else if(t.defaultScope!==Cn.Singleton&&t.defaultScope!==Cn.Transient&&t.defaultScope!==Cn.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Xm(),this._bindingDictionary=new Fc,this._snapshots=[],this._middleware=null,this._activations=new Fc,this._deactivations=new Fc,this.parent=null,this._metadataReader=new fY,this._moduleActivationStore=new yR}static merge(n,t,...i){const a=new my,o=[n,t,...i].map(r=>py(r)),s=py(a);return o.forEach(r=>{var d;d=s,r.traverse((l,c)=>{c.forEach(u=>{d.add(u.serviceIdentifier,u.clone())})})}),a}load(...n){const t=this._getContainerModuleHelpersFactory();for(const i of n){const a=t(i.id);i.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}}async loadAsync(...n){const t=this._getContainerModuleHelpersFactory();for(const i of n){const a=t(i.id);await i.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}}unload(...n){n.forEach(t=>{const i=this._removeModuleBindings(t.id);this._deactivateSingletons(i),this._removeModuleHandlers(t.id)})}async unloadAsync(...n){for(const t of n){const i=this._removeModuleBindings(t.id);await this._deactivateSingletonsAsync(i),this._removeModuleHandlers(t.id)}}bind(n){return this._bind(this._buildBinding(n))}rebind(n){return this.unbind(n),this.bind(n)}async rebindAsync(n){return await this.unbindAsync(n),this.bind(n)}unbind(n){if(this._bindingDictionary.hasKey(n)){const t=this._bindingDictionary.get(n);this._deactivateSingletons(t)}this._removeServiceFromDictionary(n)}async unbindAsync(n){if(this._bindingDictionary.hasKey(n)){const t=this._bindingDictionary.get(n);await this._deactivateSingletonsAsync(t)}this._removeServiceFromDictionary(n)}unbindAll(){this._bindingDictionary.traverse((n,t)=>{this._deactivateSingletons(t)}),this._bindingDictionary=new Fc}async unbindAllAsync(){const n=[];this._bindingDictionary.traverse((t,i)=>{n.push(this._deactivateSingletonsAsync(i))}),await Promise.all(n),this._bindingDictionary=new Fc}onActivation(n,t){this._activations.add(n,t)}onDeactivation(n,t){this._deactivations.add(n,t)}isBound(n){let t=this._bindingDictionary.hasKey(n);return!t&&this.parent&&(t=this.parent.isBound(n)),t}isCurrentBound(n){return this._bindingDictionary.hasKey(n)}isBoundNamed(n,t){return this.isBoundTagged(n,Ms,t)}isBoundTagged(n,t,i){let a=!1;if(this._bindingDictionary.hasKey(n)){const o=this._bindingDictionary.get(n),s=function(r,d,l){const c=$4(d,l),u=k_(c);if(u.kind===yr.unmanaged)throw new Error("Unexpected metadata when creating target");const f=new hy("",u,"Variable"),h=new z4(r);return new ev(d,h,null,[],f)}(this,n,{customTag:{key:t,value:i},isMultiInject:!1});a=o.some(r=>r.constraint(s))}return!a&&this.parent&&(a=this.parent.isBoundTagged(n,t,i)),a}snapshot(){this._snapshots.push(vR.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){const n=this._snapshots.pop();if(n===void 0)throw new Error("No snapshot available to restore.");this._bindingDictionary=n.bindings,this._activations=n.activations,this._deactivations=n.deactivations,this._middleware=n.middleware,this._moduleActivationStore=n.moduleActivationStore}createChild(n){const t=new my(n||this.options);return t.parent=this,t}applyMiddleware(...n){const t=this._middleware?this._middleware:this._planAndResolve();this._middleware=n.reduce((i,a)=>a(i),t)}applyCustomMetadataReader(n){this._metadataReader=n}get(n){const t=this._getNotAllArgs(n,!1,!1);return this._getButThrowIfAsync(t)}async getAsync(n){const t=this._getNotAllArgs(n,!1,!1);return this._get(t)}getTagged(n,t,i){const a=this._getNotAllArgs(n,!1,!1,t,i);return this._getButThrowIfAsync(a)}async getTaggedAsync(n,t,i){const a=this._getNotAllArgs(n,!1,!1,t,i);return this._get(a)}getNamed(n,t){return this.getTagged(n,Ms,t)}async getNamedAsync(n,t){return this.getTaggedAsync(n,Ms,t)}getAll(n,t){const i=this._getAllArgs(n,t,!1);return this._getButThrowIfAsync(i)}async getAllAsync(n,t){const i=this._getAllArgs(n,t,!1);return this._getAll(i)}getAllTagged(n,t,i){const a=this._getNotAllArgs(n,!0,!1,t,i);return this._getButThrowIfAsync(a)}async getAllTaggedAsync(n,t,i){const a=this._getNotAllArgs(n,!0,!1,t,i);return this._getAll(a)}getAllNamed(n,t){return this.getAllTagged(n,Ms,t)}async getAllNamedAsync(n,t){return this.getAllTaggedAsync(n,Ms,t)}resolve(n){const t=this.isBound(n);t||this.bind(n).toSelf();const i=this.get(n);return t||this.unbind(n),i}tryGet(n){const t=this._getNotAllArgs(n,!1,!0);return this._getButThrowIfAsync(t)}async tryGetAsync(n){const t=this._getNotAllArgs(n,!1,!0);return this._get(t)}tryGetTagged(n,t,i){const a=this._getNotAllArgs(n,!1,!0,t,i);return this._getButThrowIfAsync(a)}async tryGetTaggedAsync(n,t,i){const a=this._getNotAllArgs(n,!1,!0,t,i);return this._get(a)}tryGetNamed(n,t){return this.tryGetTagged(n,Ms,t)}async tryGetNamedAsync(n,t){return this.tryGetTaggedAsync(n,Ms,t)}tryGetAll(n,t){const i=this._getAllArgs(n,t,!0);return this._getButThrowIfAsync(i)}async tryGetAllAsync(n,t){const i=this._getAllArgs(n,t,!0);return this._getAll(i)}tryGetAllTagged(n,t,i){const a=this._getNotAllArgs(n,!0,!0,t,i);return this._getButThrowIfAsync(a)}async tryGetAllTaggedAsync(n,t,i){const a=this._getNotAllArgs(n,!0,!0,t,i);return this._getAll(a)}tryGetAllNamed(n,t){return this.tryGetAllTagged(n,Ms,t)}async tryGetAllNamedAsync(n,t){return this.tryGetAllTaggedAsync(n,Ms,t)}_preDestroy(n,t){var i;if(n!==void 0&&Reflect.hasMetadata(FS,n)){const a=Reflect.getMetadata(FS,n);return(i=t[a.value])==null?void 0:i.call(t)}}_removeModuleHandlers(n){const t=this._moduleActivationStore.remove(n);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)}_removeModuleBindings(n){return this._bindingDictionary.removeByCondition(t=>t.moduleId===n)}_deactivate(n,t){const i=t==null?void 0:Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(n.serviceIdentifier)){const o=this._deactivateContainer(t,this._deactivations.get(n.serviceIdentifier).values());if(vr(o))return this._handleDeactivationError(o.then(async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(n,t,i)),n.serviceIdentifier)}const a=this._propagateContainerDeactivationThenBindingAndPreDestroy(n,t,i);if(vr(a))return this._handleDeactivationError(a,n.serviceIdentifier)}catch(a){if(a instanceof Error)throw new Error(kS(nl(n.serviceIdentifier),a.message))}}async _handleDeactivationError(n,t){try{await n}catch(i){if(i instanceof Error)throw new Error(kS(nl(t),i.message))}}_deactivateContainer(n,t){let i=t.next();for(;typeof i.value=="function";){const a=i.value(n);if(vr(a))return a.then(async()=>this._deactivateContainerAsync(n,t));i=t.next()}}async _deactivateContainerAsync(n,t){let i=t.next();for(;typeof i.value=="function";)await i.value(n),i=t.next()}_getContainerModuleHelpersFactory(){const n=d=>l=>{const c=this._buildBinding(l);return c.moduleId=d,this._bind(c)},t=()=>d=>{this.unbind(d)},i=()=>async d=>this.unbindAsync(d),a=()=>d=>this.isBound(d),o=d=>{const l=n(d);return c=>(this.unbind(c),l(c))},s=d=>(l,c)=>{this._moduleActivationStore.addActivation(d,l,c),this.onActivation(l,c)},r=d=>(l,c)=>{this._moduleActivationStore.addDeactivation(d,l,c),this.onDeactivation(l,c)};return d=>({bindFunction:n(d),isboundFunction:a(),onActivationFunction:s(d),onDeactivationFunction:r(d),rebindFunction:o(d),unbindAsyncFunction:i(),unbindFunction:t()})}_bind(n){return this._bindingDictionary.add(n.serviceIdentifier,n),new IY(n)}_buildBinding(n){const t=this.options.defaultScope||Cn.Transient;return new gR(n,t)}async _getAll(n){return Promise.all(this._get(n))}_get(n){const t={...n,contextInterceptor:i=>i,targetType:F4.Variable};if(this._middleware){const i=this._middleware(t);if(i==null)throw new Error("Invalid return type in middleware. Middleware must return!");return i}return this._planAndResolve()(t)}_getButThrowIfAsync(n){const t=this._get(n);if(W4(t))throw new Error(`You are attempting to construct ${function(i){return typeof i=="function"?`[function/class ${i.name||"<anonymous>"}]`:typeof i=="symbol"?i.toString():`'${i}'`}(n.serviceIdentifier)} in a synchronous way but it has asynchronous dependencies.`);return t}_getAllArgs(n,t,i){return{avoidConstraints:!(t!=null&&t.enforceBindingConstraints),isMultiInject:!0,isOptional:i,serviceIdentifier:n}}_getNotAllArgs(n,t,i,a,o){return{avoidConstraints:!1,isMultiInject:t,isOptional:i,key:a,serviceIdentifier:n,value:o}}_getPlanMetadataFromNextArgs(n){const t={isMultiInject:n.isMultiInject};return n.key!==void 0&&(t.customTag={key:n.key,value:n.value}),n.isOptional===!0&&(t.isOptional=!0),t}_planAndResolve(){return n=>{let t=pY(this._metadataReader,this,n.targetType,n.serviceIdentifier,this._getPlanMetadataFromNextArgs(n),n.avoidConstraints);return t=n.contextInterceptor(t),function(a){return mR(a.plan.rootRequest.requestScope)(a.plan.rootRequest)}(t)}}_deactivateIfSingleton(n){if(n.activated)return vr(n.cache)?n.cache.then(t=>this._deactivate(n,t)):this._deactivate(n,n.cache)}_deactivateSingletons(n){for(const t of n)if(vr(this._deactivateIfSingleton(t)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}async _deactivateSingletonsAsync(n){await Promise.all(n.map(async t=>this._deactivateIfSingleton(t)))}_propagateContainerDeactivationThenBindingAndPreDestroy(n,t,i){return this.parent?this._deactivate.bind(this.parent)(n,t):this._bindingDeactivationAndPreDestroy(n,t,i)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(n,t,i){this.parent?await this._deactivate.bind(this.parent)(n,t):await this._bindingDeactivationAndPreDestroyAsync(n,t,i)}_removeServiceFromDictionary(n){try{this._bindingDictionary.remove(n)}catch{throw new Error(`Could not unbind serviceIdentifier: ${nl(n)}`)}}_bindingDeactivationAndPreDestroy(n,t,i){if(typeof n.onDeactivation=="function"){const a=n.onDeactivation(t);if(vr(a))return a.then(()=>this._preDestroy(i,t))}return this._preDestroy(i,t)}async _bindingDeactivationAndPreDestroyAsync(n,t,i){typeof n.onDeactivation=="function"&&await n.onDeactivation(t),await this._preDestroy(i,t)}}class TY{constructor(n){x(this,"id");x(this,"registry");this.id=Xm(),this.registry=n}}function DY(e,n,t,i){(function(a){if(a!==void 0)throw new Error(K4)})(n),Q4(N4,e,t.toString(),i)}function OY(e){let n=[];if(Array.isArray(e)){n=e;const t=function(i){const a=new Set;for(const o of i){if(a.has(o))return o;a.add(o)}}(n.map(i=>i.key));if(t!==void 0)throw new Error(`${k4} ${t.toString()}`)}else n=[e];return n}function Q4(e,n,t,i){const a=OY(i);let o={};Reflect.hasOwnMetadata(e,n)&&(o=Reflect.getMetadata(e,n));let s=o[t];if(s===void 0)s=[];else for(const r of s)if(a.some(d=>d.key===r.key))throw new Error(`${k4} ${r.key.toString()}`);s.push(...a),o[t]=s,Reflect.defineMetadata(e,o,n)}function J4(e){return(n,t,i)=>{typeof i=="number"?DY(n,t,i,e):function(a,o,s){if(a.prototype!==void 0)throw new Error(K4);Q4(B4,a.constructor,o,s)}(n,t,e)}}function ue(){return function(e){if(Reflect.hasOwnMetadata(f8,e))throw new Error("Cannot apply @injectable decorator multiple times.");const n=Reflect.getMetadata(x4,e)||[];return Reflect.defineMetadata(f8,n,e),e}}function X4(e){return n=>(t,i,a)=>{if(n===void 0){const o=typeof t=="function"?t.name:t.constructor.name;throw new Error(`@inject called with undefined this could mean that the class ${o} has a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation.`)}J4(new xd(e,n))(t,i,a)}}const Pe=X4(L4);function tv(){return J4(new xd(O4,!0))}const eB=X4(j4);function LY(e,n){return()=>(t,i)=>{const a=new xd(e,i);if(Reflect.hasOwnMetadata(e,t.constructor))throw new Error(n);Reflect.defineMetadata(e,a,t.constructor)}}const _R=LY(xS,"Cannot apply @postConstruct decorator multiple times in the same class");var ht=AP(),vy;(function(e){e.KIND="elementAnimate";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasArrayProp(i,"elementIds")}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(vy||(vy={}));var KS;(function(e){e.KIND="autoAlign";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(KS||(KS={}));var rm;(function(e){e.KIND="attachBoundary";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasStringProp(i,"elementId")&&ht.hasStringProp(i,"eventKind")}e.is=n;function t(i){return{kind:e.KIND,isOperation:!0,...i}}e.create=t})(rm||(rm={}));var qS;(function(e){e.KIND="setBreakpoint";function n(t){return{kind:e.KIND,...t}}e.create=n})(qS||(qS={}));var HS;(function(e){e.KIND="toggleBreakpoint";function n(t){return{kind:e.KIND,...t}}e.create=n})(HS||(HS={}));var yy;(function(e){e.KIND="showBreakpoints";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasArrayProp(i,"elementBreakpoints")&&ht.hasBooleanProp(i,"globalDisabled")}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(yy||(yy={}));var om;(function(e){e.KIND="changeColor";function n(a){return i(a)}e.changeColor=n;function t(a){return i(a)}e.deleteColor=t;function i(a){return{kind:e.KIND,isOperation:!0,...a}}e.create=i})(om||(om={}));var _y;(function(e){e.KIND="updateColorPalette";function n(t){return ht.Action.hasKind(t,e.KIND)}e.is=n})(_y||(_y={}));var VS;(function(e){e.KIND="straightenEdge";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(VS||(VS={}));var GS;(function(e){e.KIND="autoBendEdge";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(GS||(GS={}));var sm;(function(e){e.KIND="toggleCustomIcons";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasBooleanProp(i,"showCustomIcons")}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(sm||(sm={}));var by;(function(e){e.KIND="openDataClassEditor";function n(){return{kind:e.KIND}}e.create=n;function t(i){return ht.Action.hasKind(i,e.KIND)}e.is=t})(by||(by={}));var zS;(function(e){e.KIND="openDecoratorBrowser";function n(t){return{kind:e.KIND,elementId:t}}e.create=n})(zS||(zS={}));var Sy;(function(e){e.KIND="setExecutedElements";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasArrayProp(i,"elementExecutions")}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(Sy||(Sy={}));var Ey;(function(e){e.KIND="elementStopped";function n(i){return ht.Action.hasKind(i,e.KIND)}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(Ey||(Ey={}));var am;(function(e){e.KIND="openFormEditor";function n(i){return{kind:e.KIND,...i}}e.create=n;function t(i){return ht.Action.hasKind(i,e.KIND)}e.is=t})(am||(am={}));var US;(function(e){e.KIND="goToSource";function n(t){return{kind:e.KIND,elementId:t}}e.create=n})(US||(US={}));var qd;(function(e){e.KIND="jumpInto";function n(i){return{kind:e.KIND,...i}}e.create=n;function t(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasStringProp(i,"elementId")}e.is=t})(qd||(qd={}));var $S;(function(e){function n(t,i={}){return{kind:ht.UpdateModelAction.KIND,newRoot:t,...i}}e.create=n})($S||($S={}));var C8;(function(e){e.KIND="openQuickOutline";function n(){return{kind:e.KIND}}e.create=n})(C8||(C8={}));var qa;(function(e){e.KIND="updatePaletteItems";function n(){return{kind:e.KIND}}e.create=n;function t(i){return ht.Action.hasKind(i,e.KIND)}e.is=t})(qa||(qa={}));var YS;(function(e){e.KIND="startProcess";function n(i,a){return{kind:e.KIND,elementId:i,processStartUri:a}}e.create=n;function t(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasStringProp(i,"elementId")&&ht.hasStringProp(i,"processStartUri")}e.is=t})(YS||(YS={}));var WS;(function(e){e.KIND="searchProcessCallers";function n(t){return{kind:e.KIND,elementId:t}}e.create=n})(WS||(WS={}));var Kf;(function(e){e.KIND="switchTheme";function n(i){return ht.Action.hasKind(i,e.KIND)&&ht.hasStringProp(i,"theme")}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(Kf||(Kf={}));var ZS;(function(e){e.KIND="changeActivityType";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(ZS||(ZS={}));var cm;(function(e){e.KIND="enableViewport";function n(i){return ht.Action.hasKind(i,e.KIND)}e.is=n;function t(){return{kind:e.KIND}}e.create=t})(cm||(cm={}));var Cy;(function(e){e.KIND="originViewport";function n(t={}){return{kind:e.KIND,animate:!0,...t}}e.create=n})(Cy||(Cy={}));var um;(function(e){e.KIND="moveIntoViewport";function n(t){return{kind:e.KIND,animate:!0,retainZoom:!1,...t}}e.create=n})(um||(um={}));var qf;(function(e){e.KIND="ivyViewportZoom";function n(i){return ht.Action.hasKind(i,e.KIND)}e.is=n;function t(i){return{kind:e.KIND,...i}}e.create=t})(qf||(qf={}));var QS;(function(e){e.KIND="wrapToSub";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(QS||(QS={}));var JS;(function(e){e.KIND="unwrapSub";function n(t){return{kind:e.KIND,isOperation:!0,...t}}e.create=n})(JS||(JS={}));const K_=Symbol("animateFeature");function P8(e){return e.hasFeature(K_)}var jY=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},NY=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},BY=function(e,n){return function(t,i){n(t,i,e)}},Df,Py;(function(e){function n(t){return{kind:Ry.KIND,...t}}e.create=n})(Py||(Py={}));var Ju;let Ry=(Ju=class extends A.Command{constructor(t){super();x(this,"action");x(this,"animated",[]);x(this,"deanimated",[]);this.action=t}execute(t){var a;const i=t.root;return this.action.animatedIDs.forEach(o=>{const s=i.index.getById(o);s instanceof A.GChildElement&&P8(s)&&this.animated.push(s)}),(a=this.action.deAnimatedIDs)==null||a.forEach(o=>{const s=i.index.getById(o);s instanceof A.GChildElement&&P8(s)&&this.deanimated.push(s)}),this.redo(t)}undo(t){for(const i of this.animated)A.removeCssClasses(i,Df.CSS_CLASS);for(const i of this.deanimated)A.addCssClasses(i,Df.CSS_CLASS);return t.root}redo(t){for(const i of this.deanimated)A.removeCssClasses(i,Df.CSS_CLASS);for(const i of this.animated)A.addCssClasses(i,Df.CSS_CLASS);return t.root}},Df=Ju,x(Ju,"KIND","elementAnimateFeedback"),x(Ju,"CSS_CLASS","animate"),Ju);Ry=Df=jY([ue(),BY(0,Pe(A.TYPES.Action)),NY("design:paramtypes",[Object])],Ry);var bR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},tB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Hf=class{constructor(){x(this,"animateElementIDs",new Set);x(this,"feedbackDispatcher");x(this,"actionDispatcher")}handle(n){if(vy.is(n))for(const t of n.elementIds){this.animateElementIDs.add(t);const i=Py.create({animatedIDs:[...this.animateElementIDs]});this.feedbackDispatcher.registerFeedback(this,[i]),this.actionDispatcher.dispatch(um.create({elementIds:[t]})),setTimeout(()=>{this.animateElementIDs.delete(t),this.feedbackDispatcher.registerFeedback(this,[Py.create({animatedIDs:[...this.animateElementIDs],deAnimatedIDs:[t]})]),this.animateElementIDs.size===0&&this.feedbackDispatcher.deregisterFeedback(this,[])},2e3)}}};bR([Pe(A.TYPES.IFeedbackActionDispatcher),tB("design:type",Object)],Hf.prototype,"feedbackDispatcher",void 0);bR([Pe(A.TYPES.IActionDispatcher),tB("design:type",Object)],Hf.prototype,"actionDispatcher",void 0);Hf=bR([ue()],Hf);const xY=new A.FeatureModule((e,n,t)=>{e(Hf).toSelf().inSingletonScope(),A.configureActionHandler({bind:e,isBound:t},vy.KIND,Hf),A.configureCommand({bind:e,isBound:t},Ry)}),$e={QuickActionProvider:Symbol.for("QuickActionProvider"),ToolBarButtonProvider:Symbol.for("ToolBarButtonProvider"),ToolBar:Symbol.for("ToolBar"),ColorPalette:Symbol.for("ColorPalette"),ActivityTypesPalette:Symbol.for("ActivityTypesPalette"),IvyViewerOptions:Symbol.for("IvyViewerOptions")};var V;(function(e){e.ActivitiesGroup="activities-group",e.AlignHorizontal="align-horizontal",e.AlignVertical="align-vertical",e.AlternativeGateways="alternative-gateways",e.Annotation="annotation",e.ArrowRight="arrow-right",e.ArrowUpRight="arrow-up-right",e.ArrowsMaximize="arrows-maximize",e.Attribute="attribute",e.AutoAlign="auto-align",e.Bend="bend",e.Bpmn="bpmn",e.Bug="bug",e.CalendarTime="calendar-time",e.CallOutline="call-outline",e.Call="call",e.Caution="caution",e.Center="center",e.ChangeType="change-type",e.Check="check",e.Checklist="checklist",e.Chevron="chevron",e.ClockOutline="clock-outline",e.Clock="clock",e.Close="close",e.Cms="cms",e.ColorDrop="color-drop",e.Comment="comment",e.Connector="connector",e.CustomImage="custom-image",e.DarkMode="dark-mode",e.DataClass="data-class",e.DatabaseLink="database-link",e.DatabaseOutline="database-outline",e.Database="database",e.DeviceMobile="device-mobile",e.DeviceTablet="device-tablet",e.DialogLayout="dialog-layout",e.Dots="dots",e.Download="download",e.DragDrop="drag-drop",e.Duplicate="duplicate",e.EMailOutline="e-mail-outline",e.EMail="e-mail",e.EditDots="edit-dots",e.Edit="edit",e.EndPageOutline="end-page-outline",e.EndPage="end-page",e.ErrorEnd="error-end",e.ErrorStart="error-start",e.ErrorXMark="error-x-mark",e.Error="error",e.EventStartOutline="event-start-outline",e.EventStart="event-start",e.ExitEndOutline="exit-end-outline",e.ExitEnd="exit-end",e.Extension="extension",e.Eye="eye",e.FileImport="file-import",e.File="file",e.FilterCog="filter-cog",e.Filter="filter",e.FitToScreen="fit-to-screen",e.FolderOpen="folder-open",e.Folders="folders",e.Function="function",e.GatewaysGroup="gateways-group",e.GoToSource="go-to-source",e.GridDots="grid-dots",e.Help="help",e.Helplines="helplines",e.Home="home",e.InfoCircle="info-circle",e.InitStartOutline="init-start-outline",e.InitStart="init-start",e.Ivy="ivy",e.JoinGateways="join-gateways",e.JoinTasksGateways="join-tasks-gateways",e.JumpOut="jump-out",e.Label="label",e.LaneSwimlanes="lane-swimlanes",e.LayoutSidebarRightCollapse="layout-sidebar-right-collapse",e.LetterD="letter-d",e.ListSearch="list-search",e.List="list",e.ManualOutline="manual-outline",e.Manual="manual",e.Market="market",e.MethodStartOutline="method-start-outline",e.MethodStart="method-start",e.MultiSelection="multi-selection",e.NoteOutline="note-outline",e.Note="note",e.PasswordUser="password-user",e.Password="password",e.PenEdit="pen-edit",e.Persistence="persistence",e.Play="play",e.Plus="plus",e.PoolSwimlanes="pool-swimlanes",e.ProcessEnd="process-end",e.Process="process",e.ProgramOutline="program-outline",e.Quote="quote",e.ReceiveOutline="receive-outline",e.Receive="receive",e.Reconnect="reconnect",e.Redo="redo",e.RestClientOutline="rest-client-outline",e.RestClient="rest-client",e.RuleOutline="rule-outline",e.Rule="rule",e.ScriptFileOutline="script-file-outline",e.Script="script",e.Search="search",e.SelectionTool="selection-tool",e.Selector="selector",e.SendOutline="send-outline",e.Send="send",e.SettingsCog="settings-cog",e.SettingsOutline="settings-outline",e.Settings="settings",e.Spinner="spinner",e.Sql="sql",e.StartProgramOutline="start-program-outline",e.StartProgram="start-program",e.StartSignalOutline="start-signal-outline",e.StartSignal="start-signal",e.Start="start",e.Straighten="straighten",e.SubActivitiesDashed="sub-activities-dashed",e.SubActivities="sub-activities",e.SubEndOutline="sub-end-outline",e.SubEnd="sub-end",e.SubManualOutline="sub-manual-outline",e.SubReceiveOutline="sub-receive-outline",e.SubRuleOutline="sub-rule-outline",e.SubScriptOutline="sub-script-outline",e.SubSendOutline="sub-send-outline",e.SubStartOutline="sub-start-outline",e.SubStart="sub-start",e.SubUserOutline="sub-user-outline",e.SubWebService="sub-web-service",e.TaskDoubleOutline="task-double-outline",e.TaskOutline="task-outline",e.Task="task",e.TasksGateways="tasks-gateways",e.Toggle="toggle",e.Tool="tool",e.Trash="trash",e.TriggerOutline="trigger-outline",e.Trigger="trigger",e.Undo="undo",e.Unwrap="unwrap",e.Upload="upload",e.UserDialogOutline="user-dialog-outline",e.UserDialog="user-dialog",e.UserOutline="user-outline",e.UserTaskOutline="user-task-outline",e.UserTask="user-task",e.User="user",e.Users="users",e.WebService="web-service",e.WindowMinimize="window-minimize",e.WrapToSubprocess="wrap-to-subprocess",e.WsStartOutline="ws-start-outline",e.WsStart="ws-start"})(V||(V={}));V.ActivitiesGroup+"",V.AlignHorizontal+"",V.AlignVertical+"",V.AlternativeGateways+"",V.Annotation+"",V.ArrowRight+"",V.ArrowUpRight+"",V.ArrowsMaximize+"",V.Attribute+"",V.AutoAlign+"",V.Bend+"",V.Bpmn+"",V.Bug+"",V.CalendarTime+"",V.CallOutline+"",V.Call+"",V.Caution+"",V.Center+"",V.ChangeType+"",V.Check+"",V.Checklist+"",V.Chevron+"",V.ClockOutline+"",V.Clock+"",V.Close+"",V.Cms+"",V.ColorDrop+"",V.Comment+"",V.Connector+"",V.CustomImage+"",V.DarkMode+"",V.DataClass+"",V.DatabaseLink+"",V.DatabaseOutline+"",V.Database+"",V.DeviceMobile+"",V.DeviceTablet+"",V.DialogLayout+"",V.Dots+"",V.Download+"",V.DragDrop+"",V.Duplicate+"",V.EMailOutline+"",V.EMail+"",V.EditDots+"",V.Edit+"",V.EndPageOutline+"",V.EndPage+"",V.ErrorEnd+"",V.ErrorStart+"",V.ErrorXMark+"",V.Error+"",V.EventStartOutline+"",V.EventStart+"",V.ExitEndOutline+"",V.ExitEnd+"",V.Extension+"",V.Eye+"",V.FileImport+"",V.File+"",V.FilterCog+"",V.Filter+"",V.FitToScreen+"",V.FolderOpen+"",V.Folders+"",V.Function+"",V.GatewaysGroup+"",V.GoToSource+"",V.GridDots+"",V.Help+"",V.Helplines+"",V.Home+"",V.InfoCircle+"",V.InitStartOutline+"",V.InitStart+"",V.Ivy+"",V.JoinGateways+"",V.JoinTasksGateways+"",V.JumpOut+"",V.Label+"",V.LaneSwimlanes+"",V.LayoutSidebarRightCollapse+"",V.LetterD+"",V.ListSearch+"",V.List+"",V.ManualOutline+"",V.Manual+"",V.Market+"",V.MethodStartOutline+"",V.MethodStart+"",V.MultiSelection+"",V.NoteOutline+"",V.Note+"",V.PasswordUser+"",V.Password+"",V.PenEdit+"",V.Persistence+"",V.Play+"",V.Plus+"",V.PoolSwimlanes+"",V.ProcessEnd+"",V.Process+"",V.ProgramOutline+"",V.Quote+"",V.ReceiveOutline+"",V.Receive+"",V.Reconnect+"",V.Redo+"",V.RestClientOutline+"",V.RestClient+"",V.RuleOutline+"",V.Rule+"",V.ScriptFileOutline+"",V.Script+"",V.Search+"",V.SelectionTool+"",V.Selector+"",V.SendOutline+"",V.Send+"",V.SettingsCog+"",V.SettingsOutline+"",V.Settings+"",V.Spinner+"",V.Sql+"",V.StartProgramOutline+"",V.StartProgram+"",V.StartSignalOutline+"",V.StartSignal+"",V.Start+"",V.Straighten+"",V.SubActivitiesDashed+"",V.SubActivities+"",V.SubEndOutline+"",V.SubEnd+"",V.SubManualOutline+"",V.SubReceiveOutline+"",V.SubRuleOutline+"",V.SubScriptOutline+"",V.SubSendOutline+"",V.SubStartOutline+"",V.SubStart+"",V.SubUserOutline+"",V.SubWebService+"",V.TaskDoubleOutline+"",V.TaskOutline+"",V.Task+"",V.TasksGateways+"",V.Toggle+"",V.Tool+"",V.Trash+"",V.TriggerOutline+"",V.Trigger+"",V.Undo+"",V.Unwrap+"",V.Upload+"",V.UserDialogOutline+"",V.UserDialog+"",V.UserOutline+"",V.UserTaskOutline+"",V.UserTask+"",V.User+"",V.Users+"",V.WebService+"",V.WindowMinimize+"",V.WrapToSubprocess+"",V.WsStartOutline+"",V.WsStart+"";var q_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let Fn=class{multiQuickAction(){}};Fn=q_([ue()],Fn);let XS=class{singleQuickAction(){}};XS=q_([ue()],XS);let eE=class{singleQuickAction(n){if(A.isDeletable(n))return this.quickAction([n.id])}multiQuickAction(n){const t=n.filter(i=>A.isDeletable(i)).map(i=>i.id);if(t.length>0)return this.quickAction(t)}quickAction(n){return{icon:V.Trash,title:"Delete",location:"Left",sorting:"A",action:A.DeleteElementOperation.create(n)}}};eE=q_([ue()],eE);let tE=class extends XS{multiQuickAction(n){const t=n.map(i=>i.id);if(t.length>0)return{icon:V.AutoAlign,title:"Auto Align (A)",location:"Middle",sorting:"Y",action:KS.create({elementIds:t}),shortcut:"KeyA"}}};tE=q_([ue()],tE);const My=Symbol("multipleOutgoingEdgesFeature");function FY(e){return e.hasFeature(My)}var SR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},kY=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},nE,wd;let Bf=(wd=class extends A.BaseCreationTool{constructor(){super(...arguments);x(this,"anchorRegistry");x(this,"isTriggerAction",Vf.is);x(this,"creationToolMouseListener");x(this,"feedbackEndMovingMouseListener")}get id(){return nE.ID}doEnable(){this.creationToolMouseListener=new KY(this.triggerAction,this),this.feedbackEndMovingMouseListener=new A.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.creationToolMouseListener)),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.feedbackEndMovingMouseListener)),this.toDisposeOnDisable.push(this.registerFeedback([A.cursorFeedbackAction(A.CursorCSS.OPERATION_NOT_ALLOWED)],this,[A.RemoveFeedbackEdgeAction.create(),A.cursorFeedbackAction()]))}},nE=wd,x(wd,"ID","quick-action-edge-creation-tool"),wd);SR([Pe(A.AnchorComputerRegistry),kY("design:type",A.AnchorComputerRegistry)],Bf.prototype,"anchorRegistry",void 0);Bf=nE=SR([ue()],Bf);class KY extends A.DragAwareMouseListener{constructor(t,i){super();x(this,"triggerAction");x(this,"tool");x(this,"source");x(this,"target");x(this,"currentTarget");x(this,"allowedTarget",!1);x(this,"proxyEdge");this.triggerAction=t,this.tool=i,this.proxyEdge=new A.GEdge,this.proxyEdge.type=t.elementTypeId,this.proxyEdge.sourceId=t.sourceId,this.source=this.triggerAction.sourceId,this.tool.registerFeedback([A.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source})])}reinitialize(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.tool.registerFeedback([A.RemoveFeedbackEdgeAction.create()])}nonDraggingMouseUp(t,i){const a=[];return i.button===0?(this.currentTarget&&(this.target=this.currentTarget.id),this.source&&this.target&&(a.push(this.edgeOperation(this.source,this.target)),A.isCtrlOrCmd(i)?this.reinitialize():a.push(A.EnableDefaultToolsAction.create()))):i.button===2&&a.push(A.EnableDefaultToolsAction.create()),a}edgeOperation(t,i){return this.triggerAction.reconnect&&this.triggerAction.edgeId?A.ReconnectEdgeOperation.create({edgeElementId:this.triggerAction.edgeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args}):A.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args})}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(t){const i=A.findParentByFeature(t,A.isConnectable);return i!==this.currentTarget?(this.currentTarget=i,this.currentTarget&&(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.isAllowedTarget(i)):this.allowedTarget=this.isAllowedSource(i),this.allowedTarget)?[this.isSourceSelected()?A.cursorFeedbackAction(A.CursorCSS.EDGE_CREATION_TARGET):A.cursorFeedbackAction(A.CursorCSS.EDGE_CREATION_SOURCE)]:[A.cursorFeedbackAction(A.CursorCSS.OPERATION_NOT_ALLOWED)]):[]}isAllowedSource(t){return t!==void 0&&A.isConnectable(t)&&t.canConnect(this.proxyEdge,"source")}isAllowedTarget(t){return t!==void 0&&A.isConnectable(t)&&t.canConnect(this.proxyEdge,"target")}}var Vf;(function(e){e.KIND="quickActionTriggerEdgeCreation";function n(i){return A.Action.hasKind(i,e.KIND)&&A.hasStringProp(i,"elementTypeId")&&A.hasStringProp(i,"sourceId")}e.is=n;function t(i,a,o={}){return{kind:e.KIND,elementTypeId:i,sourceId:a,...o}}e.create=t})(Vf||(Vf={}));let iE=class extends Fn{singleQuickAction(n){const t=new A.GEdge;if(t.type="edge",n instanceof A.GNode&&n.canConnect(t,"source")&&(Array.from(n.outgoingEdges).length===0||FY(n)))return{icon:V.Connector,title:"Connect",location:"Right",sorting:"Z",action:Vf.create("edge",n.id)}}};iE=SR([ue()],iE);var ER=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let rE=class extends Fn{singleQuickAction(n){if(n instanceof A.GEdge)return{icon:V.Straighten,title:"Straighten (S)",location:"Middle",sorting:"A",action:VS.create({elementId:n.id}),letQuickActionsOpen:!0,shortcut:"KeyS"}}};rE=ER([ue()],rE);let oE=class extends Fn{singleQuickAction(n){if(n instanceof A.GEdge)return{icon:V.Bend,title:"Bend (B)",location:"Middle",sorting:"B",action:GS.create({elementId:n.id}),letQuickActionsOpen:!0,shortcut:"KeyB"}}};oE=ER([ue()],oE);let sE=class extends Fn{singleQuickAction(n){if(n instanceof A.GEdge)return{icon:V.Reconnect,title:"Reconnect (R)",location:"Right",sorting:"A",action:Vf.create(n.type,n.sourceId,{edgeId:n.id,reconnect:!0}),letQuickActionsOpen:!0,shortcut:"KeyR"}}};sE=ER([ue()],sE);const nB=new A.FeatureModule(e=>{e($e.QuickActionProvider).to(rE),e($e.QuickActionProvider).to(oE),e($e.QuickActionProvider).to(sE)}),iB=Symbol("unwrapFeature"),H_=Symbol("wrapFeature"),Zg=Symbol("singleWrapFeature");function rB(e){return e.hasFeature(iB)}function qY(e){return e.hasFeature(H_)}function HY(e){return e.hasFeature(Zg)}const CR=Symbol("errorBoundaryFeature");function VY(e){return e.hasFeature(CR)}const oB=Symbol("signalBoundaryFeature");function GY(e){return e.hasFeature(oB)}const nv=Symbol("breakpointFeature");function aE(e){return e.hasFeature(nv)}const Uy=class Uy extends A.GChildElement{constructor(t="",i=!1,a=!1,o=Uy.TYPE,s=!1){super();x(this,"condition");x(this,"disabled");x(this,"globalDisabled");x(this,"type");x(this,"hoverFeedback");this.condition=t,this.disabled=i,this.globalDisabled=a,this.type=o,this.hoverFeedback=s}hasFeature(t){return t===A.hoverFeedbackFeature||t===A.selectFeature}mouseUp(){return[]}};x(Uy,"TYPE","breakpoint-handle");let Gf=Uy;function zY(e,n,t,i){cE(e),e.add(new Gf(n,t,i))}function cE(e){e.removeAll(n=>n instanceof Gf)}const iv=Symbol("executionFeature");function Ay(e){return e.hasFeature(iv)}const gh=Symbol("quickActionFeature");function sB(e){return A.isBoundsAware(e)&&A.isSelectable(e)&&e instanceof A.GParentElement&&e.hasFeature(gh)}var Hd;(function(e){e.DEFAULT="event"})(Hd||(Hd={}));var Xe;(function(e){e.DEFAULT=Hd.DEFAULT+":start",e.START=e.DEFAULT+":requestStart",e.START_ERROR=e.DEFAULT+":errorStartEvent",e.START_SIGNAL=e.DEFAULT+":signalStartEvent",e.START_PROGRAM=e.DEFAULT+":programStart",e.START_SUB=e.DEFAULT+":callSubStart",e.START_WS=e.DEFAULT+":webserviceStart",e.START_HD=e.DEFAULT+":htmlDialogStart",e.START_HD_METHOD=e.DEFAULT+":htmlDialogMethodStart",e.START_HD_EVENT=e.DEFAULT+":htmlDialogEventStart",e.START_EMBEDDED=e.DEFAULT+":embeddedStart",e.START_THIRD_PARTY=e.DEFAULT+":thirdPartyProgramStart"})(Xe||(Xe={}));var hn;(function(e){e.DEFAULT=Hd.DEFAULT+":end",e.END=e.DEFAULT+":taskEnd",e.END_ERROR=e.DEFAULT+":errorEnd",e.END_PAGE=e.DEFAULT+":taskEndPage",e.END_SUB=e.DEFAULT+":callSubEnd",e.END_WS=e.DEFAULT+":webserviceEnd",e.END_HD=e.DEFAULT+":htmlDialogEnd",e.END_HD_EXIT=e.DEFAULT+":htmlDialogExit",e.END_EMBEDDED=e.DEFAULT+":embeddedEnd"})(hn||(hn={}));var $r;(function(e){e.DEFAULT=Hd.DEFAULT+":intermediate",e.INTERMEDIATE_TASK=e.DEFAULT+":taskSwitchEvent",e.INTERMEDIATE_WAIT=e.DEFAULT+":waitEvent",e.INTERMEDIATE_THIRD_PARTY=e.DEFAULT+":thirdPartyWaitEvent"})($r||($r={}));var Ha;(function(e){e.DEFAULT=Hd.DEFAULT+":boundary",e.BOUNDARY_ERROR=e.DEFAULT+":errorBoundaryEvent",e.BOUNDARY_SIGNAL=e.DEFAULT+":signalBoundaryEvent"})(Ha||(Ha={}));var Hi;(function(e){e.DEFAULT="gateway",e.TASK=e.DEFAULT+":taskSwitchGateway",e.JOIN=e.DEFAULT+":join",e.SPLIT=e.DEFAULT+":split",e.ALTERNATIVE=e.DEFAULT+":alternative"})(Hi||(Hi={}));var _e;(function(e){e.DEFAULT="activity",e.GENERIC=e.DEFAULT+":genericActivity",e.COMMENT=e.DEFAULT+":processAnnotation",e.SCRIPT=e.DEFAULT+":script",e.HD=e.DEFAULT+":dialogCall",e.USER=e.DEFAULT+":userTask",e.SOAP=e.DEFAULT+":webServiceCall",e.REST=e.DEFAULT+":restClientCall",e.DB=e.DEFAULT+":database",e.EMAIL=e.DEFAULT+":eMail",e.SUB_PROCESS=e.DEFAULT+":subProcessCall",e.EMBEDDED_PROCESS=e.DEFAULT+":embeddedProcessElement",e.TRIGGER=e.DEFAULT+":triggerCall",e.PROGRAM=e.DEFAULT+":programInterface",e.BPMN_GENERIC=e.DEFAULT+":genericBpmnElement",e.BPMN_USER=e.DEFAULT+":userBpmnElement",e.BPMN_MANUAL=e.DEFAULT+":manualBpmnElement",e.BPMN_SCRIPT=e.DEFAULT+":scriptBpmnElement",e.BPMN_RECEIVE=e.DEFAULT+":receiveBpmnElement",e.BPMN_RULE=e.DEFAULT+":ruleBpmnElement",e.BPMN_SEND=e.DEFAULT+":sendBpmnElement",e.BPMN_SERVICE=e.DEFAULT+":serviceBpmnElement",e.THIRD_PARTY=e.DEFAULT+":thirdPartyProgramInterface",e.THIRD_PARTY_RULE=e.THIRD_PARTY+":RuleActivity",e.LABEL=e.DEFAULT+"-label"})(_e||(_e={}));var As;(function(e){e.DEFAULT="lanes",e.LANE=e.DEFAULT+":lane",e.POOL=e.DEFAULT+":pool",e.LABEL=e.DEFAULT+":label"})(As||(As={}));var xf;(function(e){e.DEFAULT="edge",e.ASSOCIATION=e.DEFAULT+":association",e.LABEL=e.DEFAULT+":label"})(xf||(xf={}));var lm;(function(e){e.DEFAULT="label"})(lm||(lm={}));const Nf=class Nf extends A.RectangularNode{constructor(){super(...arguments);x(this,"args")}get resizeLocations(){return[A.ResizeHandleLocation.Top,A.ResizeHandleLocation.Bottom]}get editableLabel(){return rv(this,As.LABEL)}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}isFirstChild(){return this.parent instanceof Nf?this.parent.embeddedLanes().indexOf(this)===0:!1}isLastChild(){if(this.parent instanceof Nf){const t=this.parent.embeddedLanes();return t.indexOf(this)===t.length-1}return!1}embeddedLanes(){return this.children.filter(t=>t instanceof Nf).map(t=>t)}canConnect(){return!1}};x(Nf,"DEFAULT_FEATURES",[A.boundsFeature,A.layoutContainerFeature,A.fadeFeature,A.nameFeature,A.withEditLabelFeature,A.selectFeature,gh,A.deletableFeature,A.resizeFeature]);let $o=Nf;class Vd extends A.RectangularNode{constructor(){super(...arguments);x(this,"name","");x(this,"duration");x(this,"taskType");x(this,"reference");x(this,"executionCount");x(this,"args")}get editableLabel(){return rv(this,_e.LABEL)}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get labelBounds(){return{x:-this.bounds.width/2+3,y:0,width:this.bounds.width-6,height:this.bounds.height}}}x(Vd,"DEFAULT_FEATURES",[A.connectableFeature,A.deletableFeature,A.selectFeature,A.boundsFeature,A.resizeFeature,gh,K_,A.moveFeature,A.layoutContainerFeature,A.fadeFeature,A.hoverFeedbackFeature,A.popupFeature,A.nameFeature,A.withEditLabelFeature,A.openFeature,nv,CR,iv,H_,Zg]);class UY extends Vd{get labelBounds(){return{...super.labelBounds,y:0,height:this.bounds.height}}}class Fd extends A.CircularNode{constructor(){super(...arguments);x(this,"args");x(this,"executionCount")}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return rv(this,lm.DEFAULT)}}x(Fd,"DEFAULT_FEATURES",[A.connectableFeature,A.deletableFeature,A.selectFeature,A.boundsFeature,K_,A.moveFeature,A.layoutContainerFeature,A.fadeFeature,A.hoverFeedbackFeature,A.popupFeature,A.openFeature,nv,gh,A.withEditLabelFeature,iv,H_]);class $Y extends Fd{canConnect(n,t){return super.canConnect(n,t)&&t==="target"}}class Ff extends Fd{canConnect(n,t){return super.canConnect(n,t)&&(t==="source"||this.typeOf(n.sourceId)===_e.COMMENT)}typeOf(n){var t;if(n)return(t=this.index.getById(n))==null?void 0:t.type}}class PR extends A.DiamondNode{constructor(){super(...arguments);x(this,"args");x(this,"executionCount");x(this,"size",{width:32,height:32})}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return rv(this,lm.DEFAULT)}}x(PR,"DEFAULT_FEATURES",[A.connectableFeature,A.deletableFeature,A.selectFeature,A.boundsFeature,K_,A.moveFeature,A.layoutContainerFeature,A.fadeFeature,A.hoverFeedbackFeature,A.popupFeature,A.openFeature,nv,gh,A.withEditLabelFeature,iv,H_,My]);class dm extends A.GEdge{constructor(){super(...arguments);x(this,"executionCount")}get color(){var t;return(t=this.args)==null?void 0:t.color}get bounds(){return this.routingPoints.reduce((t,i)=>A.Bounds.combine(t,{x:i.x,y:i.y,width:0,height:0}),this.centerBounds())}centerBounds(){var a,o;const t=A.Bounds.center(((a=this.source)==null?void 0:a.bounds)||A.Bounds.EMPTY),i=A.Bounds.center(((o=this.target)==null?void 0:o.bounds)||A.Bounds.EMPTY);return A.Bounds.translate(A.Bounds.EMPTY,A.centerOfLine(t,i))}get editableLabel(){return rv(this,xf.LABEL)}}x(dm,"DEFAULT_FEATURES",[A.editFeature,A.reconnectFeature,A.deletableFeature,A.selectFeature,A.fadeFeature,A.hoverFeedbackFeature,A.popupFeature,A.withEditLabelFeature,iv,gh]);class dl extends A.GLabel{constructor(){super(...arguments);x(this,"isMultiLine",!0)}get editControlDimension(){return{width:Math.max(this.bounds.width+25,144),height:Math.max(this.bounds.height,44)}}get editControlPositionCorrection(){return{x:-2,y:-3}}get labelBounds(){const t=this.font(),i=this.text.split(`
`),a=Math.max(...i.map(s=>this.textWidth(s,t))),o=14*i.length;return{x:-a/2,y:0,width:a,height:o}}textWidth(t,i){const a=document.createElement("canvas");if("getContext"in a){const o=a.getContext("2d");if(o)return o.font=i,o.measureText(t).width}return this.bounds.width}font(t=document.body){const i=this.cssStyle(t,"font-weight"),a="14px",o=this.cssStyle(t,"font-family");return`${i} ${a} ${o}`}cssStyle(t,i){return window.getComputedStyle(t,void 0).getPropertyValue(i)}}x(dl,"DEFAULT_FEATURES",[A.fadeFeature,A.editLabelFeature]);class aB extends dl{get labelBounds(){return{...super.labelBounds,y:-super.labelBounds.height/2}}}class cB extends dl{get editControlDimension(){return{width:Math.min(this.bounds.height+25,144),height:Math.max(this.bounds.width,44)}}}class YY extends dl{constructor(){super(...arguments);x(this,"isMultiLine",!0)}get editControlDimension(){return A.isBoundsAware(this.parent)?{width:this.parent.bounds.width,height:this.parent.bounds.height}:{width:this.bounds.width,height:this.bounds.height}}get editControlPositionCorrection(){return A.Point.ORIGIN}get labelBounds(){return this.parent instanceof Vd?this.parent.labelBounds:{x:-this.bounds.width/2,y:18,width:this.bounds.width,height:this.bounds.height-18}}}function rv(e,n){const t=e.children.find(i=>i.type===n);if(t&&A.isEditableLabel(t))return t}var WY=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},cy,Id;let uE=(Id=class extends A.DecorationPlacer{getPosition(n){if(n instanceof A.GChildElement&&A.isSizeable(n.parent)){const t=-cy.DECORATOR_RADIUS*2,i=n.parent.bounds.height-cy.DECORATOR_RADIUS*2;return n.parent instanceof Vd?{x:t-6,y:i-4}:{x:t-4,y:i}}return A.Point.ORIGIN}},cy=Id,x(Id,"DECORATOR_RADIUS",6),Id);uE=cy=WY([ue()],uE);const ZY=new A.FeatureModule((e,n,t)=>{const i={bind:e,isBound:t};A.bindAsService(i,A.TYPES.IVNodePostprocessor,uE)},{featureId:A.decorationModule.featureId}),uy=Symbol("jumpFeature");function QY(e){return e.hasFeature(uy)}function uB(e){return A.isBoundsAware(e)&&A.isSelectable(e)&&e instanceof $o}var JY=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let lE=class{constructor(){x(this,"cssClasses",["movement-not-allowed"])}validate(n,t){if(!t)return!0;if(!A.isBoundsAwareMoveable(n)&&!uB(n))return!1;const i=this.parentLocation(n,A.Point.ORIGIN);return i.x+t.x>=0&&i.y+t.y>=0}parentLocation(n,t){if(n instanceof A.GChildElement){const i=n.parent;if(A.isBoundsAware(i))return this.parentLocation(i,{x:t.x+i.bounds.x,y:t.y+i.bounds.y})}return t}};lE=JY([ue()],lE);const AS={createElement:A.svg};function RR(e,n){if(e.executionCount)return AS.createElement("g",null,AS.createElement("rect",{"class-execution-badge":!0,rx:"7",ry:"7",x:n-11,y:-7,width:22,height:14}),AS.createElement("text",{"class-execution-text":!0,x:n,dy:".4em"},e.executionCount))}var XY=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let Yo=class{constructor(){x(this,"showCustomIcons",!0)}handle(n){if(sm.is(n))return this.showCustomIcons=n.showCustomIcons,$S.create()}get isShowCustomIcons(){return this.showCustomIcons}set setShowCustomIcons(n){this.showCustomIcons=n}};Yo=XY([ue()],Yo);var eW=q7();const lB=V8(eW);var Kc;(function(e){e[e.SI=0]="SI",e[e.IMG=1]="IMG",e[e.NO=2]="NO"})(Kc||(Kc={}));const tW={res:"",style:Kc.NO};var Ve;(function(e){e.SIGNAL_EVENT="M10.5 3.5C10.3328 3.5 10.1767 3.58355 10.084 3.72265L2.08398 15.7227C1.98169 15.8761 1.97215 16.0734 2.05916 16.2359C2.14617 16.3985 2.3156 16.5 2.5 16.5L18.5 16.5C18.6844 16.5 18.8538 16.3985 18.9408 16.2359C19.0278 16.0733 19.0183 15.8761 18.916 15.7226L10.916 3.72265C10.8233 3.58355 10.6672 3.5 10.5 3.5ZM17.5657 15.5L3.43426 15.5L10.5 4.90139L17.5657 15.5Z",e.PROGRAM="M11.1712 3.2767C11.4432 3.32408 11.6254 3.58304 11.578 3.85508L9.40725 16.3165C9.35986 16.5886 9.1009 16.7707 8.82886 16.7233C8.55681 16.6759 8.37469 16.417 8.42208 16.1449L10.5928 3.68347C10.6402 3.41143 10.8991 3.22931 11.1712 3.2767ZM5.88773 5.62629C6.09413 5.80975 6.11272 6.12579 5.92926 6.33218L2.66898 9.99999L5.92926 13.6678C6.11272 13.8742 6.09413 14.1902 5.88773 14.3737C5.68134 14.5572 5.36531 14.5386 5.18185 14.3322L1.6263 10.3322C1.4579 10.1427 1.4579 9.85725 1.6263 9.66781L5.18185 5.66781C5.36531 5.46142 5.68134 5.44283 5.88773 5.62629ZM14.1122 5.62629C14.3186 5.44283 14.6347 5.46142 14.8181 5.66781L18.3737 9.66781C18.5421 9.85725 18.5421 10.1427 18.3737 10.3322L14.8181 14.3322C14.6347 14.5386 14.3186 14.5572 14.1122 14.3737C13.9058 14.1902 13.8873 13.8742 14.0707 13.6678L17.331 9.99999L14.0707 6.33218C13.8873 6.12579 13.9058 5.80975 14.1122 5.62629Z",e.ERROR_EVENT="M11.1799 1.5119C11.4087 1.56273 11.5714 1.76564 11.5714 1.99999V7.72221H14.5C14.671 7.72221 14.8301 7.80955 14.9218 7.95377C15.0136 8.098 15.0253 8.27911 14.9529 8.43398L10.3815 18.2118C10.2823 18.424 10.0489 18.5389 9.82011 18.4881C9.59134 18.4372 9.42857 18.2343 9.42857 18V12.2778H6.5C6.32905 12.2778 6.16995 12.1904 6.07817 12.0462C5.98639 11.902 5.97466 11.7209 6.04706 11.566L10.6185 1.78822C10.7177 1.57593 10.9511 1.46106 11.1799 1.5119ZM7.28572 11.2778H9.92857C10.2047 11.2778 10.4286 11.5016 10.4286 11.7778V15.75L13.7143 8.72221H11.0714C10.7953 8.72221 10.5714 8.49835 10.5714 8.22221V4.24999L7.28572 11.2778Z",e.SUB_START="M3.85303 2C3.85303 1.72386 4.07688 1.5 4.35303 1.5H9.00009C9.82851 1.5 10.5001 2.17157 10.5001 3V16.7929L15.2936 11.9994C15.4889 11.8041 15.8054 11.8041 16.0007 11.9994C16.196 12.1947 16.196 12.5112 16.0007 12.7065L10.3536 18.3536C10.2599 18.4473 10.1327 18.5 10.0001 18.5C9.86748 18.5 9.7403 18.4473 9.64653 18.3536L3.99947 12.7065C3.80421 12.5112 3.80421 12.1946 3.99947 11.9994C4.19474 11.8041 4.51132 11.8041 4.70658 11.9994L9.50009 16.7929V3C9.50009 2.72386 9.27623 2.5 9.00009 2.5H4.35303C4.07688 2.5 3.85303 2.27614 3.85303 2Z",e.WS_EVENT="M10.58 1.52C10.51 1.5 10.43 1.49 10.35 1.51C10.23 1.51 10.11 1.51 9.99 1.51C9.87 1.51 9.75 1.51 9.63 1.51C9.55 1.5 9.48 1.51 9.4 1.52C4.99 1.82 1.5 5.5 1.5 10C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 10C18.52 5.5 15.01 1.82 10.58 1.52ZM16.8 6.83H12.91C12.61 5.37 12.09 3.95 11.38 2.62C13.79 3.07 15.79 4.67 16.8 6.83ZM12.24 10C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 10C7.77 9.27 7.82 8.55 7.93 7.83H12.08C12.19 8.54 12.24 9.27 12.24 10ZM9.83 2.5C9.88 2.5 9.94 2.5 10 2.5C10.06 2.5 10.11 2.5 10.17 2.5C10.98 3.85 11.56 5.31 11.89 6.83H8.11C8.45 5.31 9.03 3.85 9.83 2.5ZM8.61 2.63C7.9 3.95 7.39 5.37 7.08 6.84H3.2C4.21 4.68 6.21 3.08 8.61 2.63ZM2.5 10C2.5 9.25 2.61 8.52 2.82 7.83H6.92C6.82 8.55 6.77 9.27 6.77 10C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 10ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.99C13.24 9.26 13.19 8.54 13.09 7.82H17.19C17.4 8.51 17.51 9.23 17.51 9.99C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",e.INIT_START="M12.3132 4.31313C12.5085 4.11787 12.825 4.11787 13.0203 4.31313L18.3536 9.64647C18.4474 9.74024 18.5001 9.86741 18.5001 10C18.5001 10.1326 18.4474 10.2598 18.3536 10.3536L13.0203 15.6869C12.825 15.8822 12.5085 15.8822 12.3132 15.6869C12.1179 15.4916 12.1179 15.1751 12.3132 14.9798L16.793 10.5L2 10.5C1.72386 10.5 1.5 10.2761 1.5 9.99998C1.5 9.72384 1.72386 9.49998 2 9.49998L16.793 9.50002L12.3132 5.02024C12.1179 4.82498 12.1179 4.5084 12.3132 4.31313Z",e.METHOD_START="M1.50004 3C1.50004 2.17157 2.17161 1.5 3.00004 1.5H17C17.8285 1.5 18.5 2.17157 18.5 3V17C18.5 17.8284 17.8285 18.5 17 18.5H3.00004C2.17161 18.5 1.50004 17.8284 1.50004 17V14C1.50004 13.7239 1.7239 13.5 2.00004 13.5C2.27618 13.5 2.50004 13.7239 2.50004 14V17C2.50004 17.2761 2.7239 17.5 3.00004 17.5H17C17.2762 17.5 17.5 17.2761 17.5 17V3C17.5 2.72386 17.2762 2.5 17 2.5H3.00004C2.7239 2.5 2.50004 2.72386 2.50004 3V6C2.50004 6.27614 2.27618 6.5 2.00004 6.5C1.7239 6.5 1.50004 6.27614 1.50004 6V3ZM8.75769 6.09112C8.95296 5.89586 9.26954 5.89586 9.4648 6.09112L13.0204 9.64668C13.2156 9.84194 13.2156 10.1585 13.0204 10.3538L9.4648 13.9093C9.26954 14.1046 8.95296 14.1046 8.75769 13.9093C8.56243 13.7141 8.56243 13.3975 8.75769 13.2022L11.4597 10.5002L2 10.5002C1.72386 10.5002 1.5 10.2764 1.5 10.0002C1.5 9.72407 1.72386 9.50021 2 9.50021L11.4597 9.50023L8.75769 6.79823C8.56243 6.60297 8.56243 6.28638 8.75769 6.09112Z",e.EVENT_START="M17.61 1.5H3.39C2.62 1.5 2 2.12 2 2.89V11.78C2 12.55 2.62 13.17 3.39 13.17H7.33V17.5H6.05C5.77 17.5 5.55 17.72 5.55 18C5.55 18.28 5.77 18.5 6.05 18.5H14.94C15.22 18.5 15.44 18.28 15.44 18C15.44 17.72 15.22 17.5 14.94 17.5H13.66V13.17H17.6C18.37 13.17 18.99 12.55 18.99 11.78V2.89C18.99 2.12 18.37 1.5 17.6 1.5H17.61ZM12.67 17.5H8.33V13.17H12.66V17.5H12.67ZM18 11.78C18 11.99 17.83 12.17 17.61 12.17H3.39C3.18 12.17 3 12 3 11.78V2.89C3 2.68 3.17 2.5 3.39 2.5H17.61C17.82 2.5 18 2.67 18 2.89V11.78Z",e.TASK="M1.5 4C1.5 3.72386 1.72386 3.5 2 3.5H18C18.2761 3.5 18.5 3.72386 18.5 4C18.5 4.27614 18.2761 4.5 18 4.5H2C1.72386 4.5 1.5 4.27614 1.5 4Z M1.5 10C1.5 9.72386 1.72386 9.5 2 9.5H18C18.2761 9.5 18.5 9.72386 18.5 10C18.5 10.2761 18.2761 10.5 18 10.5H2C1.72386 10.5 1.5 10.2761 1.5 10Z M1.5 16C1.5 15.7239 1.72386 15.5 2 15.5H18C18.2761 15.5 18.5 15.7239 18.5 16C18.5 16.2761 18.2761 16.5 18 16.5H2C1.72386 16.5 1.5 16.2761 1.5 16Z",e.WAIT="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM10 6.64282C10.2761 6.64282 10.5 6.86668 10.5 7.14282V9.79286L12.3536 11.6465C12.5488 11.8417 12.5488 12.1583 12.3535 12.3536C12.1583 12.5488 11.8417 12.5488 11.6464 12.3535L9.64644 10.3535C9.55268 10.2597 9.5 10.1326 9.5 9.99996V7.14282C9.5 6.86668 9.72386 6.64282 10 6.64282Z",e.END_PAGE="M17 1.25H3C2.03 1.25 1.25 2.03 1.25 3V17C1.25 17.97 2.03 18.75 3 18.75H17C17.97 18.75 18.75 17.97 18.75 17V3C18.75 2.03 17.97 1.25 17 1.25ZM2.75 3C2.75 2.86 2.86 2.75 3 2.75H6.58V6.58H2.75V3ZM17.25 17C17.25 17.14 17.14 17.25 17 17.25H3C2.86 17.25 2.75 17.14 2.75 17V8.08H17.25V17ZM17.25 6.58H8.08V2.75H17C17.14 2.75 17.25 2.86 17.25 3V6.58Z",e.SUB_END="M10.5001 1.5C10.6327 1.5 10.7599 1.55268 10.8536 1.64645L16.5007 7.29351C16.696 7.48877 16.696 7.80535 16.5007 8.00061C16.3054 8.19588 15.9889 8.19588 15.7936 8.00061L11.0001 3.20711L11.0001 17C11.0001 17.2761 11.2239 17.5 11.5001 17.5H16.1471C16.4233 17.5 16.6471 17.7239 16.6471 18C16.6471 18.2761 16.4233 18.5 16.1471 18.5H11.5001C10.6717 18.5 10.0001 17.8284 10.0001 17L10.0001 3.20711L5.20658 8.00061C5.01132 8.19587 4.69474 8.19587 4.49947 8.00061C4.30421 7.80535 4.30421 7.48877 4.49947 7.29351L10.1465 1.64645C10.2403 1.55268 10.3675 1.5 10.5001 1.5Z",e.EXIT_END="M3.5 2.5C3.22386 2.5 3 2.72386 3 3L3 17C3 17.2761 3.22386 17.5 3.5 17.5L17.5 17.5C17.7761 17.5 18 17.2761 18 17V12.6667C18 12.3905 18.2239 12.1667 18.5 12.1667C18.7761 12.1667 19 12.3905 19 12.6667V17C19 17.8284 18.3284 18.5 17.5 18.5L3.5 18.5C2.67157 18.5 2 17.8284 2 17L2 3C2 2.17157 2.67158 1.5 3.5 1.5L7.83334 1.5C8.10948 1.5 8.33334 1.72386 8.33334 2C8.33334 2.27614 8.10948 2.5 7.83334 2.5L3.5 2.5ZM12.6667 2C12.6667 1.72386 12.8906 1.5 13.1667 1.5H18.4999C18.7761 1.5 18.9999 1.72385 18.9999 1.99999L19.0001 7.33332C19.0001 7.60946 18.7762 7.83332 18.5001 7.83333C18.224 7.83334 18.0001 7.60949 18.0001 7.33335L18 3.20707L8.18681 13.0202C7.99155 13.2155 7.67496 13.2155 7.4797 13.0202C7.28444 12.825 7.28444 12.5084 7.4797 12.3131L17.2928 2.5H13.1667C12.8906 2.5 12.6667 2.27614 12.6667 2Z",e.ALTERNATIVE="M1.64645 1.64645C1.84171 1.45118 2.15829 1.45118 2.35355 1.64645L10 9.29289L17.6464 1.64646C17.8417 1.4512 18.1583 1.4512 18.3535 1.64646C18.5488 1.84173 18.5488 2.15831 18.3535 2.35357L10.7071 10L18.3535 17.6464C18.5488 17.8417 18.5488 18.1583 18.3535 18.3535C18.1583 18.5488 17.8417 18.5488 17.6464 18.3535L10 10.7071L2.35355 18.3536C2.15829 18.5488 1.84171 18.5488 1.64645 18.3536C1.45118 18.1583 1.45118 17.8417 1.64645 17.6464L9.29289 10L1.64645 2.35355C1.45118 2.15829 1.45118 1.84171 1.64645 1.64645Z",e.SPLIT="M10.0001 1.5C10.2762 1.5 10.5001 1.72386 10.5001 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.5001V18C10.5001 18.2761 10.2762 18.5 10.0001 18.5C9.72395 18.5 9.5001 18.2761 9.5001 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.5001V2C9.5001 1.72386 9.72395 1.5 10.0001 1.5Z",e.JOIN="M9.9998 1.5C10.2759 1.5 10.4998 1.72386 10.4998 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.4998V18C10.4998 18.2761 10.2759 18.5 9.9998 18.5C9.72366 18.5 9.4998 18.2761 9.4998 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.4998V2C9.4998 1.72386 9.72366 1.5 9.9998 1.5Z",e.TASKS="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM9.99976 6.9857C10.2759 6.9857 10.4998 7.20956 10.4998 7.4857V9.5H12.5143C12.7904 9.5 13.0143 9.72386 13.0143 10C13.0143 10.2761 12.7904 10.5 12.5143 10.5H10.4998V12.5144C10.4998 12.7905 10.2759 13.0144 9.99976 13.0144C9.72361 13.0144 9.49976 12.7905 9.49976 12.5144V10.5H7.4856C7.20945 10.5 6.9856 10.2761 6.9856 10C6.9856 9.72386 7.20945 9.5 7.4856 9.5H9.49976V7.4857C9.49976 7.20956 9.72361 6.9857 9.99976 6.9857Z",e.USER_TASK="M1.5 5.90298C1.5 5.62684 1.72386 5.40298 2 5.40298H10.3056C10.5817 5.40298 10.8056 5.62684 10.8056 5.90298C10.8056 6.17913 10.5817 6.40298 10.3056 6.40298H2C1.72386 6.40298 1.5 6.17913 1.5 5.90298ZM15.4787 6.40298C14.9595 6.40298 14.5387 6.82384 14.5387 7.34298C14.5387 7.86213 14.9595 8.28298 15.4787 8.28298C15.9978 8.28298 16.4187 7.86213 16.4187 7.34298C16.4187 6.82384 15.9978 6.40298 15.4787 6.40298ZM13.5387 7.34298C13.5387 6.27155 14.4072 5.40298 15.4787 5.40298C16.5501 5.40298 17.4187 6.27155 17.4187 7.34298C17.4187 8.41442 16.5501 9.28298 15.4787 9.28298C14.4072 9.28298 13.5387 8.41442 13.5387 7.34298ZM1.5 9.99993C1.5 9.72379 1.72386 9.49993 2 9.49993H10.3056C10.5817 9.49993 10.8056 9.72379 10.8056 9.99993C10.8056 10.2761 10.5817 10.4999 10.3056 10.4999H2C1.72386 10.4999 1.5 10.2761 1.5 9.99993ZM14.6383 12.0756C14.3252 12.0756 14.0248 12.2 13.8034 12.4215C13.5819 12.6429 13.4575 12.9432 13.4575 13.2564V14.0968C13.4575 14.373 13.2337 14.5968 12.9575 14.5968C12.6814 14.5968 12.4575 14.373 12.4575 14.0968V13.2564C12.4575 12.678 12.6873 12.1233 13.0963 11.7144C13.5052 11.3054 14.0599 11.0756 14.6383 11.0756H16.3191C16.8975 11.0756 17.4522 11.3054 17.8612 11.7144C18.2702 12.1233 18.4999 12.678 18.4999 13.2564V14.0968C18.4999 14.373 18.2761 14.5968 17.9999 14.5968C17.7238 14.5968 17.4999 14.373 17.4999 14.0968V13.2564C17.4999 12.9432 17.3755 12.6429 17.1541 12.4215C16.9326 12.2 16.6323 12.0756 16.3191 12.0756H14.6383ZM1.5 14.097C1.5 13.8209 1.72386 13.597 2 13.597H8.03415C8.31029 13.597 8.53415 13.8209 8.53415 14.097C8.53415 14.3731 8.31029 14.597 8.03415 14.597H2C1.72386 14.597 1.5 14.3731 1.5 14.097Z",e.USER_DIALOG="M10 11.23C10.94 11.23 11.7 10.47 11.7 9.53C11.7 8.59 10.94 7.83 10 7.83C9.06 7.83 8.3 8.59 8.3 9.53C8.3 10.47 9.06 11.23 10 11.23ZM10 8.83C10.39 8.83 10.7 9.14 10.7 9.53C10.7 9.92 10.39 10.23 10 10.23C9.61 10.23 9.3 9.92 9.3 9.53C9.3 9.14 9.61 8.83 10 8.83Z M16.86 1.5H3.14C2.2 1.5 1.5 2.31 1.5 3.23V5.66C1.5 5.66 1.5 5.68 1.5 5.69C1.5 5.7 1.5 5.71 1.5 5.72V16.77C1.5 17.69 2.2 18.5 3.14 18.5H16.86C17.8 18.5 18.5 17.69 18.5 16.77V3.23C18.5 2.31 17.8 1.5 16.86 1.5ZM17.5 16.77C17.5 17.21 17.18 17.5 16.86 17.5H3.14C2.82 17.5 2.5 17.21 2.5 16.77V6.19H17.5V16.77ZM17.5 5.19H2.5V3.23C2.5 2.79 2.82 2.5 3.14 2.5H16.86C17.18 2.5 17.5 2.79 17.5 3.23V5.19Z M7.9 15.66C8.18 15.66 8.4 15.44 8.4 15.16V14.46C8.4 14.22 8.49 13.99 8.66 13.82C8.83 13.65 9.06 13.56 9.3 13.56H10.7C10.94 13.56 11.17 13.65 11.34 13.82C11.51 13.99 11.6 14.22 11.6 14.46V15.16C11.6 15.44 11.82 15.66 12.1 15.66C12.38 15.66 12.6 15.44 12.6 15.16V14.46C12.6 13.96 12.4 13.47 12.04 13.12C11.68 12.76 11.2 12.56 10.7 12.56H9.3C8.8 12.56 8.31 12.76 7.96 13.12C7.6 13.48 7.4 13.96 7.4 14.46V15.16C7.4 15.44 7.62 15.66 7.9 15.66Z",e.SCRIPT="M8.45003 10.44C8.20003 10.32 7.90003 10.42 7.78003 10.66L6.89003 12.44C6.82003 12.58 6.82003 12.75 6.89003 12.89L7.78003 14.67C7.90003 14.92 8.20003 15.02 8.45003 14.89C8.70003 14.76 8.80003 14.47 8.67003 14.22L7.89003 12.67L8.67003 11.12C8.79003 10.87 8.69003 10.57 8.45003 10.45V10.44Z M11.56 10.44C11.31 10.56 11.21 10.86 11.34 11.11L12.12 12.66L11.34 14.21C11.22 14.46 11.32 14.76 11.56 14.88C11.8 15 12.11 14.9 12.23 14.66L13.12 12.88C13.19 12.74 13.19 12.57 13.12 12.43L12.23 10.65C12.11 10.4 11.81 10.3 11.56 10.43V10.44Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z",e.TRIGGER="M18.46 9.81C18.43 9.75 18.4 9.69 18.35 9.65L14.22 5.52C14.02 5.32 13.71 5.32 13.51 5.52C13.31 5.72 13.31 6.03 13.51 6.23L16.79 9.50999H7.68C7.4 9.50999 7.18 9.72999 7.18 10.01C7.18 10.29 7.4 10.51 7.68 10.51H16.79L13.51 13.79C13.31 13.99 13.31 14.3 13.51 14.5C13.71 14.7 14.02 14.7 14.22 14.5L18.35 10.37C18.35 10.37 18.43 10.27 18.46 10.21C18.51 10.09 18.51 9.95 18.46 9.83V9.81Z M2.77 8.72C2.07 8.72 1.5 9.29 1.5 9.99C1.5 10.69 2.07 11.26 2.77 11.26C3.47 11.26 4.04 10.69 4.04 9.99C4.04 9.29 3.47 8.72 2.77 8.72Z",e.DATABASE="M2.93817 4.02139C2.59033 4.29551 2.5 4.51734 2.5 4.66667C2.5 4.81599 2.59033 5.03782 2.93817 5.31195C3.28037 5.58163 3.80652 5.84636 4.50126 6.07794C5.88551 6.53936 7.82965 6.83333 10 6.83333C12.1704 6.83333 14.1145 6.53936 15.4987 6.07794C16.1935 5.84636 16.7196 5.58163 17.0618 5.31195C17.4097 5.03782 17.5 4.81599 17.5 4.66667C17.5 4.51734 17.4097 4.29551 17.0618 4.02139C16.7196 3.7517 16.1935 3.48697 15.4987 3.25539C14.1145 2.79397 12.1704 2.5 10 2.5C7.82965 2.5 5.88551 2.79397 4.50126 3.25539C3.80652 3.48697 3.28037 3.7517 2.93817 4.02139ZM17.5 6.2309C17.0526 6.54124 16.4751 6.80657 15.815 7.02663C14.3038 7.53035 12.2479 7.83333 10 7.83333C7.75208 7.83333 5.69621 7.53035 4.18503 7.02663C3.52486 6.80657 2.94736 6.54124 2.5 6.2309V9.99999C2.5 10.1399 2.58304 10.3578 2.92244 10.6309C3.25721 10.9004 3.78199 11.1715 4.50126 11.4113C5.93651 11.8897 7.91486 12.1667 10 12.1667C12.0851 12.1667 14.0635 11.8897 15.4987 11.4113C16.218 11.1715 16.7428 10.9004 17.0776 10.6309C17.417 10.3578 17.5 10.1399 17.5 9.99999V6.2309ZM17.5 11.5628C17.0592 11.8694 16.4867 12.136 15.815 12.36C14.2496 12.8817 12.1583 13.1667 10 13.1667C7.84168 13.1667 5.75037 12.8817 4.18503 12.36C3.51327 12.136 2.94081 11.8694 2.5 11.5628V15.3333C2.5 15.4732 2.58304 15.6912 2.92244 15.9643C3.25721 16.2337 3.78199 16.5049 4.50126 16.7446C5.93651 17.223 7.91486 17.5 10 17.5C12.0851 17.5 14.0635 17.223 15.4987 16.7446C16.218 16.5049 16.7428 16.2337 17.0776 15.9643C17.417 15.6912 17.5 15.4732 17.5 15.3333V11.5628ZM18.5 15.3333C18.5 15.9007 18.1616 16.3755 17.7045 16.7434C17.2428 17.1149 16.596 17.433 15.815 17.6933C14.2496 18.2151 12.1583 18.5 10 18.5C7.84168 18.5 5.75037 18.2151 4.18503 17.6933C3.40401 17.433 2.75722 17.1149 2.29549 16.7434C1.83838 16.3755 1.5 15.9007 1.5 15.3333V4.66667C1.5 4.07961 1.85738 3.59992 2.31919 3.23597C2.78664 2.86759 3.43206 2.5577 4.18503 2.30671C5.69621 1.80298 7.75208 1.5 10 1.5C12.2479 1.5 14.3038 1.80298 15.815 2.30671C16.5679 2.5577 17.2134 2.86759 17.6808 3.23597C18.1426 3.59992 18.5 4.07961 18.5 4.66667V15.3333Z",e.WEB_SERVICE="M10.58 1.51999C10.51 1.49999 10.43 1.48999 10.35 1.50999C10.23 1.50999 10.11 1.50999 9.99 1.50999C9.87 1.50999 9.75 1.50999 9.63 1.50999C9.55 1.49999 9.48 1.50999 9.4 1.51999C4.99 1.81999 1.5 5.49999 1.5 9.99999C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 9.99999C18.52 5.49999 15.01 1.81999 10.58 1.51999ZM16.8 6.82999H12.91C12.61 5.36999 12.09 3.94999 11.38 2.61999C13.79 3.06999 15.79 4.66999 16.8 6.82999ZM12.24 9.99999C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 9.99999C7.77 9.26999 7.82 8.54999 7.93 7.82999H12.08C12.19 8.53999 12.24 9.26999 12.24 9.99999ZM9.83 2.49999C9.88 2.49999 9.94 2.49999 10 2.49999C10.06 2.49999 10.11 2.49999 10.17 2.49999C10.98 3.84999 11.56 5.30999 11.89 6.82999H8.11C8.45 5.30999 9.03 3.84999 9.83 2.49999ZM8.61 2.62999C7.9 3.94999 7.39 5.36999 7.08 6.83999H3.2C4.21 4.67999 6.21 3.07999 8.61 2.62999ZM2.5 9.99999C2.5 9.24999 2.61 8.51999 2.82 7.82999H6.92C6.82 8.54999 6.77 9.26999 6.77 9.99999C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 9.99999ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.98999C13.24 9.25999 13.19 8.53999 13.09 7.81999H17.19C17.4 8.50999 17.51 9.22999 17.51 9.98999C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",e.RULE="M16.8549 1.505H3.14488C2.24488 1.505 1.50488 2.245 1.50488 3.145V16.855C1.50488 17.765 2.24488 18.495 3.14488 18.495H6.52488C6.52488 18.495 6.55488 18.495 6.57488 18.495C6.59488 18.495 6.60488 18.495 6.62488 18.495H16.8549C17.7649 18.495 18.4949 17.755 18.4949 16.855V3.145C18.4949 2.235 17.7549 1.505 16.8549 1.505V1.505ZM6.07488 17.505H3.14488C2.79488 17.505 2.50488 17.215 2.50488 16.865V12.795H6.07488V17.505V17.505ZM6.07488 11.795H2.50488V7.07501H6.07488V11.785V11.795ZM17.5049 16.865C17.5049 17.225 17.2149 17.505 16.8649 17.505H7.07488V12.795H17.5049V16.865ZM17.5049 11.795H7.07488V7.07501H17.5049V11.785V11.795ZM17.5049 6.085H2.50488V3.145C2.50488 2.795 2.79488 2.505 3.14488 2.505H16.8549C17.2049 2.505 17.4949 2.795 17.4949 3.145V6.07501L17.5049 6.085Z",e.REST_CLIENT="M4.34348 14.9871C4.64515 14.7032 5.11981 14.7177 5.40365 15.0193L5.41334 15.0296C5.69718 15.3313 5.68273 15.806 5.38106 16.0898C5.07939 16.3737 4.60473 16.3592 4.32089 16.0575L4.3112 16.0472C4.02736 15.7456 4.04181 15.2709 4.34348 14.9871Z M8.61204 12.0005C7.67503 11.0046 6.38087 10.4217 5.01413 10.3799C4.73812 10.3714 4.52121 10.1408 4.52966 9.86482C4.53811 9.5888 4.76871 9.3719 5.04472 9.38034C6.67649 9.43028 8.22163 10.1263 9.34034 11.3152C10.459 12.5042 11.0597 14.0888 11.0103 15.7206C11.0019 15.9966 10.7714 16.2136 10.4954 16.2053C10.2194 16.1969 10.0024 15.9664 10.0107 15.6903C10.0522 14.3236 9.54904 12.9964 8.61204 12.0005Z M12.7334 8.12283C11.7602 7.08858 10.5929 6.25613 9.29809 5.67303C8.00324 5.08992 6.60622 4.76757 5.18679 4.72438C4.91077 4.71598 4.69383 4.48542 4.70222 4.20941C4.71062 3.93339 4.94118 3.71645 5.2172 3.72485C6.76789 3.77203 8.29411 4.12418 9.7087 4.76122C11.1233 5.39825 12.3986 6.30767 13.4617 7.43757C14.5248 8.56746 15.3549 9.8957 15.9047 11.3464C16.4545 12.7972 16.7131 14.342 16.6659 15.8927C16.6575 16.1687 16.4269 16.3856 16.1509 16.3772C15.8749 16.3688 15.6579 16.1382 15.6663 15.8622C15.7096 14.4428 15.4729 13.0287 14.9696 11.7008C14.4664 10.3729 13.7065 9.15708 12.7334 8.12283Z",e.EMAIL="M2.52467 5.30441L10 10.288L17.4753 5.30441C17.3586 4.71897 16.842 4.27777 16.2222 4.27777H3.77778C3.15804 4.27777 2.64135 4.71897 2.52467 5.30441ZM17.5 6.48981L10.2774 11.3049C10.1094 11.4169 9.8906 11.4169 9.72265 11.3049L2.5 6.48981V14.4444C2.5 15.1501 3.07208 15.7222 3.77778 15.7222H16.2222C16.9279 15.7222 17.5 15.1501 17.5 14.4444V6.48981ZM1.5 5.55555C1.5 4.29757 2.5198 3.27777 3.77778 3.27777H16.2222C17.4802 3.27777 18.5 4.29757 18.5 5.55555V14.4444C18.5 15.7024 17.4802 16.7222 16.2222 16.7222H3.77778C2.5198 16.7222 1.5 15.7024 1.5 14.4444V5.55555Z",e.USER="M10.0001 3.21796C8.46359 3.21796 7.21802 4.46353 7.21802 6.00001C7.21802 7.5365 8.46359 8.78207 10.0001 8.78207C11.5366 8.78207 12.7821 7.5365 12.7821 6.00001C12.7821 4.46353 11.5366 3.21796 10.0001 3.21796ZM6.21802 6.00001C6.21802 3.91124 7.9113 2.21796 10.0001 2.21796C12.0888 2.21796 13.7821 3.91124 13.7821 6.00001C13.7821 8.08878 12.0888 9.78207 10.0001 9.78207C7.9113 9.78207 6.21802 8.08878 6.21802 6.00001ZM8.35896 12.859C7.62111 12.859 6.91349 13.1521 6.39175 13.6739C5.87001 14.1956 5.5769 14.9032 5.5769 15.6411V17.2821C5.5769 17.5582 5.35305 17.7821 5.0769 17.7821C4.80076 17.7821 4.5769 17.5582 4.5769 17.2821V15.6411C4.5769 14.638 4.97537 13.676 5.68464 12.9667C6.39392 12.2575 7.3559 11.859 8.35896 11.859H11.641C12.6441 11.859 13.6061 12.2575 14.3153 12.9667C15.0246 13.676 15.4231 14.638 15.4231 15.6411V17.2821C15.4231 17.5582 15.1992 17.7821 14.9231 17.7821C14.6469 17.7821 14.4231 17.5582 14.4231 17.2821V15.6411C14.4231 14.9032 14.13 14.1956 13.6082 13.6739C13.0865 13.1521 12.3789 12.859 11.641 12.859H8.35896Z",e.MANUAL="M18.37 9.94187C18.28 9.73187 18.16 9.55187 18 9.39187C17.84 9.23187 17.66 9.11187 17.45 9.02187C17.24 8.93187 17.02 8.89187 16.8 8.89187H16.75C16.85 8.67187 16.91 8.44187 16.91 8.19187C16.91 7.74187 16.73 7.31187 16.41 6.99187C16.09 6.67187 15.66 6.49187 15.21 6.49187H10.42L10.74 6.17187C11.05 5.86187 11.25 5.44187 11.31 5.00187C11.36 4.56187 11.27 4.11187 11.04 3.73187C10.81 3.35187 10.45 3.07187 10.02 2.96187C9.58 2.85187 9.13 2.91187 8.74 3.13187C6.03 4.65187 4.52 5.52187 4.13 5.77187L3.89 5.93187C3.16 6.41187 2.55 7.07187 2.14 7.84187C1.76 8.54187 1.54 9.32187 1.5 10.1219C1.5 10.1419 1.5 10.1719 1.5 10.1919V11.7919C1.5 13.2119 2.05 14.5419 3.05 15.5419C4.05 16.5419 5.38 17.0919 6.8 17.0919H13.6C14.05 17.0919 14.49 16.9119 14.8 16.5919C15.11 16.2719 15.3 15.8419 15.3 15.3919C15.3 15.1519 15.24 14.9119 15.14 14.6919H15.2C15.65 14.6919 16.08 14.5119 16.4 14.1919C16.72 13.8719 16.9 13.4419 16.9 12.9919C16.9 12.7419 16.84 12.5119 16.75 12.2919H16.8C17.02 12.2919 17.24 12.2519 17.45 12.1619C17.66 12.0719 17.84 11.9519 18 11.7919C18.16 11.6319 18.28 11.4519 18.37 11.2419C18.45 11.0319 18.5 10.8119 18.5 10.5919C18.5 10.3719 18.46 10.1519 18.37 9.94187ZM17.45 10.8619C17.41 10.9419 17.36 11.0219 17.3 11.0919C17.24 11.1619 17.16 11.2119 17.07 11.2419C16.99 11.2819 16.9 11.2919 16.8 11.2919H15.21C15.21 11.2919 15.21 11.2919 15.2 11.2919H10C9.72 11.2919 9.5 11.5119 9.5 11.7919C9.5 12.0719 9.72 12.2919 10 12.2919H15.21C15.39 12.2919 15.57 12.3619 15.7 12.4919C15.83 12.6219 15.91 12.8019 15.91 12.9919C15.91 13.1819 15.84 13.3619 15.71 13.4919C15.58 13.6219 15.4 13.7019 15.21 13.7019H10.01C9.73 13.7019 9.51 13.9219 9.51 14.2019C9.51 14.4819 9.73 14.7019 10.01 14.7019H13.61C13.79 14.7019 13.97 14.7819 14.11 14.9119C14.24 15.0419 14.31 15.2219 14.31 15.4019C14.31 15.5819 14.24 15.7619 14.1 15.9019C13.97 16.0319 13.79 16.1119 13.6 16.1119H6.8C5.65 16.1119 4.57 15.6619 3.76 14.8519C2.95 14.0419 2.5 12.9619 2.5 11.8119V10.3819C2.5 9.67187 2.68 8.96187 3.01 8.34187C3.35 7.72187 3.84 7.18187 4.43 6.79187L4.67 6.63187C5.04 6.39187 6.57 5.51187 9.22 4.02187C9.38 3.93187 9.57 3.91187 9.74 3.95187C9.92 4.00187 10.07 4.11187 10.16 4.27187C10.27 4.46187 10.32 4.68187 10.29 4.90187C10.26 5.12187 10.16 5.33187 10.01 5.48187L8.83 6.66187C8.83 6.66187 8.75 6.76187 8.72 6.82187C8.67 6.94187 8.67 7.08187 8.72 7.20187C8.77 7.32187 8.87 7.42187 8.99 7.47187C9.05 7.50187 9.12 7.51187 9.18 7.51187H15.18C15.37 7.51187 15.54 7.58187 15.68 7.71187C15.81 7.84187 15.89 8.02187 15.89 8.21187C15.89 8.40187 15.81 8.57187 15.68 8.70187C15.55 8.83187 15.37 8.91187 15.18 8.91187H9.98C9.7 8.91187 9.48 9.13187 9.48 9.41187C9.48 9.69187 9.7 9.91187 9.98 9.91187H16.78C16.87 9.91187 16.96 9.93187 17.05 9.96187C17.14 10.0019 17.21 10.0519 17.28 10.1119C17.35 10.1819 17.4 10.2519 17.43 10.3419C17.47 10.4319 17.48 10.5219 17.48 10.6119C17.48 10.7019 17.46 10.7919 17.43 10.8819L17.45 10.8619Z",e.SERVICE="M11.975 3.05291C11.4727 0.982614 8.5279 0.982526 8.02544 3.05265C7.86008 3.73266 7.08472 4.05496 6.48482 3.69022C4.66486 2.58252 2.5832 4.66517 3.69139 6.48425C3.77602 6.62304 3.82677 6.78001 3.83933 6.94207C3.8519 7.10414 3.82602 7.26688 3.7638 7.41705C3.70158 7.56723 3.60479 7.70059 3.48129 7.80628C3.35779 7.91198 3.21108 7.98702 3.0531 8.02529C0.982807 8.52754 0.982579 11.4724 3.05269 11.9749C3.21053 12.0132 3.35709 12.0883 3.48045 12.194C3.60381 12.2997 3.70049 12.433 3.76263 12.5831C3.82478 12.7332 3.85063 12.8958 3.8381 13.0577C3.82556 13.2197 3.77499 13.3764 3.69049 13.5151C2.58244 15.3352 4.66514 17.4171 6.48431 16.3089C6.6231 16.2243 6.78006 16.1735 6.94213 16.161C7.10419 16.1484 7.26693 16.1743 7.41711 16.2365C7.56728 16.2987 7.70064 16.3955 7.80634 16.519C7.91203 16.6425 7.98707 16.7892 8.02535 16.9472C8.52759 19.0175 11.4724 19.0177 11.9749 16.9476C12.0133 16.7898 12.0884 16.6432 12.1941 16.5199C12.2997 16.3965 12.433 16.2998 12.5831 16.2377C12.7332 16.1755 12.8958 16.1497 13.0578 16.1622C13.2197 16.1747 13.3765 16.2253 13.5152 16.3098C15.3352 17.4179 17.4172 15.3352 16.309 13.516C16.2243 13.3772 16.1736 13.2202 16.161 13.0582C16.1485 12.8961 16.1743 12.7334 16.2365 12.5832C16.2988 12.433 16.3956 12.2997 16.5191 12.194C16.6426 12.0883 16.7893 12.0132 16.9473 11.9749C19.0175 11.4727 19.0175 8.52779 16.9474 8.02533C16.7897 7.98692 16.6432 7.91186 16.5199 7.80624C16.3965 7.70055 16.2999 7.56725 16.2377 7.41717C16.1756 7.26709 16.1497 7.10446 16.1623 6.94251C16.1748 6.78055 16.2254 6.62375 16.3099 6.48502C17.418 4.665 15.3351 2.5832 13.5159 3.69144C13.3771 3.77606 13.2203 3.82671 13.0582 3.83928C12.8962 3.85184 12.7334 3.82597 12.5832 3.76375C12.4331 3.70153 12.2997 3.60473 12.194 3.48124C12.0883 3.35774 12.0132 3.21089 11.975 3.05291ZM8.99719 3.28867C9.25225 2.23732 10.748 2.23727 11.0031 3.28853C11.0785 3.59947 11.2262 3.88837 11.4343 4.13145C11.6423 4.37457 11.9049 4.56512 12.2005 4.6876C12.4961 4.81008 12.8165 4.86102 13.1355 4.83629C13.4545 4.81156 13.7631 4.71187 14.0363 4.54535C14.9603 3.98248 16.0188 5.04014 15.4558 5.965C15.2895 6.23808 15.1899 6.54655 15.1652 6.86533C15.1406 7.18415 15.1915 7.5043 15.3138 7.79975C15.4361 8.09519 15.6265 8.35761 15.8693 8.56565C16.1121 8.7737 16.4006 8.92151 16.7114 8.99707C17.7627 9.25213 17.763 10.7479 16.7118 11.0031C16.4008 11.0784 16.1119 11.2262 15.8688 11.4342C15.6257 11.6423 15.4352 11.9048 15.3127 12.2004C15.1902 12.4961 15.1393 12.8164 15.164 13.1355C15.1887 13.4545 15.2885 13.7632 15.455 14.0364C16.0177 14.9603 14.9601 16.0187 14.0353 15.4557C13.7622 15.2894 13.4538 15.1899 13.135 15.1652C12.9888 15.1539 12.8423 15.1584 12.698 15.1785C12.5277 15.2022 12.3605 15.2475 12.2006 15.3137C12.0404 15.3801 11.89 15.4663 11.7526 15.5701C11.6366 15.6578 11.5299 15.758 11.4346 15.8692C11.2266 16.1121 11.0788 16.4006 11.0032 16.7113C10.7482 17.7627 9.25235 17.7628 8.99719 16.7116C8.92183 16.4006 8.77412 16.1119 8.56609 15.8688C8.35802 15.6257 8.09549 15.4351 7.79986 15.3126C7.50423 15.1902 7.18387 15.1392 6.86483 15.164C6.54579 15.1887 6.2371 15.2884 5.96389 15.455C5.03998 16.0176 3.98155 14.9601 4.54459 14.0352C4.7109 13.7622 4.81044 13.4537 4.83511 13.1349C4.85979 12.8161 4.80889 12.4959 4.68656 12.2005C4.56422 11.9051 4.3739 11.6426 4.13105 11.4346C3.88821 11.2265 3.59944 11.0787 3.28872 11.0031C2.23737 10.7481 2.23746 9.2523 3.28872 8.99714C3.59966 8.92178 3.88842 8.77407 4.13151 8.56603C4.37462 8.35797 4.56517 8.09544 4.68765 7.79981C4.81013 7.50418 4.86108 7.18381 4.83634 6.86477C4.81161 6.5458 4.71193 6.23717 4.5454 5.96399C3.98253 5.04005 5.04044 3.98162 5.96531 4.54469C7.14319 5.26084 8.67189 4.62643 8.99719 3.28867ZM6.83352 10C6.83352 8.25114 8.25128 6.83337 10.0002 6.83337C11.7491 6.83337 13.1669 8.25114 13.1669 10C13.1669 11.7489 11.7491 13.1667 10.0002 13.1667C8.25128 13.1667 6.83352 11.7489 6.83352 10ZM10.0002 7.83337C8.80357 7.83337 7.83352 8.80342 7.83352 10C7.83352 11.1967 8.80357 12.1667 10.0002 12.1667C11.1968 12.1667 12.1669 11.1967 12.1669 10C12.1669 8.80342 11.1968 7.83337 10.0002 7.83337Z",e.SEND="M15.69 11.865C15.49 11.665 15.18 11.665 14.98 11.865C14.78 12.065 14.78 12.375 14.98 12.575L16.79 14.385H12.66C12.38 14.385 12.16 14.605 12.16 14.885C12.16 15.165 12.38 15.385 12.66 15.385H16.79L14.98 17.195C14.78 17.395 14.78 17.705 14.98 17.905C15.18 18.105 15.49 18.105 15.69 17.905L18.36 15.235C18.56 15.035 18.56 14.725 18.36 14.525L15.69 11.855V11.865Z M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.75 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z",e.RECEIVE="M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.74 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z M18 14.385H13.87L15.68 12.575C15.88 12.375 15.88 12.065 15.68 11.865C15.48 11.665 15.17 11.665 14.97 11.865L12.3 14.535C12.21 14.625 12.15 14.755 12.15 14.885C12.15 15.015 12.2 15.145 12.3 15.235L14.97 17.905C15.17 18.105 15.48 18.105 15.68 17.905C15.88 17.705 15.88 17.395 15.68 17.195L13.87 15.385H18C18.28 15.385 18.5 15.165 18.5 14.885C18.5 14.605 18.28 14.385 18 14.385Z",e.ANGLE_DOWN="m 14.374468,7.8998791 c 0.182994,0.2068134 0.163691,0.5228707 -0.04311,0.7058045 l -4.008014,3.5465644 c -0.189819,0.167972 -0.475268,0.167328 -0.664388,-0.0015 L 5.6669878,8.586132 C 5.4610018,8.4022667 5.4431148,8.0861255 5.6270808,7.8801401 5.8110458,7.6741547 6.127087,7.6563679 6.333072,7.8402331 l 3.660444,3.2685679 3.675158,-3.2520147 c 0.206803,-0.1829338 0.522801,-0.1637207 0.705794,0.043093 z",e.NOTE="M7.34003 7.83H8.23003C8.51003 7.83 8.73003 7.61 8.73003 7.33C8.73003 7.05 8.51003 6.83 8.23003 6.83H7.34003C7.06003 6.83 6.84003 7.05 6.84003 7.33C6.84003 7.61 7.06003 7.83 7.34003 7.83Z M12.67 13.94H7.34003C7.06003 13.94 6.84003 14.16 6.84003 14.44C6.84003 14.72 7.06003 14.94 7.34003 14.94H12.67C12.95 14.94 13.17 14.72 13.17 14.44C13.17 14.16 12.95 13.94 12.67 13.94Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z M7.34003 10.39C7.06003 10.39 6.84003 10.61 6.84003 10.89C6.84003 11.17 7.06003 11.39 7.34003 11.39H12.67C12.95 11.39 13.17 11.17 13.17 10.89C13.17 10.61 12.95 10.39 12.67 10.39H7.34003Z",e.PUZZLE="M10.0038 1.95906C10.2954 1.66743 10.6921 1.5 11.1104 1.5C11.5287 1.5 11.9254 1.66742 12.2171 1.95906L13.7162 3.45817C13.8335 3.57549 13.885 3.74336 13.8536 3.90628C13.8222 4.06919 13.7121 4.20594 13.5596 4.2713C13.2336 4.411 12.9448 4.62539 12.7205 4.90144C12.497 5.17656 12.3457 5.50614 12.2757 5.85649C12.2066 6.20173 12.2238 6.5584 12.3276 6.8985C12.4309 7.23723 12.6216 7.5501 12.8707 7.7992C13.1262 8.05472 13.4318 8.23875 13.7714 8.34237L13.7737 8.34307C14.1043 8.44568 14.4672 8.4635 14.8134 8.39426L14.815 8.39395C15.1696 8.32419 15.492 8.17403 15.7685 7.94942L15.7734 7.94542L15.7734 7.94545C16.0446 7.73076 16.2576 7.44522 16.3974 7.11325C16.462 6.95982 16.5987 6.84861 16.7621 6.81661C16.9255 6.78461 17.094 6.83601 17.2118 6.95373L18.7109 8.45284C19.0025 8.74447 19.1699 9.1412 19.1699 9.5595C19.1699 9.97781 19.0025 10.3745 18.7109 10.6662L17.0386 12.3384C17.2914 12.4259 17.5334 12.5455 17.7592 12.6948C18.2824 13.0408 18.6896 13.5321 18.9272 14.1175C19.163 14.6987 19.2215 15.3297 19.1041 15.9414L19.1029 15.9479L19.1029 15.9479C18.977 16.5605 18.675 17.1241 18.2366 17.5632C17.7971 18.0105 17.2313 18.3146 16.6146 18.4336C15.9951 18.5602 15.3632 18.4909 14.7874 18.2573L14.7851 18.2563C14.2114 18.0201 13.7131 17.6153 13.3659 17.0909C13.2152 16.8666 13.0952 16.6236 13.0076 16.3695L11.3361 18.0409C11.0445 18.3326 10.6477 18.5 10.2294 18.5C9.81112 18.5 9.41439 18.3326 9.12276 18.0409L7.62365 16.5418C7.50633 16.4245 7.45485 16.2566 7.48623 16.0937C7.5176 15.9308 7.62775 15.7941 7.78024 15.7287C8.10622 15.589 8.39505 15.3746 8.61934 15.0986C8.84288 14.8234 8.99411 14.4939 9.06418 14.1435C9.13323 13.7983 9.11605 13.4416 9.01229 13.1015C8.90895 12.7628 8.71822 12.4499 8.46912 12.2008C8.2136 11.9453 7.90806 11.7613 7.56842 11.6576L7.56613 11.6569C7.2355 11.5543 6.87262 11.5365 6.52642 11.6057L6.52487 11.606C6.17024 11.6758 5.84781 11.826 5.57136 12.0506L5.56644 12.0546L5.56642 12.0545C5.29523 12.2692 5.08224 12.5548 4.94246 12.8867C4.87786 13.0402 4.74113 13.1514 4.57776 13.1834C4.41439 13.2154 4.24581 13.164 4.12809 13.0463L2.62898 11.5472C2.33735 11.2555 2.16992 10.8588 2.16992 10.4405C2.16992 10.0222 2.33735 9.62547 2.62898 9.33384L4.30121 7.6616C4.04847 7.57405 3.80643 7.45448 3.58063 7.30516C3.05746 6.95919 2.65022 6.46794 2.41265 5.8825C2.17681 5.30131 2.11838 4.67035 2.23571 4.05858L2.23695 4.05211L2.23699 4.05212C2.36289 3.43944 2.66489 2.87586 3.10332 2.43676C3.5428 1.98951 4.10854 1.68537 4.72526 1.56641C5.3447 1.43982 5.97665 1.50909 6.55242 1.74273L6.55479 1.74369L6.55479 1.7437C7.12851 1.97994 7.62681 2.38473 7.97407 2.90917C8.12465 3.13352 8.24467 3.37645 8.33229 3.63053L10.0038 1.95906ZM11.1104 2.5C10.9603 2.5 10.8171 2.55993 10.7109 2.66616L8.35918 5.01785C8.21618 5.16085 8.00112 5.20363 7.81428 5.12624C7.62744 5.04885 7.50562 4.86653 7.50562 4.6643C7.50562 4.2364 7.37809 3.81511 7.14305 3.46542L7.14095 3.4623L7.14096 3.4623C6.90591 3.10684 6.56669 2.83033 6.17521 2.66886C5.77186 2.50544 5.33973 2.46104 4.92331 2.54661L4.91686 2.54793L4.91685 2.54789C4.49831 2.62816 4.11387 2.83465 3.81546 3.1388L3.81212 3.1422L3.81211 3.14219C3.51331 3.44099 3.30468 3.82759 3.21719 4.25017C3.13641 4.67467 3.17765 5.10823 3.33927 5.50648C3.49957 5.90151 3.77439 6.23441 4.13222 6.47104C4.49242 6.70924 4.90834 6.8357 5.33422 6.8357C5.53645 6.8357 5.71877 6.95752 5.79616 7.14436C5.87355 7.3312 5.83077 7.54626 5.68777 7.68926L3.33609 10.0409C3.22985 10.1472 3.16992 10.2904 3.16992 10.4405C3.16992 10.5906 3.22985 10.7338 3.33609 10.8401L4.37025 11.8742C4.53173 11.6498 4.72342 11.4469 4.94325 11.2725C5.34832 10.944 5.82074 10.7254 6.33185 10.6249C6.83737 10.524 7.36868 10.5488 7.86138 10.7015C8.35965 10.8537 8.80681 11.1243 9.17623 11.4937C9.53814 11.8556 9.81633 12.3101 9.96876 12.8097C10.1208 13.308 10.1462 13.8323 10.0448 14.3396C9.94432 14.8418 9.72609 15.3222 9.39546 15.7292C9.21887 15.9465 9.01598 16.1367 8.79349 16.2975L9.82987 17.3338C9.93611 17.4401 10.0793 17.5 10.2294 17.5C10.3795 17.5 10.5227 17.4401 10.629 17.3338L12.9807 14.9821C13.1237 14.8391 13.3387 14.7964 13.5256 14.8738C13.7124 14.9512 13.8342 15.1335 13.8342 15.3357C13.8342 15.7636 13.9618 16.1849 14.1968 16.5346L14.1989 16.5377L14.1989 16.5377C14.434 16.8932 14.7732 17.1697 15.1647 17.3312C15.568 17.4946 16.0001 17.539 16.4165 17.4534L16.423 17.4521L16.423 17.4521C16.8415 17.3718 17.226 17.1653 17.5244 16.8612L17.5277 16.8578L17.5277 16.8578C17.8265 16.559 18.0352 16.1724 18.1227 15.7498C18.2034 15.3253 18.1622 14.8918 18.0006 14.4935C17.8403 14.0985 17.5655 13.7656 17.2076 13.529C16.8474 13.2908 16.4315 13.1643 16.0056 13.1643C15.8034 13.1643 15.6211 13.0425 15.5437 12.8556C15.4663 12.6688 15.5091 12.4537 15.6521 12.3107L18.0038 9.95906C18.11 9.85282 18.1699 9.70958 18.1699 9.5595C18.1699 9.40943 18.11 9.26618 18.0038 9.15995L16.9696 8.12579C16.8081 8.35015 16.6164 8.55311 16.3966 8.72752C15.9916 9.05598 15.5191 9.2746 15.008 9.37514C14.5025 9.47598 13.9712 9.45118 13.4785 9.29849C12.9802 9.14627 12.533 8.87572 12.1636 8.50631C11.8017 8.14439 11.5235 7.68994 11.3711 7.19031C11.2191 6.69204 11.1936 6.16772 11.2951 5.66038C11.3955 5.15816 11.6138 4.67779 11.9444 4.27085C12.121 4.05351 12.3239 3.86328 12.5464 3.70255L11.51 2.66616C11.4037 2.55993 11.2605 2.5 11.1104 2.5Z"})(Ve||(Ve={}));const nW=new Map([[Xe.START_SIGNAL,Ve.SIGNAL_EVENT],[Xe.START_PROGRAM,Ve.PROGRAM],[Xe.START_THIRD_PARTY,Ve.PUZZLE],[Xe.START_ERROR,Ve.ERROR_EVENT],[Xe.START_SUB,Ve.SUB_START],[Xe.START_WS,Ve.WS_EVENT],[Xe.START_HD,Ve.INIT_START],[Xe.START_HD_METHOD,Ve.METHOD_START],[Xe.START_HD_EVENT,Ve.EVENT_START],[$r.INTERMEDIATE_TASK,Ve.TASK],[$r.INTERMEDIATE_WAIT,Ve.WAIT],[$r.INTERMEDIATE_THIRD_PARTY,Ve.PUZZLE],[Ha.BOUNDARY_ERROR,Ve.ERROR_EVENT],[Ha.BOUNDARY_SIGNAL,Ve.SIGNAL_EVENT],[hn.END_PAGE,Ve.END_PAGE],[hn.END_ERROR,Ve.ERROR_EVENT],[hn.END_SUB,Ve.SUB_END],[hn.END_WS,Ve.WS_EVENT],[hn.END_HD_EXIT,Ve.EXIT_END],[Hi.ALTERNATIVE,Ve.ALTERNATIVE],[Hi.SPLIT,Ve.SPLIT],[Hi.JOIN,Ve.JOIN],[Hi.TASK,Ve.TASKS],[_e.USER,Ve.USER_TASK],[_e.HD,Ve.USER_DIALOG],[_e.SCRIPT,Ve.SCRIPT],[_e.TRIGGER,Ve.TRIGGER],[_e.DB,Ve.DATABASE],[_e.SOAP,Ve.WEB_SERVICE],[_e.REST,Ve.REST_CLIENT],[_e.EMAIL,Ve.EMAIL],[_e.THIRD_PARTY,Ve.PUZZLE],[_e.THIRD_PARTY_RULE,Ve.RULE],[_e.PROGRAM,Ve.PROGRAM],[_e.BPMN_USER,Ve.USER],[_e.BPMN_MANUAL,Ve.MANUAL],[_e.BPMN_SCRIPT,Ve.SCRIPT],[_e.BPMN_SERVICE,Ve.SERVICE],[_e.BPMN_RULE,Ve.RULE],[_e.BPMN_SEND,Ve.SEND],[_e.BPMN_RECEIVE,Ve.RECEIVE]]),iW=new Map([["std:Compensation",Ve.ANGLE_DOWN],["std:Cancel",Ve.ALTERNATIVE],["std:Escalation",Ve.TRIGGER],["std:Timer",Ve.WAIT],["std:Message",Ve.EMAIL],["std:Conditional",Ve.NOTE]]),rW=e=>{if(e.includes("/faces/javax.faces.resource"))return{res:e,style:Kc.IMG};if(e.startsWith("ext:"))return{res:Ve.PUZZLE,style:Kc.SI};const n=nW.get(e);if(n)return{res:n,style:Kc.SI};const t=iW.get(e);return t?{res:t,style:Kc.SI}:tW},Qg={createElement:A.svg},oW=[_e.USER,_e.SCRIPT,_e.HD,_e.TRIGGER,_e.SUB_PROCESS];function sW(e,n){const t={height:20,width:20,x:10,y:e.bounds.height/2-10},i=fB(n,t,!1,"");if(i)return Qg.createElement("g",{"class-activity-icon":!0,"data-actitiy-type":aW(e.type)},Qg.createElement("rect",{height:30,width:30,x:5,y:e.bounds.height/2-15}),i)}const aW=e=>e.endsWith("BpmnElement")?"bpmn":oW.includes(e)?"workflow":"interface";function dB(e,n,t){const i={height:14,width:18,x:n-9,y:n-7};return fB(e,i,!0,t)}function fB(e,n,t,i){const a=rW(e);if(a.style===Kc.SI)return Qg.createElement("svg",{"class-sprotty-icon-svg":!0,viewBox:"0 0 20 20",height:n.height,width:n.width,x:n.x,y:n.y},Qg.createElement("path",{style:{fill:i},d:a.res}));if(a.style===Kc.IMG){const o=lB(`<img src="${a.res}"></img>`);return Qg.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:n.height,width:n.width,x:n.x,y:n.y,"class-sprotty-icon":!0,"class-icon-small":t},o)}}var MR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},cW=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};const Lf={createElement:A.svg};let zf=class extends A.RectangularNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var o;if(!this.isVisible(t,i))return;const a=this.getRoundedCornerRadius(t);return Lf.createElement("g",null,Lf.createElement("rect",{attrs:{[A.ATTR_BBOX_ELEMENT]:!0},"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,x:0,y:0,rx:a,ry:a,width:t.bounds.width,height:t.bounds.height,style:{stroke:t.color}}),i.renderChildren(t),sW(t,(o=this.customIconHandler)!=null&&o.isShowCustomIcons?t.customIcon:t.type),this.getNodeDecorator(t),RR(t,t.bounds.width))}getNodeDecorator(t){}getRoundedCornerRadius(t){return 5}};MR([Pe(Yo),tv(),cW("design:type",Yo)],zf.prototype,"customIconHandler",void 0);zf=MR([ue()],zf);let dE=class extends zf{getNodeDecorator(n){return Lf.createElement("svg",{x:n.bounds.width/2-6,y:n.bounds.height-12-1,height:12,width:12},Lf.createElement("rect",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,x:1,y:1,rx:2,ry:2,width:10,height:10}),Lf.createElement("line",{"class-sprotty-node-decorator":!0,x1:6,y1:3,x2:6,y2:9}),Lf.createElement("line",{"class-sprotty-node-decorator":!0,x1:3,y1:6,x2:9,y2:6}))}};dE=MR([ue()],dE);var AR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},uW=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};const fE={createElement:A.svg};let Uf=class extends A.CircularNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var o;const a=this.getRadius(t);return fE.createElement("g",null,A.hiddenBoundingRect(t,i),fE.createElement("circle",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,r:a,cx:a,cy:a,style:{stroke:t.color}}),this.getEventDecorator(a),dB((o=this.customIconHandler)!=null&&o.isShowCustomIcons?t.customIcon:t.type,a,t.color),i.renderChildren(t),RR(t,2*a))}getEventDecorator(t){}};AR([Pe(Yo),tv(),uW("design:type",Yo)],Uf.prototype,"customIconHandler",void 0);Uf=AR([ue()],Uf);let Rd=class extends Uf{getEventDecorator(n){return fE.createElement("circle",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,r:n-3,cx:n,cy:n})}};Rd=AR([ue()],Rd);var hB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},lW=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};const R8={createElement:A.svg};let wy=class extends A.DiamondNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var r;const a=new A.Diamond({height:Math.max(t.size.height,0),width:Math.max(t.size.width,0),x:0,y:0}),o=`${this.svgStr(a.topPoint)} ${this.svgStr(a.rightPoint)} ${this.svgStr(a.bottomPoint)} ${this.svgStr(a.leftPoint)}`,s=this.getRadius(t);return R8.createElement("g",null,A.hiddenBoundingRect(t,i),R8.createElement("polygon",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,points:o,style:{stroke:t.color}}),dB((r=this.customIconHandler)!=null&&r.isShowCustomIcons?t.customIcon:t.type,s,t.color),i.renderChildren(t),RR(t,Math.max(t.size.width,0)))}getRadius(t){const i=Math.min(t.size.width,t.size.height);return i>0?i/2:0}svgStr(t){return`${t.x},${t.y}`}};hB([Pe(Yo),tv(),lW("design:type",Yo)],wy.prototype,"customIconHandler",void 0);wy=hB([ue()],wy);var dW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let hE=class extends A.GLSPProjectionView{getBackgroundBounds(n,t,i){const a=super.getBackgroundBounds(n,t,i);return a.height=a.height*2,a.width=a.width*2,a}renderSvg(n,t){const i=this.edgeRouterRegistry.routeAllChildren(n),a=`scale(${n.zoom}) translate(${-n.scroll.x},${-n.scroll.y})`,o="http://www.w3.org/2000/svg";return xa("svg",{ns:o,style:{height:"100%",...this.getGridStyle(n,t)},class:{"sprotty-graph":!0}},xa("g",{ns:o,attrs:{transform:a}},[...t.renderChildren(n,{edgeRouting:i}),this.renderNegativeArea(n)]))}renderNegativeArea(n){if(A.isViewport(n.root)){const t=A.getModelBounds(n.root)??A.Bounds.EMPTY;return xa("g",{class:{"negative-area-group":!0}},[xa("rect",{attrs:{x:t.x,y:t.y,width:t.width,height:-t.y},class:{"negative-area":!0}}),xa("rect",{attrs:{x:t.x,y:0,width:-t.x,height:t.height},class:{"negative-area":!0}})])}return xa("g",{},[])}};hE=dW([ue()],hE);var wR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};const Md={createElement:A.svg};let Iy=class extends A.RectangularNodeView{render(n,t){if(this.isEmbeddedLane(n)){const i=n.isFirstChild()?4:0,a=n.isLastChild()?4:0,o=t.targetKind==="hidden"?0:1,s=`M0,0
      h${Math.max(n.size.width-i,0)}
      q${i},0 ${i},${i}
      v${Math.max(n.size.height-o-i-a,0)}
      q0,${a} -${a},${a}
      h-${Math.max(n.size.width-a,0)}
      z`;return Md.createElement("g",null,Md.createElement("path",{"class-sprotty-node":!0,"class-selected":n.selected,d:s,style:this.laneStyle(n)}),t.renderChildren(n))}return Md.createElement("g",null,Md.createElement("rect",{"class-sprotty-node":!0,"class-selected":n.selected,x:"0",y:"0",rx:"4px",ry:"4px",width:Math.max(n.size.width,0),height:Math.max(n.size.height,0),style:this.laneStyle(n)}),this.getDecoratorLine(n),t.renderChildren(n))}isEmbeddedLane(n){return n.parent instanceof $o}getDecoratorLine(n){}laneStyle(n){return n.color?{"--lane-color":n.color}:{}}};Iy=wR([ue()],Iy);let pE=class extends Iy{getDecoratorLine(n){const t=this.getPoolLaneSpace(n),i=n.size.height,a=`M${t},0 v${i} h-${t-4} q-4,0 -4,-4 v-${i-8} q0,-4 4,-4 z`;return Md.createElement("path",{"class-sprotty-node":!0,"class-pool-label-rect":!0,d:a})}laneStyle(n){return{}}getPoolLaneSpace(n){let t=24;return A.hasArgs(n)&&n.args&&(t=A.GArgument.getNumber(n,"poolLabelSpace")??24),t-1}};pE=wR([ue()],pE);let gE=class extends A.GLabelView{render(n){let t=n.bounds.height;A.isBoundsAware(n.parent)&&(t=n.parent.bounds.height);const i=`rotate(270) translate(-${t/2} ${n.bounds.width/2})`;return Md.createElement("text",{"class-sprotty-label":!0,transform:i},n.text.split(`
`).map((a,o)=>Md.createElement("tspan",{key:o,dy:o===0?0:"1.2em",x:0,style:a?{}:{visibility:"hidden"}},a||".")))}};gE=wR([ue()],gE);function fW(e){return e.replace(/[\\"&'\\/<>\n]/g,function(n){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;","\n":"<br/>"}[n]??""})}var V_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};const el={createElement:A.svg};let Jg=class{render(n,t){const i=fW(n.text),a=n.labelBounds,o=lB(`<div style="height: ${a.height}px;">${i}</div>`);return el.createElement("g",null,el.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:a.height,width:a.width,x:a.x,y:a.y,z:10,"class-sprotty-label":!0,"class-node-child-label":n.parent.type.startsWith(_e.DEFAULT)},o),t.renderChildren(n))}};Jg=V_([ue()],Jg);let mE=class extends A.PolylineEdgeViewWithGapsOnIntersections{renderLine(n,t,i){const a=super.renderLine(n,t,i,void 0);return a.data&&(a.data.style={stroke:n.color}),a}renderAdditionals(n,t,i){const a=super.renderAdditionals(n,t,i),o=this.edgePadding(n),s=o?[this.renderMouseHandle(t,o)]:[],r=t[t.length-2],d=t[t.length-1],l=el.createElement("path",{"class-sprotty-edge":!0,"class-arrow":!0,d:"M 0,0.3 L 6,-3.5 M 0,-0.3 L 6,3.5",transform:`rotate(${A.toDegrees(A.angleOfPoint({x:r.x-d.x,y:r.y-d.y}))} ${d.x} ${d.y}) translate(${d.x} ${d.y})`,style:{stroke:n.color,fill:n.color}});return a.push(...s,l),a}edgePadding(n){if(n.args)return A.EdgePadding.from(n)}renderMouseHandle(n,t){return el.createElement("path",{"class-mouse-handle":!0,d:this.createPathForSegments(n),style:{strokeWidth:`${t*2}px`,stroke:"transparent",strokeDasharray:"none",strokeDashoffset:"0"}})}createPathForSegments(n){const t=n[0];let i=`M ${t.x},${t.y}`;for(let a=1;a<n.length;a++){const o=n[a];i+=` L ${o.x},${o.y}`}return i}intersectionPath(n,t,i,a){try{return super.intersectionPath(n,t,i,a)}catch{return""}}};mE=V_([ue()],mE);let vE=class extends A.GEdgeView{renderLine(n,t,i){const a=super.renderLine(n,t,i);return a.data&&(a.data.style={stroke:n.color}),a}renderAdditionals(n,t){if(A.hasArgs(n)&&n.args){const i=A.EdgePadding.from(n);return i?[this.renderMouseHandle(t,i)]:[]}return[]}};vE=V_([ue()],vE);let yE=class extends A.GResizeHandleView{render(n,t){if(t.targetKind==="hidden")return;const i=n.parent;if(!uB(i))return super.render(n,t);const a=this.getLaneHandlePosition(n,i);return a!==void 0?this.renderLaneResizeHandle(n,a):el.createElement("g",null)}renderLaneResizeHandle(n,t){const i=n.parent.bounds.width,a=el.createElement("svg",{"class-lane-resize-handle":!0,"class-mouseover":n.hoverFeedback,x:0,y:t.y-10,width:i,height:20},el.createElement("rect",{x:0,y:0,height:20,width:i,"class-lane-resize-mouse-handle":!0}),el.createElement("line",{x1:i/2-20,y1:10,x2:i/2+20,y2:10}),";");return A.setAttr(a,"data-kind",n.location),a}getLaneHandlePosition(n,t){return n.isNResize()?{x:A.Dimension.center(t.bounds).x,y:5}:n.isSResize()?{x:A.Dimension.center(t.bounds).x,y:A.Bounds.dimension(t.bounds).height-5}:super.getPosition(n)}};yE=V_([ue()],yE);var hW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};const Kg={createElement:A.svg};let _E=class extends A.GIssueMarkerView{render(n){const t=super.getMaxSeverity(n),i=Kg.createElement("g",{"class-sprotty-issue":!0},Kg.createElement("g",null,this.getGlspIssueMarkerBackground(t),Kg.createElement("path",{d:this.getGlspIssueMarkerPath(t)})));return A.setClass(i,"sprotty-"+t,!0),i}getGlspIssueMarkerBackground(n){switch(n){case"warning":return Kg.createElement("polygon",{"class-sprotty-issue-background":!0,points:"8 0, 12 12, 0 12"});case"error":case"info":return Kg.createElement("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 6}getGlspIssueMarkerPath(n){switch(n){case"error":return"M8 2.5C4.96243 2.5 2.5 4.96243 2.5 8C2.5 11.0376 4.96243 13.5 8 13.5C11.0376 13.5 13.5 11.0376 13.5 8C13.5 4.96243 11.0376 2.5 8 2.5ZM1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8Z M6.31311 6.3131C6.50838 6.11784 6.82496 6.11784 7.02022 6.3131L8 7.29288L8.97978 6.3131C9.17504 6.11784 9.49162 6.11784 9.68689 6.3131C9.88215 6.50837 9.88215 6.82495 9.68689 7.02021L8.70711 7.99999L9.68689 8.97977C9.88215 9.17503 9.88215 9.49161 9.68689 9.68688C9.49162 9.88214 9.17504 9.88214 8.97978 9.68688L8 8.7071L7.02022 9.68688C6.82496 9.88214 6.50838 9.88214 6.31311 9.68688C6.11785 9.49161 6.11785 9.17503 6.31311 8.97977L7.29289 7.99999L6.31311 7.02021C6.11785 6.82495 6.11785 6.50837 6.31311 6.3131Z";case"warning":return"M8.00706 6.52274C8.2832 6.52274 8.50706 6.7466 8.50706 7.02274V9.50001C8.50706 9.77615 8.2832 10 8.00706 10C7.73091 10 7.50706 9.77615 7.50706 9.50001V7.02274C7.50706 6.7466 7.73091 6.52274 8.00706 6.52274ZM8.00706 10.5243C8.2832 10.5243 8.50706 10.7482 8.50706 11.0243V11.031C8.50706 11.3071 8.2832 11.531 8.00706 11.531C7.73091 11.531 7.50706 11.3071 7.50706 11.031V11.0243C7.50706 10.7482 7.73091 10.5243 8.00706 10.5243Z M7.06898 2.75412C7.35117 2.58775 7.67277 2.5 8.00035 2.5C8.32793 2.5 8.64953 2.58775 8.93172 2.75412C9.21237 2.91958 9.44384 3.1568 9.60237 3.44136L14.3352 11.6072C14.347 11.6275 14.3573 11.6487 14.3662 11.6704C14.4784 11.9478 14.521 12.2484 14.4904 12.5461C14.4597 12.8437 14.3567 13.1293 14.1903 13.378C14.0239 13.6266 13.7992 13.8308 13.5358 13.9727C13.2724 14.1146 12.9782 14.1899 12.679 14.192L12.6755 14.192H3.33854C3.32627 14.192 3.31411 14.1916 3.30207 14.1907C3.28148 14.1922 3.26058 14.1924 3.23943 14.1913C2.9473 14.1763 2.663 14.0915 2.41028 13.9442C2.15756 13.7969 1.94375 13.5913 1.7867 13.3445C1.62965 13.0977 1.53392 12.8169 1.5075 12.5256C1.48107 12.2342 1.52473 11.9408 1.63481 11.6698C1.64356 11.6482 1.6538 11.6273 1.66546 11.6072L6.39833 3.44136C6.55686 3.1568 6.78833 2.91958 7.06898 2.75412ZM3.30172 13.1933C3.31388 13.1924 3.32616 13.192 3.33854 13.192H12.6736C12.8091 13.1908 12.9422 13.1566 13.0616 13.0923C13.1813 13.0278 13.2835 12.935 13.3592 12.8219C13.4348 12.7088 13.4817 12.5789 13.4956 12.4436C13.5085 12.3186 13.4929 12.1925 13.4503 12.0746L8.72989 3.93021C8.65777 3.79988 8.55216 3.6912 8.42385 3.61555C8.29553 3.5399 8.1493 3.5 8.00035 3.5C7.8514 3.5 7.70517 3.5399 7.57686 3.61555C7.44855 3.6912 7.34284 3.79983 7.27073 3.93017L7.26591 3.93888L2.55022 12.0749C2.50836 12.19 2.49232 12.313 2.50341 12.4352C2.51542 12.5677 2.55895 12.6954 2.63036 12.8076C2.70177 12.9198 2.79899 13.0133 2.9139 13.0803C3.02881 13.1473 3.15808 13.1858 3.29092 13.1927C3.29453 13.1928 3.29813 13.1931 3.30172 13.1933Z";case"info":return"M 6.5719 0.013 A 5.9159 5.9159 90 0 1 10.2188 1.7695 A 6.1421 6.1421 90 0 1 10.619 9.9386 A 5.9594 5.9594 90 0 1 3.1546 11.4523 A 6.0899 6.0899 90 0 1 0.4402 8.4074 A 6.1943 6.1943 90 0 1 0.2401 4.3098 A 6.0899 6.0899 90 0 1 2.65 1.0126 A 5.9159 5.9159 90 0 1 6.5719 0.013 Z M 6.9825 11.1913 A 5.1242 5.1242 90 0 0 9.9491 9.3905 A 5.2808 5.2808 90 0 0 9.6011 2.3784 A 5.0633 5.0633 90 0 0 3.1372 1.7347 A 5.2721 5.2721 90 0 0 3.5722 10.6867 A 5.0546 5.0546 90 0 0 6.9825 11.1913 Z M 5.534 4.3359 H 6.6214 V 3.4659 H 5.534 Z M 6.6214 5.2059 V 8.6858 H 5.534 V 5.2059 Z"}}};_E=hW([ue()],_E);const bE=Symbol("goToFormFeature");function pW(e){return e.hasFeature(bE)}const ly=Symbol("goToSourceFeature");function gW(e){return e.hasFeature(ly)}const mW=new A.FeatureModule((e,n,t,i)=>{i(A.TYPES.ILogger).to(A.ConsoleLogger).inSingletonScope(),i(A.TYPES.LogLevel).toConstantValue(A.LogLevel.warn),e(A.TYPES.IContextMenuItemProvider).to(A.DeleteElementContextMenuItemProvider),e(A.TYPES.IMovementRestrictor).to(lE);const a={bind:e,unbind:n,isBound:t,rebind:i};A.overrideModelElement(a,A.DefaultTypes.GRAPH,A.GGraph,hE),A.overrideModelElement(a,A.DefaultTypes.ISSUE_MARKER,A.GIssueMarker,_E),o(Xe.START),o(Xe.START_ERROR),o(Xe.START_SIGNAL),o(Xe.START_PROGRAM,{enable:[ly]}),o(Xe.START_SUB),o(Xe.START_WS),o(Xe.START_HD),o(Xe.START_HD_METHOD),o(Xe.START_HD_EVENT),o(Xe.START_EMBEDDED),o(Xe.START_THIRD_PARTY),s(hn.END),s(hn.END_ERROR),s(hn.END_PAGE),s(hn.END_SUB),s(hn.END_WS),s(hn.END_HD),s(hn.END_HD_EXIT),s(hn.END_EMBEDDED),A.configureModelElement(a,$r.INTERMEDIATE_TASK,Fd,Rd),A.configureModelElement(a,$r.INTERMEDIATE_WAIT,Fd,Rd,{enable:[ly]}),A.configureModelElement(a,$r.INTERMEDIATE_THIRD_PARTY,Fd,Rd),A.configureModelElement(a,Ha.BOUNDARY_ERROR,Ff,Rd),A.configureModelElement(a,Ha.BOUNDARY_SIGNAL,Ff,Rd),r(Hi.TASK),r(Hi.JOIN,{disable:[My]}),r(Hi.SPLIT),r(Hi.ALTERNATIVE),A.configureModelElement(a,_e.LABEL,YY,Jg),A.configureModelElement(a,_e.COMMENT,UY,zf,{disable:[nv,CR,Zg]}),d(_e.GENERIC),d(_e.SCRIPT),d(_e.SOAP),d(_e.REST),d(_e.DB),d(_e.EMAIL),d(_e.THIRD_PARTY),d(_e.THIRD_PARTY_RULE),d(_e.PROGRAM,{enable:[ly]}),d(_e.TRIGGER,{enable:[uy]}),d(_e.HD,{enable:[bE]}),d(_e.USER,{enable:[oB,bE]}),l(_e.SUB_PROCESS,{enable:[uy],disable:[Zg]}),l(_e.EMBEDDED_PROCESS),l(_e.BPMN_GENERIC),l(_e.BPMN_MANUAL),l(_e.BPMN_RECEIVE),l(_e.BPMN_RULE),l(_e.BPMN_SCRIPT),l(_e.BPMN_SEND),l(_e.BPMN_SERVICE),l(_e.BPMN_USER),A.configureModelElement(a,As.LANE,$o,Iy),A.configureModelElement(a,As.POOL,$o,pE),A.configureModelElement(a,As.LABEL,cB,gE),A.overrideModelElement(a,xf.DEFAULT,dm,mE),A.configureModelElement(a,xf.ASSOCIATION,dm,vE),A.configureModelElement(a,xf.LABEL,aB,Jg,{enable:[A.selectFeature,A.moveFeature]}),A.overrideModelElement(a,lm.DEFAULT,dl,Jg,{enable:[A.selectFeature,A.moveFeature]});function o(c,u){A.configureModelElement(a,c,Ff,Uf,u)}function s(c,u){A.configureModelElement(a,c,$Y,Uf,u)}function r(c,u){A.configureModelElement(a,c,PR,wy,u)}function d(c,u){A.configureModelElement(a,c,Vd,zf,u)}function l(c,u){A.configureModelElement(a,c,Vd,dE,u||{enable:[uy,iB,My],disable:[Zg]})}});var vW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let SE=class extends A.DirectLabelEditTool{enable(){this.toDisposeOnDisable.push(this.keyTool.registerListener(this.createEditLabelKeyListener()))}};SE=vW([ue()],SE);var pB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},EE;let CE=class{handle(n){if(A.isEditLabelAction(n))return A.SetUIExtensionVisibilityAction.create({extensionId:Ty.IVY_ID,visible:!0,contextElementsId:[n.labelId]})}};CE=pB([ue()],CE);var Td;let Ty=(Td=class extends A.EditLabelUI{id(){return EE.IVY_ID}configureAndAdd(n,t){super.configureAndAdd(n,t),n.style.top="3px"}},EE=Td,x(Td,"IVY_ID","ivyEditLabelUi"),Td);Ty=EE=pB([ue()],Ty);var yW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let PE=class extends Fn{singleQuickAction(n){if(A.isWithEditableLabel(n)&&n.editableLabel)return{icon:V.Label,title:"Edit Label (L)",location:"Middle",sorting:"C",action:A.EditLabelAction.create(n.editableLabel.id),shortcut:"KeyL",letQuickActionsOpen:!0}}};PE=yW([ue()],PE);const gB=new A.FeatureModule((e,n,t)=>{A.configureCommand({bind:e,isBound:t},A.ApplyLabelEditCommand),e(A.TYPES.IEditLabelValidator).to(A.ServerEditLabelValidator),e(A.TYPES.IEditLabelValidationDecorator).to(A.BalloonLabelValidationDecorator),A.bindAsService(e,A.TYPES.IDefaultTool,SE),e($e.QuickActionProvider).to(PE)},{featureId:A.labelEditModule.featureId}),mB=new A.FeatureModule((e,n,t)=>{const i={bind:e,isBound:t};A.configureActionHandler(i,A.EditLabelAction.KIND,CE),A.bindAsService(i,A.TYPES.IUIExtension,Ty)},{featureId:A.labelEditUiModule.featureId});var vB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},yB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},_B=function(e,n){return function(t,i){n(t,i,e)}},ja,Ug,RE;(function(e){function n(t){return{kind:Dy.KIND,...t}}e.create=n})(RE||(RE={}));var Ba;let Dy=(Ba=class extends A.Command{constructor(t){super();x(this,"action");x(this,"executed",[]);x(this,"failed",[]);x(this,"lastExecutedElement");this.action=t}execute(t){var a;const i=t.root;return this.lastExecutedElement=i.index.getById(this.action.lastExecutedElementId),(a=this.action.oldElementExecutions)==null||a.forEach(o=>{const s=i.index.getById(o.elementId);if(s instanceof A.GChildElement&&Ay(s)){M8(s,0);const r=o.failed?ja.FAILED_CSS_CLASS:ja.EXECUTED_CSS_CLASS;A.removeCssClasses(s,r)}}),this.action.elementExecutions.forEach(o=>{const s=i.index.getById(o.elementId);s instanceof A.GChildElement&&Ay(s)&&(M8(s,o.count),o.failed?this.failed.push(s):this.executed.push(s))}),this.redo(t)}undo(t){return A.removeCssClassOfElements(this.executed,ja.EXECUTED_CSS_CLASS),A.removeCssClassOfElements(this.failed,ja.FAILED_CSS_CLASS),t.root}redo(t){return A.addCssClassToElements(this.executed,ja.EXECUTED_CSS_CLASS),A.addCssClassToElements(this.failed,ja.FAILED_CSS_CLASS),A.removeCssClassOfElements(this.executed,ja.LAST_EXECUTED_CSS_CLASS),this.lastExecutedElement&&A.addCssClasses(this.lastExecutedElement,ja.LAST_EXECUTED_CSS_CLASS),t.root}},ja=Ba,x(Ba,"KIND","executedFeedbackCommand"),x(Ba,"EXECUTED_CSS_CLASS","executed"),x(Ba,"LAST_EXECUTED_CSS_CLASS","last"),x(Ba,"FAILED_CSS_CLASS","failed"),Ba);Dy=ja=vB([ue(),_B(0,Pe(A.TYPES.Action)),yB("design:paramtypes",[Object])],Dy);var ME;(function(e){function n(t){return{kind:Oy.KIND,...t}}e.create=n})(ME||(ME={}));var Xu;let Oy=(Xu=class extends A.Command{constructor(t){super();x(this,"action");x(this,"stoppedElement");this.action=t}execute(t){const i=t.root,a=i.index.getById(this.action.oldStoppedElement);a instanceof A.GChildElement&&Ay(a)&&A.removeCssClasses(a,Ug.STOPPED_CSS_CLASS);const o=i.index.getById(this.action.stoppedElement??"");return o instanceof A.GChildElement&&Ay(o)&&(this.stoppedElement=o),this.redo(t)}undo(t){return A.removeCssClasses(this.stoppedElement,Ug.STOPPED_CSS_CLASS),t.root}redo(t){return A.addCssClasses(this.stoppedElement,Ug.STOPPED_CSS_CLASS),t.root}},Ug=Xu,x(Xu,"KIND","stoppedFeedbackCommand"),x(Xu,"STOPPED_CSS_CLASS","stopped"),Xu);Oy=Ug=vB([ue(),_B(0,Pe(A.TYPES.Action)),yB("design:paramtypes",[Object])],Oy);function M8(e,n){e.executionCount=n}var lf=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},ov=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Gd=class{constructor(){x(this,"feedbackDispatcher");x(this,"actionDispatcher");x(this,"modelInitializationConstraint");x(this,"oldExecutions")}handle(n){if(Sy.is(n)){const t=RE.create({oldElementExecutions:this.oldExecutions,elementExecutions:n.elementExecutions,lastExecutedElementId:n.lastExecutedElementId});this.modelInitializationConstraint.onInitialized(()=>{n.elementExecutions.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldExecutions=n.elementExecutions})}}};lf([Pe(A.TYPES.IFeedbackActionDispatcher),ov("design:type",Object)],Gd.prototype,"feedbackDispatcher",void 0);lf([Pe(A.TYPES.IActionDispatcher),ov("design:type",Object)],Gd.prototype,"actionDispatcher",void 0);lf([Pe(A.ModelInitializationConstraint),ov("design:type",A.ModelInitializationConstraint)],Gd.prototype,"modelInitializationConstraint",void 0);Gd=lf([ue()],Gd);let $f=class{constructor(){x(this,"feedbackDispatcher");x(this,"actionDispatcher");x(this,"oldStoppedElement")}handle(n){if(Ey.is(n)){const t=ME.create({oldStoppedElement:this.oldStoppedElement,stoppedElement:n.elementId});n.elementId&&n.elementId.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldStoppedElement=n.elementId??""}}};lf([Pe(A.TYPES.IFeedbackActionDispatcher),ov("design:type",Object)],$f.prototype,"feedbackDispatcher",void 0);lf([Pe(A.TYPES.IActionDispatcher),ov("design:type",Object)],$f.prototype,"actionDispatcher",void 0);$f=lf([ue()],$f);const _W=new A.FeatureModule((e,n,t)=>{e(Gd).toSelf().inSingletonScope(),e($f).toSelf().inSingletonScope(),A.configureActionHandler({bind:e,isBound:t},Sy.KIND,Gd),A.configureActionHandler({bind:e,isBound:t},Ey.KIND,$f),A.configureCommand({bind:e,isBound:t},Dy),A.configureCommand({bind:e,isBound:t},Oy)});var bB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},bW=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Ly=class extends A.GLSPCommandStack{constructor(){super(...arguments);x(this,"actionDispatcher")}undo(){return this.actionDispatcher().then(t=>t.dispatch(A.UndoAction.create())),this.thenUpdate()}redo(){return this.actionDispatcher().then(t=>t.dispatch(A.RedoAction.create())),this.thenUpdate()}};bB([Pe(A.TYPES.IActionDispatcherProvider),bW("design:type",Function)],Ly.prototype,"actionDispatcher",void 0);Ly=bB([ue()],Ly);var G_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},SB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let fm=class{constructor(){x(this,"actionDispatcher");x(this,"editorContext");x(this,"jumpStack",new Map)}handle(n){if(qd.is(n)&&!n.noViewportUpdate)return this.updateViewport(n),ht.SelectAllAction.create(!1)}updateViewport(n){const t=this.editorContext.modelRoot;if(n.elementId===""){const i=this.jumpStack.get(t.id.substring(0,t.id.lastIndexOf("-")));i&&this.actionDispatcher.dispatch(A.SetViewportAction.create(t.id,i,{animate:!1}))}else A.isViewport(t)&&this.jumpStack.set(this.editorContext.modelRoot.id,t)}};G_([Pe(A.TYPES.IActionDispatcher),SB("design:type",Object)],fm.prototype,"actionDispatcher",void 0);G_([Pe(A.EditorContextService),SB("design:type",A.EditorContextService)],fm.prototype,"editorContext",void 0);fm=G_([ue()],fm);let AE=class extends Fn{singleQuickAction(n){if(QY(n))return{icon:V.SubStart,title:"Jump (J)",location:"Middle",sorting:"A",action:qd.create({elementId:n.id}),readonlySupport:!0,shortcut:"KeyJ"}}};AE=G_([ue()],AE);function Uo(e,n){const t=e?["ivy",`ivy-${e}`]:[];return n&&t.push(...n),Ie("i",t)}function Ie(e,n,t){const i=document.createElement(e);return n&&i.classList.add(...n),t&&(i.textContent=t),i}class SW{constructor(n,t){x(this,"state");x(this,"onclick");x(this,"input");this.state=n,this.onclick=t}create(){const n=Ie("label",["switch"]);return this.input=document.createElement("input"),this.input.type="checkbox",this.input.checked=this.state,this.input.onchange=()=>{var i;const t=((i=this.input)==null?void 0:i.checked)??!this.state;this.state=t,this.onclick(t)},n.appendChild(this.input),n.appendChild(Ie("span",["slider","round"])),n}switch(){var n;this.input&&(this.input.checked=!this.state,(n=this.input)==null||n.dispatchEvent(new UIEvent("change")))}}var z_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},IR=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},dy,Dd;let qc=(Dd=class extends A.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"selectionService");x(this,"editorContext")}id(){return dy.ID}containerClass(){return"jump-out-container"}initializeContents(t){t.style.position="absolute"}onBeforeShow(t){t.innerHTML="";const i=Ie("button",["jump-out-btn"]);i.title="Jump out (J)",i.appendChild(Uo(V.JumpOut)),i.onclick=()=>this.actionDispatcher.dispatch(qd.create({elementId:""})),t.appendChild(i)}handle(t){(A.SetModelAction.is(t)||A.UpdateModelAction.is(t))&&this.actionDispatcher.dispatch(A.SetUIExtensionVisibilityAction.create({extensionId:dy.ID,visible:this.showJumpOutBtn(t.newRoot.id)}))}showJumpOutBtn(t){return t.includes("-")}},dy=Dd,x(Dd,"ID","jumpOutUi"),Dd);z_([Pe(A.TYPES.IActionDispatcher),IR("design:type",Object)],qc.prototype,"actionDispatcher",void 0);z_([Pe(A.SelectionService),IR("design:type",A.SelectionService)],qc.prototype,"selectionService",void 0);z_([Pe(A.EditorContextService),IR("design:type",A.EditorContextService)],qc.prototype,"editorContext",void 0);qc=dy=z_([ue()],qc);const EW=new A.FeatureModule((e,n,t)=>{e(qc).toSelf().inSingletonScope(),e(A.TYPES.IUIExtension).toService(qc),A.configureActionHandler({bind:e,isBound:t},A.SetModelAction.KIND,qc),A.configureActionHandler({bind:e,isBound:t},A.UpdateModelAction.KIND,qc),e($e.QuickActionProvider).to(AE),A.configureActionHandler({bind:e,isBound:t},qd.KIND,fm)});var CW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let wE=class extends Fn{singleQuickAction(n){if(n instanceof $o&&n.type===As.POOL)return{icon:V.LaneSwimlanes,title:"Create Lane",location:"Right",sorting:"A",letQuickActionsOpen:!0,action:A.CreateNodeOperation.create(As.LANE,{containerId:n.id})}}};wE=CW([ue()],wE);const EB=new A.FeatureModule(e=>{e($e.QuickActionProvider).to(wE)});var fy={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */var PW=fy.exports,A8;function RW(){return A8||(A8=1,function(e){(function(n,t){e.exports?e.exports=t():n.Toastify=t()})(PW,function(n){var t=function(s){return new t.lib.init(s)},i="1.12.0";t.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},t.lib=t.prototype={toastify:i,constructor:t,init:function(s){return s||(s={}),this.options={},this.toastElement=null,this.options.text=s.text||t.defaults.text,this.options.node=s.node||t.defaults.node,this.options.duration=s.duration===0?0:s.duration||t.defaults.duration,this.options.selector=s.selector||t.defaults.selector,this.options.callback=s.callback||t.defaults.callback,this.options.destination=s.destination||t.defaults.destination,this.options.newWindow=s.newWindow||t.defaults.newWindow,this.options.close=s.close||t.defaults.close,this.options.gravity=s.gravity==="bottom"?"toastify-bottom":t.defaults.gravity,this.options.positionLeft=s.positionLeft||t.defaults.positionLeft,this.options.position=s.position||t.defaults.position,this.options.backgroundColor=s.backgroundColor||t.defaults.backgroundColor,this.options.avatar=s.avatar||t.defaults.avatar,this.options.className=s.className||t.defaults.className,this.options.stopOnFocus=s.stopOnFocus===void 0?t.defaults.stopOnFocus:s.stopOnFocus,this.options.onClick=s.onClick||t.defaults.onClick,this.options.offset=s.offset||t.defaults.offset,this.options.escapeMarkup=s.escapeMarkup!==void 0?s.escapeMarkup:t.defaults.escapeMarkup,this.options.ariaLive=s.ariaLive||t.defaults.ariaLive,this.options.style=s.style||t.defaults.style,s.backgroundColor&&(this.options.style.background=s.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var s=document.createElement("div");s.className="toastify on "+this.options.className,this.options.position?s.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(s.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):s.className+=" toastify-right",s.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var r in this.options.style)s.style[r]=this.options.style[r];if(this.options.ariaLive&&s.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)s.appendChild(this.options.node);else if(this.options.escapeMarkup?s.innerText=this.options.text:s.innerHTML=this.options.text,this.options.avatar!==""){var d=document.createElement("img");d.src=this.options.avatar,d.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?s.appendChild(d):s.insertAdjacentElement("afterbegin",d)}if(this.options.close===!0){var l=document.createElement("button");l.type="button",l.setAttribute("aria-label","Close"),l.className="toast-close",l.innerHTML="&#10006;",l.addEventListener("click",(function(m){m.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var c=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&c>360?s.insertAdjacentElement("afterbegin",l):s.appendChild(l)}if(this.options.stopOnFocus&&this.options.duration>0){var u=this;s.addEventListener("mouseover",function(m){window.clearTimeout(s.timeOutValue)}),s.addEventListener("mouseleave",function(){s.timeOutValue=window.setTimeout(function(){u.removeElement(s)},u.options.duration)})}if(typeof this.options.destination<"u"&&s.addEventListener("click",(function(m){m.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&s.addEventListener("click",(function(m){m.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var f=a("x",this.options),h=a("y",this.options),p=this.options.position=="left"?f:"-"+f,g=this.options.gravity=="toastify-top"?h:"-"+h;s.style.transform="translate("+p+","+g+")"}return s},showToast:function(){this.toastElement=this.buildToast();var s;if(typeof this.options.selector=="string"?s=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?s=this.options.selector:s=document.body,!s)throw"Root element is not defined";var r=t.defaults.oldestFirst?s.firstChild:s.lastChild;return s.insertBefore(this.toastElement,r),t.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(s){s.className=s.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),s.parentNode&&s.parentNode.removeChild(s),this.options.callback.call(s),t.reposition()}).bind(this),400)}},t.reposition=function(){for(var s={top:15,bottom:15},r={top:15,bottom:15},d={top:15,bottom:15},l=document.getElementsByClassName("toastify"),c,u=0;u<l.length;u++){o(l[u],"toastify-top")===!0?c="toastify-top":c="toastify-bottom";var f=l[u].offsetHeight;c=c.substr(9,c.length-1);var h=15,p=window.innerWidth>0?window.innerWidth:screen.width;p<=360?(l[u].style[c]=d[c]+"px",d[c]+=f+h):o(l[u],"toastify-left")===!0?(l[u].style[c]=s[c]+"px",s[c]+=f+h):(l[u].style[c]=r[c]+"px",r[c]+=f+h)}return this};function a(s,r){return r.offset[s]?isNaN(r.offset[s])?r.offset[s]:r.offset[s]+"px":"0px"}function o(s,r){return!s||typeof r!="string"?!1:!!(s.className&&s.className.trim().split(/\s+/gi).indexOf(r)>-1)}return t.lib.init.prototype=t.lib,t})}(fy)),fy.exports}var MW=RW();const CB=V8(MW);var AW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let Qu=class{constructor(){x(this,"duration",2e3);x(this,"messageToast");x(this,"progressMessages",new Map)}handle(n){if(A.MessageAction.is(n))return this.updateToast(n.message,n.severity);if(A.StartProgressAction.is(n))return this.updateToast(this.progress(n),"INFO");if(A.UpdateProgressAction.is(n))return this.updateToast(this.progress(n),"INFO");if(A.EndProgressAction.is(n))return this.updateToast(this.progress(n),"NONE")}progress(n){A.StartProgressAction.is(n)&&this.progressMessages.set(n.progressId,n.title);let t=this.progressMessages.get(n.progressId)??"";n.message&&(t+=t.length>0?`${t}: ${n.message}`:n.message);const i=A.EndProgressAction.is(n)?void 0:n.percentage;return i&&i>0&&(t+=t.length>0?`${t} (${i}%)`:`${i}%`),A.EndProgressAction.is(n)&&this.progressMessages.delete(n.progressId),t}message(n){var t;(t=this.messageToast)==null||t.hideToast(),n.severity!=="NONE"&&(this.messageToast=this.createToast(n.message,n.severity),this.messageToast.showToast())}updateToast(n,t){var i;(i=this.messageToast)==null||i.hideToast(),t!=="NONE"&&(this.messageToast=this.createToast(n,t),this.messageToast.showToast())}createToast(n,t){return CB({text:n,close:!0,gravity:"bottom",position:"left",className:`severity-${t}`,duration:t==="ERROR"?void 0:this.duration})}};Qu=AW([ue()],Qu);const wW=new A.FeatureModule((e,n,t,i)=>{const a={bind:e,unbind:n,isBound:t,rebind:i};e(Qu).toSelf().inSingletonScope(),A.configureActionHandler(a,A.StatusAction.KIND,Qu),A.configureActionHandler(a,A.MessageAction.KIND,Qu),A.configureActionHandler(a,A.StartProgressAction.KIND,Qu),A.configureActionHandler(a,A.UpdateProgressAction.KIND,Qu),A.configureActionHandler(a,A.EndProgressAction.KIND,Qu)});var IW=$c();const TW=()=>({hideSensitiveInfo:!1});function DW(e,n){const t=e.get($e.IvyViewerOptions);return IW.safeAssign(t,n),t}function PB(e){if(!e.source||!e.target)return e.bounds;const n=e.source,t=e.target,i=[],a={x:0,y:0,width:0,height:0};i.push(A.Bounds.translate(a,A.Bounds.center(n.bounds))),i.push(...e.routingPoints.map(r=>A.Bounds.translate(a,{x:r.x,y:r.y}))),i.push(A.Bounds.translate(a,A.Bounds.center(t.bounds)));let o=i.reduce((r,d)=>A.Bounds.combine(r,d)),s=e;for(;s instanceof A.GChildElement;){const r=s.parent;o=r.localToParent(o),s=r}return o}function OW(e){let n=A.Bounds.translate(e.labelBounds,e.position),t=e;for(;t instanceof A.GChildElement;){const i=t.parent;n=i.localToParent(n),t=i}return n}var LW=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let IE=class extends A.GLSPSvgExporter{getBounds(n){const t=[];return n.index.all().filter(i=>i.root!==i).filter(i=>!(i instanceof cB)).forEach(i=>{i instanceof A.GNode&&t.push(A.getAbsoluteBounds(i)),i instanceof dl&&i.text.length>0&&t.push(OW(i)),i instanceof A.GEdge&&t.push(PB(i))}),t.filter(A.Bounds.isValid).reduce(A.Bounds.combine)}};IE=LW([ue()],IE);function TR(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let df=TR();function RB(e){df=e}const Xg={exec:()=>null};function bt(e,n=""){let t=typeof e=="string"?e:e.source;const i={replace:(a,o)=>{let s=typeof o=="string"?o:o.source;return s=s.replace(Vi.caret,"$1"),t=t.replace(a,s),i},getRegex:()=>new RegExp(t,n)};return i}const Vi={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[   ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[  ][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},jW=/^(?:[ \t]*(?:\n|$))+/,NW=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,BW=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,sv=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,xW=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,DR=/(?:[*+-]|\d{1,9}[.)])/,MB=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,AB=bt(MB).replace(/bull/g,DR).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),FW=bt(MB).replace(/bull/g,DR).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),OR=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kW=/^[^\n]+/,LR=/(?!\s*\])(?:\\.|[^\[\]\\])+/,KW=bt(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",LR).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),qW=bt(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,DR).getRegex(),U_="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",jR=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,HW=bt("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[   ]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[   ]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[   ]*)+\\n|$))","i").replace("comment",jR).replace("tag",U_).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),wB=bt(OR).replace("hr",sv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U_).getRegex(),VW=bt(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",wB).getRegex(),NR={blockquote:VW,code:NW,def:KW,fences:BW,heading:xW,hr:sv,html:HW,lheading:AB,list:qW,newline:jW,paragraph:wB,table:Xg,text:kW},w8=bt("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",sv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}  )[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U_).getRegex(),GW={...NR,lheading:FW,table:w8,paragraph:bt(OR).replace("hr",sv).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",w8).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U_).getRegex()},zW={...NR,html:bt(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",jR).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Xg,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:bt(OR).replace("hr",sv).replace("heading",` *#{1,6} *[^
]`).replace("lheading",AB).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},UW=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,$W=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,IB=/^( {2,}|\\)\n(?!\s*$)/,YW=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,$_=/[\p{P}\p{S}]/u,BR=/[\s\p{P}\p{S}]/u,TB=/[^\s\p{P}\p{S}]/u,WW=bt(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,BR).getRegex(),DB=/(?!~)[\p{P}\p{S}]/u,ZW=/(?!~)[\s\p{P}\p{S}]/u,QW=/(?:[^\s\p{P}\p{S}]|~)/u,JW=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,OB=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,XW=bt(OB,"u").replace(/punct/g,$_).getRegex(),eZ=bt(OB,"u").replace(/punct/g,DB).getRegex(),LB="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",tZ=bt(LB,"gu").replace(/notPunctSpace/g,TB).replace(/punctSpace/g,BR).replace(/punct/g,$_).getRegex(),nZ=bt(LB,"gu").replace(/notPunctSpace/g,QW).replace(/punctSpace/g,ZW).replace(/punct/g,DB).getRegex(),iZ=bt("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,TB).replace(/punctSpace/g,BR).replace(/punct/g,$_).getRegex(),rZ=bt(/\\(punct)/,"gu").replace(/punct/g,$_).getRegex(),oZ=bt(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),sZ=bt(jR).replace("(?:-->|$)","-->").getRegex(),aZ=bt("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",sZ).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),jy=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,cZ=bt(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",jy).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),jB=bt(/^!?\[(label)\]\[(ref)\]/).replace("label",jy).replace("ref",LR).getRegex(),NB=bt(/^!?\[(ref)\](?:\[\])?/).replace("ref",LR).getRegex(),uZ=bt("reflink|nolink(?!\\()","g").replace("reflink",jB).replace("nolink",NB).getRegex(),xR={_backpedal:Xg,anyPunctuation:rZ,autolink:oZ,blockSkip:JW,br:IB,code:$W,del:Xg,emStrongLDelim:XW,emStrongRDelimAst:tZ,emStrongRDelimUnd:iZ,escape:UW,link:cZ,nolink:NB,punctuation:WW,reflink:jB,reflinkSearch:uZ,tag:aZ,text:YW,url:Xg},lZ={...xR,link:bt(/^!?\[(label)\]\((.*?)\)/).replace("label",jy).getRegex(),reflink:bt(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",jy).getRegex()},TE={...xR,emStrongRDelimAst:nZ,emStrongLDelim:eZ,url:bt(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},dZ={...TE,br:bt(IB).replace("{2,}","*").getRegex(),text:bt(TE.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ty={normal:NR,gfm:GW,pedantic:zW},qg={normal:xR,gfm:TE,breaks:dZ,pedantic:lZ},fZ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},I8=e=>fZ[e];function Na(e,n){if(n){if(Vi.escapeTest.test(e))return e.replace(Vi.escapeReplace,I8)}else if(Vi.escapeTestNoEncode.test(e))return e.replace(Vi.escapeReplaceNoEncode,I8);return e}function T8(e){try{e=encodeURI(e).replace(Vi.percentDecode,"%")}catch{return null}return e}function D8(e,n){var o;const t=e.replace(Vi.findPipe,(s,r,d)=>{let l=!1,c=r;for(;--c>=0&&d[c]==="\\";)l=!l;return l?"|":" |"}),i=t.split(Vi.splitPipe);let a=0;if(i[0].trim()||i.shift(),i.length>0&&!((o=i.at(-1))!=null&&o.trim())&&i.pop(),n)if(i.length>n)i.splice(n);else for(;i.length<n;)i.push("");for(;a<i.length;a++)i[a]=i[a].trim().replace(Vi.slashPipe,"|");return i}function Hg(e,n,t){const i=e.length;if(i===0)return"";let a=0;for(;a<i&&e.charAt(i-a-1)===n;)a++;return e.slice(0,i-a)}function hZ(e,n){if(e.indexOf(n[1])===-1)return-1;let t=0;for(let i=0;i<e.length;i++)if(e[i]==="\\")i++;else if(e[i]===n[0])t++;else if(e[i]===n[1]&&(t--,t<0))return i;return-1}function O8(e,n,t,i,a){const o=n.href,s=n.title||null,r=e[1].replace(a.other.outputLinkReplace,"$1");if(e[0].charAt(0)!=="!"){i.state.inLink=!0;const d={type:"link",raw:t,href:o,title:s,text:r,tokens:i.inlineTokens(r)};return i.state.inLink=!1,d}return{type:"image",raw:t,href:o,title:s,text:r}}function pZ(e,n,t){const i=e.match(t.other.indentCodeCompensation);if(i===null)return n;const a=i[1];return n.split(`
`).map(o=>{const s=o.match(t.other.beginningSpace);if(s===null)return o;const[r]=s;return r.length>=a.length?o.slice(a.length):o}).join(`
`)}class Ny{constructor(n){x(this,"options");x(this,"rules");x(this,"lexer");this.options=n||df}space(n){const t=this.rules.block.newline.exec(n);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(n){const t=this.rules.block.code.exec(n);if(t){const i=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?i:Hg(i,`
`)}}}fences(n){const t=this.rules.block.fences.exec(n);if(t){const i=t[0],a=pZ(i,t[3]||"",this.rules);return{type:"code",raw:i,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:a}}}heading(n){const t=this.rules.block.heading.exec(n);if(t){let i=t[2].trim();if(this.rules.other.endingHash.test(i)){const a=Hg(i,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(i=a.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:i,tokens:this.lexer.inline(i)}}}hr(n){const t=this.rules.block.hr.exec(n);if(t)return{type:"hr",raw:Hg(t[0],`
`)}}blockquote(n){const t=this.rules.block.blockquote.exec(n);if(t){let i=Hg(t[0],`
`).split(`
`),a="",o="";const s=[];for(;i.length>0;){let r=!1;const d=[];let l;for(l=0;l<i.length;l++)if(this.rules.other.blockquoteStart.test(i[l]))d.push(i[l]),r=!0;else if(!r)d.push(i[l]);else break;i=i.slice(l);const c=d.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${c}`:c,o=o?`${o}
${u}`:u;const f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=f,i.length===0)break;const h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const p=h,g=p.raw+`
`+i.join(`
`),m=this.blockquote(g);s[s.length-1]=m,a=a.substring(0,a.length-p.raw.length)+m.raw,o=o.substring(0,o.length-p.text.length)+m.text;break}else if((h==null?void 0:h.type)==="list"){const p=h,g=p.raw+`
`+i.join(`
`),m=this.list(g);s[s.length-1]=m,a=a.substring(0,a.length-h.raw.length)+m.raw,o=o.substring(0,o.length-p.raw.length)+m.raw,i=g.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:s,text:o}}}list(n){let t=this.rules.block.list.exec(n);if(t){let i=t[1].trim();const a=i.length>1,o={type:"list",raw:"",ordered:a,start:a?+i.slice(0,-1):"",loose:!1,items:[]};i=a?`\\d{1,9}\\${i.slice(-1)}`:`\\${i}`,this.options.pedantic&&(i=a?i:"[*+-]");const s=this.rules.other.listItemRegex(i);let r=!1;for(;n;){let l=!1,c="",u="";if(!(t=s.exec(n))||this.rules.block.hr.test(n))break;c=t[0],n=n.substring(c.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,_=>" ".repeat(3*_.length)),h=n.split(`
`,1)[0],p=!f.trim(),g=0;if(this.options.pedantic?(g=2,u=f.trimStart()):p?g=t[1].length+1:(g=t[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,u=f.slice(g),g+=t[1].length),p&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,n=n.substring(h.length+1),l=!0),!l){const _=this.rules.other.nextBulletRegex(g),S=this.rules.other.hrRegex(g),E=this.rules.other.fencesBeginRegex(g),C=this.rules.other.headingBeginRegex(g),M=this.rules.other.htmlBeginRegex(g);for(;n;){const L=n.split(`
`,1)[0];let I;if(h=L,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),I=h):I=h.replace(this.rules.other.tabCharGlobal,"    "),E.test(h)||C.test(h)||M.test(h)||_.test(h)||S.test(h))break;if(I.search(this.rules.other.nonSpaceChar)>=g||!h.trim())u+=`
`+I.slice(g);else{if(p||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(f)||C.test(f)||S.test(f))break;u+=`
`+h}!p&&!h.trim()&&(p=!0),c+=L+`
`,n=n.substring(L.length+1),f=I.slice(g)}}o.loose||(r?o.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(r=!0));let m=null,v;this.options.gfm&&(m=this.rules.other.listIsTask.exec(u),m&&(v=m[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:c,task:!!m,checked:v,loose:!1,text:u,tokens:[]}),o.raw+=c}const d=o.items.at(-1);if(d)d.raw=d.raw.trimEnd(),d.text=d.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let l=0;l<o.items.length;l++)if(this.lexer.state.top=!1,o.items[l].tokens=this.lexer.blockTokens(o.items[l].text,[]),!o.loose){const c=o.items[l].tokens.filter(f=>f.type==="space"),u=c.length>0&&c.some(f=>this.rules.other.anyLine.test(f.raw));o.loose=u}if(o.loose)for(let l=0;l<o.items.length;l++)o.items[l].loose=!0;return o}}html(n){const t=this.rules.block.html.exec(n);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(n){const t=this.rules.block.def.exec(n);if(t){const i=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:i,raw:t[0],href:a,title:o}}}table(n){var r;const t=this.rules.block.table.exec(n);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const i=D8(t[1]),a=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(r=t[3])!=null&&r.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(i.length===a.length){for(const d of a)this.rules.other.tableAlignRight.test(d)?s.align.push("right"):this.rules.other.tableAlignCenter.test(d)?s.align.push("center"):this.rules.other.tableAlignLeft.test(d)?s.align.push("left"):s.align.push(null);for(let d=0;d<i.length;d++)s.header.push({text:i[d],tokens:this.lexer.inline(i[d]),header:!0,align:s.align[d]});for(const d of o)s.rows.push(D8(d,s.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[c]})));return s}}lheading(n){const t=this.rules.block.lheading.exec(n);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(n){const t=this.rules.block.paragraph.exec(n);if(t){const i=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:i,tokens:this.lexer.inline(i)}}}text(n){const t=this.rules.block.text.exec(n);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(n){const t=this.rules.inline.escape.exec(n);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(n){const t=this.rules.inline.tag.exec(n);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(n){const t=this.rules.inline.link.exec(n);if(t){const i=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(i)){if(!this.rules.other.endAngleBracket.test(i))return;const s=Hg(i.slice(0,-1),"\\");if((i.length-s.length)%2===0)return}else{const s=hZ(t[2],"()");if(s>-1){const d=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,d).trim(),t[3]=""}}let a=t[2],o="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(a);s&&(a=s[1],o=s[3])}else o=t[3]?t[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(i)?a=a.slice(1):a=a.slice(1,-1)),O8(t,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(n,t){let i;if((i=this.rules.inline.reflink.exec(n))||(i=this.rules.inline.nolink.exec(n))){const a=(i[2]||i[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=t[a.toLowerCase()];if(!o){const s=i[0].charAt(0);return{type:"text",raw:s,text:s}}return O8(i,o,i[0],this.lexer,this.rules)}}emStrong(n,t,i=""){let a=this.rules.inline.emStrongLDelim.exec(n);if(!a||a[3]&&i.match(this.rules.other.unicodeAlphaNumeric))return;if(!(a[1]||a[2]||"")||!i||this.rules.inline.punctuation.exec(i)){const s=[...a[0]].length-1;let r,d,l=s,c=0;const u=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*n.length+s);(a=u.exec(t))!=null;){if(r=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!r)continue;if(d=[...r].length,a[3]||a[4]){l+=d;continue}else if((a[5]||a[6])&&s%3&&!((s+d)%3)){c+=d;continue}if(l-=d,l>0)continue;d=Math.min(d,d+l+c);const f=[...a[0]][0].length,h=n.slice(0,s+a.index+f+d);if(Math.min(s,d)%2){const g=h.slice(1,-1);return{type:"em",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(n){const t=this.rules.inline.code.exec(n);if(t){let i=t[2].replace(this.rules.other.newLineCharGlobal," ");const a=this.rules.other.nonSpaceChar.test(i),o=this.rules.other.startingSpaceChar.test(i)&&this.rules.other.endingSpaceChar.test(i);return a&&o&&(i=i.substring(1,i.length-1)),{type:"codespan",raw:t[0],text:i}}}br(n){const t=this.rules.inline.br.exec(n);if(t)return{type:"br",raw:t[0]}}del(n){const t=this.rules.inline.del.exec(n);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(n){const t=this.rules.inline.autolink.exec(n);if(t){let i,a;return t[2]==="@"?(i=t[1],a="mailto:"+i):(i=t[1],a=i),{type:"link",raw:t[0],text:i,href:a,tokens:[{type:"text",raw:i,text:i}]}}}url(n){var i;let t;if(t=this.rules.inline.url.exec(n)){let a,o;if(t[2]==="@")a=t[0],o="mailto:"+a;else{let s;do s=t[0],t[0]=((i=this.rules.inline._backpedal.exec(t[0]))==null?void 0:i[0])??"";while(s!==t[0]);a=t[0],t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:a,href:o,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(n){const t=this.rules.inline.text.exec(n);if(t){const i=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:i}}}}class Go{constructor(n){x(this,"tokens");x(this,"options");x(this,"state");x(this,"tokenizer");x(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=n||df,this.options.tokenizer=this.options.tokenizer||new Ny,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={other:Vi,block:ty.normal,inline:qg.normal};this.options.pedantic?(t.block=ty.pedantic,t.inline=qg.pedantic):this.options.gfm&&(t.block=ty.gfm,this.options.breaks?t.inline=qg.breaks:t.inline=qg.gfm),this.tokenizer.rules=t}static get rules(){return{block:ty,inline:qg}}static lex(n,t){return new Go(t).lex(n)}static lexInline(n,t){return new Go(t).inlineTokens(n)}lex(n){n=n.replace(Vi.carriageReturn,`
`),this.blockTokens(n,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const i=this.inlineQueue[t];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(n,t=[],i=!1){var a,o,s;for(this.options.pedantic&&(n=n.replace(Vi.tabCharGlobal,"    ").replace(Vi.spaceLine,""));n;){let r;if((o=(a=this.options.extensions)==null?void 0:a.block)!=null&&o.some(l=>(r=l.call({lexer:this},n,t))?(n=n.substring(r.raw.length),t.push(r),!0):!1))continue;if(r=this.tokenizer.space(n)){n=n.substring(r.raw.length);const l=t.at(-1);r.raw.length===1&&l!==void 0?l.raw+=`
`:t.push(r);continue}if(r=this.tokenizer.code(n)){n=n.substring(r.raw.length);const l=t.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.at(-1).src=l.text):t.push(r);continue}if(r=this.tokenizer.fences(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(n)){n=n.substring(r.raw.length);const l=t.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title});continue}if(r=this.tokenizer.table(n)){n=n.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(n)){n=n.substring(r.raw.length),t.push(r);continue}let d=n;if((s=this.options.extensions)!=null&&s.startBlock){let l=1/0;const c=n.slice(1);let u;this.options.extensions.startBlock.forEach(f=>{u=f.call({lexer:this},c),typeof u=="number"&&u>=0&&(l=Math.min(l,u))}),l<1/0&&l>=0&&(d=n.substring(0,l+1))}if(this.state.top&&(r=this.tokenizer.paragraph(d))){const l=t.at(-1);i&&(l==null?void 0:l.type)==="paragraph"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(r),i=d.length!==n.length,n=n.substring(r.raw.length);continue}if(r=this.tokenizer.text(n)){n=n.substring(r.raw.length);const l=t.at(-1);(l==null?void 0:l.type)==="text"?(l.raw+=`
`+r.raw,l.text+=`
`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(r);continue}if(n){const l="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(n,t=[]){return this.inlineQueue.push({src:n,tokens:t}),t}inlineTokens(n,t=[]){var r,d,l;let i=n,a=null;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,a.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o=!1,s="";for(;n;){o||(s=""),o=!1;let c;if((d=(r=this.options.extensions)==null?void 0:r.inline)!=null&&d.some(f=>(c=f.call({lexer:this},n,t))?(n=n.substring(c.raw.length),t.push(c),!0):!1))continue;if(c=this.tokenizer.escape(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.tag(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.link(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.reflink(n,this.tokens.links)){n=n.substring(c.raw.length);const f=t.at(-1);c.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=c.raw,f.text+=c.text):t.push(c);continue}if(c=this.tokenizer.emStrong(n,i,s)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.codespan(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.br(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.del(n)){n=n.substring(c.raw.length),t.push(c);continue}if(c=this.tokenizer.autolink(n)){n=n.substring(c.raw.length),t.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(n))){n=n.substring(c.raw.length),t.push(c);continue}let u=n;if((l=this.options.extensions)!=null&&l.startInline){let f=1/0;const h=n.slice(1);let p;this.options.extensions.startInline.forEach(g=>{p=g.call({lexer:this},h),typeof p=="number"&&p>=0&&(f=Math.min(f,p))}),f<1/0&&f>=0&&(u=n.substring(0,f+1))}if(c=this.tokenizer.inlineText(u)){n=n.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(s=c.raw.slice(-1)),o=!0;const f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=c.raw,f.text+=c.text):t.push(c);continue}if(n){const f="Infinite loop on byte: "+n.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return t}}class By{constructor(n){x(this,"options");x(this,"parser");this.options=n||df}space(n){return""}code({text:n,lang:t,escaped:i}){var s;const a=(s=(t||"").match(Vi.notSpaceStart))==null?void 0:s[0],o=n.replace(Vi.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Na(a)+'">'+(i?o:Na(o,!0))+`</code></pre>
`:"<pre><code>"+(i?o:Na(o,!0))+`</code></pre>
`}blockquote({tokens:n}){return`<blockquote>
${this.parser.parse(n)}</blockquote>
`}html({text:n}){return n}heading({tokens:n,depth:t}){return`<h${t}>${this.parser.parseInline(n)}</h${t}>
`}hr(n){return`<hr>
`}list(n){const t=n.ordered,i=n.start;let a="";for(let r=0;r<n.items.length;r++){const d=n.items[r];a+=this.listitem(d)}const o=t?"ol":"ul",s=t&&i!==1?' start="'+i+'"':"";return"<"+o+s+`>
`+a+"</"+o+`>
`}listitem(n){var i;let t="";if(n.task){const a=this.checkbox({checked:!!n.checked});n.loose?((i=n.tokens[0])==null?void 0:i.type)==="paragraph"?(n.tokens[0].text=a+" "+n.tokens[0].text,n.tokens[0].tokens&&n.tokens[0].tokens.length>0&&n.tokens[0].tokens[0].type==="text"&&(n.tokens[0].tokens[0].text=a+" "+Na(n.tokens[0].tokens[0].text),n.tokens[0].tokens[0].escaped=!0)):n.tokens.unshift({type:"text",raw:a+" ",text:a+" ",escaped:!0}):t+=a+" "}return t+=this.parser.parse(n.tokens,!!n.loose),`<li>${t}</li>
`}checkbox({checked:n}){return"<input "+(n?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:n}){return`<p>${this.parser.parseInline(n)}</p>
`}table(n){let t="",i="";for(let o=0;o<n.header.length;o++)i+=this.tablecell(n.header[o]);t+=this.tablerow({text:i});let a="";for(let o=0;o<n.rows.length;o++){const s=n.rows[o];i="";for(let r=0;r<s.length;r++)i+=this.tablecell(s[r]);a+=this.tablerow({text:i})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+a+`</table>
`}tablerow({text:n}){return`<tr>
${n}</tr>
`}tablecell(n){const t=this.parser.parseInline(n.tokens),i=n.header?"th":"td";return(n.align?`<${i} align="${n.align}">`:`<${i}>`)+t+`</${i}>
`}strong({tokens:n}){return`<strong>${this.parser.parseInline(n)}</strong>`}em({tokens:n}){return`<em>${this.parser.parseInline(n)}</em>`}codespan({text:n}){return`<code>${Na(n,!0)}</code>`}br(n){return"<br>"}del({tokens:n}){return`<del>${this.parser.parseInline(n)}</del>`}link({href:n,title:t,tokens:i}){const a=this.parser.parseInline(i),o=T8(n);if(o===null)return a;n=o;let s='<a href="'+n+'"';return t&&(s+=' title="'+Na(t)+'"'),s+=">"+a+"</a>",s}image({href:n,title:t,text:i}){const a=T8(n);if(a===null)return Na(i);n=a;let o=`<img src="${n}" alt="${i}"`;return t&&(o+=` title="${Na(t)}"`),o+=">",o}text(n){return"tokens"in n&&n.tokens?this.parser.parseInline(n.tokens):"escaped"in n&&n.escaped?n.text:Na(n.text)}}class FR{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}}class zo{constructor(n){x(this,"options");x(this,"renderer");x(this,"textRenderer");this.options=n||df,this.options.renderer=this.options.renderer||new By,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new FR}static parse(n,t){return new zo(t).parse(n)}static parseInline(n,t){return new zo(t).parseInline(n)}parse(n,t=!0){var a,o;let i="";for(let s=0;s<n.length;s++){const r=n[s];if((o=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&o[r.type]){const l=r,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){i+=c||"";continue}}const d=r;switch(d.type){case"space":{i+=this.renderer.space(d);continue}case"hr":{i+=this.renderer.hr(d);continue}case"heading":{i+=this.renderer.heading(d);continue}case"code":{i+=this.renderer.code(d);continue}case"table":{i+=this.renderer.table(d);continue}case"blockquote":{i+=this.renderer.blockquote(d);continue}case"list":{i+=this.renderer.list(d);continue}case"html":{i+=this.renderer.html(d);continue}case"paragraph":{i+=this.renderer.paragraph(d);continue}case"text":{let l=d,c=this.renderer.text(l);for(;s+1<n.length&&n[s+1].type==="text";)l=n[++s],c+=`
`+this.renderer.text(l);t?i+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):i+=c;continue}default:{const l='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return i}parseInline(n,t=this.renderer){var a,o;let i="";for(let s=0;s<n.length;s++){const r=n[s];if((o=(a=this.options.extensions)==null?void 0:a.renderers)!=null&&o[r.type]){const l=this.options.extensions.renderers[r.type].call({parser:this},r);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){i+=l||"";continue}}const d=r;switch(d.type){case"escape":{i+=t.text(d);break}case"html":{i+=t.html(d);break}case"link":{i+=t.link(d);break}case"image":{i+=t.image(d);break}case"strong":{i+=t.strong(d);break}case"em":{i+=t.em(d);break}case"codespan":{i+=t.codespan(d);break}case"br":{i+=t.br(d);break}case"del":{i+=t.del(d);break}case"text":{i+=t.text(d);break}default:{const l='Token with "'+d.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return i}}class em{constructor(n){x(this,"options");x(this,"block");this.options=n||df}preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?Go.lex:Go.lexInline}provideParser(){return this.block?zo.parse:zo.parseInline}}x(em,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));class gZ{constructor(...n){x(this,"defaults",TR());x(this,"options",this.setOptions);x(this,"parse",this.parseMarkdown(!0));x(this,"parseInline",this.parseMarkdown(!1));x(this,"Parser",zo);x(this,"Renderer",By);x(this,"TextRenderer",FR);x(this,"Lexer",Go);x(this,"Tokenizer",Ny);x(this,"Hooks",em);this.use(...n)}walkTokens(n,t){var a,o;let i=[];for(const s of n)switch(i=i.concat(t.call(this,s)),s.type){case"table":{const r=s;for(const d of r.header)i=i.concat(this.walkTokens(d.tokens,t));for(const d of r.rows)for(const l of d)i=i.concat(this.walkTokens(l.tokens,t));break}case"list":{const r=s;i=i.concat(this.walkTokens(r.items,t));break}default:{const r=s;(o=(a=this.defaults.extensions)==null?void 0:a.childTokens)!=null&&o[r.type]?this.defaults.extensions.childTokens[r.type].forEach(d=>{const l=r[d].flat(1/0);i=i.concat(this.walkTokens(l,t))}):r.tokens&&(i=i.concat(this.walkTokens(r.tokens,t)))}}return i}use(...n){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(i=>{const a={...i};if(a.async=this.defaults.async||a.async||!1,i.extensions&&(i.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const s=t.renderers[o.name];s?t.renderers[o.name]=function(...r){let d=o.renderer.apply(this,r);return d===!1&&(d=s.apply(this,r)),d}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=t[o.level];s?s.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),a.extensions=t),i.renderer){const o=this.defaults.renderer||new By(this.defaults);for(const s in i.renderer){if(!(s in o))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const r=s,d=i.renderer[r],l=o[r];o[r]=(...c)=>{let u=d.apply(o,c);return u===!1&&(u=l.apply(o,c)),u||""}}a.renderer=o}if(i.tokenizer){const o=this.defaults.tokenizer||new Ny(this.defaults);for(const s in i.tokenizer){if(!(s in o))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const r=s,d=i.tokenizer[r],l=o[r];o[r]=(...c)=>{let u=d.apply(o,c);return u===!1&&(u=l.apply(o,c)),u}}a.tokenizer=o}if(i.hooks){const o=this.defaults.hooks||new em;for(const s in i.hooks){if(!(s in o))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const r=s,d=i.hooks[r],l=o[r];em.passThroughHooks.has(s)?o[r]=c=>{if(this.defaults.async)return Promise.resolve(d.call(o,c)).then(f=>l.call(o,f));const u=d.call(o,c);return l.call(o,u)}:o[r]=(...c)=>{let u=d.apply(o,c);return u===!1&&(u=l.apply(o,c)),u}}a.hooks=o}if(i.walkTokens){const o=this.defaults.walkTokens,s=i.walkTokens;a.walkTokens=function(r){let d=[];return d.push(s.call(this,r)),o&&(d=d.concat(o.call(this,r))),d}}this.defaults={...this.defaults,...a}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,t){return Go.lex(n,t??this.defaults)}parser(n,t){return zo.parse(n,t??this.defaults)}parseMarkdown(n){return(i,a)=>{const o={...a},s={...this.defaults,...o},r=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&o.async===!1)return r(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof i>"u"||i===null)return r(new Error("marked(): input parameter is undefined or null"));if(typeof i!="string")return r(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=n);const d=s.hooks?s.hooks.provideLexer():n?Go.lex:Go.lexInline,l=s.hooks?s.hooks.provideParser():n?zo.parse:zo.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(i):i).then(c=>d(c,s)).then(c=>s.hooks?s.hooks.processAllTokens(c):c).then(c=>s.walkTokens?Promise.all(this.walkTokens(c,s.walkTokens)).then(()=>c):c).then(c=>l(c,s)).then(c=>s.hooks?s.hooks.postprocess(c):c).catch(r);try{s.hooks&&(i=s.hooks.preprocess(i));let c=d(i,s);s.hooks&&(c=s.hooks.processAllTokens(c)),s.walkTokens&&this.walkTokens(c,s.walkTokens);let u=l(c,s);return s.hooks&&(u=s.hooks.postprocess(u)),u}catch(c){return r(c)}}}onError(n,t){return i=>{if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,n){const a="<p>An error occurred:</p><pre>"+Na(i.message+"",!0)+"</pre>";return t?Promise.resolve(a):a}if(t)return Promise.reject(i);throw i}}}const zd=new gZ;function Mt(e,n){return zd.parse(e,n)}Mt.options=Mt.setOptions=function(e){return zd.setOptions(e),Mt.defaults=zd.defaults,RB(Mt.defaults),Mt};Mt.getDefaults=TR;Mt.defaults=df;Mt.use=function(...e){return zd.use(...e),Mt.defaults=zd.defaults,RB(Mt.defaults),Mt};Mt.walkTokens=function(e,n){return zd.walkTokens(e,n)};Mt.parseInline=zd.parseInline;Mt.Parser=zo;Mt.parser=zo.parse;Mt.Renderer=By;Mt.TextRenderer=FR;Mt.Lexer=Go;Mt.lexer=Go.lex;Mt.Tokenizer=Ny;Mt.Hooks=em;Mt.parse=Mt;Mt.options;Mt.setOptions;Mt.use;Mt.walkTokens;Mt.parseInline;zo.parse;Go.lex;var Fa=Ua();const ny=new Map([[Xe.START,V.Start],[Xe.START_SIGNAL,V.StartSignalOutline],[Xe.START_PROGRAM,V.StartProgramOutline],[Xe.START_ERROR,V.ErrorStart],[Xe.START_SUB,V.SubStartOutline],[Xe.START_WS,V.WsStartOutline],[Xe.START_HD,V.InitStartOutline],[Xe.START_HD_METHOD,V.MethodStartOutline],[Xe.START_HD_EVENT,V.EventStartOutline],[Xe.START_THIRD_PARTY,V.Extension],[$r.INTERMEDIATE_TASK,V.TaskDoubleOutline],[$r.INTERMEDIATE_WAIT,V.ClockOutline],[$r.INTERMEDIATE_THIRD_PARTY,V.Extension],[Ha.BOUNDARY_ERROR,V.ErrorStart],[Ha.BOUNDARY_SIGNAL,V.StartSignalOutline],[hn.END,V.ProcessEnd],[hn.END_PAGE,V.EndPageOutline],[hn.END_ERROR,V.ErrorEnd],[hn.END_SUB,V.SubEndOutline],[hn.END_WS,V.WsStartOutline],[hn.END_HD,V.ProcessEnd],[hn.END_HD_EXIT,V.ExitEndOutline],[Hi.ALTERNATIVE,V.AlternativeGateways],[Hi.SPLIT,V.JoinGateways],[Hi.JOIN,V.JoinGateways],[Hi.TASK,V.JoinTasksGateways],[_e.USER,V.UserTaskOutline],[_e.HD,V.UserDialogOutline],[_e.SCRIPT,V.ScriptFileOutline],[_e.EMBEDDED_PROCESS,V.SubActivitiesDashed],[_e.SUB_PROCESS,V.SubActivities],[_e.TRIGGER,V.TriggerOutline],[_e.DB,V.DatabaseOutline],[_e.SOAP,V.WebService],[_e.REST,V.RestClientOutline],[_e.EMAIL,V.EMailOutline],[_e.THIRD_PARTY,V.Extension],[_e.THIRD_PARTY_RULE,V.RuleOutline],[_e.PROGRAM,V.ProgramOutline],[_e.BPMN_GENERIC,V.SubActivitiesDashed],[_e.BPMN_USER,V.SubUserOutline],[_e.BPMN_MANUAL,V.SubManualOutline],[_e.BPMN_SCRIPT,V.SubScriptOutline],[_e.BPMN_SERVICE,V.SubWebService],[_e.BPMN_RULE,V.SubRuleOutline],[_e.BPMN_SEND,V.SubSendOutline],[_e.BPMN_RECEIVE,V.SubReceiveOutline],[_e.COMMENT,V.NoteOutline],[As.POOL,V.PoolSwimlanes],[As.LANE,V.LaneSwimlanes]]);class mZ{constructor(){x(this,"menuCssClass",["bar-menu","simple-menu"]);x(this,"bodyDiv")}create(n){return this.bodyDiv=Ie("div",this.menuCssClass),n.appendChild(this.bodyDiv),this.createMenuBody(this.bodyDiv),this.bodyDiv}remove(){var n;(n=this.bodyDiv)==null||n.remove()}}const Ur=class Ur{constructor(n,t,i){x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu"]);x(this,"paletteItemsCopy",[]);x(this,"bodyDiv");x(this,"searchField");x(this,"itemsDiv");this.actionDispatcher=n,this.action=t,this.paletteItems=i,this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))}create(n){return this.bodyDiv=Ie("div",this.menuCssClass),n.appendChild(this.bodyDiv),this.action.customCssClass&&this.bodyDiv.classList.add(this.action.customCssClass),this.action.showSearch&&this.bodyDiv.appendChild(this.createPaletteItemSearchField()),this.createItemsDiv(this.bodyDiv),this.appendMenuParts(this.bodyDiv),this.bodyDiv}remove(){var n;(n=this.bodyDiv)==null||n.remove()}appendMenuParts(n){}createPaletteItemSearchField(){const n=Ie("div",["bar-menu-search"]);return n.appendChild(Uo(V.Search)),this.searchField=Ie("input",["menu-search-input"]),this.searchField.type="text",this.searchField.placeholder="Search",this.searchField.onkeyup=t=>this.filterKeyUp(t),this.searchField.onkeydown=t=>this.clearSearchInputOnEscape(t),setTimeout(()=>{var t;return(t=this.searchField)==null?void 0:t.focus()},1),n.appendChild(this.searchField),n}filterKeyUp(n){var t;Fa.matchesKeystroke(n,"ArrowUp")||Fa.matchesKeystroke(n,"ArrowLeft")?this.navigateUpOrDown(-1):Fa.matchesKeystroke(n,"ArrowDown")||Fa.matchesKeystroke(n,"ArrowRight")?this.navigateUpOrDown(1):Fa.matchesKeystroke(n,"Enter")?this.triggerItem():this.requestFilterUpdate(((t=this.searchField)==null?void 0:t.value)??"")}clearSearchInputOnEscape(n){Fa.matchesKeystroke(n,"Escape")&&this.searchField&&(this.searchField.value="",this.requestFilterUpdate(""))}requestFilterUpdate(n){this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const t=[];for(const i of this.paletteItems)if(i.children){const a=i.children.filter(o=>o.label.toLowerCase().includes(n.toLowerCase()));a.length>0&&(i.children.splice(0,i.children.length),a.forEach(o=>i.children.push(o)),t.push(i))}this.paletteItems=t,this.bodyDiv&&this.createItemsDiv(this.bodyDiv)}navigateUpOrDown(n){if(this.itemsDiv){const t=Array.from(this.itemsDiv.querySelectorAll(`.${Ur.ITEM_BUTTON}`)),i=t.filter(s=>s.classList.contains(Ur.ACTIVE_ELEMENT))[0];let a=t.indexOf(i)+n;a<0?a=t.length-1:a>=t.length&&(a=0);const o=t[a];this.focusButton(o),o==null||o.scrollIntoView({behavior:"instant",block:"end",inline:"end"})}}triggerItem(){const n=this.currentItem();n==null||n.click()}createItemsDiv(n){const t=Ie("div",["bar-menu-items"]);let i=0;if(this.paletteItems.sort(A.compare).forEach(a=>{if(a.children){const o=this.createToolGroup(t,a);a.children.sort(A.compare).forEach(s=>o.appendChild(this.createToolButton(s,i++))),this.appendItemToGroup(o)}}),this.paletteItems.length===0){const a=Ie("div");a.innerText="No results found.",a.classList.add("no-result"),t.appendChild(a)}this.itemsDiv&&n.removeChild(this.itemsDiv),n.appendChild(t),this.itemsDiv=t,this.navigateUpOrDown(1)}appendItemToGroup(n){}createToolGroup(n,t){const i=Ie("div",[Ur.ITEM_GROUP]);i.id=t.id,n.appendChild(i);const a=Ie("div",["menu-group-header"]);a.textContent=t.label,i.appendChild(a);const o=Ie("div",["menu-group-items"]);return i.appendChild(o),i.appendChild(Ie("div",["menu-group-divider"])),o}createToolButton(n,t){const i=Ie("div",[Ur.ITEM_BUTTON]);i.tabIndex=t;const a=Ie("div",["menu-item-icon"]);a.appendChild(this.appendPaletteIcon(n)),i.appendChild(a);const o=Ie("div",["menu-item-text"]);return o.appendChild(Ie("span",["menu-item-label"],n.label)),"info"in n&&typeof n.info=="string"&&o.appendChild(Ie("span",["menu-item-info"],n.info)),i.appendChild(o),i.onclick=()=>this.actionDispatcher.dispatchAll(this.toolButtonOnClick(n)),i.onmouseenter=()=>this.focusButton(i),"description"in n&&typeof n.description=="string"&&n.description!=="undefined"?i.title=n.description:i.title=n.label,this.appendToToolButton(o,n),i}appendToToolButton(n,t){}focusButton(n){var t;(t=this.currentItem())==null||t.classList.remove(Ur.ACTIVE_ELEMENT),n==null||n.classList.add(Ur.ACTIVE_ELEMENT)}currentItem(){var n;return(n=this.itemsDiv)==null?void 0:n.querySelector(`.${Ur.ITEM_BUTTON}.${Ur.ACTIVE_ELEMENT}`)}appendPaletteIcon(n){if(!n.icon)return Uo();const t=this.resolveIcon(n.icon);if(t)return Uo(t);const i=Ie("img");return i.src=n.icon,i}resolveIcon(n){return n.startsWith(_e.THIRD_PARTY)?ny.get(_e.THIRD_PARTY):n.startsWith(Xe.START_THIRD_PARTY)?ny.get(Xe.START_THIRD_PARTY):n.startsWith($r.INTERMEDIATE_THIRD_PARTY)?ny.get($r.INTERMEDIATE_THIRD_PARTY):ny.get(n)}};x(Ur,"ACTIVE_ELEMENT","focus"),x(Ur,"ITEM_GROUP","menu-group"),x(Ur,"ITEM_BUTTON","menu-item");let hm=Ur;class vZ{constructor(n,t,i){x(this,"actionDispatcher");x(this,"elementIds");x(this,"editUi");x(this,"item");x(this,"colorNameInput");x(this,"colorInput");x(this,"colorPickerInput");x(this,"colorPickerDecorator");x(this,"deleteBtn");this.actionDispatcher=n,this.elementIds=t,this.editUi=this.createEditUi(i)}showEditUi(n){this.item=n,this.setInputValue(this.colorNameInput,n==null?void 0:n.label),this.setInputValue(this.colorInput,n==null?void 0:n.icon),this.setInputValue(this.colorPickerInput,n==null?void 0:n.icon),this.colorPickerDecorator&&(this.colorPickerDecorator.style.backgroundColor=(n==null?void 0:n.icon)??""),this.deleteBtn&&(this.deleteBtn.style.display=n?"block":"none"),this.editUi.style.display="block"}setInputValue(n,t){n&&(n.value=t??"")}createEditUi(n){const t=Ie("div",["edit-color"]);return t.appendChild(this.createBody()),t.appendChild(this.createFooter()),n.appendChild(t),t}createBody(){const n=Ie("div",["edit-color-body"]),[t,i]=this.createInput("Name",this.colorNameInput);n.appendChild(t),this.colorNameInput=i;const[a,o]=this.createInput("Color",this.colorInput,!0);return n.appendChild(a),this.colorInput=o,n}createInput(n,t,i=!1){const a=`input-${n}`,o=Ie("div",["edit-color-input"]),s=Ie("label");if(s.htmlFor=a,s.textContent=n,o.appendChild(s),t=document.createElement("input"),t.name=n,t.id=a,i){const r=Ie("div",["color-picker"]);this.colorPickerDecorator=Ie("span",["decorator"]);const d=document.createElement("input");this.colorPickerDecorator.onclick=()=>d.click(),d.type="color",d.onchange=l=>this.colorInputChange(l.target),d.onchange=l=>this.colorInputChange(l.target),this.colorPickerInput=d,r.appendChild(this.colorPickerDecorator),r.appendChild(d),r.appendChild(t),o.appendChild(r)}else o.appendChild(t);return[o,t]}colorInputChange(n){if(n instanceof HTMLInputElement&&this.colorPickerInput&&this.colorPickerDecorator&&this.colorInput){const t=n.value;this.colorPickerInput.value=t,this.colorPickerDecorator.style.backgroundColor=t,this.colorInput.value=t}}createFooter(){const n=Ie("footer",["edit-color-footer"]);this.deleteBtn=Ie("button",["edit-color-delete"]),this.deleteBtn.textContent="Delete",this.deleteBtn.autofocus=!0,this.deleteBtn.type="button",this.deleteBtn.onclick=()=>this.deleteColor();const t=Ie("button",["edit-color-save"]);return t.textContent="Save",t.type="button",t.onclick=()=>this.validateInputsAndRun(()=>this.changeColor()),n.appendChild(this.deleteBtn),n.appendChild(t),n}validateInputsAndRun(n){const t=this.validateInput(this.colorNameInput),i=this.validateInput(this.colorInput);t&&i&&n()}validateInput(n){if(n){if(n.value==="")return n.classList.add("error"),!1;n.classList.remove("error")}return!0}deleteColor(){this.item&&this.actionDispatcher.dispatch(om.deleteColor({elementIds:this.elementIds,oldColor:this.item.label}))}changeColor(){var i,a;const n=((i=this.colorNameInput)==null?void 0:i.value)??"",t=((a=this.colorInput)==null?void 0:a.value)??"";this.actionDispatcher.dispatch(om.create({elementIds:this.elementIds,color:t,colorName:n}))}}var ws;(function(e){e.KIND="showQuickActionMenu";function n(a){return{kind:e.KIND,...a}}e.create=n;function t(){return n({elementIds:[],paletteItems:()=>[],actions:()=>[]})}e.empty=t;function i(a){return A.Action.hasKind(a,e.KIND)}e.is=i})(ws||(ws={}));class yZ extends hm{constructor(t,i,a){super(t,i,a);x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu","quick-action-bar-menu"]);x(this,"editUi");this.actionDispatcher=t,this.action=i,this.paletteItems=a}appendMenuParts(t){this.action.isEditable&&(this.editUi=new vZ(this.actionDispatcher,this.action.elementIds,t))}remove(){var t;(t=this.bodyDiv)==null||t.remove()}appendItemToGroup(t){if(this.action.isEditable){const i=Ie("div",[hm.ITEM_BUTTON,"new-color-btn"]);i.appendChild(Ie("span",["new-color-icon","ivy",`ivy-${V.Plus}`])),i.insertAdjacentText("beforeend","New Color"),i.onclick=()=>{var a;return(a=this.editUi)==null?void 0:a.showEditUi()},i.onmouseenter=()=>this.focusButton(i),t.appendChild(i)}}toolButtonOnClick(t){return this.action.actions(t,this.action.elementIds)}appendToToolButton(t,i){this.action.isEditable&&i.label!=="default"&&t.appendChild(this.createEditButton(i))}createEditButton(t){const i=Uo(V.Edit,["color-edit-button"]);return i.title="Edit Color",i.onclick=a=>{var o;a.stopPropagation(),(o=this.editUi)==null||o.showEditUi(t)},i}appendPaletteIcon(t){if(this.action.isEditable)if(t.icon&&t.icon.length>0){const i=Ie("span",["color-icon"]);return i.style.backgroundColor=t.icon,i}else return Ie("span",["empty-icon"]);return super.appendPaletteIcon(t)}}var Yf;(function(e){e.KIND="showSimpleQuickActionMenu";function n(i){return{kind:e.KIND,...i}}e.create=n;function t(i){return A.Action.hasKind(i,e.KIND)}e.is=t})(Yf||(Yf={}));class _Z extends mZ{constructor(t){super();x(this,"action");this.action=t}createMenuBody(t){const i=Ie("div",["bar-menu-text"]);if(t.appendChild(i),this.action.title&&i.appendChild(this.createTitle(this.action.title)),this.action.markers.forEach(a=>i.appendChild(this.createMarker(a))),this.action.text&&i.appendChild(this.createDescription(this.action.text)),this.action.info)for(const[a,o]of Object.entries(this.action.info))i.appendChild(this.addInfo(a,o));i.appendChild(this.createInfo("PID",this.action.elementId))}addInfo(t,i){switch(i.type){case"STRING":return this.createInfo(t,i.value);case"CODE":return this.createCodeInfo(t,i.value)}}createTitle(t){const i=Ie("p",["simple-menu-header"]);return i.textContent=t,i}createCodeInfo(t,i){const a=Ie("p",["simple-menu-text","simple-menu-small"]),o=Ie("strong");o.textContent=`${t}: `,a.prepend(o);const s=Ie("pre");return s.textContent=i,a.appendChild(s),a}createInfo(t,i){const a=Ie("p",["simple-menu-text","simple-menu-small"]),o=Ie("strong");return a.textContent=i,o.textContent=`${t}: `,a.prepend(o),a}createDescription(t){const i=Mt.parse(t,{async:!1,breaks:!0}),a=document.createElement("template");a.innerHTML=i;const o=Ie("div",["simple-menu-text"]);for(const s of a.content.childNodes)o.appendChild(s);return o}createMarker(t){const i=Ie("div",["menu-marker"]);return t.issues.forEach(a=>i.appendChild(this.createIssue(a))),i}createIssue(t){const i=Ie("div",["menu-issue"]),a=Ie("div",["menu-issue-title"]);a.appendChild(Uo(this.ivyIconForSeverity(t.severity)));const o=Ie("span");o.textContent=t.severity==="error"?"Error":"Caution",a.appendChild(o),i.appendChild(a);const s=Ie("p",["menu-issue-message"]);return s.textContent=t.message,i.appendChild(s),i}ivyIconForSeverity(t){switch(t){case"info":return V.InfoCircle;case"warning":return V.Caution;case"error":return V.ErrorXMark}}}const BB=16,bZ=(e,n,t=16)=>{let i=e.width/2;const a=e.x+e.width+t-i;a>n.width&&(i+=a-n.width);const o=e.x-t;i>o&&(i=o);let s=BB;const r=e.y+e.height+s-t;return r>n.height&&(s-=r-n.height),{left:-i,top:s}},SZ=(e,n)=>{if(e.y!==n.height+BB)return{top:-n.height-e.height+n.y}};var ff=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},il=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},zr,Od;let _t=(Od=class extends A.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"activeQuickActions",[]);x(this,"activeQuickActionBtn");x(this,"quickActionBar");x(this,"quickActionMenu");x(this,"resizeObserver");x(this,"actionDispatcherProvider");x(this,"selectionService");x(this,"mouseTool");x(this,"editorContext");x(this,"quickActionProviders")}id(){return zr.ID}init(){this.selectionService.onSelectionChanged(t=>this.selectionChanged(t.root,t.selectedElements)),this.mouseTool.register(new EZ(this)),this.resizeObserver=new ResizeObserver(t=>{t.length===1&&t[0].target instanceof HTMLElement&&zr.shiftMenu(t[0].target,this.quickActionBar)})}containerClass(){return"quick-actions-container"}getActiveQuickActions(){return this.activeQuickActions}initializeContents(t){t.style.position="absolute",t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}selectionChanged(t,i){var a;(a=this.editorContext.modelRoot.cssClasses)!=null&&a.includes(A.CursorCSS.MARQUEE)||i.length<1?this.hideUi():this.showUi()}handle(t){ws.is(t)&&this.showItemMenu(t),Yf.is(t)&&this.showSimpleMenu(t),A.RemoveMarqueeAction.is(t)&&this.editorContext.selectedElements.length>0&&this.showUi()}showSimpleMenu(t){this.removeMenu(),this.quickActionMenu=new _Z(t),this.createMenu(this.quickActionMenu)}async showItemMenu(t){this.removeMenu(),t.elementIds.length>0?(this.quickActionMenu=new yZ(await this.actionDispatcherProvider(),t,t.paletteItems()),this.createMenu(this.quickActionMenu)):this.setActiveQuickActionBtn()}createMenu(t){var i;if(this.quickActionBar){const a=t.create(this.containerElement);a.offsetWidth>this.quickActionBar.offsetWidth?(a.classList.add("border-radius"),this.quickActionBar.classList.add("no-bottom-border-radius"),zr.shiftBar(a,this.getParentContainer(),8)):zr.shiftBar(a,this.getParentContainer(),24),zr.shiftMenu(a,this.quickActionBar),(i=this.resizeObserver)==null||i.observe(a)}}removeMenu(){var t,i;(t=this.quickActionMenu)==null||t.remove(),this.quickActionMenu=void 0,(i=this.resizeObserver)==null||i.disconnect()}showUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(A.SetUIExtensionVisibilityAction.create({extensionId:zr.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]})))}hideUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(A.SetUIExtensionVisibilityAction.create({extensionId:zr.ID,visible:!1})))}onBeforeShow(t,i,...a){t.innerHTML="";const o=CZ(a,i),s=o.filter(r=>!(r instanceof A.GRoutableElement)||!(r instanceof dm));if(s.length>1)this.showMultiQuickActionUi(t,s);else if(o.length===1&&o[0]instanceof A.GEdge&&sB(o[0]))this.showEdgeQuickActionUi(t,o[0]);else{const r=PZ(s);this.showSingleQuickActionUi(t,r)}}showMultiQuickActionUi(t,i){if(this.activeQuickActions=this.loadMultiQuickActions(i),this.activeQuickActions.length===0)return;const a=i.filter(o=>!(o instanceof aB)).map(A.getAbsoluteBounds).filter(A.Bounds.isValid).reduce(A.Bounds.combine);this.quickActionBar=this.createQuickActionsBar(t,a,!0),this.createQuickActions(this.quickActionBar,this.activeQuickActions),zr.shiftBar(this.quickActionBar,this.getParentContainer())}showSingleQuickActionUi(t,i){if(A.isNotUndefined(i)){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;this.quickActionBar=this.createQuickActionsBar(t,A.getAbsoluteBounds(i)),this.createQuickActions(this.quickActionBar,this.activeQuickActions),zr.shiftBar(this.quickActionBar,this.getParentContainer())}}showEdgeQuickActionUi(t,i){if(A.isNotUndefined(i)&&!i.id.endsWith("_feedback_edge")&&i.source&&i.target){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;const a=PB(i);this.quickActionBar=this.createQuickActionsBar(t,a),this.createQuickActions(this.quickActionBar,this.activeQuickActions),zr.shiftBar(this.quickActionBar,this.getParentContainer())}}static shiftBar(t,i,a=16){if(i===null)return;const o=bZ(t.getBoundingClientRect(),{width:i.offsetWidth,height:i.offsetHeight},a);t.style.left=`${o.left}px`,t.style.top=`${o.top}px`}static shiftMenu(t,i){if(!i)return;const a=SZ({height:t.getBoundingClientRect().height,y:t.offsetTop},{height:i==null?void 0:i.getBoundingClientRect().height,y:i.offsetTop});a&&(t.style.top=`${a.top}px`)}createQuickActionsBar(t,i,a=!1){if(t.style.left=`${i.x+i.width/2}px`,t.style.top=`${i.y+i.height}px`,a){const s=Ie("div",["multi-selection-box"]);s.style.marginLeft=`-${i.width/2}px`,s.style.marginTop=`-${i.height}px`,s.style.height=`${i.height+10}px`,s.style.width=`${i.width+10}px`,t.appendChild(s)}const o=Ie("div",["quick-actions-bar"]);return t.appendChild(o),o}createQuickActions(t,i){this.createQuickActionGroup(t,i,"Left"),this.createQuickActionGroup(t,i,"Middle"),this.createQuickActionGroup(t,i,"Right"),this.setContainerVisible(!0)}createQuickActionGroup(t,i,a){const o=Ie("div",["quick-actions-group"]);i.filter(s=>s.location===a).sort((s,r)=>s.sorting.localeCompare(r.sorting)).forEach(s=>{o.appendChild(this.createQuickActionBtn(s))}),o.children.length>0&&t.appendChild(o)}createQuickActionBtn(t){const i=Ie("button");i.appendChild(Uo(t.icon)),i.title=t.title;const a=[t.action];return t.letQuickActionsOpen||a.push(A.SetUIExtensionVisibilityAction.create({extensionId:zr.ID,visible:!1})),t.removeSelection&&a.push(A.SelectAllAction.create(!1)),i.onclick=()=>this.triggerQuickActionBtn(i,a),i}triggerQuickActionBtn(t,i){this.activeQuickActionBtn===t&&this.quickActionMenu?(this.setActiveQuickActionBtn(),this.removeMenu()):(this.setActiveQuickActionBtn(t),this.actionDispatcherProvider().then(a=>a.dispatchAll(i)))}setActiveQuickActionBtn(t){var i,a;(i=this.activeQuickActionBtn)==null||i.classList.remove("active"),this.activeQuickActionBtn=t,(a=this.activeQuickActionBtn)==null||a.classList.add("active")}loadSingleQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.singleQuickAction(t)))}loadMultiQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.multiQuickAction(t)))}filterQuickActions(t){return t.filter(A.isNotUndefined).filter(i=>!this.isReadonly()||i.readonlySupport)}isReadonly(){return this.editorContext.isReadonly}},zr=Od,x(Od,"ID","quickActionsUi"),Od);ff([Pe(A.TYPES.IActionDispatcherProvider),il("design:type",Function)],_t.prototype,"actionDispatcherProvider",void 0);ff([Pe(A.SelectionService),il("design:type",A.SelectionService)],_t.prototype,"selectionService",void 0);ff([Pe(A.GLSPMouseTool),il("design:type",A.GLSPMouseTool)],_t.prototype,"mouseTool",void 0);ff([Pe(A.EditorContextService),il("design:type",A.EditorContextService)],_t.prototype,"editorContext",void 0);ff([eB($e.QuickActionProvider),il("design:type",Array)],_t.prototype,"quickActionProviders",void 0);ff([_R(),il("design:type",Function),il("design:paramtypes",[]),il("design:returntype",void 0)],_t.prototype,"init",null);_t=zr=ff([ue()],_t);class EZ extends A.MouseListener{constructor(t){super();x(this,"quickActionUi");this.quickActionUi=t}wheel(){return this.quickActionUi.showUi(),[]}}function CZ(e,n){return e.map(t=>n.index.getById(t)).filter(A.isNotUndefined).filter(t=>!(t instanceof A.GLabel))}function PZ(e){return e.filter(sB)[0]}var xB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},RZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let xy=class extends A.ChangeBoundsManager{constructor(){super(...arguments);x(this,"selectionService")}addMoveFeedback(t,i,a,o){return super.addMoveFeedback(t,i,a,o),this.hideQuickUIFeedback(t),t}addResizeFeedback(t,i,a,o){return super.addResizeFeedback(t,i,a,o),this.hideQuickUIFeedback(t),t}hideQuickUIFeedback(t){t.add(A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!1}),A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}))}};xB([Pe(A.SelectionService),RZ("design:type",A.SelectionService)],xy.prototype,"selectionService",void 0);xy=xB([ue()],xy);var MZ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let DE=class extends A.RankedSelectMouseListener{mouseUp(n,t){return this.isMouseDown?super.mouseUp(n,t):[]}};DE=MZ([ue()],DE);var AZ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let OE=class extends A.ChangeBoundsTool{createChangeBoundsListener(){return new wZ(this)}};OE=AZ([ue()],OE);class wZ extends A.ChangeBoundsListener{mouseDown(n,t){return this.activeResizeElement&&this.activeResizeElement instanceof $o?[]:super.mouseDown(n,t)}resizeBoundsAction(n){const t=n.elementResizes.filter(i=>i.valid.size);return this.isLaneMove(n,t)&&this.changeLaneResizeToMove(t[0]),A.SetBoundsFeedbackAction.create(t.map(i=>this.toElementAndBounds(i)))}isLaneMove(n,t){return t.length===1&&t[0].element instanceof $o&&n.handleMove.element.location===A.ResizeHandleLocation.Top}changeLaneResizeToMove(n){n.toBounds={...n.fromBounds,...A.Bounds.position(n.toBounds)}}}const FB=new A.FeatureModule((e,n,t,i)=>{const a={bind:e,unbind:n,isBound:t,rebind:i};A.configureCommand(a,A.ShowChangeBoundsToolResizeFeedbackCommand),A.configureCommand(a,A.HideChangeBoundsToolResizeFeedbackCommand),A.bindAsService(a,A.TYPES.IChangeBoundsManager,xy),A.bindAsService(a,A.TYPES.IDefaultTool,OE),A.configureView(a,A.GResizeHandle.TYPE,yE)},{featureId:A.changeBoundsToolModule.featureId}),IZ=new A.FeatureModule((e,n,t)=>{const i={bind:e,isBound:t};A.bindAsService(i,A.TYPES.HiddenVNodePostprocessor,A.ExportSvgPostprocessor),A.configureCommand(i,A.ExportSvgCommand),A.bindAsService(i,A.TYPES.SvgExporter,IE)},{featureId:A.exportModule.featureId}),TZ=new A.FeatureModule((e,n,t)=>{const i={bind:e,isBound:t};A.configureCommand(i,A.SelectCommand),A.configureCommand(i,A.SelectAllCommand),A.configureCommand(i,A.SelectFeedbackCommand),A.bindAsService(i,A.TYPES.MouseListener,DE)},{featureId:A.selectModule.featureId});var kB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},DZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let tl=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(n){qa.is(n)&&this.updateColorPalette(),_y.is(n)&&(this.paletteItems=n.paletteItems,this.actionDispatcher.dispatch(ws.empty()))}async updateColorPalette(){this.actionDispatcher.request(A.RequestContextActions.create({contextId:"ivy-tool-color-palette",editorContext:{selectedElementIds:[]}})).then(n=>{A.SetContextActions.is(n)&&(this.paletteItems=n.actions.map(t=>t))})}};kB([Pe(A.TYPES.IActionDispatcher),DZ("design:type",Object)],tl.prototype,"actionDispatcher",void 0);tl=kB([ue()],tl);var kR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},KB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let pm=class{constructor(){x(this,"colors");x(this,"actionDispatcher");x(this,"actions",(n,t)=>[om.changeColor({elementIds:t,color:n.icon??"",colorName:n.label})])}singleQuickAction(n){if(n.type!==As.POOL)return this.quickAction([n.id],()=>this.colors.getPaletteItems())}multiQuickAction(n){return this.quickAction(n.map(t=>t.id),()=>this.colors.getPaletteItems())}quickAction(n,t){return{icon:V.ColorDrop,title:"Select color",location:"Middle",sorting:"Z",action:ws.create({elementIds:n,paletteItems:t,actions:this.actions,customCssClass:"colors-menu",isEditable:!0}),letQuickActionsOpen:!0,readonlySupport:!1}}};kR([Pe($e.ColorPalette),KB("design:type",tl)],pm.prototype,"colors",void 0);kR([Pe(A.TYPES.IActionDispatcher),KB("design:type",Object)],pm.prototype,"actionDispatcher",void 0);pm=kR([ue()],pm);var KR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},qB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Wf=class extends Fn{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"options")}singleQuickAction(t){if(!(t instanceof $o||this.options.hideSensitiveInfo&&t instanceof A.GEdge))return{icon:V.InfoCircle,title:"Information (I)",location:"Left",sorting:"B",action:Yf.create({elementId:t.id,markers:this.markers(t),title:this.name(t),text:A.hasArgs(t)&&t.args?A.GArgument.getString(t,"desc"):"",info:this.info(t)}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyI"}}info(t){return A.hasArgs(t)&&t.args?t.args.info:void 0}name(t){var o;let i="";A.isWithEditableLabel(t)&&t.editableLabel&&(i=(o=t.editableLabel)==null?void 0:o.text);const a=this.nameAddition(t);return a&&(i+=a),i.length>0?i.trim():void 0}nameAddition(t){if(A.hasArgs(t)&&t.args){const i=A.GArgument.getString(t,"varName");if(i)return` [${i}]`;const a=A.GArgument.getString(t,"outerElement");if(a)return` [${a}]`}}markers(t){return t instanceof A.GChildElement?t.children.filter(i=>i instanceof A.GIssueMarker).map(i=>i):[]}};KR([Pe(A.TYPES.IActionDispatcher),qB("design:type",Object)],Wf.prototype,"actionDispatcher",void 0);KR([Pe($e.IvyViewerOptions),qB("design:type",Object)],Wf.prototype,"options",void 0);Wf=KR([ue()],Wf);var OZ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},LE;let Ud=LE=class{theme(){return document.documentElement.dataset.theme??LE.prefsColorScheme()}handle(n){if(Kf.is(n)){const t=document.documentElement;t.dataset.theme=n.theme,t.classList.remove("light","dark"),t.classList.add(n.theme)}}static prefsColorScheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}};Ud=LE=OZ([ue()],Ud);var gm;(function(e){e.KIND="showToolBarOptionsMenu";function n(i){return{kind:e.KIND,id:"options_menu",...i}}e.create=n;function t(i){return A.Action.hasKind(i,e.KIND)}e.is=t})(gm||(gm={}));var Y_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},qR=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},pi;(function(e){e.Left="left",e.Middle="middle",e.Right="right"})(pi||(pi={}));function LZ(e,n){const t=e.sorting.localeCompare(n.sorting);return t!==0?t:e.title.localeCompare(n.title)}const jZ={icon:V.SelectionTool,title:"Selection Tool",sorting:"A",action:()=>A.EnableDefaultToolsAction.create(),id:"btn_default_tools",location:pi.Left,readonly:!0,switchFocus:!0},NZ={icon:V.MultiSelection,title:"Marquee Tool (Shift)",sorting:"B",action:()=>A.EnableToolsAction.create([A.MarqueeMouseTool.ID]),id:"btn_marquee_tools",location:pi.Left,readonly:!0,switchFocus:!0},BZ={icon:V.Undo,title:"Undo",sorting:"C",action:()=>A.UndoAction.create(),id:"btn_undo_tools",location:pi.Left},xZ={icon:V.Redo,title:"Redo",sorting:"D",action:()=>A.RedoAction.create(),id:"btn_redo_tools",location:pi.Left};let Zf=class{constructor(){x(this,"customIconHandler");x(this,"gridManager");x(this,"switchThemeHandler")}button(){const n=()=>this.customIconHandler.isShowCustomIcons,t=()=>this.gridManager.isGridVisible,i=this.switchThemeHandler,a=i?()=>i.theme():void 0;return{icon:V.Settings,title:"Settings",sorting:"Y",action:()=>gm.create({customIconState:n,grid:t,theme:a}),id:"btn_options_menu",location:pi.Right,readonly:!0,switchFocus:!0}}};Y_([Pe(Yo),qR("design:type",Yo)],Zf.prototype,"customIconHandler",void 0);Y_([Pe(A.TYPES.IGridManager),qR("design:type",Object)],Zf.prototype,"gridManager",void 0);Y_([Pe(Ud),tv(),qR("design:type",Ud)],Zf.prototype,"switchThemeHandler",void 0);Zf=Y_([ue()],Zf);class FZ{constructor(n=V.DarkMode,t="Darkmode",i=a=>Kf.create({theme:a?"dark":"light"})){x(this,"icon");x(this,"label");x(this,"action");this.icon=n,this.label=t,this.action=i}}class kZ{constructor(n=V.GridDots,t="Grid",i=a=>A.ShowGridAction.create({show:a})){x(this,"icon");x(this,"label");x(this,"action");this.icon=n,this.label=t,this.action=i}}class KZ{constructor(n=V.CustomImage,t="Custom Icon",i=a=>sm.create({showCustomIcons:a})){x(this,"icon");x(this,"label");x(this,"action");this.icon=n,this.label=t,this.action=i}}class qZ{constructor(n,t){x(this,"actionDispatcher");x(this,"showAction");x(this,"bodyDiv");this.actionDispatcher=n,this.showAction=t}create(n){this.bodyDiv=Ie("div",["tool-bar-options-menu"]),n.appendChild(this.bodyDiv),this.bodyDiv.appendChild(this.createHeader()),this.bodyDiv.appendChild(this.createOptions());const t=document.querySelector("#btn_options_menu");if(t){const i=n.offsetWidth,a=t.offsetLeft+t.offsetWidth/2;this.bodyDiv.style.setProperty("--menu-arrow-pos",`${i-a-15}px`)}return this.bodyDiv}createHeader(){const n=Ie("div",["tool-bar-options-header"]);n.appendChild(Uo(V.Settings));const t=document.createElement("label");return t.textContent="Options",n.appendChild(t),n}createOptions(){const n=Ie("div",["tool-bar-options"]);return this.showAction.theme&&n.appendChild(this.createOption(new FZ,this.showAction.theme()==="dark")),n.appendChild(this.createOption(new kZ,this.showAction.grid())),n.appendChild(this.createOption(new KZ,this.showAction.customIconState())),n}createOption(n,t){const i=Ie("div",["tool-bar-option"]);i.appendChild(Uo(n.icon));const a=document.createElement("label");a.textContent=n.label,i.appendChild(a);const o=new SW(t,s=>this.actionDispatcher.dispatch(n.action(s)));return i.appendChild(o.create()),a.onclick=()=>o.switch(),i}remove(){var n;(n=this.bodyDiv)==null||n.remove()}}var Is;(function(e){e.KIND="showToolBarMenu";function n(i){return{kind:e.KIND,...i}}e.create=n;function t(i){return A.Action.hasKind(i,e.KIND)}e.is=t})(Is||(Is={}));class HZ extends hm{constructor(t,i,a){super(t,i,a);x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu","tool-bar-menu"]);this.actionDispatcher=t,this.action=i,this.paletteItems=a}toolButtonOnClick(t){return this.action.actions(t)}}var hf=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},rl=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},VZ=function(e,n){return function(t,i){n(t,i,e)}},$g;const L8="clicked";var Ld;let Vn=(Ld=class extends A.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"selectionService");x(this,"editorContext");x(this,"toolBarButtonProvider");x(this,"lastActivebutton");x(this,"defaultToolsButton");x(this,"toggleCustomIconsButton");x(this,"verticalAlignButton");x(this,"lastMenuAction");x(this,"toolBarMenu");x(this,"toDisposeOnDisable",new A.DisposableCollection);x(this,"toDisposeOnHide",new A.DisposableCollection)}id(){return $g.ID}init(){this.toDisposeOnDisable.push(this.editorContext.onEditModeChanged(()=>this.editModeChanged()))}containerClass(){return $g.ID}initializeContents(t){this.createHeader(),this.lastActivebutton=this.defaultToolsButton,t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}onBeforeShow(){this.toDisposeOnHide.push(this.selectionService.onSelectionChanged(()=>this.selectionChanged()))}hide(){super.hide(),this.toDisposeOnHide.dispose()}createHeader(){const t=Ie("div",["tool-bar-header"]);t.appendChild(this.createLeftButtons()),t.appendChild(this.createMiddleButtons()),t.appendChild(this.createRightButtons()),this.containerElement.innerHTML="",this.containerElement.appendChild(t),this.changeActiveButton()}createLeftButtons(){const t=Ie("div",["left-buttons"]);if(this.defaultToolsButton=this.createToolButton(jZ),t.appendChild(this.defaultToolsButton),t.appendChild(this.createToolButton(NZ)),!this.editorContext.isReadonly){const i=Ie("div",["edit-buttons"]);i.appendChild(this.createToolButton(BZ)),i.appendChild(this.createToolButton(xZ)),t.appendChild(i)}return t}createMiddleButtons(){const t=Ie("div",["middle-buttons"]);return this.appendProvidedButtons(t,pi.Middle),t}createRightButtons(){const t=Ie("div",["right-buttons"]);return this.appendProvidedButtons(t,pi.Right),t}appendProvidedButtons(t,i){this.toolBarButtonProvider.map(a=>a.button()).filter(A.isNotUndefined).filter(a=>a.location===i).filter(a=>!this.editorContext.isReadonly||a.readonly).sort(LZ).forEach(a=>t.appendChild(this.createToolButton(a)))}createToolButton(t){const i=Ie("button",["tool-bar-button"]);return i.appendChild(Uo(t.icon)),i.title=t.title,t.id&&(i.id=t.id),i.onclick=()=>{this.dispatchAction([t.action()]),t.switchFocus&&this.changeActiveButton(i)},this.createTitleToolButton(i,t)}createTitleToolButton(t,i){if(i.showTitle){const a=Ie("span",["tool-bar-title-button"]),o=document.createElement("label");return o.textContent=i.title,i.isNotMenu||t.appendChild(Uo(V.Chevron)),a.appendChild(o),a.appendChild(t),a}return t}dispatchAction(t){this.actionDispatcher.dispatchAll(t.concat(A.SelectAllAction.create(!1)))}handle(t){if(A.EnableToolPaletteAction.is(t))return A.SetUIExtensionVisibilityAction.create({extensionId:$g.ID,visible:!0});A.EnableDefaultToolsAction.is(t)&&(this.changeActiveButton(),this.restoreFocus()),gm.is(t)&&this.toggleOptionsMenu(t),Is.is(t)&&this.toggleToolBarMenu(t),qa.is(t)&&this.containerElement&&this.createHeader()}async toggleToolBarMenu(t){var a,o;const i=await t.paletteItems();if(i.length!==0&&t.id!==this.lastMenuAction){this.toolBarMenu=new HZ(this.actionDispatcher,t,i);const s=this.toolBarMenu.create(this.containerElement);if(this.lastActivebutton){const r=s.offsetLeft+s.offsetWidth,d=this.lastActivebutton.offsetLeft+this.lastActivebutton.offsetWidth/2;s.style.setProperty("--menu-arrow-pos",`${r-d-6}px`)}this.setLastMenuAction(t.id)}else this.changeActiveButton(),this.setLastMenuAction(void 0),(o=(a=document.getElementById(this.options.baseDiv))==null?void 0:a.querySelector("div[tabindex]"))==null||o.focus()}toggleOptionsMenu(t){t.id!==this.lastMenuAction?(this.toolBarMenu=new qZ(this.actionDispatcher,t),this.toolBarMenu.create(this.containerElement),this.setLastMenuAction(t.id)):(this.changeActiveButton(),this.setLastMenuAction(void 0))}setLastMenuAction(t){this.lastMenuAction=t}changeActiveButton(t){var a;(a=this.lastActivebutton)==null||a.classList.remove(L8);let i=this.defaultToolsButton;t&&(i=t),i==null||i.classList.add(L8),this.lastActivebutton=i,this.hideMenus()}hideMenus(){var t;(t=this.toolBarMenu)==null||t.remove(),this.toolBarMenu=void 0}editModeChanged(){this.containerElement&&this.createHeader()}selectionChanged(){}disable(){this.toDisposeOnDisable.dispose()}},$g=Ld,x(Ld,"ID","ivy-tool-bar"),Ld);hf([Pe(A.TYPES.IActionDispatcher),rl("design:type",Object)],Vn.prototype,"actionDispatcher",void 0);hf([Pe(A.SelectionService),rl("design:type",A.SelectionService)],Vn.prototype,"selectionService",void 0);hf([Pe(A.EditorContextService),rl("design:type",A.EditorContextService)],Vn.prototype,"editorContext",void 0);hf([eB($e.ToolBarButtonProvider),rl("design:type",Array)],Vn.prototype,"toolBarButtonProvider",void 0);hf([_R(),rl("design:type",Function),rl("design:paramtypes",[]),rl("design:returntype",void 0)],Vn.prototype,"init",null);Vn=$g=hf([ue()],Vn);let jE=class extends A.MouseListener{constructor(t){super();x(this,"toolBar");this.toolBar=t}mouseDown(){return this.toolBar.changeActiveButton(),this.toolBar.setLastMenuAction(),[]}};jE=hf([ue(),VZ(0,Pe(Vn)),rl("design:paramtypes",[Vn])],jE);var HB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},GZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Gc=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[]);x(this,"extensionItems")}getPaletteItems(){return this.paletteItems}async getExtensionItems(){return this.extensionItems||(this.extensionItems=new Promise(n=>{this.actionDispatcher.request(A.RequestContextActions.create({contextId:"ivy-tool-extensions-palette",editorContext:{selectedElementIds:[]}})).then(t=>{A.SetContextActions.is(t)&&n(t.actions.map(i=>i))})})),this.extensionItems}handle(n){qa.is(n)&&this.updateElementPalette()}async updateElementPalette(){this.actionDispatcher.request(A.RequestContextActions.create({contextId:Vn.ID,editorContext:{selectedElementIds:[]}})).then(n=>{A.SetContextActions.is(n)&&(this.paletteItems=n.actions.map(t=>t))})}};HB([Pe(A.TYPES.IActionDispatcher),GZ("design:type",Object)],Gc.prototype,"actionDispatcher",void 0);Gc=HB([ue()],Gc);var av=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},zZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};class cv extends Fn{constructor(){super(...arguments);x(this,"paletteHandler");x(this,"element");x(this,"actions",(t,i)=>[A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!1}),...t.actions.map(a=>UZ(a,i[0])).filter(A.isNotUndefined)])}singleQuickAction(t){if(this.element=t,!(!A.isConnectable(t)||!t.canConnect(new A.GEdge,"source")||t.type===_e.COMMENT))return this.quickAction()}hasOutgoingEdges(){return this.element instanceof A.GConnectableElement&&Array.from(this.element.outgoingEdges).length>0}paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(t=>!this.filterPaletteGroups().includes(t.id))}filterPaletteGroups(){const t=["event-start-group","swimlane-group"];return this.hasOutgoingEdges()&&t.push("event-end-group"),t}quickActionItem(){return{id:"",actions:[],label:"",sortString:""}}quickAction(){const t=this.quickActionItem();return{icon:t.icon,title:`${t.label} (A)`,location:"Right",sorting:t.sortString,action:ws.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions}),readonlySupport:!1,letQuickActionsOpen:!0}}}av([Pe(Gc),zZ("design:type",Gc)],cv.prototype,"paletteHandler",void 0);let NE=class extends cv{paletteItems(){return()=>{const n=this.paletteHandler.getPaletteItems().filter(i=>this.filterPaletteGroups().includes(i.id)),t=$Z(this.element);return t&&n.push(t),n}}filterPaletteGroups(){const n=["event-intermediate-group"];return this.hasOutgoingEdges()||n.push("event-end-group"),n}quickActionItem(){return{label:"Events",icon:V.Start,sortString:"A",id:"",actions:[]}}};NE=av([ue()],NE);let BE=class extends cv{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id==="gateway-group")}quickActionItem(){return{label:"Gateways",icon:V.GatewaysGroup,sortString:"B",id:"",actions:[]}}};BE=av([ue()],BE);let xE=class extends cv{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id==="activity-group"||n.id==="interface-activity-group"||n.id==="bpmn-activity-group")}quickActionItem(){return{label:"Activities",icon:V.ActivitiesGroup,sortString:"C",id:"",actions:[]}}};xE=av([ue()],xE);let FE=class extends cv{quickAction(){return{icon:V.Task,title:"Create Node",location:"Hidden",sorting:"Z",action:ws.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions,showSearch:!0}),letQuickActionsOpen:!0,readonlySupport:!1,shortcut:"KeyA"}}};FE=av([ue()],FE);function UZ(e,n){if(A.TriggerNodeCreationAction.is(e))return A.CreateNodeOperation.create(e.elementTypeId,{args:{previousElementId:n}});if(rm.is(e))return e}function $Z(e){const n=[];if(VY(e)&&n.push({id:"error-boundary",label:"Error Boundary",sortString:"A",actions:[rm.create({elementId:e.id,eventKind:"error"})],icon:Ha.BOUNDARY_ERROR}),GY(e)&&n.push({id:"signal-boundary",label:"Signal Boundary",sortString:"B",actions:[rm.create({elementId:e.id,eventKind:"signal"})],icon:Ha.BOUNDARY_SIGNAL}),n.length!==0)return{id:"boundary-group",label:"Boundary Events",sortString:"Z",actions:[],children:n}}var VB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},YZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let kd=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(n){qa.is(n)&&this.updateActivityTypePalette()}async updateActivityTypePalette(){this.actionDispatcher.request(A.RequestContextActions.create({contextId:"ivy-tool-activity-type-palette",editorContext:{selectedElementIds:[]}})).then(n=>{A.SetContextActions.is(n)&&(this.paletteItems=n.actions.map(t=>t))})}};VB([Pe(A.TYPES.IActionDispatcher),YZ("design:type",Object)],kd.prototype,"actionDispatcher",void 0);kd=VB([ue()],kd);var HR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},GB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let mm=class extends Fn{constructor(){super(...arguments);x(this,"types");x(this,"actionDispatcher");x(this,"actions",(t,i)=>[ZS.create({elementId:i[0],typeId:t.id}),ws.empty()])}singleQuickAction(t){if(rB(t))return{icon:V.ChangeType,title:"Select Activity Type",location:"Middle",sorting:"Y",action:ws.create({elementIds:[t.id],paletteItems:()=>this.types.getPaletteItems(),actions:this.actions,customCssClass:"activity-type-menu"}),letQuickActionsOpen:!0,readonlySupport:!1}}};HR([Pe($e.ActivityTypesPalette),GB("design:type",kd)],mm.prototype,"types",void 0);HR([Pe(A.TYPES.IActionDispatcher),GB("design:type",Object)],mm.prototype,"actionDispatcher",void 0);mm=HR([ue()],mm);const zB=new A.FeatureModule((e,n,t)=>{A.bindAsService(e,A.TYPES.IUIExtension,_t),A.configureActionHandler({bind:e,isBound:t},ws.KIND,_t),A.configureActionHandler({bind:e,isBound:t},Yf.KIND,_t),A.configureActionHandler({bind:e,isBound:t},A.RemoveMarqueeAction.KIND,_t),WZ({bind:e,isBound:t}),ZZ({bind:e}),QZ({bind:e,isBound:t}),JZ({bind:e,isBound:t})});function WZ(e){e.bind(Bf).toSelf().inSingletonScope(),e.bind(A.TYPES.ITool).toService(Bf),A.configureActionHandler(e,Vf.KIND,Bf)}function ZZ(e){e.bind($e.QuickActionProvider).to(eE),e.bind($e.QuickActionProvider).to(Wf),e.bind($e.QuickActionProvider).to(iE),e.bind($e.QuickActionProvider).to(tE),e.bind($e.QuickActionProvider).to(NE),e.bind($e.QuickActionProvider).to(BE),e.bind($e.QuickActionProvider).to(xE),e.bind($e.QuickActionProvider).to(FE)}function QZ(e){e.bind(tl).toSelf().inSingletonScope(),e.bind($e.ColorPalette).toService(tl),A.configureActionHandler(e,qa.KIND,tl),A.configureActionHandler(e,_y.KIND,tl),e.bind($e.QuickActionProvider).to(pm)}function JZ(e){e.bind(kd).toSelf().inSingletonScope(),e.bind($e.ActivityTypesPalette).toService(kd),A.configureActionHandler(e,qa.KIND,kd),e.bind($e.QuickActionProvider).to(mm)}var fl=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},XZ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let zc=class{constructor(){x(this,"paletteHandler");x(this,"actions",n=>[Is.create({id:"",paletteItems:()=>[],actions:()=>[]}),...n.actions])}button(){return this.createToolBarButton(this.paletteItems())}paletteItems(){return()=>this.paletteHandler.getPaletteItems()}};fl([Pe(Gc),XZ("design:type",Gc)],zc.prototype,"paletteHandler",void 0);zc=fl([ue()],zc);let kE=class extends zc{createToolBarButton(n){const t="all_elements_menu";return{icon:V.Task,title:"All Elements",sorting:"A",action:()=>Is.create({id:t,paletteItems:n,actions:this.actions,showSearch:!0}),id:`btn_${t}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};kE=fl([ue()],kE);let KE=class extends zc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id.match(/event-[a-z]+-group/))}createToolBarButton(n){const t="events_menu";return{icon:V.Start,title:"Events",sorting:"B",action:()=>Is.create({id:t,paletteItems:n,actions:this.actions}),id:`btn_${t}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};KE=fl([ue()],KE);let qE=class extends zc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id==="gateway-group")}createToolBarButton(n){const t="gateways_menu";return{icon:V.GatewaysGroup,title:"Gateways",sorting:"C",action:()=>Is.create({id:t,paletteItems:n,actions:this.actions}),id:`btn_${t}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};qE=fl([ue()],qE);let HE=class extends zc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id==="activity-group"||n.id==="interface-activity-group"||n.id==="bpmn-activity-group")}createToolBarButton(n){const t="activities_menu";return{icon:V.ActivitiesGroup,title:"Activities",sorting:"D",action:()=>Is.create({id:t,paletteItems:n,actions:this.actions}),id:`btn_${t}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};HE=fl([ue()],HE);let VE=class extends zc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(n=>n.id==="swimlane-group"||n.id==="annotation-group")}createToolBarButton(n){const t="artifacts_menu";return{icon:V.PoolSwimlanes,title:"Artifacts",sorting:"E",action:()=>Is.create({id:t,paletteItems:n,actions:this.actions}),id:`btn_${t}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};VE=fl([ue()],VE);let GE=class extends zc{createToolBarButton(){const n="extensions_menu";return{icon:V.Extension,title:"Extensions",sorting:"F",action:()=>Is.create({id:n,paletteItems:()=>this.paletteHandler.getExtensionItems(),actions:this.actions,showSearch:!0,customCssClass:"menu-as-list"}),id:`btn_${n}`,location:pi.Middle,switchFocus:!0,showTitle:!0}}};GE=fl([ue()],GE);const UB=new A.FeatureModule((e,n,t)=>{const i={bind:e,isBound:t};A.bindAsService(i,$e.ToolBar,Vn),e(A.TYPES.IUIExtension).toService(Vn),A.configureActionHandler(i,A.EnableToolPaletteAction.KIND,Vn),A.configureActionHandler(i,Is.KIND,Vn),A.configureActionHandler(i,gm.KIND,Vn),eQ(i),A.bindAsService(i,A.TYPES.MouseListener,jE),e(Yo).toSelf().inSingletonScope(),A.configureActionHandler(i,sm.KIND,Yo),A.configureActionHandler(i,A.EnableDefaultToolsAction.KIND,Vn),A.configureActionHandler(i,qa.KIND,Vn)},{featureId:A.toolPaletteModule.featureId});function eQ(e){e.bind(Gc).toSelf().inSingletonScope(),A.configureActionHandler(e,qa.KIND,Gc),e.bind($e.ToolBarButtonProvider).to(kE),e.bind($e.ToolBarButtonProvider).to(KE),e.bind($e.ToolBarButtonProvider).to(qE),e.bind($e.ToolBarButtonProvider).to(HE),e.bind($e.ToolBarButtonProvider).to(VE),e.bind($e.ToolBarButtonProvider).to(GE),e.bind($e.ToolBarButtonProvider).to(Zf)}var W_=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},tm=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let ol=class extends A.GLSPScrollMouseListener{constructor(){super(...arguments);x(this,"quickActionUi");x(this,"mouseTool")}init(){this.mouseTool.registerListener(this)}mouseDown(t,i){return A.findParentByFeature(t,A.toTypeGuard(A.GResizeHandle))?[]:super.mouseDown(t,i)}mouseMove(t,i){const a=super.mouseMove(t,i);return this.lastScrollPosition&&this.quickActionUi.hideUi(),a}mouseUp(t,i){return this.lastScrollPosition&&this.quickActionUi.showUi(),super.mouseUp(t,i)}wheel(t,i){if(A.isCtrlOrCmd(i))return[];const a=A.findParentByFeature(t,A.isViewport),o={x:i.pageX,y:i.pageY};return i.shiftKey?o.x+=i.deltaY!==0?i.deltaY:i.deltaX:(o.x+=i.deltaX,o.y+=i.deltaY),a?this.dragCanvas(a,i,o):[]}};W_([Pe(_t),tm("design:type",_t)],ol.prototype,"quickActionUi",void 0);W_([Pe(A.GLSPMouseTool),tm("design:type",A.GLSPMouseTool)],ol.prototype,"mouseTool",void 0);W_([_R(),tm("design:type",Function),tm("design:paramtypes",[]),tm("design:returntype",void 0)],ol.prototype,"init",null);ol=W_([ue()],ol);class tQ{constructor(n,t=V.Center,i="centerBtn",a="Center (M)",o=()=>A.CenterAction.create(n())){x(this,"elementIds");x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.elementIds=n,this.icon=t,this.id=i,this.title=a,this.action=o}}class nQ{constructor(n=V.WindowMinimize,t="originBtn",i="Origin screen (O)",a=()=>Cy.create()){x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.icon=n,this.id=t,this.title=i,this.action=a}}class iQ{constructor(n=V.FitToScreen,t="fitToScreenBtn",i="Fit to screen (F)",a=()=>A.FitToScreenAction.create([],{padding:10})){x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.icon=n,this.id=t,this.title=i,this.action=a}}var uv=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},Z_=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},Yg,jd;let Ka=(jd=class extends A.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"toolManager");x(this,"editorContext");x(this,"selectionService");x(this,"zoomLevel","100%");x(this,"zoomLevelElement")}id(){return Yg.ID}containerClass(){return Yg.ID}initializeContents(t){this.createBar(),t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}createBar(){const t=Ie("div",["viewport-bar"]);t.appendChild(this.createViewportTools()),this.containerElement.appendChild(t)}createViewportTools(){const t=Ie("div",["viewport-bar-tools"]);return t.appendChild(this.createViewportButton(new nQ)),t.appendChild(this.createViewportButton(new iQ)),t.appendChild(this.createViewportButton(new tQ(()=>[...this.selectionService.getSelectedElementIDs()]))),this.zoomLevelElement=document.createElement("label"),this.zoomLevelElement.textContent=this.zoomLevel,t.appendChild(this.zoomLevelElement),t}createViewportButton(t){const i=Ie("button");return i.appendChild(Uo(t.icon)),i.id=t.id,i.title=t.title,i.onclick=()=>this.actionDispatcher.dispatch(t.action()).then(()=>{const a=this.editorContext.modelRoot;A.isViewport(a)&&this.actionDispatcher.dispatchAll([A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}),A.SetViewportAction.create(a.id,a,{})])}),i}handle(t){cm.is(t)&&this.actionDispatcher.dispatch(A.SetUIExtensionVisibilityAction.create({extensionId:Yg.ID,visible:!0})),A.SetViewportAction.is(t)?this.updateZoomLevel(t.newViewport.zoom):qf.is(t)&&this.updateZoomLevel(t.zoom)}updateZoomLevel(t){this.zoomLevel=(t*100).toFixed(0).toString()+"%",this.zoomLevelElement&&(this.zoomLevelElement.textContent=this.zoomLevel)}},Yg=jd,x(jd,"ID","ivy-viewport-bar"),jd);uv([Pe(A.TYPES.IActionDispatcher),Z_("design:type",Object)],Ka.prototype,"actionDispatcher",void 0);uv([Pe(A.TYPES.IToolManager),Z_("design:type",Object)],Ka.prototype,"toolManager",void 0);uv([Pe(A.EditorContextService),Z_("design:type",A.EditorContextService)],Ka.prototype,"editorContext",void 0);uv([Pe(A.SelectionService),Z_("design:type",A.SelectionService)],Ka.prototype,"selectionService",void 0);Ka=Yg=uv([ue()],Ka);var mh=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},lv=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},Q_=function(e,n){return function(t,i){n(t,i,e)}},wS;let zE=(wS=class extends A.BoundsAwareViewportCommand{constructor(t){super(t.animate);x(this,"action");this.action=t}getElementIds(){return[]}initialize(t){if(!A.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=this.getNewViewport();if(i){const{zoomLimits:a,horizontalScrollLimits:o,verticalScrollLimits:s}=this.viewerOptions;this.newViewport=A.limitViewport(i,t.canvasBounds,o,s,a)}}getNewViewport(){return{zoom:1,scroll:{x:0,y:0}}}},x(wS,"KIND",Cy.KIND),wS);zE=mh([ue(),Q_(0,Pe(A.TYPES.Action)),lv("design:paramtypes",[Object])],zE);function Fy(e){return!!e&&A.isBoundsAware(e)&&!(e instanceof dl)}function $B(e){return A.isSelected(e)&&A.isBoundsAware(e)&&!(e instanceof dl)}var IS;let UE=(IS=class extends A.FitToScreenCommand{constructor(t){super(t);x(this,"action");this.action=t}getNewViewport(t,i){if(!A.Dimension.isValid(i.canvasBounds))return;const a=A.Bounds.center(t),o=this.action.padding===void 0?0:2*this.action.padding,s=this.toolBarHeight();let r=Math.min(i.canvasBounds.width/(t.width+o),(i.canvasBounds.height-s)/(t.height+o));return this.action.maxZoom!==void 0&&(r=Math.min(r,this.action.maxZoom)),r===1/0&&(r=1),{scroll:{x:a.x-.5*i.canvasBounds.width/r,y:a.y-.5*(i.canvasBounds.height+s)/r},zoom:r}}toolBarHeight(){const t=document.querySelector('[id$="_'+Vn.ID+'"]');return t?t.getBoundingClientRect().height:0}initialize(t){if(A.isViewport(t)){this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];A.getElements(t.index,this.getElementIds(),Fy).forEach(o=>i.push(this.boundsInViewport(o,o.bounds,t))),i.length===0&&A.forEachElement(t.index,$B,o=>i.push(this.boundsInViewport(o,o.bounds,t))),i.length===0&&A.forEachElement(t.index,Fy,o=>i.push(this.boundsInViewport(o,o.bounds,t)));const a=i.reduce((o,s)=>A.Bounds.combine(o,s),A.Bounds.EMPTY);if(A.Dimension.isValid(a)){const o=this.getNewViewport(a,t);if(o){const{zoomLimits:s,horizontalScrollLimits:r,verticalScrollLimits:d}=this.viewerOptions;this.newViewport=A.limitViewport(o,t.canvasBounds,r,d,s)}}}}},x(IS,"KIND",A.FitToScreenAction.KIND),IS);UE=mh([ue(),Q_(0,Pe(A.TYPES.Action)),lv("design:paramtypes",[Object])],UE);let ky=class extends A.CenterCommand{constructor(){super(...arguments);x(this,"selectionService")}getNewViewport(t,i){if(A.Dimension.isValid(i.canvasBounds))return super.getNewViewport(t,i)}initialize(t){if(!A.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];A.getElements(t.index,this.getElementIds(),Fy).forEach(o=>i.push(this.boundsInViewport(o,o.bounds,t))),i.length===0&&A.forEachElement(t.index,$B,o=>i.push(this.boundsInViewport(o,o.bounds,t))),i.length===0&&A.forEachElement(t.index,Fy,o=>i.push(this.boundsInViewport(o,o.bounds,t)));const a=i.reduce((o,s)=>A.Bounds.combine(o,s),A.Bounds.EMPTY);if(A.Dimension.isValid(a)){const o=this.getNewViewport(a,t);if(o){const{zoomLimits:s,horizontalScrollLimits:r,verticalScrollLimits:d}=this.viewerOptions;this.newViewport=A.limitViewport(o,t.canvasBounds,r,d,s)}}}};mh([Pe(A.SelectionService),lv("design:type",A.SelectionService)],ky.prototype,"selectionService",void 0);ky=mh([ue()],ky);var TS;let $E=(TS=class extends A.BoundsAwareViewportCommand{constructor(t){super(t.animate);x(this,"action");this.action=t}getElementIds(){return this.action.elementIds}getNewViewport(t,i){if(A.Dimension.isValid(i.canvasBounds))return rQ(i.canvasBounds,A.isViewport(i)?i.scroll:A.Point.ORIGIN,A.Bounds.center(t),this.action.retainZoom&&A.isViewport(i)?i.zoom:1)}},x(TS,"KIND",um.KIND),TS);$E=mh([ue(),Q_(0,Pe(A.TYPES.Action)),lv("design:paramtypes",[Object])],$E);function rQ(e,n,t,i){return{scroll:{x:j8(e.width,n.x,t.x,i),y:j8(e.height,n.y,t.y,i)},zoom:i}}function j8(e,n,t,i){const a=t-n;return a>e||a<0?t-.5*e/i:n}var DS;let YE=(DS=class extends A.Command{constructor(t){super();x(this,"action");this.action=t}execute(t){const i=t.root;return A.isViewport(i)&&(i.zoom=this.action.zoom),i}undo(t){return t.logger.error(this,"Cannot undo a ivy viewport zoom command"),t.root}redo(t){return t.logger.error(this,"Cannot redo a ivy viewport zoom command"),t.root}},x(DS,"KIND",qf.KIND),DS);YE=mh([ue(),Q_(0,Pe(A.TYPES.Action)),lv("design:paramtypes",[Object])],YE);var oQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let WE=class extends A.ZoomMouseListener{wheel(n,t){return A.isCtrlOrCmd(t)?super.wheel(n,t):[]}getZoomFactor(n){return n.deltaMode===n.DOM_DELTA_PAGE?Math.exp(-n.deltaY*.5):n.deltaMode===n.DOM_DELTA_LINE?Math.exp(-n.deltaY*.05):Math.exp(-n.deltaY*.003)}};WE=oQ([ue()],WE);const sQ=new A.FeatureModule((e,n,t,i)=>{const a={bind:e,isBound:t,rebind:i};A.configureCommand(a,A.GetViewportCommand),A.configureCommand(a,A.SetViewportCommand),A.configureCommand(a,A.RepositionCommand),A.configureCommand(a,ky),A.configureCommand(a,UE),A.bindAsService(a,A.TYPES.MouseListener,WE),e(ol).toSelf().inSingletonScope(),A.configureActionHandler(a,A.EnableToolsAction.KIND,ol),A.configureActionHandler(a,A.EnableDefaultToolsAction.KIND,ol),A.bindAsService(a,A.TYPES.IUIExtension,Ka),A.configureActionHandler(a,cm.KIND,Ka),A.configureActionHandler(a,A.SetViewportAction.KIND,Ka),A.configureActionHandler(a,qf.KIND,Ka),A.configureCommand(a,zE),A.configureCommand(a,$E),A.configureCommand(a,YE)},{featureId:A.viewportModule.featureId});var YB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let ZE=class extends Fn{singleQuickAction(n){if(rB(n))return{icon:V.Unwrap,title:"Unwrap embedded subprocess (U)",location:"Middle",sorting:"B",action:JS.create({elementId:n.id}),shortcut:"KeyU"}}};ZE=YB([ue()],ZE);let QE=class{singleQuickAction(n){if(HY(n))return this.quickAction([n.id])}multiQuickAction(n){const t=n.map(i=>i.id);if(t.length>0&&!n.find(i=>!qY(i)))return this.quickAction(t)}quickAction(n){return{icon:V.WrapToSubprocess,title:"Wrap to embedded process (W)",location:"Middle",sorting:"B",action:QS.create({elementIds:n}),shortcut:"KeyW"}}};QE=YB([ue()],QE);const WB=new A.FeatureModule(e=>{e($e.QuickActionProvider).to(ZE),e($e.QuickActionProvider).to(QE)});var aQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},cQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},uQ=function(e,n){return function(t,i){n(t,i,e)}};let JE=class extends A.BringToFrontCommand{constructor(t){super(t);x(this,"action");this.action=t}addToSelection(t){t instanceof $o||this.selected.push({element:t,index:t.parent.children.indexOf(t)})}};JE=aQ([ue(),uQ(0,Pe(A.TYPES.Action)),cQ("design:paramtypes",[Object])],JE);const lQ=new A.FeatureModule((e,n,t)=>{A.configureCommand({bind:e,isBound:t},JE)},{featureId:A.zorderModule.featureId});var dQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},fQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};class XE extends A.ResizeElementHandler{constructor(){super(...arguments);x(this,"selectionService")}handle(t){if(A.ResizeElementAction.is(t)&&t.elementIds.length===1){const i=A.getElements(this.editorContextService.modelRoot.index,t.elementIds,A.isSelectableAndBoundsAware);if(i.length===1&&A.isResizable(i[0]))return this.handleResizeElement(t),A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]})}}}dQ([Pe(A.SelectionService),fQ("design:type",A.SelectionService)],XE.prototype,"selectionService",void 0);var ZB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},hQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let kf=class extends A.ZoomKeyTool{constructor(){super(...arguments);x(this,"zoomKeyListener",new eC(this))}getEditorContextService(){return this.editorContextService}};kf=ZB([ue()],kf);let eC=class extends A.ZoomKeyListener{constructor(t){super(t);x(this,"tool");x(this,"dispatch",(t,i=!1)=>{this.tool.actionDispatcher.dispatch(t).then(()=>{const a=this.tool.getEditorContextService().modelRoot;if(!A.isViewport(a))return;const o=A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!0,contextElementsId:[...this.tool.selectionService.getSelectedElementIDs()]});this.tool.actionDispatcher.dispatchAll(i?[o,A.SetViewportAction.create(a.id,a,{})]:[o])})});this.tool=t}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(A.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["+"],description:"Zoom in to element or viewport",group:"Viewport",position:0},{shortcuts:["-"],description:"Zoom out to element or viewport",group:"Viewport",position:1}]}))}keyDown(t,i){const a=this.tool.selectionService.getSelectedElementIDs();return this.matchesZoomOutKeystroke(i)?a.length>0?this.dispatch(A.ZoomElementAction.create(a,A.ZoomKeyListener.defaultZoomOutFactor)):this.dispatch(A.ZoomViewportAction.create(A.ZoomKeyListener.defaultZoomOutFactor)):this.matchesZoomInKeystroke(i)?a.length>0?this.dispatch(A.ZoomElementAction.create(a,A.ZoomKeyListener.defaultZoomInFactor)):this.dispatch(A.ZoomViewportAction.create(A.ZoomKeyListener.defaultZoomInFactor)):A.matchesKeystroke(i,"KeyM")?this.dispatch(A.CenterAction.create(a),!0):A.matchesKeystroke(i,"KeyF")?this.dispatch(A.FitToScreenAction.create(a),!0):A.matchesKeystroke(i,"KeyO")&&this.dispatch(A.OriginViewportAction.create(),!0),[]}};eC=ZB([ue(),hQ("design:paramtypes",[kf])],eC);var pQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let tC=class{handle(n){A.FocusDomAction.is(n)&&this.focusBySelector(n.id)}focusBySelector(n){var t;(t=document.querySelector(n))==null||t.focus()}};tC=pQ([ue()],tC);var VR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},QB=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let vm=class extends A.MovementKeyTool{constructor(){super(...arguments);x(this,"movementRestrictor")}enable(){this.movementKeyListener||(this.movementKeyListener=new nC(this,this.grid)),this.keytool.register(this.movementKeyListener),this.movementKeyListener.registerShortcutKey()}};VR([Pe(A.TYPES.IMovementRestrictor),tv(),QB("design:type",Object)],vm.prototype,"movementRestrictor",void 0);vm=VR([ue()],vm);let nC=class extends A.MoveKeyListener{constructor(t,i={x:A.MoveKeyListener.defaultMoveX,y:A.MoveKeyListener.defaultMoveY}){super(t,i);x(this,"tool");x(this,"grid");this.tool=t,this.grid=i}keyDown(t,i){const a=this.moveDelta(i);return a===void 0?[]:this.tool.selectionService.hasSelectedElements()?this.moveElements(a):this.moveGraph(t,a)}moveDelta(t){if(A.matchesKeystroke(t,"ArrowUp"))return{x:0,y:-this.grid.y};if(A.matchesKeystroke(t,"ArrowDown"))return{x:0,y:this.grid.y};if(A.matchesKeystroke(t,"ArrowLeft"))return{x:-this.grid.x,y:0};if(A.matchesKeystroke(t,"ArrowRight"))return{x:this.grid.x,y:0}}moveGraph(t,i){const a=A.findParentByFeature(t,A.isViewport);if(a===void 0)return[];const o={scroll:{x:a.scroll.x+i.x,y:a.scroll.y+i.y},zoom:a.zoom};return[A.SetViewportAction.create(a.id,o,{animate:!1})]}moveElements(t){let i=A.getElements(this.tool.selectionService.getModelRoot().index,Array.from(this.tool.selectionService.getSelectedElementIDs()),A.isBoundsAware);if(i=i.filter(o=>!this.isChildOfSelected(i,o)).filter(o=>o.hasFeature(A.boundsFeature)),i.length===0)return[];const a=i.filter(o=>this.isMovementAllowed(o,t)).map(o=>this.getElementAndUpdatedBound(o,t));return a.length!==i.length?[]:[A.ChangeBoundsOperation.create(a),A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!0,contextElementsId:[...i.map(o=>o.id)]})]}isChildOfSelected(t,i){return i instanceof A.GChildElement&&t.includes(i.parent)}isMovementAllowed(t,i){if(this.tool.movementRestrictor){const a=this.updatePosition(t,i);return this.tool.movementRestrictor.validate(t,a)}return!0}getElementAndUpdatedBound(t,i){const a=A.toElementAndBounds(t);return a.newPosition=this.updatePosition(t,i),a}updatePosition(t,i){return{x:t.bounds.x+i.x,y:t.bounds.y+i.y}}};nC=VR([ue(),QB("design:paramtypes",[vm,Object])],nC);var Tf=Y(),JB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},gQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Ky=class extends A.GlobalKeyListenerTool{constructor(){super(...arguments);x(this,"selectionService")}registerShortcutKey(){this.actionDispatcher.onceModelInitialized().then(()=>{this.actionDispatcher.dispatchAll([A.SetAccessibleKeyShortcutAction.create({token:A.KeyboardToolPalette.name,keys:[{shortcuts:["1"],description:"Focus on tool palette",group:"Tool-Palette",position:0}]}),A.SetAccessibleKeyShortcutAction.create({token:"Graph",keys:[{shortcuts:["2"],description:"Focus on graph",group:"Graph",position:0}]})])})}handleKeyEvent(t){var i,a;if(this.isInput(t))return[];if(this.matchesSetFocusOnToolPalette(t))return[A.FocusDomAction.create("#btn_default_tools")];if(this.matchesSetFocusOnDiagram(t)){const o=[A.FocusDomAction.create(`#${(a=(i=document.querySelector("svg.sprotty-graph"))==null?void 0:i.parentElement)==null?void 0:a.id}`)];if(!this.selectionService.hasSelectedElements()){const s=Tf.toArray(this.selectionService.getModelRoot().index.all()).find(r=>r instanceof Ff);s&&o.push(Tf.SelectAction.create({selectedElementsIDs:[s.id]}))}return o}return[]}isInput(t){return t.target instanceof HTMLInputElement}matchesSetFocusOnToolPalette(t){return Tf.matchesKeystroke(t,"Digit1")||Tf.matchesKeystroke(t,"Numpad1")}matchesSetFocusOnDiagram(t){return Tf.matchesKeystroke(t,"Digit2")||Tf.matchesKeystroke(t,"Numpad2")}};JB([Pe(A.SelectionService),gQ("design:type",A.SelectionService)],Ky.prototype,"selectionService",void 0);Ky=JB([ue()],Ky);var XB=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},mQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let qy=class extends A.KeyListener{constructor(){super(...arguments);x(this,"quickActionUi")}keyDown(t,i){const a=this.quickActionUi.getActiveQuickActions().filter(o=>o.shortcut&&Fa.matchesKeystroke(i,o.shortcut));return a.length===1&&!a[0].letQuickActionsOpen?[a[0].action,A.SetUIExtensionVisibilityAction.create({extensionId:_t.ID,visible:!1})]:a.map(o=>o.action)}};XB([Pe(_t),mQ("design:type",_t)],qy.prototype,"quickActionUi",void 0);qy=XB([ue()],qy);var GR=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},ex=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let ym=class extends A.KeyListener{constructor(){super(...arguments);x(this,"selectionService");x(this,"quickActionUi")}keyDown(t,i){return Fa.matchesKeystroke(i,"KeyJ")&&this.isJumpOutActive()?[qd.create({elementId:""})]:[]}isJumpOutActive(){return this.selectionService.getModelRoot().id.includes("-")&&!this.isJumpIntoActive()}isJumpIntoActive(){return this.quickActionUi.getActiveQuickActions().map(t=>t.action).map(t=>t.kind).some(t=>t==="jumpInto")}};GR([Pe(A.SelectionService),ex("design:type",A.SelectionService)],ym.prototype,"selectionService",void 0);GR([Pe(_t),ex("design:type",_t)],ym.prototype,"quickActionUi",void 0);ym=GR([ue()],ym);var vQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let iC=class extends A.SearchAutocompletePaletteTool{constructor(){super(...arguments);x(this,"keyListener",new yQ(this))}};iC=vQ([ue()],iC);class yQ extends A.SearchAutocompletePaletteKeyListener{registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(A.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:[A.isMac()?"CMD":"CTRL","F"],description:"Activate search for elements",group:"Search",position:0}]}))}matchesSearchActivateKeystroke(n){return A.matchesKeystroke(n,"KeyF","ctrlCmd")}}var _Q=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let rC=class extends A.SearchAutocompletePalette{getSuggestionProviders(){return[new SQ,new EQ]}show(n,...t){this.activeElement=document.activeElement,!(!this.containerElement&&!this.initialize())&&(this.onBeforeShow(this.containerElement,n,...t),this.setContainerVisible(!0),this.root=n,this.autocompleteWidget.open(n))}};rC=_Q([ue()],rC);const bQ=e=>e.startsWith(_e.DEFAULT)?V.ActivitiesGroup:e.startsWith(Hd.DEFAULT)?V.Start:e.startsWith(Hi.DEFAULT)?V.GatewaysGroup:V.PoolSwimlanes;class SQ{async retrieveSuggestions(n){return A.toArray(n.index.all()).filter(t=>t instanceof A.GNode).map(t=>({element:t,action:{label:`[${t.type}] - ${this.getNodeLabel(t)}`,actions:this.getActions(t),icon:`ivy ivy-${bQ(t.type)}`}}))}getActions(n){return[A.SelectAction.create({selectedElementsIDs:[n.id]}),A.CenterAction.create([n.id],{retainZoom:!0})]}getNodeLabel(n){const t=n.children.find(i=>i instanceof A.GLabel);return t!=null&&t.text?t.text:n.id}}class EQ{async retrieveSuggestions(n){return A.toArray(n.index.all().filter(i=>i instanceof A.GEdge)).map(i=>({element:i,action:{label:`[${i.type}] - ${this.getEdgeLabel(n,i)}`,actions:this.getActions(i),icon:`ivy ivy-${V.Straighten}`}}))}getActions(n){return[A.SelectAction.create({selectedElementsIDs:[n.id]}),A.CenterAction.create([n.sourceId,n.targetId])]}getEdgeLabel(n,t){const i=t.children.find(s=>s instanceof A.GLabel);if(i!=null&&i.text)return i.text;const a=n.index.getById(t.sourceId),o=n.index.getById(t.targetId);return(a==null?void 0:a.type)+" -> "+(o==null?void 0:o.type)}}var CQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let oC=class extends A.ElementNavigatorTool{constructor(){super(...arguments);x(this,"elementNavigatorKeyListener",new PQ(this))}};oC=CQ([ue()],oC);var jf;(function(e){e.DEFAULT="default",e.POSITION="position"})(jf||(jf={}));class PQ extends A.ElementNavigatorKeyListener{triggerDefaultNavigationOnEvent(n,t){return this.matchesActivateDefaultNavigation(n)?(this.mode!==jf.DEFAULT?(this.clean(),this.tool.actionDispatcher.dispatchAll([A.EnableToolsAction.create([A.ElementNavigatorTool.ID,A.SearchAutocompletePaletteTool.ID,A.AccessibleKeyShortcutTool.ID]),A.ShowToastMessageAction.create({id:Symbol.for(A.ElementNavigatorKeyListener.name),message:"Navigation On: Use arrow keys to select preceding () or succeding () elements. Use the up () and down () arrows to navigate paths. Press 'ESC' to exit."})]),this.navigator=this.tool.localElementNavigator,this.mode=jf.DEFAULT):this.resetDefaultNavigationOnEvent(n,t),!0):!1}triggerPositionNavigationOnEvent(n,t){return this.matchesActivatePositionNavigation(n)?(this.mode!==jf.POSITION?(this.clean(),this.tool.actionDispatcher.dispatchAll([A.EnableToolsAction.create([A.ElementNavigatorTool.ID,A.SearchAutocompletePaletteTool.ID,A.AccessibleKeyShortcutTool.ID]),A.ShowToastMessageAction.create({id:Symbol.for(A.ElementNavigatorKeyListener.name),message:"Position based Navigation On: Navigate nearest elements using arrow keys: () for above, () for below, () for previous, () for next element. Press 'ESC' to exit."})]),this.navigator=this.tool.elementNavigator,this.mode=jf.POSITION):this.resetPositionNavigationOnEvent(n,t),!0):!1}}const tx=new A.FeatureModule((e,n,t,i)=>{const a={bind:e,unbind:n,isBound:t,rebind:i};MQ(a),AQ(a),A.configureMoveZoom(a),IQ(a),A.configureShortcutHelpTool(a),wQ(a),TQ(a),A.configureToastTool(a),A.configureActionHandler(a,A.FocusDomAction.KIND,tC),nx(a)},{featureId:A.accessibilityModule.featureId}),RQ=new A.FeatureModule((e,n,t,i)=>{nx({bind:e})});function MQ(e){e.bind(XE).toSelf().inSingletonScope(),A.configureActionHandler(e,A.ResizeElementAction.KIND,XE),A.bindAsService(e,A.TYPES.IDefaultTool,A.ResizeKeyTool)}function AQ(e){A.bindAsService(e,A.TYPES.IDefaultTool,vm),A.bindAsService(e,A.TYPES.IDefaultTool,kf),A.configureActionHandler(e,A.KeyboardGridCellSelectedAction.KIND,kf),A.configureActionHandler(e,A.KeyboardGridKeyboardEventAction.KIND,kf),A.bindAsService(e,A.TYPES.IDefaultTool,A.DeselectKeyTool)}function wQ(e){A.bindAsService(e,A.TYPES.IDefaultTool,Ky),A.bindAsService(e,A.TYPES.IUIExtension,A.KeyboardGrid),A.configureActionHandler(e,A.EnableKeyboardGridAction.KIND,A.KeyboardGrid)}function nx({bind:e}){e(A.TYPES.KeyListener).to(qy),e(A.TYPES.KeyListener).to(ym)}function IQ(e){A.bindAsService(e,A.TYPES.IUIExtension,rC),A.bindAsService(e,A.TYPES.IDefaultTool,iC)}function TQ(e){A.bindAsService(e,A.TYPES.IDefaultTool,oC),A.bindAsService(e,A.TYPES.IElementNavigator,A.PositionNavigator),A.bindAsService(e,A.TYPES.ILocalElementNavigator,A.LocalElementNavigator)}function DQ(e,...n){const t=A.initializeDiagramContainer(new my,{remove:[A.hoverModule,A.navigationModule,A.statusModule,A.contextMenuModule]},A.baseViewModule,A.helperLineModule,A.gridModule,{replace:sQ},{replace:ZY},{replace:lQ},{replace:UB},{replace:gB},{replace:mB},{replace:FB},{replace:IZ},{replace:TZ},mW,zB,WB,EW,EB,xY,_W,nB,wW,tx,...n);return A.bindOrRebind(t,A.TYPES.Grid).toConstantValue({x:8,y:8}),t.bind($e.IvyViewerOptions).toConstantValue(TW()),t.bind(A.TYPES.IHelperLineOptions).toConstantValue({alignmentElementFilter:i=>!(i instanceof $o)&&A.DEFAULT_ALIGNABLE_ELEMENT_FILTER(i)}),A.bindOrRebind(t,A.MarqueeUtil).to(A.MarqueeUtil).inSingletonScope(),A.bindOrRebind(t,A.TYPES.IMarqueeBehavior).toConstantValue({entireEdge:!0,entireElement:!0}),A.bindOrRebind(t,A.TYPES.ICommandStack).to(Ly).inSingletonScope(),A.bindOrRebind(t,A.TYPES.ILogger).to(A.ConsoleLogger).inSingletonScope(),A.bindOrRebind(t,A.TYPES.LogLevel).toConstantValue(A.LogLevel.warn),A.bindOrRebind(t,A.TYPES.ISnapper).to(A.GLSPCenterGridSnapper),A.overrideViewerOptions(t,{baseDiv:e,hiddenDiv:e+"_hidden"}),t}var OQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let sC=class extends Fn{singleQuickAction(n){if(aE(n))return{icon:V.Bug,title:"Toggle Breakpoint (B)",location:"Left",sorting:"C",action:qS.create({elementId:n.id}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyB"}}};sC=OQ([ue()],sC);var ix=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},LQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)},jQ=function(e,n){return function(t,i){n(t,i,e)}},aC;(function(e){function n(t){return{kind:Hy.KIND,...t}}e.create=n})(aC||(aC={}));var OS;let Hy=(OS=class extends A.Command{constructor(t){super();x(this,"action");x(this,"showBreakpoints",[]);this.action=t}execute(t){var i;return(i=this.action.oldBreakpoints)==null||i.forEach(a=>{const o=t.root.index.getById(a.elementId);o instanceof A.GChildElement&&aE(o)&&cE(o)}),this.action.breakpoints.forEach(a=>{const o=t.root.index.getById(a.elementId);o instanceof A.GChildElement&&aE(o)&&this.showBreakpoints.push({element:o,condition:a.condition,disabled:a.disabled,globalDisabled:this.action.globalDisabled??!1})}),this.redo(t)}undo(t){for(const i of this.showBreakpoints)cE(i.element);return t.root}redo(t){for(const i of this.showBreakpoints)zY(i.element,i.condition,i.disabled,i.globalDisabled);return t.root}},x(OS,"KIND","elementBreakpointFeedback"),OS);Hy=ix([ue(),jQ(0,Pe(A.TYPES.Action)),LQ("design:paramtypes",[Object])],Hy);let cC=class extends A.MouseListener{mouseUp(n){return n instanceof Gf?[HS.create({elementId:n.parent.id,disable:!n.disabled})]:[]}};cC=ix([ue()],cC);var rx=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},NQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let _m=class{constructor(){x(this,"oldBreakpoints",[]);x(this,"feedbackDispatcher")}handle(n){if(yy.is(n)){const t=aC.create({breakpoints:n.elementBreakpoints,oldBreakpoints:this.oldBreakpoints,globalDisabled:n.globalDisabled});this.feedbackDispatcher.registerFeedback(this,[t]),this.oldBreakpoints=n.elementBreakpoints}}};rx([Pe(A.TYPES.IFeedbackActionDispatcher),NQ("design:type",Object)],_m.prototype,"feedbackDispatcher",void 0);_m=rx([ue()],_m);var BQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};const iy={createElement:A.svg};let uC=class{render(n){var t;return A.isBoundsAware(n.parent)?iy.createElement("g",null,iy.createElement("circle",{"class-ivy-breakpoint-handle":!0,"class-disabled":n.disabled,"class-condition":((t=n.condition)==null?void 0:t.length)>0&&n.condition!=="true","class-mouseover":n.hoverFeedback,cx:-10,cy:9,r:4}),n.globalDisabled&&iy.createElement("line",{"class-ivy-breakpoint-handle-globaldisable":!0,x1:-15,y1:14,x2:-5,y2:4})):iy.createElement("g",null)}};uC=BQ([ue()],uC);new A.FeatureModule((e,n,t)=>{e(_m).toSelf().inSingletonScope(),A.configureActionHandler({bind:e,isBound:t},yy.KIND,_m),A.configureCommand({bind:e,isBound:t},Hy),A.configureView({bind:e,isBound:t},Gf.TYPE,uC),e($e.QuickActionProvider).to(sC),e(A.TYPES.MouseListener).to(cC)});const xQ=new A.FeatureModule((e,n,t)=>{e(Ud).toSelf().inSingletonScope(),A.configureActionHandler({bind:e,isBound:t},Kf.KIND,Ud)});let FQ=class extends A.KeyListener{keyDown(n,t){return Fa.matchesKeystroke(t,"KeyC")?[by.create()]:[]}};var kQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let lC=class{button(){return{icon:V.DatabaseLink,title:"Open Data Class (C)",sorting:"E",action:()=>by.create(),location:pi.Right,readonly:!0}}};lC=kQ([ue()],lC);new A.FeatureModule(e=>{e(A.TYPES.KeyListener).to(FQ),e($e.ToolBarButtonProvider).to(lC)});function KQ(e){return e.hasFeature(A.openFeature)}var qQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let dC=class extends Fn{singleQuickAction(n){if(KQ(n)&&n.type!==_e.COMMENT)return{icon:V.CustomImage,title:"Custom Icon",location:"Middle",sorting:"C",action:zS.create(n.id),letQuickActionsOpen:!0}}};dC=qQ([ue()],dC);new A.FeatureModule(e=>{e($e.QuickActionProvider).to(dC)});class HQ extends A.KeyListener{keyDown(n,t){return Fa.matchesKeystroke(t,"KeyF")?[am.create()]:[]}}var ox=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o},VQ=function(e,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,n)};let Vy=class{constructor(){x(this,"editorContext")}button(){try{if(A.hasArgs(this.editorContext.modelRoot)&&A.GArgument.getString(this.editorContext.modelRoot,"kind")==="html-dialog")return{icon:V.File,title:"Open Form Editor (F)",sorting:"F",action:()=>am.create(),location:pi.Right,readonly:!0}}catch(n){console.log("Couldn't load model root",n)}}};ox([Pe(A.EditorContextService),VQ("design:type",A.EditorContextService)],Vy.prototype,"editorContext",void 0);Vy=ox([ue()],Vy);var GQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let fC=class extends Fn{singleQuickAction(n){if(pW(n))return{icon:V.SubStart,title:"Open Form (J)",location:"Middle",sorting:"A",action:am.create({elementId:n.id}),readonlySupport:!0,shortcut:"KeyJ"}}};fC=GQ([ue()],fC);new A.FeatureModule(e=>{e(A.TYPES.KeyListener).to(HQ),e($e.ToolBarButtonProvider).to(Vy),e($e.QuickActionProvider).to(fC)});var zQ=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let hC=class extends Fn{singleQuickAction(n){if(gW(n))return{icon:V.GoToSource,title:"Go To Source (S)",location:"Middle",sorting:"B",action:US.create(n.id),readonlySupport:!0,shortcut:"KeyS"}}};hC=zQ([ue()],hC);new A.FeatureModule(e=>{e($e.QuickActionProvider).to(hC)});var sx=function(e,n,t,i){var a=arguments.length,o=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,n,t,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(n,t,o):s(n,t))||o);return a>3&&o&&Object.defineProperty(n,t,o),o};let pC=class extends Fn{singleQuickAction(n){if(n instanceof Ff&&n.type===Xe.START){const t=A.GArgument.getString(n,"processStartUri")??"";return{icon:V.Play,title:"Start Process (X)",location:"Left",sorting:"A",action:YS.create(n.id,t),readonlySupport:!0,shortcut:"KeyX",removeSelection:!0}}}};pC=sx([ue()],pC);let gC=class extends Fn{constructor(){super(...arguments);x(this,"supportedEventTypes",[Xe.START,Xe.START_ERROR,Xe.START_SUB,Xe.START_HD,Xe.START_HD_METHOD])}singleQuickAction(t){if(t instanceof Ff&&this.isSearchViewAvailable(t.type))return{icon:V.Search,title:"Search callers of this process (O)",location:"Left",sorting:"B",action:WS.create(t.id),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyO"}}isSearchViewAvailable(t){return this.supportedEventTypes.includes(t)}};gC=sx([ue()],gC);new A.FeatureModule(e=>{e($e.QuickActionProvider).to(pC),e($e.QuickActionProvider).to(gC)});class UQ extends A.BaseJsonrpcGLSPClient{error(n,...t){console.error(`[IvyJsonrpcGLSPClient] ${n}`,t),CB({text:`${n}  (Click to reload)`,className:"severity-ERROR",duration:-1,close:!0,gravity:"bottom",position:"left",onClick:()=>window.location.reload()}).showToast()}handleConnectionError(n){this.error("Connection to server is erroring. Shutting down server.",n),this.stop(),this.state=A.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===A.ClientState.Stopping||this.state===A.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}this.error("Connection to server got closed."),this.state=A.ClientState.ServerError}}}var $Q=Object.getOwnPropertyDescriptor,YQ=(e,n,t,i)=>{for(var a=i>1?void 0:i?$Q(n,t):n,o=e.length-1,s;o>=0;o--)(s=e[o])&&(a=s(a)||a);return a};let mC=class{handle(e){A.NavigateToExternalTargetAction.is(e)&&window.open(this.evaluateTargetUrl(e.target),"_self")}evaluateTargetUrl(e){const n=new URL(window.location.href);n.searchParams.set("pmv",this.evaluatePmv(e));const t=this.getArg(e,"processPid");if(t)n.searchParams.set("pid",t),n.searchParams.delete("file");else{const a=e.uri.substring(this.indexOfPmvSlashInUri(e.uri));n.searchParams.set("file",a),n.searchParams.delete("pid")}const i=this.getArg(e,A.NavigationTarget.ELEMENT_IDS);return i&&n.searchParams.set("select",i),n.toString()}evaluatePmv(e){const n=this.getArg(e,"pmv");return n||e.uri.substring(1,this.indexOfPmvSlashInUri(e.uri))}indexOfPmvSlashInUri(e){return e.indexOf("/",1)}getArg(e,n){if(e.args&&e.args[n])return e.args[n].toString()}};mC=YQ([ue()],mC);const WQ=new A.FeatureModule((e,n,t)=>{A.configureActionHandler({bind:e,isBound:t},ht.NavigateToExternalTargetAction.KIND,mC)},{featureId:A.navigationModule.featureId}),ZQ=new A.FeatureModule((e,n,t)=>{A.bindAsService(e,A.TYPES.IUIExtension,_t),A.configureActionHandler({bind:e,isBound:t},ws.KIND,_t),A.configureActionHandler({bind:e,isBound:t},Yf.KIND,_t),A.configureActionHandler({bind:e,isBound:t},A.RemoveMarqueeAction.KIND,_t),e($e.QuickActionProvider).to(Wf)});function QQ(){const e=window.location.protocol;if(e.startsWith("http")){const n=window.location.href;return n.substring(e.length+2,n.indexOf("/process-viewer"))}return"localhost:8081"}function JQ(){return window.location.protocol==="https:"||zR().get("secure")==="true"}function XQ(){return zR().get("mode")==="preview"}function zR(){return new URLSearchParams(window.location.search)}var eJ=Object.defineProperty,tJ=Object.getOwnPropertyDescriptor,J_=(e,n,t,i)=>{for(var a=i>1?void 0:i?tJ(n,t):n,o=e.length-1,s;o>=0;o--)(s=e[o])&&(a=(i?s(n,t,a):s(a))||a);return i&&a&&eJ(n,t,a),a};const ax=Symbol("ContainerSymbol");let $d=class{constructor(){x(this,"actionDispatcher");x(this,"options");x(this,"container")}async postModelInitialization(){await this.dispatchAfterModelInitialized(),XQ()||this.actionDispatcher.dispatch(cm.create())}async dispatchAfterModelInitialized(){const e=[];return this.isNumeric(this.options.zoom)?(e.push(qf.create({zoom:+this.options.zoom/100})),e.push(...this.showElement(n=>A.CenterAction.create(n,{animate:!1,retainZoom:!0})))):e.push(...this.showElement(n=>um.create({elementIds:n,animate:!1,retainZoom:!0}))),e.push(Kf.create({theme:this.options.theme})),this.actionDispatcher.dispatchAll(e)}showElement(e){if(this.options.highlight)return[e([this.options.highlight])];if(this.options.select){const n=this.options.select.split(A.NavigationTarget.ELEMENT_IDS_SEPARATOR);return[A.SelectAction.create({selectedElementsIDs:n}),e(n)]}return[]}isNumeric(e){const n=parseFloat(e);return!isNaN(n)&&isFinite(n)}};J_([Pe(A.GLSPActionDispatcher)],$d.prototype,"actionDispatcher",2);J_([Pe(A.TYPES.IDiagramOptions)],$d.prototype,"options",2);J_([Pe(ax)],$d.prototype,"container",2);$d=J_([ue()],$d);const nJ=new TY(e=>{e(A.TYPES.IDiagramStartup).toDynamicValue(n=>{const t=n.container.createChild();return t.bind($d).toSelf().inSingletonScope(),t.bind(ax).toConstantValue(n.container),t.get($d)}).inSingletonScope()});var iJ=P_(),cx=Object.defineProperty,rJ=Object.getOwnPropertyDescriptor,oJ=(e,n,t)=>n in e?cx(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,X_=(e,n,t,i)=>{for(var a=i>1?void 0:i?rJ(n,t):n,o=e.length-1,s;o>=0;o--)(s=e[o])&&(a=(i?s(n,t,a):s(a))||a);return i&&a&&cx(n,t,a),a},sJ=(e,n)=>(t,i)=>n(t,i,e),aJ=(e,n,t)=>oJ(e,n+"",t);let Gy=class{constructor(){x(this,"url")}};Gy=X_([ue()],Gy);var zy;(e=>{e.KIND="caseVisualizationCommand";function n(){return{kind:e.KIND}}e.create=n;function t(i){return A.Action.hasKind(i,e.KIND)}e.is=t})(zy||(zy={}));let Qf=class extends A.Command{constructor(n){super();x(this,"processData");x(this,"edgeRouterRegistry");this.action=n}execute(n){const t=n.root;return this.populate(t)}async populate(n){const t=await(await fetch(this.processData.url)).json(),i={color:t.passedColor},a={color:t.activeColor};return t.nodes.forEach(o=>{const s=n.index.getById(o.id);(s instanceof dm||s instanceof Vd||s instanceof Fd||s instanceof PR)&&(o.passed&&(s.args=i,s.cssClasses=["passed"]),t.activeElementIds.includes(o.id)&&(s.args=a,s.cssClasses=["active"]))}),n}undo(n){return n.root}redo(n){return this.execute(n)}};aJ(Qf,"KIND",zy.KIND);X_([Pe(Gy)],Qf.prototype,"processData",2);X_([Pe(iJ.EdgeRouterRegistry)],Qf.prototype,"edgeRouterRegistry",2);Qf=X_([ue(),sJ(0,Pe(A.TYPES.Action))],Qf);var cJ=Object.defineProperty,uJ=Object.getOwnPropertyDescriptor,ux=(e,n,t,i)=>{for(var a=i>1?void 0:i?uJ(n,t):n,o=e.length-1,s;o>=0;o--)(s=e[o])&&(a=(i?s(n,t,a):s(a))||a);return i&&a&&cJ(n,t,a),a};let bm=class{constructor(){x(this,"actionDispatcher");x(this,"handle",()=>{this.actionDispatcher.dispatch(zy.create())})}};ux([Pe(A.GLSPActionDispatcher)],bm.prototype,"actionDispatcher",2);bm=ux([ue()],bm);const lJ=new A.FeatureModule((e,n,t)=>{A.configureActionHandler({bind:e,isBound:t},A.UpdateModelAction.KIND,bm),A.configureActionHandler({bind:e,isBound:t},A.SetModelAction.KIND,bm),A.configureCommand({bind:e,isBound:t},Qf)});function dJ(e){const n=DQ("sprotty",A.createDiagramOptionsModule(e),xQ,WQ,nJ,RQ,lJ,{remove:[gB,mB,FB,WB,EB,nB,A.deletionToolModule,A.edgeEditToolModule,A.nodeCreationToolModule,UB,tx]},{remove:zB,add:ZQ});return DW(n,{hideSensitiveInfo:!0}),n}const Za=zR(),UR=Za.get("app")??"designer";let vC=Za.get("server");vC||(vC=QQ().replace(UR,""));const fJ=Za.get("processUrl")??"http://localhost:3000/mock.json",hJ=Za.get("pmv")??"",lx=Za.get("pid")??"",dx=Za.get("file")??"",N8=Za.get("highlight")??"",pJ=Za.get("select"),gJ=Za.get("zoom")??"",mJ=Za.get("theme")??Ud.prefsColorScheme(),yC="ivy-glsp-process-viewer",B8="ivy-glsp-process",vJ=ht.ApplicationIdProvider.get()+"_"+dx+lx,yJ=`${JQ()?"wss":"ws"}://${vC}/`,_J=`${yJ}${UR}/${yC}`;let _C,ry;const bJ=new A.GLSPWebSocketProvider(_J,{reconnectDelay:5e3,reconnectAttempts:120});bJ.listen({onConnection:fx,onReconnect:SJ,logger:console});async function fx(e,n=!1){_C=new UQ({id:yC,connectionProvider:e}),ry=dJ({clientId:vJ,diagramType:B8,glspClientProvider:async()=>_C,sourceUri:dx,editMode:A.EditMode.READONLY,highlight:N8,select:pJ,zoom:gJ,theme:mJ}),ry.bind(Gy).toConstantValue({url:fJ}),await ry.get(A.DiagramLoader).load({requestModelOptions:{isReconnecting:n,app:UR,pmv:hJ,pid:lx,highlight:N8,readonly:!0,diagramType:B8},initializeParameters:{applicationId:ht.ApplicationIdProvider.get(),protocolVersion:ht.GLSPClient.protocolVersion}});const i=ry.get(A.GLSPActionDispatcher);if(n){const a=`Connection to the ${yC} glsp server got closed. Connection was successfully re-established.`,o=5e3,s="WARNING";i.dispatchAll([A.StatusAction.create(a,{severity:s,timeout:o}),A.MessageAction.create(a,{severity:s})])}}async function SJ(e){_C.stop(),fx(e,!0)}
